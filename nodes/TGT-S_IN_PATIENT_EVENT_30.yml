fileVersion: 1
id: b21ad428-90dd-4468-bcad-a35cbfb50c59
name: S_IN_PATIENT_EVENT_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ea4766b-b43c-437a-ae80-cc1e36881c81
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07a1e033-9d59-4f18-b428-35316d9fb6b4
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfa707bb-f5db-4ff9-a4f4-93f879e94f8e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79b9c8b7-452e-484d-a66c-db39b8215209
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d864dd9b-aeb8-4039-b27c-cbbe2287777d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.event_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d2a26a1-69dc-48b8-8172-a19f116eb868
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27f0f80e-1c1f-4f85-b287-933af381e6be
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7e8b555-6a91-4d77-862f-06684bcf98da
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 642a4760-bec4-478f-9a23-8f19e8b8f7d3
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c5bc11b-46bc-48f8-94da-5d892746126d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37580a07-e17e-43f0-8517-e163812a7e1d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d038e44a-a52f-489c-bb4b-f92c5d1e85b9
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: patient_age_on_arrival_yyymm
        name: PATIENT_AGE_ON_ARRIVAL_YYYMM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: SUBSTRING(CONVERT(varchar,s_in_patient_event_20.patient_age_on_arrival_years + 1000),2,3) + ':' + SUBSTRING(CONVERT(varchar, (s_in_patient_event_20.patient_age_on_arrival_months % 12) + 100),2,2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd97ecd5-926d-4439-9768-c5a1fdd9ff13
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: string of specialty that patient stayed-in during the encounter
        name: EVENT_STAYS_SPECIALTY_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 560c578f-c3de-48f5-9a9b-46bca52516e4
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b011e20-decb-433c-916d-91a5d3092dd4
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_years
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73609387-383d-43ba-aa84-c1f991c57934
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed39cb80-ffef-4267-a393-727918685f60
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_months
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60336580-3224-44c2-9135-0d36457cd014
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d87b9dc1-7496-41cc-8592-fd988eb7f235
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.event_stays_specialty_path=dim_event_stays_specialty_path.event_stays_specialty_path
        name: DIM_EVENT_STAYS_SPECIALTY_PATH_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9eaea674-6242-444d-adbb-d84e31462605
                stepCounter: 957acdb6-9c32-43e6-904f-a9187e7c758c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07602956-7a52-4bef-a1cd-4cebe4299c91
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.patient_age_on_arrival_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59401b1b-f1f0-4176-ba49-58cdb4475dc3
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 335b7be7-a1ed-485e-93d6-a82980b9f728
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78e7fa78-17f2-48a5-a053-549eb8e6636b
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e27c45bd-c8ed-4474-a218-97391eb59823
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29466b7a-664c-486d-b789-3908f71fd076
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PLANNED_CARE_INTERVENTION_COMPONENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfd1a9f2-0d00-49cb-89d7-88697e4ad2f4
                stepCounter: 23ff231f-9b21-4bd4-b0c3-da82c0b9758c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b995ef12-85d7-444b-aa1a-ddfa9107144a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PLANNED_CARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef1f72de-9847-4770-8eda-48e40fdb696b
                stepCounter: 2c51f4f9-57b5-4407-b99a-a74174e84fac
            transform: IFNULL(dim_planned_care_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddfe9ac7-dda0-4ea2-b3a8-1a773de1073e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cee177ad-5827-4015-b67e-a1e9d3f4270b
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ce5beee-0e44-4c65-b4b1-289f06617c90
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d45ae76-45f1-47a6-8d93-a6893e71735a
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d311f990-de3a-4abe-9036-97cdbd68f56d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_MANAGEMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 116e99d4-ddd2-4588-9fd5-e5e31f3fa98e
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa3f0a74-3715-448f-8335-0bd11de95dc3
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.prof_carer_episode_outcome_reference_no=dim_discharge_outcome.discharge_outcome_reference_no
        name: DIM_DISCHARGE_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42560fe6-8d10-43ee-862a-7299d15d3238
                stepCounter: 0278f074-fa5d-4c3c-819f-5f01eabb1142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28907eca-e1d1-43b6-acf0-c99577f6f71b
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_management_type_reference_no=dim_intended_management_type.intended_management_type_reference_no
        name: DIM_INTENDED_MANAGEMENT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef8aa76d-9ad7-408b-a895-3c1f5f07304b
                stepCounter: 8f205619-162f-4c3e-9f3b-af7f11b78334
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42fd8cd1-ebd1-48ec-94cc-4b20b0b7cdf0
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.patient_management_type_reference_no=dim_event_type.intended_management_type_reference_no
        name: DIM_EVENT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bbdc354-7178-4933-9651-c7e115d0cf92
                stepCounter: 3fdf4180-c40e-4f94-9cbb-852501d299b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29d62f0a-f10a-4717-92c3-ae3cb230d8e8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2e426c1-ec3b-49a9-955f-b740e0796c3a
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c777937-d84e-4b88-8ad5-18e6fb7b11a6
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admin_category_reference_no=dim_inpatient_admin_category.inpatient_admin_category_reference_no
        name: DIM_INPATIENT_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e264e9a-81eb-4993-96d0-0f0c1df44adf
                stepCounter: 9cf2dc59-d690-483b-a875-60ead7b456c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14b60397-a9f8-4adb-9995-7cba23cb827a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admin_category_reference_no=dim_purchaser.purchaser_reference_no
        name: DIM_PURCHASER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5359e9e9-a873-4f6d-8b70-005d22be8ed1
                stepCounter: 83d04de3-0551-4ba3-814b-2ca3e4840adf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e5eafc-7214-4625-a0fe-92e5127dccd6
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ee16e59-32a0-44a6-a5c5-08d0c2b3a4d6
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6745b690-ef3c-466d-be8c-7aedd8b0649d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: first_actual_theatre_date
        name: FIRST_ACTUAL_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e720c938-9951-4b45-9441-f5df31d0d5d8
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05e04197-76d3-4682-8f5c-b0f8c7fa28f5
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR (1)
        defaultValue: ""
        description: into_theatre_flag
        name: INTO_THEATRE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c209d53-c32e-4991-84aa-dcee626f6b1d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1961949-d6da-4645-93e0-a9fba3084846
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: pre_admit_date
        name: PRE_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b61de2f6-5515-4ccc-ad6d-47dce49c5a46
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3435f344-1cb2-45af-adaa-b102a26de702
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae5ceaf9-c2ec-4b9f-870b-0415dac1da9d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2359c4b-d98c-411a-86cb-e28da2a269f1
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.CONVERT(date,s_in_patient_event_20.admission_date)=dim_admission_date.admission_calendar_date
        name: DIM_ADMISSION_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b402ec63-d2cf-47e5-ab27-e5c03a6296f4
                stepCounter: 9996feda-efbd-41f4-8569-36f5c8b63c75
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d20f218-1cdd-49fb-9f1e-932cce466e23
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e5ae9fb-b1fa-4782-b2a0-ce70ac07d0a5
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 579abf23-45cc-444a-9a24-58abeaa5287d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admission_ward_reference_no=dim_admission_ward.admission_ward_reference_no
        name: DIM_ADMISSION_WARD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6de0d799-570f-44e1-ab72-e01157ee4c80
                stepCounter: 0b4f315f-51cb-4593-8623-b32f3fc664aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1851806f-5b02-409e-86a0-8d4928fe220a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a6bc33b-4faf-4747-9def-1f1deabc827e
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eae4e84d-f501-4385-b66e-3984bc7c3da0
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admission_clinician_reference_no=dim_admission_clinician.admission_clinician_reference_no
        name: DIM_ADMISSION_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34bd1187-6d8f-4c2b-9eb2-a0cce6f50aae
                stepCounter: 90b9aba6-49fc-4ba5-8f65-83c15df32c79
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a212c10e-4eab-4783-9179-fc5a53889614
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04b901f9-66b7-4928-8230-b5f226dc10b3
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4dc42ca-909b-4e85-9589-d32adf8887da
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge outcome
        name: PROF_CARER_EPISODE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c9e892e-b84a-4de1-97d3-8f6461b7b9de
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e49e6c49-0a27-4c6d-a11f-da4309d5f6cc
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admission_specialty_reference_no=dim_admission_specialty.admission_specialty_reference_no
        name: DIM_ADMISSION_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7032326d-f344-413c-aab1-3525299c9ceb
                stepCounter: 653bb678-9e6b-4b04-9b51-5cbba170a526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 749398b5-b05d-4c2d-8f49-a99202eec653
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e205a3b-7abd-4028-8b43-ee7c75788093
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe78bbb1-5480-4b4a-b3d5-9626615d50b9
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5542c4ed-5744-4530-b8ce-3d0efc958831
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c9d96d-e9ce-4787-9446-ecf386b428d6
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admission_method_reference_no=dim_admission_method.admission_method_reference_no
        name: DIM_ADMISSION_METHOD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f228ac9a-42c6-489f-bcad-ee502f61a194
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc76f1f5-061b-4c82-bd19-be835a6ebb0a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admission_method_reference_no=dim_admission_type.admission_method_reference_no
        name: DIM_ADMISSION_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2e60128-b077-486c-b90e-18022d25b932
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 413407e2-6ac8-49a8-ad4e-25a21a62c77a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_SOURCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b193a8b-6ba9-43f7-ab07-fa9617045c33
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0279d955-7f82-4ae9-82c8-6e1c142c5624
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.admission_source_reference_no=dim_admission_source.admission_source_reference_no
        name: DIM_ADMISSION_SOURCE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c51545c-208a-4795-b104-c8e71ed30273
                stepCounter: 03e13fac-da9d-4222-8e2c-95b3d7218199
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79bce439-33d0-405d-bb54-233c2e0ad332
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_INSTRUCTION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4485ce0e-3c13-47ba-a086-27ecc18ce122
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ef9c38c-7220-4d1d-b775-2c32a5d5f5cc
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf1c6d78-cbd5-46cb-a95e-215a73efc675
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af2c0596-fd40-4327-87ee-9458b48f8a0e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ED_FIRST_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cc321c8-f429-4ee7-9760-370644fd7e9a
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4818a0f1-da5a-45d6-9dfa-97ef1d270034
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dcff920-7866-4419-ae42-95b70a04c9e1
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bab9a2f-ee12-4e38-8064-4ee4ad77cad1
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a23da2de-aefb-46c7-b595-7f061608ad3d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4de76ccf-028b-4f1b-b248-f0ac937992da
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abada4e0-bfcb-4409-9a53-4ef3a8a8c54b
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 606f481c-3927-4054-ac15-a84ef8fea160
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d687f2ac-eaaf-447b-b09d-2649d52460fb
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a692ee4a-be5f-4a19-a5c4-ec20ec787e54
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee01c182-1319-4db0-b562-a1868f7ca5d8
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c621d4c-dc3c-48e5-9322-93d3563269aa
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2881274-9522-4d03-8ed3-e3e8ffda19e3
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c351884-931d-4d29-9ccd-a0affad6989c
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGE_DESTINATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ae84e89-d293-4dca-a958-94185d5aa3e5
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ea2e0bc-5c9d-4e74-b418-320376067ad3
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.discharge_destination_reference_no=dim_discharge_destination.discharge_destination_reference_no
        name: DIM_DISCHARGE_DESTINATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50139081-3c61-470c-a651-adf046a5ce35
                stepCounter: a05a4266-44b7-4574-abee-00c3094cf764
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb6a3841-a870-4e2f-919f-3b0d96de2b42
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGE_METHOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e9f52e5-a560-4500-9541-6c5922b66f68
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4a3525c-5494-4aeb-b42d-3778647ba8dc
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.discharge_method_reference_no=dim_discharge_method.discharge_method_reference_no
        name: DIM_DISCHARGE_METHOD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c35b6168-30f1-4fd6-922f-b82f113e0d3e
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c919162e-0bda-42c2-9509-3fb6f628c77c
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 841434fc-443c-4512-a621-a5570efb951f
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ce1b529-96a4-4a35-897b-626996175598
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.discharge_method_reference_no=dim_event_end_type.discharge_method_reference_no
        name: DIM_EVENT_END_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe0f265-db60-4c13-a017-42c40d326d36
                stepCounter: 4bc73c85-857d-4c3e-a52a-ddec6f472a2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e714389-b0d9-47e4-afdd-8fc3c2d043ff
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac468aa4-e852-4790-980d-d2bedfb8ba9f
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a96b16dd-951e-4277-9c65-1c4dff11510c
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.CONVERT(date,s_in_patient_event_20.discharge_date)=dim_discharge_date.discharge_calendar_date
        name: DIM_DISCHARGE_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985b56af-022e-46b3-82b0-51ae204ca926
                stepCounter: 45fbd3a8-64d0-4be6-b03a-8d128a18b549
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d883652-e552-409f-90f2-b3976454253f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb12c2ca-91a1-4877-93e8-637b94682806
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cf2ee82-508b-4beb-927e-18cbbcee4c06
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGE_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cf7d7d4-409e-4e78-91a0-b9b88da4aab4
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82cf9554-e0bf-49a1-bda4-8b3ef7736fd6
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.discharge_ward_reference_no=dim_discharge_ward.discharge_ward_reference_no
        name: DIM_DISCHARGE_WARD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a25735e-86ed-4c2f-a186-3de54d64cd3b
                stepCounter: eb6e873e-8280-46c0-88b0-99a491465182
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99c65746-c6e2-43d6-909b-f96ccfda44ba
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGE_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7b9166e-a153-41d0-a185-3c62d60ee364
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82e185ee-3d25-4845-853f-fcbbf718a7bb
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.discharge_clinician_reference_no=dim_discharge_clinician.discharge_clinician_reference_no
        name: DIM_DISCHARGE_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cca54d1-eacf-425c-a627-1bac1547c043
                stepCounter: 95f534bc-2a59-4894-85f0-8f8290f11380
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a95e9db-9030-4ac2-92ac-fd2fab04b562
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGE_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c9fe145-eda2-49fa-8bd4-67c39b3b26f1
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e4dadfd-2a3b-4c8c-8fa2-acc9b55ed203
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.discharge_specialty_reference_no=dim_discharge_specialty.discharge_specialty_reference_no
        name: DIM_DISCHARGE_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 958dc448-145a-434d-9ea4-20fc505ee700
                stepCounter: 0a4357f3-ec96-4b4a-843e-aee2051c1131
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c852e5a-d072-453f-bbda-5c820f2bd850
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: s_in_patient_event_30.discharge_specialty_reference_no=dim_discharge_specialty.discharge_specialty_reference_no
        name: DISCHARGE_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d73e4b9-91ea-4c8f-a79a-03f2162a7d00
                stepCounter: 0a4357f3-ec96-4b4a-843e-aee2051c1131
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca310e15-5c7c-4b33-aa57-03b6a16b2d8d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa0ff4d-d739-4c28-a439-40629da6e9b4
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cf0a8a1-8e3e-4163-96f1-efde8c9c8ccf
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: IFNULL(dim_purchase_unit.dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccfe5694-9fd1-4c37-998e-4091241c4971
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.uncoded_purchase_unit_code=dim_uncoded_purchase_unit.purchase_unit_code
        name: DIM_UNCODED_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2b6f7c4-a447-4c41-93f2-96d0676701ea
                stepCounter: 192ea736-b48b-4ab1-a121-8b7b65c220d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a98bbc0-5661-466b-bbb2-429eb6d391fb
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: s_in_patient_event_30.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: UNIT_OF_MEASURE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3492fd8-fd8a-459a-9679-e766025ec26f
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 714a9d98-0b48-4910-af36-7e57eb62db98
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f33d40f-590c-44bf-af1a-a4923b02f185
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bac67dc5-f826-4936-9bee-4480374831b8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.replace(s_in_patient_event_20.responsibility_centre_code,'-','')=dim_responsibility_centre.responsibility_centre_code  s_in_patient_event_30.'120'=dim_responsibility_centre.company_code
        name: DIM_RESPONSIBILITY_CENTRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9a966f-0750-4c8b-a92a-a034376ca161
                stepCounter: a84cf165-8cc6-4510-8bae-53366e2d4ff7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f039cbbd-49dd-4eee-a2a5-3bc22e4f0cf5
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PAYMENT_METHOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b2a4e40-4542-418e-9f58-8f939bbd1557
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5d8157b-a87b-465f-b44d-efecdc7aa38f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ffb601f-a8ce-4804-b24c-0411c3e5767c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: "'R' + CONVERT(varchar,s_in_patient_event_20.referral_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff85e5d7-6f4a-48cb-a448-5053c1db861d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47e88be1-5bf2-42bd-b7b5-454468f13976
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d4ac0e7-a311-4e13-81f5-9917f5b39437
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 758ee22d-e88a-45bd-8e85-a6017a08e7bc
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef61c760-9243-4fde-8143-6b80ac5826f2
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.referred_to_specialty_reference_no=dim_referred_to_specialty.referred_to_specialty_reference_no
        name: DIM_REFERRED_TO_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce861156-c605-4141-85aa-6a68ce6fdf3e
                stepCounter: 8cbba75c-bfb6-4f40-8f3c-ad41dfe782e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f9d35aa-ab20-45fc-92c1-388188638dff
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515ac8f0-5bd7-46c8-a0f5-6eceecdcf19d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5fbcb8f-2154-46be-9e16-6f806c7614df
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515ac8f0-5bd7-46c8-a0f5-6eceecdcf19d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: IIF(waitlist_encounter_id IS NULL, NULL, ROW_NUMBER() OVER (PARTITION BY s_in_patient_event_20.waitlist_encounter_id ORDER BY s_in_patient_event_20.discharge_date DESC))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f5ecc62-d10c-4f83-91ce-89faff4b065e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASSESSMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efcb39e5-b2f9-4f0a-9e2a-a0dc81437743
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2efa92d4-b808-4879-9b9e-75f7fc1b8627
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5351abed-388f-419e-ac2a-3ea5841ffb58
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a38c40c-77dc-4117-b407-f6bb2244446d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28c9be2c-57d4-4ae7-a823-3e5c97e0c0dc
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e20a0eb8-c242-4b31-b4c8-ac17ee795b8f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef796997-c2d4-4073-a269-48316a45ab45
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5258dcf2-9fc9-4a9d-aa28-1e13b551247e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73bfb61b-cc9b-4f34-ba0f-a65bd1e13652
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d59dc592-65ae-40ae-b0f9-a64c11ad2baa
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2369f3a3-f341-4941-ae66-1aeb10e48ae6
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a4f7b42-45cd-47e8-8ca8-1ed9d1c7c031
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb0f37c4-0c9d-4afb-8ca6-0bd8fa236980
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9a4f21-fd3b-4025-8b41-45711bebe222
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d187042e-b061-48d2-9cc0-8a39a29e70aa
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6281d4d8-2b1c-4c4d-a26b-7e125c2c03ea
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 106388aa-f929-41a3-93b6-a1ead51c585d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ded98b7c-1a54-49b8-a820-de90a81f33fb
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.seen_by_clinician_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8256082b-4be4-4602-8885-5310ae661af8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ccba167-041a-4371-9cf4-8c805d113e00
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4f1306c-015b-4723-aced-5c8d8ec5ed7b
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eddcca1c-f885-439b-8d1d-f016192bf424
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2a1ce16-3b1b-4389-80cd-dcee3921595b
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 442590b7-2435-48e2-a73b-051486fd2940
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0af4aebd-60e8-433b-88b4-62b6b396c440
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_EXCEPTION_OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 597db3b8-811f-4e84-9d55-06c5541c9cdd
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9437e42e-51c9-420a-b822-0b2f18d7971f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.NPF_exception_outcome=dim_NPF_exception_outcome.exception_outcome_code
        name: DIM_NPF_EXCEPTION_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f65f512-c838-45f9-9c99-03ccd8942045
                stepCounter: de95585c-3973-4aa4-987a-c2bd807c83eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18b04500-55d5-43b3-a0f1-994d5c9d01ba
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Hospital Code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed1aa6ee-e27f-4e74-a543-836dfa5151bf
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 517bd32b-0aba-4da7-a8da-a3291c68b373
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.hospital_id=dim_hospital.health_org_reference_no
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: IFNULL(dim_hospital.dim_hospital_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7e27618-0de5-4aa2-9d6c-434866151912
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this record sent to NPF as an exception
        name: NPF_EXCEPTION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 023c2c06-dbb7-4679-9bb8-e0b56968d153
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cff883f8-9f00-406b-b612-337b734aabca
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.NPF_exception_outcome_reason=dim_NPF_exception_outcome_reason.exception_outcome_reason_code
        name: DIM_NPF_EXCEPTION_OUTCOME_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d082ab8-187b-4a22-87f3-1bfb58e06f59
                stepCounter: 1c26847e-de88-4f48-ae5a-850eb494754a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aba633cf-fb39-4152-819f-08abd76d30be
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.health_org_reference_no=dim_health_organisation.health_org_reference_no
        name: DIM_HEALTH_ORG_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78290bb6-3cd5-4503-8179-d1f65525ba15
                stepCounter: 0790fdf4-e815-4587-a9cd-954ea13f53c6
            transform: IFNULL(dim_health_organisation.dim_health_org_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2376433a-60b2-44e2-93a4-46ddfce65979
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1c9fcd5-a011-47ed-b9d8-f72c68bb7d74
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb7a4f6c-3984-40d4-ad65-8d46fc01eb02
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_EXCEPTION_OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d8d93be-aaf8-454c-ba53-138906f3a76e
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7394840d-e5f8-485d-8f90-8b31a8a65427
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebb04604-adfd-4e92-95d8-2394a07511fe
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e67f69c-c663-4d29-a966-42241cea93c9
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.event_ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: IFNULL(dim_ward.dim_ward_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56f74468-b076-4cd6-9bf3-c72ca8d3acfb
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_WARD_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b23eccd5-22bb-4544-a25e-35764e898b60
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d51b0da9-fe67-45bc-9542-d0a3d0c6dd5f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.NPF_destination=dim_NPF_destination.destination_code
        name: DIM_NPF_DESTINATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1352b01f-82ed-41dd-b799-6e2953d0c679
                stepCounter: 100dcac0-0a8b-413b-9cbe-c72cf0f8097b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5dd8dfc-c6bf-4c03-be8e-f82cc076740d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: NPF_REFERRED_TO_ORGANISATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a45ef3c6-f9f2-495c-bb3e-e748a44a5849
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 399093fa-dea0-4d78-8401-8210366e9303
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.NPF_attendance_outcome_code=dim_NPF_attendance_outcome.NPF_attendance_outcome_code
        name: DIM_NPF_ATTENDANCE_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d66d2ff-693b-4583-9d51-0efeeccea38b
                stepCounter: c0b1eb3a-4edf-4da7-bf54-e022e48a682f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12c14b1e-0bc1-41ea-afc9-202c74421e89
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: NPF_ATTENDANCE_OUTCOME_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8657f44c-009f-44e0-b564-388a27da137c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fecccf8f-70e1-4eec-9186-75704fdb5a58
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9f978d0-d90b-4231-bc59-ba43da1cc5e8
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca382fe0-793a-4ea4-8b74-4b6ad473657e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8d8a523-1080-4b28-86d8-227c9721d65e
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f1a6a7-0c66-46cf-96e2-ec160eb1d4c7
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.NPF_encounter_outcome_reason=dim_NPF_encounter_outcome_reason.encounter_outcome_reason_code
        name: DIM_NPF_ENCOUNTER_OUTCOME_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2defdd06-863b-47dc-a356-8dbb7103a3ad
                stepCounter: 773fcb9a-3148-41f1-95ce-7c53960a7310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 814493a4-8716-4c77-931f-f9266fe1ed3c
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_ENCOUNTER_OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c36aeef-81ba-498f-be49-86d14d588d2f
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23788196-43e3-4ee1-9778-dc0fc9362083
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be85d258-062c-4abc-b1fd-b698db736b2c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5894d50f-18d3-4954-aa36-22c752a7d0f8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.MDC_code=dim_MDC_code.MDC_code
        name: DIM_MDC_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23085b92-b2e0-4c56-9010-c0b5de017357
                stepCounter: fefa4b8d-0977-47df-951a-4365058f9b77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd47cf0e-4c9a-4f61-8c6f-145f402c65bb
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.NPF_encounter_outcome_decision=dim_NPF_encounter_outcome_decision.encounter_outcome_decision_code
        name: DIM_NPF_ENCOUNTER_OUTCOME_DECISION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79980fd0-f785-48c6-ad7d-15873206cafd
                stepCounter: 88d8f181-2811-469e-9024-809ca77fbdba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 714bf284-3b37-4c9b-a21f-1005650c2cda
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_ENCOUNTER_OUTCOME_DECISION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21025256-b73c-4d7c-8115-fca308180d4d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad42a95f-f6ee-4777-a3b9-c76f36a4cd92
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aab23b3-9435-4f05-bc7b-2df1327cf924
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adeb5058-828b-4071-b5a6-664ba8ed10c5
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fea4d93-0ac4-43b7-992a-a2e88e8aaba3
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_event_30.DRG_code=dim_DRG_code.DRG_code
        name: DIM_DRG_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bd0a5c0-d5a2-4d49-91dd-c4253418a9b4
                stepCounter: c9ea96b1-10f0-4480-aff0-b535fb105991
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29d5ab33-1bf7-4025-a58d-668381d53a56
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SURGICAL_HEALTH_TARGET_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ad4fd15-dcb7-486f-90f5-2567a220e0e2
                stepCounter: b7aeb03e-117e-40ed-a46b-1ffdc584428d
            transform: |-
              CASE WHEN discharge_date < '1 jul 2023' THEN CASE WHEN dim_domicile.IDF_class = 'Non-IDF' THEN IFNULL(dim_surgical_health_target.dim_surgical_health_target_key,0) ELSE 0 END
                          ELSE IFNULL(dim_surgical_health_target.dim_surgical_health_target_key,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa75b734-ab34-408c-89fe-5623d9d752a4
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Surgical health target volume
        name: SURGICAL_HEALTH_TARGET_VOLUME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ad4fd15-dcb7-486f-90f5-2567a220e0e2
                stepCounter: b7aeb03e-117e-40ed-a46b-1ffdc584428d
            transform: |-
              CASE WHEN discharge_date < '1 jul 2023' THEN CASE WHEN dim_domicile.IDF_class = 'Non-IDF' THEN CASE WHEN IFNULL(dim_surgical_health_target.dim_surgical_health_target_key,0) <> 0 THEN 1 ELSE 0 END ELSE 0 END
                          ELSE CASE WHEN IFNULL(dim_surgical_health_target.dim_surgical_health_target_key,0) <> 0 THEN 1 ELSE 0 END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4f24a6b-18f3-4374-bb33-9d16217aed99
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES_MOH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 381d1eac-e932-49dc-b4fa-2544f4a0da6c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd985d04-19a2-47ab-a1c8-fcf80c78b6bb
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69f46cd6-e19a-42e5-abcc-6b719bffd847
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a223b508-4e91-4068-b272-c0b297b486db
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2c25c9d-1979-4097-b540-16f2db93b88e
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aba3ccc-4ef5-4e29-bb63-f2ee10b8b2b4
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES_AVERAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 909a2e19-5d88-46d5-9981-2e0d8e6cc46e
                stepCounter: 95ed83bf-7e19-497e-8bae-40732da8defe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4250a2e2-3b4a-4359-a872-1c0ce5a82f3a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES_REPORTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 381d1eac-e932-49dc-b4fa-2544f4a0da6c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: IFNULL(s_in_patient_event_20.WIES,s_in_patient_coded_WIES_v.WIES_rating_avg)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 469566d1-df63-4ce7-9c18-0b3708fff84f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9bb1bd9-b088-44fb-900f-5a700a5e1f1f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 823c1366-3c38-4fc1-85be-a12855ac7d59
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 240ee58b-2409-4690-8535-eb1f98be3b7c
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 381d1eac-e932-49dc-b4fa-2544f4a0da6c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: |-
              CASE WHEN dim_inpatient_admin_category.inpatient_purchaser IN ('35') THEN CASE WHEN dim_purchase_unit.unit_of_measure = 'Cost Weighted Discharge' THEN IFNULL(s_in_patient_event_20.WIES,s_in_patient_coded_WIES_v.WIES_rating_avg) WHEN dim_purchase_unit.unit_of_measure like '%bed day%' THEN s_in_patient_event_20.event_length_of_stay ELSE 1 END
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9898f3d0-1ffb-47df-a90e-fbb4e3b8c6a8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d7cfcf2-2be7-4fe9-a949-f305088f45da
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19483491-b173-49dc-8495-5c5eb56f0f3f
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5593a8d0-5ece-4115-99b1-e2475246bdc7
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b619d8fc-814d-4c55-8976-a8fa602e501e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: ""
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a43f443d-2dcf-4fec-82e4-cfee732c0530
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3bb2b7d-f5d4-4060-94cc-4d3662632f65
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a50663a-df1e-4a1a-96a3-42f2a1b6c8ee
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fbb65d7-b819-4418-a6eb-9b32a74127c9
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event identifier for the MoH OS3 ALOS measure that connects across events.  The event use is the last event in the sequence.
        name: OS3_MASTER_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d201460b-0253-4efe-9673-f764faa9636c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5937a325-0b49-4aa1-ab84-bd380bf5769e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INT
        defaultValue: ""
        description: OS3 Event sequence 1= the first event in the series
        name: OS3_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b09aa6a9-706c-47a9-a20e-f56f74292b57
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b8361eb-50ad-4b09-a892-d0b8b439f2b1
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Event LOS in 30 minute units for the MoH OS3 ALOS measure that connects across events.  '
        name: OS3_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 218df89f-9b11-4069-9758-2987d7235b44
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4d30f66-86fc-4e7f-826d-dc7bde3eacce
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e41046dd-d3b0-4ba1-a25b-7e3f8ac81765
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2691abf1-732b-4415-a2f6-c8307b5c075c
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c40fcf5-0971-4263-9d8e-85f43b02f2be
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf7be07f-010d-4cb7-8ee8-d4684e0ee57e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURRENT_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fb68133-9731-4dae-92bc-ffc8def7a24a
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 311091c5-9f3a-4cb7-a95d-107939216277
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 498da220-0991-4f4f-af09-ed2addc314dc
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef6ffb4b-cfa7-4957-9f32-9f8503a7f5e1
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRESENT_TO_NEXT_EVENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd3c7458-6404-4a78-a384-eff12449f466
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0972370b-7d90-44ea-a5d3-cf29a7471679
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2718118d-5311-42f6-a57b-ba3bd7280844
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d513a891-6002-409c-9722-f1b8246d5728
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_TO_CURRENT_EVENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5567aca7-6fcc-4c5c-ad7b-a954f222518f
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf7eb4e4-2dba-4935-a4e3-81591353fbd9
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51ea0010-1bae-4f00-b037-55b1e81c37b8
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: IFNULL(s_in_patient_event_20.event_leave_total_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2213fd45-c61d-4c88-8829-fbb62b78b5fd
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b224bc33-5313-41f2-849d-9f9bf1cf62ae
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d92ed1f1-067d-492d-884e-4eea294e8c53
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b65158c-3c05-4ab0-8850-104bedfe681a
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: IFNULL(s_in_patient_event_20.event_leave_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 827fb751-bb89-4ab0-9f9c-84afdc6717be
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_03
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4033b119-b79b-4913-acd4-023b1630de67
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cbfb1ad-8412-4a3d-bb94-f4b9d1148a55
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_STAYS_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 213ff1ac-1467-43e0-b556-ec574ef14b0b
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1355bed6-9db8-4f71-a03e-6c1d84cce7be
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_04
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdc27dde-41a2-4d2a-bdd2-c4b1ffef04e3
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5ab81d5-e19a-439b-aac1-c3f3037278c8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_STAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7546e35b-c798-4001-a601-c2ca5a8d8a99
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32cfd102-bf30-4f89-a21e-dc87275656fa
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_05
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7feca5a-4586-4a40-955a-eb11df10136a
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4197ade-d057-4a2a-a84f-2788e45435e2
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: A concatenation of all ICD diagnosis code pipe delimited with asterisck denoting the first and last codes
        name: DIAGNOSIS_CODE_ALL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ebbfcb4-4a7d-4591-b3e3-27d7102afe85
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77dedacd-c8a8-494f-9e54-db7ea62d6fb3
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_TOTAL_DURATION_DDHHMM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab5c72a4-49b4-46ff-8504-ec6c0484f358
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47d116ce-75b9-4b20-8e61-a53dda58f910
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_total_duration
        name: EVENT_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c89d5a16-7c97-4655-b52a-c0ac808a810a
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6006f74f-2a8d-45b5-a457-3a5544a3c05e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: IFNULL(s_in_patient_event_20.event_length_of_stay_grouping,-2) = IFNULL(dim_length_of_stay.Day,-2)
        name: DIM_LENGTH_OF_STAY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29868af6-1153-431d-92ef-0484e4838f66
                stepCounter: 0c3de9cb-45cc-4494-acd7-733e0ce5b4b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 780a65b6-da4e-4789-b399-b3858b848bfc
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02f9fb25-9d39-49e6-9a35-6ca61581aae2
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 591abc6f-a829-4d0b-84c2-145f712c6676
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_LENGTH_OF_STAY_DDHHMM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61584803-cb75-4b55-9ec4-0d0b858e6f8c
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 461c812b-29e7-441c-ba28-f3ecdb083eb1
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb468662-eab5-400f-a928-8a1e5147af53
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b71f8eb0-dbfc-4ef7-952d-5038dcb7a8c5
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'Uncoded purchase unit code retained in this field '
        name: UNCODED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ef5620b-32d4-4541-ac0e-75abb8a38bcd
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3d7784e-1ccb-4380-ac71-7f5ff9ee7e33
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'event_length_of_stay '
        name: EVENT_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 679cb2a8-adae-48fd-a611-40b202a1f3f7
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9eeaa5e-a7b4-4b46-9b45-f87bf2ed0be2
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_03
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64c05a48-6da5-446f-80a0-75085c1b1cfc
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28279017-f9eb-4830-8827-dd6d5dbb3fef
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration unit of measure
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'day'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62d2c85b-5b1c-4d04-a942-3d4e5ccb3452
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_04
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b7127db-a014-488d-99f0-f5c00c8f9dc5
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 578ebfbe-79ea-4331-a737-950ca10d63c8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_05
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ae4268-68fa-449f-99a2-0f8f1004f4b0
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9bd65a2-95d4-4f4f-b457-d4da5b072a50
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: A concatenation of all ICD procedure code pipe delimited with asterisck denoting the first and last codes
        name: PROCEDURE_CODE_ALL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ae8799e-eeaa-4707-8060-81108d3d21d8
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5b0df5a-cb31-4447-a0c6-7cff8a4cf8d8
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_01=dim_ICD_diagnosis_primary.primary_diag_ICD_code
        name: DIM_ICD_DIAGNOSIS_PRIMARY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 572f4b5a-969b-42bc-96c8-4766731dbfd0
                stepCounter: 98dea851-fc39-4fb6-8a61-7354a9b86292
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 223ac2c3-adf0-4fcc-98b6-a9091cfbe45d
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_02=dim_ICD_diagnosis_secondary.ICD_code
        name: DIM_ICD_DIAGNOSIS_SECONDARY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9723f4f1-0c59-4944-a9ce-93ff7261bf8f
                stepCounter: aece204d-07db-400b-8b25-8269a9cbe2a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 865e72ab-c02c-4a00-aa27-a2147d495a7b
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_03=dim_ICD_diagnosis_third.ICD_code
        name: DIM_ICD_DIAGNOSIS_THIRD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c48f2b23-1d57-4142-88ba-f0e7bd64ed05
                stepCounter: ba68b872-f3c5-4572-92ce-e1425fde314b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac59b916-52aa-44d0-9e28-5a2df2e42082
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_04=dim_ICD_diagnosis_fourth.ICD_code
        name: DIM_ICD_DIAGNOSIS_FOURTH_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14a31b0a-477c-45f4-83c2-fa17c8639e4d
                stepCounter: 03aff856-8aca-44aa-8a82-3120f0641d2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26688bc6-677a-42e6-9154-cfc14f937f3a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_05=dim_ICD_diagnosis_fifth.ICD_code
        name: DIM_ICD_DIAGNOSIS_FIFTH_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04aac174-6a72-4a03-8b8e-89ec22ff1033
                stepCounter: 0514358b-872b-48c0-bbbf-94369091f268
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98bb47f4-c2af-4e79-a562-ed5f0419d9f7
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.procedure_code_01=dim_ICD_procedure_primary.primary_procedure_ICD_code
        name: DIM_ICD_PROCEDURE_PRIMARY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e16f3e2-03d2-4096-aa44-cdc68b04a7da
                stepCounter: e43f22ae-7f30-418c-bb93-38525e91a771
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea96e434-0b88-49cd-ac15-cb06d948759e
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.procedure_code_02=dim_ICD_procedure_secondary.ICD_code
        name: DIM_ICD_PROCEDURE_SECONDARY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1d2b954-889c-462b-9d39-19507d233641
                stepCounter: a2b5d099-ea92-41d6-acb2-8868f7ffcaf0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 529f4df1-166b-4853-92f2-3135b3fb5f15
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.procedure_code_03=dim_ICD_procedure_third.ICD_code
        name: DIM_ICD_PROCEDURE_THIRD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94fb8bf5-994b-44f0-877a-1c257b97874e
                stepCounter: 0c21befa-2c23-4c00-8baa-3d238d28e312
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 812efa77-130a-4d8a-a241-2d303e0f2d86
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.procedure_code_04=dim_ICD_procedure_fourth.ICD_code
        name: DIM_ICD_PROCEDURE_FOURTH_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4de061d4-53c1-43ce-8ca8-c3c27dd50e5e
                stepCounter: 5958fb22-6305-4f18-ae3f-793428a4df25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cadb920-6dfc-4f24-b83d-9a5d528a93ea
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.procedure_code_05=dim_ICD_procedure_fifth.ICD_code
        name: DIM_ICD_PROCEDURE_FIFTH_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8251e23-e39f-4356-8fb4-70c1a4f28622
                stepCounter: 31f5d238-409c-40d0-b4ac-93e7dda0ac0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04c2f5ff-87c8-4859-9388-0ea589971c80
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SMOKER_IDENTIFIED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d248b94a-c0e9-4e6d-ba56-8341350623ea
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: IFNULL(s_in_patient_event_20.smoker_identified,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c60a7d4-a613-44bf-87fc-be210467fa03
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SMOKING_ADVICE_GIVEN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89d9349c-7666-4155-a5df-9e49c2cdb9ab
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: IFNULL(s_in_patient_event_20.smoking_advice_given,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33a807b4-c435-43cb-90b9-bf127467d5ad
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: package_of_care_flag
        name: PACKAGE_OF_CARE_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: def4a2e1-9399-49c5-af7a-4e9b5ab1701d
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1993d75-c762-44b7-bc8e-950e5d60e622
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: CCL
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaa09c4c-6492-432f-b711-9f921a354c1e
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fe439ae-51a1-474f-8fa2-ab89bf9b90e2
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DISCHARGE_DESTINATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd1e2093-af53-430f-9415-7cdc97855d61
                stepCounter: a05a4266-44b7-4574-abee-00c3094cf764
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9d63ae2-0d87-4fcb-a0af-95d0c621af97
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DISCHARGE_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c31caaa1-b87e-4e22-ba82-16fade1a99d6
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0183be-7bd5-4a21-ad84-0ecc0ca8d74a
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: NXT_ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f40dafc5-5b56-4c9d-828b-7cfee946fbba
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ffa4f92-5d2d-4e1e-8848-6807276af30b
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: 'Set to 1 if discharge destination is not WTH, NSH, MASON or TEATA, discharge method is not DT or TA, and the next admittance is acute and within 28 days '
        name: ACUTE_READMIT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN dim_discharge_destination.discharge_destination_code NOT IN ('WTH','NSH','MASON','TEATA') AND s_in_patient_event_20.discharge_method_code NOT IN ('DT','TAR') AND s_in_patient_event_20.nxt_admission_method_code = 'AC' -- Acute
              AND s_in_patient_event_20.present_to_next_event_duration <= 40320 -- 28 days
              THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3c1d50f-bb98-4c1a-83a9-03df38a27d78
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Clinician notes for the encounter.
        name: ADMISSION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34b0bc36-c9e5-4482-a78a-eaaeeb09bdb6
                stepCounter: 6608a667-c773-417a-add1-6383009300a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed444dbc-2c5a-4967-bf37-4cbcace611b3
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.readmission_type_reference_no=dim_readmission_type.readmission_type_reference_no
        name: DIM_READMISSION_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44a32190-31c1-41c8-83a5-f11e2d87afcd
                stepCounter: 9b060604-ca06-4eef-aaf1-8957f2377d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07e748ab-570a-49e3-97b9-888ca3018be9
          stepCounter: b21ad428-90dd-4468-bcad-a35cbfb50c59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_LENGTH_OF_STAY: 0c3de9cb-45cc-4494-acd7-733e0ce5b4b1
          DIM_WARD: 50c31151-9204-4154-9caf-5d28244bde1a
          DIM_HOSPITAL: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_EVENT_20
          - locationName: TGT
            nodeName: DIM_LENGTH_OF_STAY
          - locationName: TGT
            nodeName: DIM_WARD
          - locationName: TGT
            nodeName: DIM_HOSPITAL
        join:
          joinCondition: |-
            FROM s_in_patient_event_20
              LEFT OUTER JOIN dim.dim_health_organisation
                ON s_in_patient_event_20.hospital_code = dim_health_organisation.health_org_code
               AND dim_health_organisation.dss_current_flag = 'Y'
               AND dim_health_organisation.health_org_code <> 'UNKNOWN'
              LEFT OUTER JOIN s_in_patient_coded_WIES_v
                ON s_in_patient_event_20.hospital_id = s_in_patient_coded_WIES_v.hospital_id
               AND s_in_patient_event_20.admission_method_code = s_in_patient_coded_WIES_v.admission_method_code
               AND s_in_patient_event_20.health_specialty_code = s_in_patient_coded_WIES_v.health_specialty_code
               AND s_in_patient_event_20.WIES_grouping = s_in_patient_coded_WIES_v.WIES_grouping
              LEFT OUTER JOIN {{ ref('TGT','DIM_LENGTH_OF_STAY') }}
                ON IFNULL(s_in_patient_event_20.event_length_of_stay, -999) = IFNULL(dim_length_of_stay.Day, -999)
              LEFT OUTER JOIN {{ ref('TGT','DIM_WARD') }}
                ON s_in_patient_event_20.service_point_reference_no = dim_ward.ward_reference_no
               AND dim_ward.dss_current_flag = 'Y'
              LEFT OUTER JOIN {{ ref('TGT','DIM_HOSPITAL') }}
                ON s_in_patient_event_20.hospital_id = dim_hospital.hospital_id
               AND dim_hospital.dss_current_flag = 'Y'
              LEFT JOIN dim.dim_surgical_health_target
                ON dim_surgical_health_target.admission_type_code = admission_method_NZNHI_code
               AND dim_surgical_health_target.purchase_unit_code = s_in_patient_event_20.purchase_unit_code
               AND dim_surgical_health_target.purchaser_code = adcat_purchaser_code
               AND IFNULL(s_in_patient_event_20.DRG_code,'A0AA') LIKE DRG_code_like
               AND s_in_patient_event_20.discharge_date BETWEEN dim_surgical_health_target.start_date AND IFNULL(dim_surgical_health_target.end_date,getdate())
              LEFT JOIN l_mappings_planned_care_IP
                ON l_mappings_planned_care_IP.purchase_unit_code = s_in_patient_event_20.purchase_unit_code
               AND l_mappings_planned_care_IP.purchaser_code = s_in_patient_event_20.adcat_purchaser_code
               AND l_mappings_planned_care_IP.drg_code_char_2 = IFNULL(substring(s_in_patient_event_20.DRG_code, 2, 1),1)
               AND l_mappings_planned_care_IP.admission_type_code = s_in_patient_event_20.admission_method_code
               AND s_in_patient_event_20.discharge_date BETWEEN l_mappings_planned_care_IP.start_date AND IFNULL(l_mappings_planned_care_IP.end_date,getdate())
              LEFT JOIN dim.dim_planned_care
                ON dim_planned_care.planned_care_intervention_component = l_mappings_planned_care_IP.planned_care_intervention_component
        name: S_IN_PATIENT_EVENT_30
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
