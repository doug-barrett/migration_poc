fileVersion: 1
id: 8767fc83-efac-4dec-84e0-b9a7401e2cff
name: S_REFERRAL_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage of Referrals "
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36480bda-dfe7-4e34-970a-ae93da270f3e
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c227920c-5d1f-491c-a2f3-316aad8a61a1
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88aeecee-6c63-4ac9-b10e-deef51d9d362
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICAL_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4a8c4c2-bc53-4edc-a5db-c1959696fd87
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d53d60-6a41-47c0-ad20-48701b158481
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ab891e-4d6b-4fb6-9a8c-7dafb1ea7985
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0262ba65-3b0d-4e2c-97d8-bee1dd1dc5d0
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCIDENT_RELATED_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6323388-915b-4e3a-b97d-5d78f598c794
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1400f779-ebc5-4b09-a483-137d0311c33a
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCIDENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2da90d02-aa4e-4140-954d-e11a54a783e9
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8379198-0458-4281-8aaf-09f1f6194e2b
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACC_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 134b27a9-8112-4e6d-a85f-4c023a45e1cb
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21a25fac-af3b-4c9f-9fd7-6c1bee8c5133
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1354e32d-4469-406c-8ed1-ad3e8adff308
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d008499-5bda-4793-8cdf-9af13e529132
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO_DERIVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba8c1498-155d-4b86-9295-5c3bfe44dab5
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a50d5f6a-828e-4078-9188-c391f28bcc3b
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_VALID_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16efe507-438b-49a1-b234-731c1459190a
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 128e294d-5450-4ad9-badf-fcdaa8bfda5e
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 567149d4-6501-469e-9916-b8a72bc114d2
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cea865d-21c0-47e3-a98c-3b5784dc50b8
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACC_INDICATORS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '-1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 224bfd6e-b2a9-4da1-8c62-0748767fe954
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y indicator for an easy join to stage table
        name: MULTI_PATIENT_ACC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 411f98ec-e843-40f2-b90b-1c2f3f249431
                stepCounter: a7a1d539-8f72-4321-801e-2c97f4d3862f
            transform: IFNULL(s_referral_ACC_no_multiple_patients_v.multi_patient_ACC,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f333ef8-0e3d-4def-9a08-decb95387922
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISABILITY_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e088c28-9cb8-406e-a731-35dc643bd05a
                stepCounter: 34a76a33-8369-4f07-bfed-e5f7cebaa4ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac11183f-e35e-4208-b34d-df8c5c32b207
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: COURT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9246b518-9cfc-4d34-bb03-07823df0b095
                stepCounter: 34a76a33-8369-4f07-bfed-e5f7cebaa4ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 468708c3-de69-4289-ac78-5dfe5b73a506
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CANCER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cd93553-0335-44fc-93ea-1e999850407e
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ELECTIVE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2ab1f67-e919-4a1b-871b-d532796eb5d2
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_REJECTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eb47331-2b3a-4d0b-9e34-3c8922ec8bbe
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_ELIGIBLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d358668e-a8cc-48c2-b86c-bbf1d6ecc441
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0c414a1-6dbb-4eb3-b252-0d09f3183079
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_ACCEPTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13ecac0f-238a-485f-b7bc-682266f2c627
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI1_WAIT_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a254388-d6b0-44df-9fcb-909acbfbdc6d
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_AUTHORISED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c492b26-b302-499b-8751-c51522b49416
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_AUTHORISED_IN_TIME_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 548d5cd4-8e62-435c-b5fa-6394168af420
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INJURY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0004798d-00d8-49f2-b264-b9ab68127222
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e4bc67-71de-4ce8-97f8-76840552fe9a
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: INSURER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14c600d1-6f24-4379-9bab-e28f847bf3ef
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f891c83e-3e70-4b1c-b98f-dd09e663b26b
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_CONTACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98942166-4b8a-4af1-8296-dee73a4f7343
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f056c83a-1b11-4890-851d-641479a0cc5c
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48034930-5b14-45e6-8435-ccf21c61c532
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5faa53e-9266-46e9-adc0-4c7f81704480
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44e960e8-1ecb-4364-8fad-2d2b798f635d
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c949fbf6-281b-4948-babf-d8d61c81d53a
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_CONTACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9f63fa6-87ec-40a3-8658-1befd94d49c1
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9727fcb1-60bd-46e9-b267-6481d047a5f0
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35c42f33-e543-4953-ae9b-4548e141af22
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b423e4c-67dd-41bc-acb1-ea1831be9740
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280b9049-9a39-49af-aab4-ec83fcecfd29
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17112047-eba7-4cdd-b8cb-c1ba2a877ae1
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f481452-7db6-4183-a5c1-28fbb38d1126
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e06bded3-ec6a-43be-9303-119af5cead01
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_BY_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5dc9a71-1213-4f5e-9d9e-e9c95f307248
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22f2a40f-b27e-4dfc-9b21-d0205a9bf696
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_BY_HEALTH_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e467675c-3e3d-49a7-b303-c5b4c984b763
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cdaae09-a7d6-444b-823e-32aa6fb0edf2
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_BY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 368d2d58-5494-4b27-97af-d44cf64da9e9
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cdaadc5-6e7b-4514-a0be-99e4f88c8b39
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_TO_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88e7f9b7-a80b-4d62-a4b4-99e124d10b69
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51486e99-30c5-4582-b529-7fc6498214d8
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_TO_HEALTH_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b40cd43e-27ef-4ee0-9834-c87986ae7b12
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dff612d-931c-49c9-b439-970e16003e88
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_TO_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 508ef3f4-3be0-4e8b-822a-4faa57bd59ac
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ad5ea57-493a-40e3-8785-b7aa2b08ee92
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_TO_WARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17e5f7d8-b6e7-46c3-8d21-83f7701792a8
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc8206c8-5b2b-4851-8d7d-801917db7268
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: NPF ESPI 1 is measured on the date that the atient is notified.  The best proxy for this is the waitlist create date.
        name: NPF_ACKNOWLEDGEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1fdb68d-fcab-4de9-915a-cb421af63cfb
                stepCounter: 27157083-4019-40ef-b39f-a70b955092ef
            transform: |-
              CASE WHEN referral_status_reference_no = 50023 --Authorised
               THEN coalesce(ds_shared_waitlist.create_date, s_referral_09.authr_date, s_referral_09.closr_date)
                          ELSE coalesce(ds_shared_waitlist.create_date, s_referral_09.closr_date)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06c0704e-17ea-44f1-9638-9696242f32b9
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excluded wailtists associated with this referral
        name: NPF_EXCLUDED_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c765e5a-1052-4bf8-9767-bbba3e4b3fde
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc5ddcc6-22ac-45b9-8d72-138b05f01ef7
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03c34b60-ec99-47b3-8912-e365c10ff361
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03240c39-6273-4c94-b8bc-4fcdb38d8bf4
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_REFERRAL_PRIORITISATION
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84677495-95cc-4a02-8f68-517006353ed4
                stepCounter: 27157083-4019-40ef-b39f-a70b955092ef
            transform: |-
              CASE WHEN ds_shared_waitlist.local_wlrul_refno IN (17740,10018080)-- Suspended
               AND s_referral_09.NPF_presenting_referral ='Y' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9142f923-5a4b-4e8d-a265-7bb320f368bb
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Suspension wailtists associated with this referral
        name: NPF_SUSPENSION_EXCEPTION_WAITLIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15a83c1f-6504-4cba-bb25-7c3b6f32c21f
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cb89f6a-c6f1-4b74-a229-ee6dd580c4e9
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Referrals with outpatient activity and no waitlists have this flag set to Y
        name: NPF_FOLLOW_UP_REFERRAL
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_referral_09.NPF_presenting_referral = 'Y' -- Is the referral a valid presening referral ?
               AND s_referral_09.referral_waitlist_count = 0 AND s_referral_09.referral_appointment_count > 0 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e49d718-de60-4fd9-ae0c-abeb24c9cccc
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PARENT_REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(s_referral_05_parent.recvd_date, s_referral_05_parent.sent_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 258d81a8-565c-418a-a1da-efcce4e4352d
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cd535b3-3ee8-41d1-b98c-8743a25ff366
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbc41ce7-9205-4a8a-8052-fea4bc2493f4
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad10592e-a5c8-4a08-9b68-f80d2a9cda03
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRED_TO_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdb73abe-6901-41bf-8b96-0b401315c976
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f03f21c-c009-40c0-9a92-64f60cce8d2e
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Death
        name: PATIENT_DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5c2ff38-a66e-4814-80ba-d041584351af
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 008e1d14-ed7f-43f3-ad08-9feca74771db
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbe39bbe-85e5-4e09-9e58-d12011190a5d
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c1a24ca-6cd4-496a-ad65-c3662a952d45
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70badb67-0e88-4c1e-834b-19d6f87160b7
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_count
        name: PATIENT_REFERRAL_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2aa6039-9464-4ee1-b785-26a23a98932b
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 610df231-ff3f-4bb0-af10-9fdde963d937
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_seq_num
        name: PATIENT_REFERRAL_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e57f53-628d-46f6-854a-c4848ee0592e
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e70a2648-a2a2-4479-9565-177f22602c0e
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de49c1a9-7253-4469-a285-16ad05868a03
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b2aaebb-f9eb-4406-9b84-14e7ed8d91d1
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_BY_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b13a15d-2889-4111-84a0-3bbe4abace51
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4c4cb67-30fc-4905-be45-ac05c128a167
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_BY_HEALTH_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a90c516-36c6-4023-9698-75490abd3397
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a4cd5df-4b51-47fb-83d6-667c0a14fc11
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_BY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b01778bc-7a9f-46cf-b2fd-f2596f7055d9
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edfb2a1e-71f4-4972-ad59-098835e08561
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_TO_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 198db7a4-b8d0-46a8-a9ad-e4577a88b34f
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c539535-db7d-4da7-9e78-0ee33a429e32
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_TO_HEALTH_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e4e74db-fecc-4e03-9c2a-f49f93cad12d
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6ad47e5-fe44-42ba-91ff-a3d63432b478
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_TO_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3d7a851-c06d-46cc-bba4-02b641dc2380
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa42a7a3-bf44-400f-9d73-b13111cbc05d
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_TO_WARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bbb1df9-dbd8-4ef1-9854-fc4a7826a352
                stepCounter: c62cac46-e64f-4cc6-9811-15cc9cb786fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aeba40e-3961-4e80-add7-ff2b8d669ca9
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRISON_LOCATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c25640a2-a808-4e79-835c-eebbcbcbab08
                stepCounter: 34a76a33-8369-4f07-bfed-e5f7cebaa4ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a14ec549-67b5-4dc5-898b-1d70069be523
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRISON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64bdabba-a75a-4154-8f45-327a32fb6828
                stepCounter: 34a76a33-8369-4f07-bfed-e5f7cebaa4ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1e00a79-2ff2-4c56-844c-c661a15d05c4
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Admissions associated with this referral
        name: REFERRAL_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b054e77d-8557-43f4-88c7-ed2c271b073b
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8c79213-444a-46f7-b498-312393df06ff
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Emergency attendances associated with this referral
        name: REFERRAL_AE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a0487b3-56c5-40af-a003-09ed2a6a35f9
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef0c21a3-dc3f-4fd4-9526-d2ba08f901ca
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Appointment (theatre/contacts/outpatients) associated with this referral
        name: REFERRAL_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a731910-4b79-4d1d-b73d-3488369ae776
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e9f6de6-34ee-49b8-9703-709b6c5d65e4
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f009efcd-2be8-48b6-b90c-051ec73dfad0
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29305a68-992a-44f3-b46e-672358d3144a
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 306e7d84-ce95-4460-80be-5ece578c6e20
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0553d58b-e292-4133-89b6-f269753258a0
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b998ca5-27a2-4f60-b4a7-7e9fefc11f13
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62d194eb-bd34-4113-b775-faf79b552dd9
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: referral_authorisation_reason_code
        name: REFERRAL_AUTHORISATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8da5cea7-ac52-4f4e-a00b-62961d25e256
                stepCounter: 0d55fc59-ab07-41e1-b7b0-b0c62bd14573
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a70cced7-fe32-4c0b-92c1-0102351b3544
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbe06adf-096e-45f6-96b2-66e18c408310
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddbc1689-4c36-4729-9bd0-dd40bf80f4d3
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_CANCELLATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3286f3c8-b907-4ca9-9566-ed299b0911bb
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 033a3e1f-ffae-45ff-a097-d90a4c1fe4a8
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_CANCELLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72a5f344-3181-4e0f-9158-954b715c18fb
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0464163-a61a-4308-bbb1-ae66c5ac22b1
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63cfa36-d3f7-48fc-b25a-23e49b8e39a5
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: coalesce(s_referral_09.closr_date,CASE WHEN s_referral_09.rstat_refno = 50023 AND s_referral_09.rject_refno NOT IN (200296,50028)THEN s_referral_09.authr_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2785f00d-3690-4616-bc7e-df8cc8713a21
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79997109-e0ea-4d57-87bd-a6a354b4db72
                stepCounter: 5869a5b8-7044-46bc-9fc6-67f49dfa30ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fedcf663-cffe-4096-a85e-298be9cde75d
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 308d7c60-b728-4be4-bc6e-1b527112908f
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1259dbb2-3c17-4350-b16d-d32b97fe523d
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 351aa7bc-c511-4de9-9b90-ef3997434246
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66d3e38a-7131-49ef-9eb9-62f9efaef24f
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03c0a140-7ae8-49ce-b8a2-724507fdcf6c
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da943205-8b21-46e9-8aae-61a28943cdfd
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c07b820f-aa64-44e4-bd80-5b616c4b2567
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9feb86ae-861a-4f10-a93f-05192cfd50ed
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fac80be3-cae5-4122-9043-3e8cfd324800
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0eff810-ab4b-46bd-ab6f-e41267666bd4
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55671874-514f-462a-8c4b-1975d892770d
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5b6490d-1915-4631-856d-743ee7c6112f
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4940031b-5cfa-4bc1-88da-d0d78ad007b7
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a98c914e-96fb-4c1d-958b-7e738474a5d3
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca65b348-ede9-4b07-a569-4e316f104c75
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 691c5477-604c-4571-bbe1-061cb1ff0da6
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The reason a referral was rejected, if the status is rejected
        name: REFERRAL_REJECTION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c104dcfc-dd40-4e97-99f0-40c2f95266dd
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9585522e-9acc-4225-9947-ae550cf49a1f
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_SENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e063eb8e-3d31-427e-9cd9-3170f6f6236e
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b323371-dac9-4301-a7fe-76925cbe7628
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: referral_source_code
        name: REFERRAL_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02fff0e4-d03a-492b-9183-c3621527f517
                stepCounter: 2323317c-3e56-4756-b64a-c4a6f700726f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8237a8c-e910-4c5c-8489-fb12a387e6fe
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SOURCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1edc5e80-f3b9-4189-a1dc-89eae3be3338
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdc5a7cc-03ad-4eda-bb67-1c95ebc82347
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: referral_status_code
        name: REFERRAL_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fc7db1-e0e1-4d9c-9916-3bf72f3e5035
                stepCounter: 6abb18ca-79da-4f03-98d9-18dc0bf8c1a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba9f85e3-5ffd-485d-b938-63eeecdd5b6f
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53266ab9-100f-4df2-af6a-cc3d60c27d29
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b85078ca-bae1-4d78-9f33-810e7e88f172
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: referral_type_code
        name: REFERRAL_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cd32e58-9d2e-4f22-bc88-9e66a16fb6a0
                stepCounter: 98967b6a-61a3-4c8e-b291-6447cdf2fc9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef7c2f7e-6d9b-46d1-aaba-a6bb886a4b45
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3955889f-174f-414e-b48d-9bb7e295fea1
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5835ba9f-0717-4711-8746-f52934248e16
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Waitlists associated with this referral
        name: REFERRAL_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 948c78cb-fd71-4055-8a07-01ee4dec2c73
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c88c3221-73ac-4d43-a6f5-c7c164593ad7
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_by_clinician_code
        name: REFERRED_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b47ca898-2cb9-41b9-93c1-f35982159f33
                stepCounter: 55bf85fd-0c5f-4597-9cf2-3e705d58e31f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7973f03-a1b5-4999-a927-b8eb208e50cf
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a14e97eb-0281-44a0-817f-c50313a47c94
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af563614-4659-4880-9a6c-2a9ff181883b
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: referred_by_clinician_type_code
        name: REFERRED_BY_CLINICIAN_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2d906ef-b274-410e-9ef2-6cc1329ed958
                stepCounter: 55bf85fd-0c5f-4597-9cf2-3e705d58e31f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6146d215-1c79-4a3c-999e-de19099b42e9
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac2ddeb-338b-4b02-815e-9032b6024630
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2adccd3-ce4e-4e1f-9f84-3e8ca950e98d
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73fc6476-316b-4335-a0e2-ecfebd5f7a24
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7157a968-ba2d-475b-b167-4bd37b8d825f
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_to_clinician_code
        name: REFERRED_TO_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba58d276-f8e8-4b43-b061-4bf63d83e31a
                stepCounter: 29481079-6a75-49a5-90b6-5a62a9091370
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449e6aaf-6ac9-4a0e-ab2f-6e0632c0be2a
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_to_clinician_type_code
        name: REFERRED_TO_CLINICIAN_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 169d5f35-26af-4d29-b6f8-a93df5125da5
                stepCounter: 29481079-6a75-49a5-90b6-5a62a9091370
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae7ebb06-2f86-4ad3-9bdf-dbeda26c70e9
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8092d951-372e-4642-99b2-8c1fbded9584
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f4033c7-15bc-4456-a715-ba626b9ee747
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23eb8537-a671-441f-8c12-72afb1ec7e61
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b2ce08e-6540-4e06-8ee7-de1f18c1370e
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_to_specialty_code
        name: REFERRED_TO_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf7c8b3-5813-4be7-a8ca-91b0073451b4
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e4f9947-f6b5-486a-b002-9e0068965207
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f717cd9a-416f-4b1e-b418-be7293d83aaa
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a10a6b6-c993-48c4-9920-f63f52ea3fad
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_STAFF_TEAM_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39368e85-fea3-4613-a8ff-fa4daa102867
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ccf210-b0f7-4f0e-a2c8-aeac599d7fb6
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_to_ward_code
        name: REFERRED_TO_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de0ef3c4-94d4-43f5-8394-f4350cf21809
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 617261a3-75c1-4e1c-9e10-9c6b698c57de
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ce3f910-0216-43b6-89c8-4013b2808d3d
                stepCounter: 2e56a8db-93ae-44f2-91ea-f04c822a766b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 226bfcf5-3fbc-4186-9d67-38aa5804d664
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Temporary LDDI transfer out Org for WDHB
        name: TRANSFER_OUT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25e4d33d-4aab-4459-88c3-8a432911573d
                stepCounter: 34a76a33-8369-4f07-bfed-e5f7cebaa4ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74a68199-252c-4274-b91a-73914fb9a9db
          stepCounter: 8767fc83-efac-4dec-84e0-b9a7401e2cff
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_REFERRAL_ACC_NO_MULTIPLE_PATIENTS_V: a7a1d539-8f72-4321-801e-2c97f4d3862f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_REFERRAL_09
          - locationName: TGT
            nodeName: S_REFERRAL_ACC_NO_MULTIPLE_PATIENTS_V
        join:
          joinCondition: |-
            FROM s_referral_09
              LEFT OUTER JOIN s_referral_09 s_referral_05_parent
                ON s_referral_09.parnt_refno IS NOT NULL
               AND s_referral_09.parnt_refno = s_referral_05_parent.refrl_refno
              LEFT OUTER JOIN s_referral_prev_next_v
                ON s_referral_09.refrl_refno = s_referral_prev_next_v.referral_reference_no
              LEFT OUTER JOIN dim.dim_ward
                ON s_referral_09.refto_ward_spont_refno = dim_ward.ward_reference_no
               AND IFNULL(dim_ward.dss_start_date, GETDATE()-10000) <= s_referral_09.recvd_date
               AND IFNULL(dim_ward.dss_end_date, GETDATE()+10000) >= s_referral_09.recvd_date
              LEFT OUTER JOIN dim.dim_specialty
                ON s_referral_09.refto_spect_refno = dim_specialty.specialty_reference_no
               AND IFNULL(dim_specialty.dss_start_date, GETDATE()-10000) <= s_referral_09.recvd_date
               AND IFNULL(dim_specialty.dss_end_date, GETDATE()+10000) >= s_referral_09.recvd_date
             INNER JOIN dim.dim_patient
                ON s_referral_09.patnt_refno = dim_patient.patient_reference_no
              LEFT OUTER JOIN dim.dim_referred_by_clinician
                ON s_referral_09.refby_proca_refno = dim_referred_by_clinician.referred_by_clinician_reference_no
               AND dim_referred_by_clinician.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_referred_to_clinician
                ON s_referral_09.refto_proca_refno = dim_referred_to_clinician.referred_to_clinician_reference_no
               AND dim_referred_to_clinician.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_referral_source
                ON s_referral_09.sorrf_refno = dim_referral_source.referral_source_reference_no
               AND IFNULL(dim_referral_source.mapping_start_date, GETDATE()-10000) <= s_referral_09.recvd_date
               AND IFNULL(dim_referral_source.mapping_end_date, GETDATE()+10000) >= s_referral_09.recvd_date
              LEFT OUTER JOIN dim.dim_referral_status
                ON s_referral_09.rstat_refno = dim_referral_status.referral_status_reference_no
               AND IFNULL(dim_referral_status.dss_start_date, GETDATE()-10000) <= s_referral_09.recvd_date
               AND IFNULL(dim_referral_status.dss_end_date, GETDATE()+10000) >= s_referral_09.recvd_date
              LEFT OUTER JOIN dim.dim_referral_completion_reason
                ON s_referral_09.clors_refno = dim_referral_completion_reason.referral_completion_reason_reference_no
               AND IFNULL(dim_referral_completion_reason.mapping_start_date, GETDATE()-10000) <= s_referral_09.recvd_date
               AND IFNULL(dim_referral_completion_reason.mapping_end_date, GETDATE()+10000) >= s_referral_09.recvd_date
              LEFT OUTER JOIN dim.dim_referral_authorisation_reason
                ON s_referral_09.authr_refno = dim_referral_authorisation_reason.referral_authorisation_reason_reference_no
               AND IFNULL(dim_referral_authorisation_reason.dss_start_date, GETDATE()-10000) <= s_referral_09.recvd_date
               AND IFNULL(dim_referral_authorisation_reason.dss_end_date, GETDATE()+10000) >= s_referral_09.recvd_date
              LEFT OUTER JOIN dim.dim_referral_type
                ON s_referral_09.retyp_refno = dim_referral_type.referral_type_reference_no
               AND IFNULL(dim_referral_type.dss_start_date, GETDATE()-10000) <= s_referral_09.recvd_date
               AND IFNULL(dim_referral_type.dss_end_date, GETDATE()+10000) >= s_referral_09.recvd_date
              LEFT OUTER JOIN s_referral_ldd_data_value
                ON s_referral_09.refrl_refno = s_referral_ldd_data_value.refrl_refno
              LEFT OUTER JOIN (
                    SELECT refrl_refno,
                           min(create_date)create_date,
                           min(local_wlrul_refno) local_wlrul_refno
                      FROM ds_shared_waitlist
                     WHERE patient_referral_waitlist_seq_num = 1
                     GROUP BY refrl_refno
                   ) ds_shared_waitlist
                ON ds_shared_waitlist.refrl_refno = s_referral_09.refrl_refno
              LEFT OUTER JOIN {{ ref('TGT','S_REFERRAL_ACC_NO_MULTIPLE_PATIENTS_V') }}
                ON s_referral_09.ACC_no_derived = s_referral_ACC_no_multiple_patients_v.ACC_no_derived
        name: S_REFERRAL_10
        noLinkRefs: []
  name: S_REFERRAL_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
