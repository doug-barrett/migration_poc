fileVersion: 1
id: f41afaf3-0521-42b0-8214-cf6517c76864
name: S_EDS_EVENT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8600734-534f-4bab-9467-79304ce48cf2
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: Uniquely identifies a document.
        isBusinessKey: true
        name: EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec7f269f-9fe8-454a-b07b-85aeaeea7214
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d3d83bb-dfb4-44d4-b06d-6e9db5d71caa
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ID identifying the original event associated with this event.
        name: ORIGINAL_EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c19cf526-defa-44f8-8e06-758120de33b6
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: COALESCE(s_EDS_event_10.original_event_id, s_EDS_event_10.event_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfd89934-2e95-4c10-8230-933efdcd440b
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: TEMPLATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bb1a127-e19a-4c9a-94da-ce34fa8e01e7
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50a2663f-8f50-45c9-bf7f-8c0dae2371d8
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: TEMPLATE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72d3ca87-9c1d-4085-a84e-bfdc370e1eff
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 010df2eb-1b1d-4d06-bef9-4257adc7996d
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NCHAR(20)
        defaultValue: ""
        description: ""
        name: EPISODE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cebdb257-e849-4bc3-b5b0-b1056dd3b536
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e20ea2e6-40d5-488c-a5fd-f535da467e19
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: Patient NHI number.
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2176544f-602d-4406-a041-930b1f605865
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0d68544-110e-43cf-afb2-3494e1ea7fbf
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e97f9df9-522f-4edf-a576-4f04663dea60
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf7e98d0-6bac-4148-afeb-1c0d923515f4
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: Uniquely identifies a row in EDS table StructuredFormData.
        name: STRUCTURED_FORM_DATA_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea91af0c-a654-4ad0-ab75-5f3180fe136e
                stepCounter: 1235c156-b2fa-4226-baa2-245b1464110d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f3d9284-4c90-4d2b-8e02-1f4743ec9e57
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(300)
        defaultValue: ""
        description: A field name in the  document that will be used in DW processing.
        name: FIELD_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4237813-606e-431d-8d70-947162479fb0
                stepCounter: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f0dd131-35fa-48ed-b9bb-5bca717b00ff
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: Uniquely identifies a row in EDS table AtomicObservation i.e. a single field in a form.
        name: ATOMIC_OBSERVATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd36d854-dd58-4599-a0d7-839c5412606a
                stepCounter: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d0b64c2-b64f-4bc6-8338-a0b63a20ea5b
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_EDS_event_20.cast(lastUpdateDateTime as date)=dim_EDS_last_update_date.calendar_date
        name: DIM_EDS_LAST_UPDATE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2a42ff0-1ca4-4a00-a43f-0b6ea545a93b
                stepCounter: e377ade6-197b-4ce5-8efb-2862582076d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f69a8e46-fd24-43e6-b1af-da015a5a3671
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09ba3320-7c0b-4de9-b14b-f9d8450182a3
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 866fd322-d859-4b1c-8e24-19f8f8c5810f
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09ba3320-7c0b-4de9-b14b-f9d8450182a3
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: cast(s_EDS_event_10.createDateTime AS date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08e672b7-4028-4d69-88f7-f6f59646c0df
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NTEXT
        defaultValue: ""
        description: Value of a single field in a form.
        name: FIELD_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22afcc9e-ce61-4ac4-a025-869e48130070
                stepCounter: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
            transform: cast(ds_EDS_AtomicObservation.value AS varchar(MAX))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f004ff42-23c7-4cdc-81bb-f73301c5afd0
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Convert the field value to a date column if it's in yyyy-mm-dd format.
        name: FIELD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22afcc9e-ce61-4ac4-a025-869e48130070
                stepCounter: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
            transform: |-
              CASE WHEN CONVERT(varchar(MAX), ds_EDS_AtomicObservation.value) LIKE '[0-3][0-9]/[0-1][0-9]/20[0-9][0-9]' THEN CONVERT(date, CONVERT(varchar(MAX), ds_EDS_AtomicObservation.value), 103)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cb74193-d977-4298-9c5f-fb1272b413ed
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Convert the field value to a date column if it's in yyyy-mm-dd format.
        name: OBSERVATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df37fa9a-2dc5-4974-96e3-4527200f5c2d
                stepCounter: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a20a4031-a9b2-4481-a107-1244a234e8a7
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(1)
        defaultValue: ""
        description: Flag indicating AtomicObservation rows are joined in a hierarchy.
        name: HAS_CHILDREN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 731220b4-ec90-4336-8753-1f190743739e
                stepCounter: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85b8724d-9837-4286-937f-b45291094924
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ID of the row that is the parent of this row in AtomicObservation.
        name: PARENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd09b0be-a500-4214-9e04-aae32e50baaa
                stepCounter: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1054f38-0be9-410d-9589-be3c7f89a84c
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da2bc353-84e0-4151-82e9-13454428011d
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11bdecde-afd9-48f5-b8ba-865d92a26c69
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: INACTIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41b31f6b-6478-4be3-a166-dc8f04b5df52
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64168aaa-8f6c-41d1-a7cb-77debfa25f68
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5ab0a5-f3c9-4990-9c75-7cb5f8230eda
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: --cast(s_EDS_event_10.admitDate AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time' AS datetime)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eaee1b0-bd58-400e-9a66-6c6365370160
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89f665c3-b8fc-4ce0-a98d-74931e2a604e
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: --cast(s_EDS_event_10.dischargeDate AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time' AS datetime)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: addf0566-c212-4d60-b15f-9d73e5bb9bf7
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5ab0a5-f3c9-4990-9c75-7cb5f8230eda
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2831c09-f321-4ca2-b8b1-6514164381cc
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89f665c3-b8fc-4ce0-a98d-74931e2a604e
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3cebb65-4937-43c7-b7f2-07b2892fb34c
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b65ca1c6-ef8e-4732-8006-3ed4d88e24f2
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c64d00b-ac76-43d5-9b16-7c1a3bf79a17
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: EXT_PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c560c739-474c-4832-b17b-0fd7f57d9ebe
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5423b4da-5049-48ea-83e8-5d9ddbf2c437
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXT_REFERRAL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 166f17a3-ea6b-4750-80ac-8f8865342b58
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77d4eda8-17c4-4918-bb2f-26dddfce39d6
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(128)
        defaultValue: ""
        description: ""
        name: LASTUPDATEUSERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e90859-9131-42d0-99f7-0354b108fd57
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e35afc06-3e3a-447a-b35a-8d275689143e
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(90)
        defaultValue: ""
        description: ""
        name: LASTUPDATEUSERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e092d40-02e4-4999-b8e3-5fd521acea19
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e9d614-b75d-4b18-9a71-37e1ffdc4fb3
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: LASTUPDATEUSERCLINICIANID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0723f3a-ce7c-4647-a326-b9bc28ac3ddc
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd31fafe-e2d0-46f0-9a88-c2cd2d3303d9
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LASTUPDATEDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43844429-10f5-4416-a055-30887f4e3375
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: -- cast(s_EDS_event_10.lastUpdateDateTime AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time' AS datetime)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a214b453-3ea4-4c59-bdf5-e1bb6ff41aaa
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LASTUPDATEDATETIME_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43844429-10f5-4416-a055-30887f4e3375
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0929f87f-f642-4a0d-8d71-cc0b1cab47a4
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.s_EDS_event_10.createUserId=dim_create_user_login_concerto.user_name
        name: DIM_CREATE_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68706e5d-f3c8-4b07-af66-769a301d6d9c
                stepCounter: 84e9f5b1-7654-4f9a-87c3-b87de0f332a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ecd7bcc-0a12-4b79-9f11-f78f2679c50a
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 166f17a3-ea6b-4750-80ac-8f8865342b58
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: "'R' + s_EDS_event_10.extReferralNo"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20447964-dea6-429f-9f2f-d54cdea69ccc
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHYSICAL_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9456c41-3179-408a-9258-b95e05483836
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20c777d5-a681-4eeb-9209-148ea70b096d
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: PHYSICAL_LOCATION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb1e1f8d-9065-45b1-a9e9-225376835138
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a697cff7-9134-45a1-93d2-3534035649ca
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ORIGINAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 650f92c2-93bd-4e74-b6b9-c159de40e389
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9918e509-25a8-4e09-bb80-2c175b67b392
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ea10296-15eb-4c09-8d78-32369bd5fb9c
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 554a2442-3f5d-4290-ba52-8255f054aec5
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: NCHAR(50)
        defaultValue: ""
        description: ""
        name: ORIG_EXT_HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43e9c518-b235-4621-9227-e0e8faff03cb
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82aaafa1-b598-4221-b172-9af4598a76bd
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: IFNULL(dim_hospital.dim_hospital_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dc0ef82-94f3-478d-825a-15db7ec64c6f
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 589a71a2-4e06-4657-826a-ea42a7b13778
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.extProviderId=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911a8788-86e5-4a5c-a00a-a957d59070b8
                stepCounter: e8e4a684-3ef8-4076-846f-48d5689e824f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbb014e7-5183-44a3-962c-bf75bb68493d
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_EDS_event_20.create_date=dim_EDS_created_date.calendar_date
        name: DIM_EDS_CREATED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b063f4d2-cd74-47c5-a2f2-a74b4580224e
                stepCounter: 93a71c72-5113-441b-99d4-d05f2c00134c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a72217c3-f7f3-4000-b576-241772f0942f
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.physicalLocation=dim_service_point.service_point_reference_no
        name: DIM_SERVICE_POINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66428538-0101-4e75-9137-beccf8a67c9a
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63e62994-9713-4636-bd0f-2069ce092ab5
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.specialtyType=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5017a5d6-43bf-40e1-96b8-c75873642ff1
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: TEMPLATEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a52d5d40-93c0-48af-b617-ac2db7bb9622
                stepCounter: eead500e-6b50-4f40-9027-af1c5bc6a758
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b57cf7de-f7e4-4547-9ce4-bdbb3bd2ffb8
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.lastUpdateUserId=dim_last_modify_user_login_concerto.user_name
        name: DIM_LAST_MODIFY_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faf66468-3790-4610-8b5e-f6328e096184
                stepCounter: 9f0babe7-0834-47a8-b944-d4c8ec750e45
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ea7fdd6-d078-45cc-a1c9-8b8c2d50ae50
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: TEMPLATE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6622169-d255-40f7-b81f-adc7a557734f
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdeea134-f497-473b-92bb-2e1bb01476b7
          stepCounter: f41afaf3-0521-42b0-8214-cf6517c76864
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EDS_EVENT_10: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
          DS_EDS_STRUCTUREDFORMDATA: 1235c156-b2fa-4226-baa2-245b1464110d
          DS_EDS_ATOMICOBSERVATION: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
          DIM_HOSPITAL: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
          DS_EDS_TEMPLATELIST: eead500e-6b50-4f40-9027-af1c5bc6a758
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EDS_EVENT_10
          - locationName: TGT
            nodeName: DS_EDS_STRUCTUREDFORMDATA
          - locationName: TGT
            nodeName: DS_EDS_ATOMICOBSERVATION
          - locationName: TGT
            nodeName: DIM_HOSPITAL
          - locationName: TGT
            nodeName: DS_EDS_TEMPLATELIST
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_EDS_EVENT_10') }} s_EDS_event_10
              LEFT JOIN {{ ref('TGT','DS_EDS_STRUCTUREDFORMDATA') }} ds_EDS_StructuredFormData
                ON s_EDS_event_10.event_id = ds_EDS_StructuredFormData.dischargeEventId
              LEFT JOIN {{ ref('TGT','DS_EDS_ATOMICOBSERVATION') }} ds_EDS_AtomicObservation
                ON ds_EDS_StructuredFormData.structuredFormDataId = ds_EDS_AtomicObservation.structuredFormDataId
              LEFT JOIN {{ ref('TGT','DIM_HOSPITAL') }} dim_hospital
                ON IFNULL(s_EDS_event_10.origExtHospitalCode,'Unknown') = dim_hospital.hospital_code
               AND dim_hospital.dss_current_flag='Y' --JOIN {{ ref('TGT','DS_EDS_TEMPLATELIST') }} ds_EDS_TemplateList     -- ON s_EDS_event_10.templateCode = ds_EDS_TemplateList.templateCode     --AND s_EDS_event_10.templateVersion = ds_EDS_TemplateList.version    JOIN  ( select *, ROW_NUMBER () over(partition by templateCode,        version order by templateId desc) rn from ds_EDS_TemplateList)ds_EDS_TemplateList    ON s_EDS_event_10.templateCode = ds_EDS_TemplateList.templateCode  AND s_EDS_event_10.templateVersion = ds_EDS_TemplateList.version  and rn=1
        name: S_EDS_EVENT_20
        noLinkRefs: []
  name: S_EDS_EVENT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
