fileVersion: 1
id: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
name: S_IN_PATIENT_STAY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74ef7329-1b85-44ca-86d5-530f33ce3a4a
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1c7a3a3-1474-4270-ae9b-54e5b66ee6e1
                stepCounter: a7d7c8ec-88ee-49a8-b500-e3f4bce83e59
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a141ff8-6c07-4ac7-8343-0e0a64072272
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2f06a6c-bc2b-4943-a499-b407228ccabd
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a4fa939-fc6a-4031-b0c5-f75958e4d6a3
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 215b9661-c15a-4a09-8912-5e40f94f4861
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 790fc1a5-cfd0-4779-9476-2dc5995c43f6
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc57cb3b-ddad-41e0-aa89-1499f506679b
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dff4644f-7ff3-4176-9a75-c9cd1d5155ec
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fc97f3a-689a-4512-9dbe-6c82df8c8a8f
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd526170-660a-4278-8b89-2799cf1d8253
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5a1e57d-a116-42f9-aeab-92b2bd78279c
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: COALESCE(s_in_patient_stay_05.episode_spect_refno,s_in_patient_stay_05.event_spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2efbcdc-8b42-4506-b451-06e97b8d12ee
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event_Specialty Code
        name: EVENT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf7c8b3-5813-4be7-a8ca-91b0073451b4
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82445afa-28c0-4bcd-aaa1-ecfcf3972b29
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event_Health_Specialty_Code
        name: EVENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab525339-3f36-4625-ba0c-d207897f094b
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a080d348-7262-462d-b3dd-3a2900cd8ae2
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa2d7c6a-6c86-4ea3-b089-309f1837b6fd
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3d43a0a-9f92-4b81-955e-e1aa5227685e
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 387fe979-349f-4207-b25a-b1a1ec419319
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: COALESCE(s_in_patient_stay_05.episode_proca_refno,s_in_patient_stay_05.stay_proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46aabcf6-679b-4a4e-a496-40a9fd62e24b
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay_Healthcare_Professional_Code
        name: STAY_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393c87d-2bfd-47b3-a557-82745248467a
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6426dede-f127-4ca6-af16-1a952173a2c3
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11d49d00-202b-4e8c-b0c6-a4b3745fe4d0
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4200031b-e952-4278-8cb1-a0970199ec1e
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11d49d00-202b-4e8c-b0c6-a4b3745fe4d0
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac9c6596-286a-4869-99da-bea598b74751
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATNT_REFNO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca2209cd-5c3c-4dda-8af8-828941463bf1
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06104c8a-ad68-456b-8970-94455fc50362
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: stay_Patient National Health Index (NMPI)
        name: STAY_PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27718396-1508-4198-87cb-7bb9a86aa18d
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca108251-659d-407d-85c1-03e2b24aaf23
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f336f5b-01f0-43ee-a885-795c0ab59fe4
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d472e0a-9450-43d9-8936-e9c7bcb46f38
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b57ffd7-44dc-4374-a500-3c4ebf465c7f
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: stay_service_point_code
        name: STAY_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 616232f3-a275-4d6a-b78d-aa462c3d6232
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b00a5f95-efe7-4da9-a899-ef93537f6386
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Leave Reference No
        name: LEAVE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541a3c07-8a69-4344-b488-c395b07ce2aa
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc9c9c5b-5dd4-4eed-9989-864610f17949
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc01d369-1954-4ce6-b8c1-a1f36dc06913
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 268468b6-9458-458e-af33-c75645ef76c7
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a42ff15b-29f6-46a4-a6c9-8389c8ce7306
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0aa178d-06e4-4205-9492-609746c96b77
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7b026a5-4298-427c-b928-5fcffd3c77dc
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04849c5f-44c4-4bf8-b711-81348b3f9b85
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ED_FIRST_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7b026a5-4298-427c-b928-5fcffd3c77dc
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: |-
              CASE WHEN s_in_patient_stay_05.aeatt_refno IS NOT NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d8a8600-adb6-4f3c-b3df-21890e363e40
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ED_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5575a982-f3a4-441e-be84-490232d53b24
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 729ba026-d8fb-4795-8e1b-e5f79db6585d
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ED_arrived_date
        name: ED_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1d761e5-2a79-4e24-8644-333c311598eb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b526dbe-efe7-43db-9bc9-36bbc12bbf22
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16a63032-3f00-40bb-ad05-c545bbb88f61
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed836bc6-7709-4b02-94e3-f884f0655530
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ED_departed_date
        name: ED_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cfdbc61-95a7-4bf6-b56e-cb882fd0daee
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2026657f-9ad8-4373-9243-ee69b8097e84
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6096a0a-9409-48a8-bb83-334a2f957ce1
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: CONVERT(varchar(4),NULLIF(s_in_patient_stay_05.active_indicator,0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08ef6c7f-2951-4571-a55c-227c3cda7c2d
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7de1c8b4-9356-4549-85b3-4c6561f9c10b
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b10bebf-726e-4259-a947-635ef478f6ee
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fef9090-da2a-41a4-b097-c37944f56211
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d6b85ce-79d9-4886-a4f6-f7fb0c2c72da
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6559cb50-b92e-4a24-b3c0-c7818339f2b5
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35765173-3d9b-47a0-ad84-a9ab76d36040
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ede6630f-e3d3-4fa7-abd7-5d2f2bd74288
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb68d4fb-2951-4da3-9251-1276c8f5aa54
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WARD_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1d06b65-7554-4680-b998-2f4363653ee6
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e87bb797-4278-46bb-9a33-3d3888a1e992
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a81084e6-9d1e-4ba7-943e-da806b2afba1
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa9a821f-3588-427c-873e-4d31fee6e177
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfe02-2c49-414e-923e-47d9625c71cf
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fed9bff9-76e1-4d14-9309-dce9b7999c68
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf1501d-b3bf-4770-a8eb-377c17b5bb68
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22b5e88a-7d6d-48eb-aefa-8cc730e2b487
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c01536e8-8bcf-46eb-8d2a-71c9e6648785
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c19198d-7cdd-4dd1-8263-e1c97a643348
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82a7df73-9814-4499-bb11-626d82de4bdf
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95e21e38-1e30-4bd5-96d9-8a03df78d242
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: VISITORS_ALLOWED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b2e8d21-bbab-40ee-b4ea-e209204cdec7
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b9c25fc-09f3-46a4-a3e1-f128ac730ffb
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13392b4b-cd33-4052-b8e1-9dc635a04228
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dd82dd7-e7e4-4250-99b4-63720d2149c4
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d71cef9-b29d-4789-9ddc-7323bb8d4560
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6148561c-5949-40c8-87f8-fd3f782ca106
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba26f5ae-7dc4-406e-99ff-f6b52ba7bba5
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a33331d-ac36-4fde-85d5-98c42b054de8
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2242de2-301a-4581-a13d-7f074201a25a
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5613572-b5df-40c2-b577-8bb481b2f201
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2263e9d2-1011-41e1-8728-6c2fb876f959
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: |-
              CASE WHEN (s_in_patient_stay_05.stay_start_date <> s_in_patient_stay_05.stay_start_date_orig OR s_in_patient_stay_05.stay_end_date <> s_in_patient_stay_05.stay_end_date_orig OR s_in_patient_stay_05.admit_date <> s_in_patient_stay_05.admit_date_orig OR s_in_patient_stay_05.disch_date <> s_in_patient_stay_05.disch_date_orig) AND s_in_patient_stay_05.stay_patnt_refno <> s_in_patient_stay_05.stay_patnt_refno_orig THEN 'DT,NHI'
                          ELSE CASE WHEN (s_in_patient_stay_05.stay_start_date <> s_in_patient_stay_05.stay_start_date_orig OR s_in_patient_stay_05.stay_end_date <> s_in_patient_stay_05.stay_end_date_orig OR s_in_patient_stay_05.admit_date <> s_in_patient_stay_05.admit_date_orig OR s_in_patient_stay_05.disch_date <> s_in_patient_stay_05.disch_date_orig) THEN 'DT' ELSE CASE WHEN s_in_patient_stay_05.stay_patnt_refno <> s_in_patient_stay_05.stay_patnt_refno_orig THEN 'NHI' END END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59ce61ee-6593-44df-a8cf-77d4a6c734d7
          stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_INPATIENT_CHANGES
        join:
          joinCondition: |-
            FROM s_inpatient_changes
              JOIN s_in_patient_stay_05
                ON s_inpatient_changes.prvsp_refno = s_in_patient_stay_05.prvsp_refno
              LEFT OUTER JOIN dim.dim_specialty
                ON COALESCE(s_in_patient_stay_05.episode_spect_refno,s_in_patient_stay_05.event_spect_refno) = dim_specialty.specialty_reference_no
               AND s_in_patient_stay_05.stay_start_date BETWEEN dim_specialty.dss_start_date AND dim_specialty.dss_end_date
              LEFT OUTER JOIN dim.dim_patient
                ON s_in_patient_stay_05.event_patnt_refno = dim_patient.patient_reference_no
              LEFT OUTER JOIN dim.dim_healthcare_professional
                ON s_in_patient_stay_05.episode_proca_refno = dim_healthcare_professional.healthcare_professional_reference_no
               AND s_in_patient_stay_05.stay_start_date BETWEEN dim_healthcare_professional.dss_start_date AND dim_healthcare_professional.dss_end_date
              LEFT OUTER JOIN ds_pims_ae_attendances
                ON s_in_patient_stay_05.aeatt_refno = ds_pims_ae_attendances.aeatt_refno
              LEFT OUTER JOIN s_in_patient_leave_05
                ON s_in_patient_stay_05.sstay_refno = s_in_patient_leave_05.sstay_refno
               AND event_leave_seq_num = 1
        name: S_IN_PATIENT_STAY_10
        noLinkRefs: []
  name: S_IN_PATIENT_STAY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
