fileVersion: 1
id: 7090ef86-210f-4716-b2d4-f90b97f2327c
name: STAGEREVENUEBUDGETSTERRITORYHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "See Notes"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e61b652b-ded5-48f3-aec6-3ba7ec10f034
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5016222c-9093-48b5-b52a-401dda1cfcbe
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: IFNULL(TerritoryHistory.TerritoryHistoryKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 690709b3-b18e-45c9-a097-e97648c9efb2
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fbfffcd-f68f-4e91-b138-90dd302e13d9
                stepCounter: 86113105-00bc-43b5-a8a2-f834db0df80b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 207d0b95-b77c-4513-899e-89e388383fd0
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e20d5ab-da2b-4014-a503-df475d992b83
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a637cea3-ea2d-4cbf-940c-f2c4ddc6f425
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff04c5a-ae73-4e7f-b592-c124cdec415a
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fe2096e-88e1-4457-b9cd-75897162c48f
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00e5f9d2-bd37-47df-9c0c-f14f140d3ec3
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c760bcd-cdc8-4e84-9ee3-86bef6a4c3ec
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9388ddb7-eed0-4802-9006-a5638b5f1fb2
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95571db4-32a7-422e-a4f5-e690602ddf0c
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d62c2879-7726-4a5b-be6f-215637acaf91
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53d737a0-d6d4-4986-963f-7a5333b0ae70
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d902ce17-5528-488c-a4ba-8c6090d05206
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d700eee-5017-4c59-8d33-2324dda3c9d6
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b408bf80-bdab-467a-af6b-60a18c5b26fa
                stepCounter: 9404e914-5471-4608-9f5d-92129a9bed17
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 412608fe-2e11-47ae-bd6b-f4756ae4ef49
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageRevenueBudgetsTerritoryHistory.BudgetDate=DimBudgetDate.BudgetDate
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48601cdc-c1a2-4a30-87f6-4533985e72cf
                stepCounter: 608b285a-dc6a-4014-ae23-f707a432945a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d886740e-4181-4c6f-ad4e-25a83bf8dfa3
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e721d4d-d61e-41e5-9efe-03501db398b9
                stepCounter: 86113105-00bc-43b5-a8a2-f834db0df80b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbf54433-14c5-4451-a441-37f0c4191412
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7da7561-809d-4ea0-a004-0ff554a639af
                stepCounter: 86113105-00bc-43b5-a8a2-f834db0df80b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8656b46-9a49-4684-92e4-8f4a6fbfa1a1
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f34d90f-6814-4cfb-9f7a-a5d988905c80
                stepCounter: 86113105-00bc-43b5-a8a2-f834db0df80b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef9b87c4-cb58-4d7d-ae92-b7a7c23af401
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2030d4f5-e2ae-48d8-867d-d4c5fbb0b595
                stepCounter: 86113105-00bc-43b5-a8a2-f834db0df80b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c03afea8-b454-4305-a4b2-84023e976b7e
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ef42efe-600f-4995-9055-1409adba2afb
                stepCounter: 86113105-00bc-43b5-a8a2-f834db0df80b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 257c6669-40de-410f-bd09-fff3444cd33b
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dcebc3f-7d8c-48bc-b425-5c88781bfbbc
          stepCounter: 7090ef86-210f-4716-b2d4-f90b97f2327c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSTERRITORY: 86113105-00bc-43b5-a8a2-f834db0df80b
          TERRITORYHISTORY: 9404e914-5471-4608-9f5d-92129a9bed17
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: TERRITORYHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSTERRITORY
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSTERRITORY') }} LoadRevenueBudgetsTerritory
              LEFT JOIN {{ ref('DIM','TERRITORYHISTORY') }} TerritoryHistory
                ON LoadRevenueBudgetsTerritory.TerritoryId = TerritoryHistory.TerritoryId
               AND LoadRevenueBudgetsTerritory.BudgetDate BETWEEN TerritoryHistory.TerritoryManagerStartDate AND TerritoryHistory.TerritoryManagerEndDate
        name: STAGEREVENUEBUDGETSTERRITORYHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSTERRITORYHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
