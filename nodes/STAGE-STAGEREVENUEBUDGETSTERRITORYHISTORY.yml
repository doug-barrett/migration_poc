fileVersion: 1
id: 0aa02700-afac-4b00-8a9f-d296daa735be
name: STAGEREVENUEBUDGETSTERRITORYHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "See Notes"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0799300b-bf78-4082-a89f-ef26edf406d2
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31d13a32-7d27-4cdd-a1ad-bb650b65d8c6
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: IFNULL(TerritoryHistory.TerritoryHistoryKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dae99f8a-0deb-452d-a497-988fefd6403b
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1e973b3-b5cb-4b16-856b-04ca2bf0e561
                stepCounter: 94b7e4da-54e1-4bea-a110-f908b319757c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7db8d13f-d0c1-41dd-89a6-cc0b98f2b2d1
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27809bf0-7e6b-4dfa-a1e5-b8aac9d51496
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bc2cb5c-f5a8-41b2-bf56-3879d96e6a8a
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e841a7d3-68d0-455f-baec-35bdcd4c77d2
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e44d42ba-d0f3-4e0e-91fb-809444f07342
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c031a21-0968-495c-a222-0e0fe777445d
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a9e6d99-3bdb-44ba-8cd7-cae90b807567
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f44246d0-f82e-4a11-a6c9-ef4895ee6e16
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8c23712-21d3-422d-bf91-f8b1fff831fe
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ec0afa3-8574-437d-bf26-058361b605b2
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a741b5e-702c-4b12-b089-d6f1ec96356d
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ffd10c-a5c0-4b95-81b8-65da2f929687
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4df094de-64a9-44fc-832d-e92594e32ec2
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 950518d5-ccd9-4a32-b97d-f8838852c286
                stepCounter: 5e07f251-5194-4a05-b912-8997c2122732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b90a809f-2036-4a49-afcc-9f3c1d75875c
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageRevenueBudgetsTerritoryHistory.BudgetDate=DimBudgetDate.BudgetDate
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cb00172-db06-4a0a-a70c-39d4297b703c
                stepCounter: 5a652858-1d0d-4737-b9f7-a8788ecd3fca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f9c5c74-7dcf-4630-9c7d-523a889d2714
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94906785-82b1-40bb-9111-f768a4911a06
                stepCounter: 94b7e4da-54e1-4bea-a110-f908b319757c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d63c58bc-5c58-419a-a1aa-591c12576062
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5f22110-a89d-4ddf-8218-0ce3622a002b
                stepCounter: 94b7e4da-54e1-4bea-a110-f908b319757c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94e60c30-73c0-42c7-837f-73df8fe1dc5c
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c4ed35-3ac7-4b9a-a12d-23681be9a97c
                stepCounter: 94b7e4da-54e1-4bea-a110-f908b319757c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46fe074a-9d0e-4ee9-8202-b6ec8626bb92
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 705c3567-78fd-40dc-896f-b8f1b5775543
                stepCounter: 94b7e4da-54e1-4bea-a110-f908b319757c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 927dff65-08b3-437c-b80d-531295a42224
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc23ddc7-637c-46d4-987f-b410e5442657
                stepCounter: 94b7e4da-54e1-4bea-a110-f908b319757c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60ad6c8d-71e9-4b4a-88cd-ead4b7e229b7
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe0a037f-2758-4393-bae5-150cc0ad664d
          stepCounter: 0aa02700-afac-4b00-8a9f-d296daa735be
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSTERRITORY: 94b7e4da-54e1-4bea-a110-f908b319757c
          TERRITORYHISTORY: 5e07f251-5194-4a05-b912-8997c2122732
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: TERRITORYHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSTERRITORY
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSTERRITORY') }} LoadRevenueBudgetsTerritory
              LEFT JOIN {{ ref('DIM','TERRITORYHISTORY') }} TerritoryHistory
                ON LoadRevenueBudgetsTerritory.TerritoryId = TerritoryHistory.TerritoryId
               AND LoadRevenueBudgetsTerritory.BudgetDate BETWEEN TerritoryHistory.TerritoryManagerStartDate AND TerritoryHistory.TerritoryManagerEndDate
        name: STAGEREVENUEBUDGETSTERRITORYHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSTERRITORYHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
