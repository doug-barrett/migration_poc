fileVersion: 1
id: a5ecc691-1cc5-4d42-808d-fb449e7445de
name: STAGEREVENUEBUDGETSTERRITORYHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41632585-5ab9-45d8-b646-57458d1294ba
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: TERRITORYHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fe5a10a-b683-42ab-a8b5-40581004a752
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: IFNULL(TERRITORYHISTORY.TERRITORYHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b06181e-e1d5-47c7-953a-65c34c3436c6
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e76846d-c5a4-4b6e-891b-6bd71c4ee77a
                stepCounter: 5a0dc650-a25d-41d1-8b18-b5fd2818f3fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8429b34e-0803-4226-80be-a291c3c73975
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52456c69-7a2d-4023-93f5-7b63352a156b
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49135869-f216-4e53-90c3-99c877a5c494
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c8bb055-3205-4af3-8d69-10a4f182cb70
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76c0cfc0-c023-4cc0-b7a2-2c1d8591fa3f
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deea4412-d830-4eff-a7b8-62aa8ef078bf
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d23e975e-ec5d-4990-8105-573642ece5a3
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6de9df20-2e7b-40fd-a702-a596b7022e5d
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e09546c-6aae-4498-a010-effc6e2f6fcb
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5e914eb-6d5f-428b-a1a6-a9c58134e872
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7a32010-013a-4f1b-aa98-e4a7ac390ac7
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6440ca18-cb59-4f80-9591-9881c0a70aae
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39f29ac5-cc9b-44d8-9c37-09ac4aabe6e0
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9799c583-9c83-4905-8d9d-97f1abb7b9a6
                stepCounter: 94c78525-03a5-4f26-aa51-148d0a3c64b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b6c37d7-3191-48fb-badc-b173d8eb040b
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSTERRITORYHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7b85210-6802-44d7-b3cd-d4123f77ad4e
                stepCounter: 64797b99-919d-44e8-9897-e768b1d377bc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 850dd718-7c4a-4818-8cea-2318a6ea0de6
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe0d0c4-284b-434d-bc23-425bf591891a
                stepCounter: 5a0dc650-a25d-41d1-8b18-b5fd2818f3fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5633d456-3be6-4794-8e25-336a45c76317
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59cfa634-b118-4444-bdf0-1070b6838b48
                stepCounter: 5a0dc650-a25d-41d1-8b18-b5fd2818f3fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6daea236-880c-4b18-98c0-84a95c559edd
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42c7162b-ada8-4332-9895-56c3a7d0faad
                stepCounter: 5a0dc650-a25d-41d1-8b18-b5fd2818f3fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3124941e-3dca-4484-af49-eb29d1e438cd
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4fabc4f-3d3c-49f8-b951-f3130a20db3e
                stepCounter: 5a0dc650-a25d-41d1-8b18-b5fd2818f3fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2f26aa7-c626-43d5-97d4-be1abd104c0e
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a31fd7c-7b29-4240-b340-78b35951148e
                stepCounter: 5a0dc650-a25d-41d1-8b18-b5fd2818f3fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c89ff636-a394-436c-86af-404889bca4ac
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8edf0aa-7999-4abc-a0eb-756da80a485f
          stepCounter: a5ecc691-1cc5-4d42-808d-fb449e7445de
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSTERRITORY: 5a0dc650-a25d-41d1-8b18-b5fd2818f3fb
          TERRITORYHISTORY: 94c78525-03a5-4f26-aa51-148d0a3c64b1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: TERRITORYHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSTERRITORY
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSTERRITORY') }} LOADREVENUEBUDGETSTERRITORY
              LEFT JOIN {{ ref('DIM','TERRITORYHISTORY') }} TERRITORYHISTORY
                ON LOADREVENUEBUDGETSTERRITORY.TERRITORYID = TERRITORYHISTORY.TERRITORYID
               AND LOADREVENUEBUDGETSTERRITORY.BUDGETDATE BETWEEN TERRITORYHISTORY.TERRITORYMANAGERSTARTDATE AND TERRITORYHISTORY.TERRITORYMANAGERENDDATE
        name: STAGEREVENUEBUDGETSTERRITORYHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSTERRITORYHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
