fileVersion: 1
id: 293ff751-5e20-4a06-8c47-5d49b93027da
name: STAGEREVENUEBUDGETSTERRITORYHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 019b6219-7d3d-462b-b57e-b46a8cd65af6
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: TERRITORYHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5e9159f-96e4-40ea-8d40-d18082a662f2
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: IFNULL(TERRITORYHISTORY.TERRITORYHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b8e179f-7f83-422c-bdc2-d95de33ba8d1
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86976299-790a-416b-a4c2-7292058f8b98
                stepCounter: 0c594af7-c5f2-41c3-846d-fe4aaca4c0ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ce96398-1f81-4f59-88b6-1712c771963c
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e189720e-849d-49b1-86a8-477a9aa90c21
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8952afe-83b5-4272-8bf6-f73cde441a63
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d5f6b7f-9aa5-4658-9597-f4cea4c84aae
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f62873d-c66c-44ec-8ede-33d0083a7d9a
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 185f64ca-1a2d-48eb-ac1e-3130fb27b6fc
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae95a0a8-3fd3-41e9-8c88-c6e594e94a56
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ce8a1aa-4bc4-41da-9c27-4a00c7d79dc7
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfc413a2-1258-42c5-90c3-4363c14d3e3b
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d831acff-39bb-4225-a345-b9c25bfd186c
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09bb6988-a92b-457d-9966-bd3baf8962ed
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08eb4030-730a-4ab0-832e-d911ab035881
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a61f56c-35cc-40e3-86bb-a2618296f39c
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1661803c-ae3d-4d3b-aeb7-95d35d7db31f
                stepCounter: 26c4a7cc-3843-4594-b013-d605e2363951
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 031d06dd-b257-4529-9f58-9aba946c9dc3
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSTERRITORYHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c42f4c59-0fc8-49d9-82dd-50d19823c0b6
                stepCounter: a902137c-8d54-45f8-853b-239442cd36bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c6db193-e846-4cd7-a19f-0815eec853ec
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db04a3cf-b96d-40d2-9bb6-99c2235f35f3
                stepCounter: 0c594af7-c5f2-41c3-846d-fe4aaca4c0ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3438da0b-d11c-4300-8be3-2418f2ee8c14
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cba682af-85f4-4e30-95af-e54542630193
                stepCounter: 0c594af7-c5f2-41c3-846d-fe4aaca4c0ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 156fe5f2-5ed2-4bc6-bab2-7994b821a3ac
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 326d991f-cee5-45b5-84b3-79a2987e6f21
                stepCounter: 0c594af7-c5f2-41c3-846d-fe4aaca4c0ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 053ea471-0df3-4d6a-8d5b-62bf3895ec46
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0064ba62-0883-4e33-895c-13071d7e49f2
                stepCounter: 0c594af7-c5f2-41c3-846d-fe4aaca4c0ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f12fe33-5a23-4456-8885-fb0783b9c58f
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8be1e9f-d068-4a48-9d5e-596f094efae2
                stepCounter: 0c594af7-c5f2-41c3-846d-fe4aaca4c0ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fab8c7f9-f72e-4882-8e46-8144a47e1667
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8ef4bc9-3ade-4f09-b80d-1f03148d8e45
          stepCounter: 293ff751-5e20-4a06-8c47-5d49b93027da
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSTERRITORY: 0c594af7-c5f2-41c3-846d-fe4aaca4c0ea
          TERRITORYHISTORY: 26c4a7cc-3843-4594-b013-d605e2363951
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: TERRITORYHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSTERRITORY
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSTERRITORY') }} LOADREVENUEBUDGETSTERRITORY
              LEFT JOIN {{ ref('DIM','TERRITORYHISTORY') }} TERRITORYHISTORY
                ON LOADREVENUEBUDGETSTERRITORY.TERRITORYID = TERRITORYHISTORY.TERRITORYID
               AND LOADREVENUEBUDGETSTERRITORY.BUDGETDATE BETWEEN TERRITORYHISTORY.TERRITORYMANAGERSTARTDATE AND TERRITORYHISTORY.TERRITORYMANAGERENDDATE
        name: STAGEREVENUEBUDGETSTERRITORYHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSTERRITORYHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
