fileVersion: 1
id: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
name: STAGEREVENUEBUDGETSTERRITORYHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62a9f477-a3f3-4373-8244-c7713a791ed4
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: TERRITORYHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0028a5e5-6af7-4764-847d-9a0f913b433b
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: IFNULL(TERRITORYHISTORY.TERRITORYHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82dee6e5-6291-4fc4-801e-6f20e5aae8e2
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e66db696-9797-490b-9f08-3782490b5ff4
                stepCounter: 1beb0395-2920-4ce7-a923-a1e98595298d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0758a580-7bdc-422a-90fb-cdbd3f5b79ed
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 298ac4a3-99cb-43d8-817c-d7cc54565fcb
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88f4c79d-198c-4151-b052-117fffc08932
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64eb56eb-568e-41a3-bd6f-a57ce1848318
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9c54bdf-120c-4e5d-8b42-b9f92bf3898f
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb779435-2720-4a8d-9f86-04322f4cdbeb
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87fac7e5-98a1-430a-b927-95383e605d46
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b7910fc-8a6a-4cfe-ba9c-18d478bd568d
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14db7133-449c-4a41-963d-73d86d944862
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7638b507-a073-4821-8b71-20bd59e7ec7b
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5308c97-1ea7-4cdd-9364-c80829b7ace7
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79d3593e-10d3-42ea-9fbd-462176d7c512
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1b070e7-f7f3-44f6-9a2c-af92c3e06318
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ea5f10d-d8a4-48dd-ae53-dea8dfc6d818
                stepCounter: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79a433da-6a6d-468b-ab20-77889fd0fe63
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSTERRITORYHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 764d6832-2e15-4af0-b7cf-63416d29597c
                stepCounter: 8bc1c3e8-3761-4925-beac-685184de97ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8030238e-e7ff-45d7-b306-ef4e1262807e
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca323f1d-c4b3-4671-8bbf-fb523a398523
                stepCounter: 1beb0395-2920-4ce7-a923-a1e98595298d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ee8e2e0-e20a-4ed1-963c-6547f9b139ba
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de291de6-7bf4-4713-9b52-d52d5cdc0544
                stepCounter: 1beb0395-2920-4ce7-a923-a1e98595298d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 291c584e-4f38-4488-992e-12c230305e41
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c967b44-66e5-4467-8f84-653120acff15
                stepCounter: 1beb0395-2920-4ce7-a923-a1e98595298d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6406e14-fb10-4258-8943-aba8a3fe8c49
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4ac26a8-a6ab-4fbe-9a1d-0e089150c728
                stepCounter: 1beb0395-2920-4ce7-a923-a1e98595298d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e0a27c7-2e92-443a-88d4-b52de73e77d1
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cda4f457-3844-4a2b-8f3b-04219bb79b33
                stepCounter: 1beb0395-2920-4ce7-a923-a1e98595298d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8277998f-5719-44f3-bcc2-8a9cf28f4985
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d4e79a0-08d5-4ae4-b2ed-2ba85ce17d42
          stepCounter: 04b18398-77b6-4c22-a8a4-5bc8ff3bf67c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSTERRITORY: 1beb0395-2920-4ce7-a923-a1e98595298d
          TERRITORYHISTORY: 88ad0cc2-7555-4b7b-9f27-ce02d5fcd36b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: TERRITORYHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSTERRITORY
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSTERRITORY') }} LOADREVENUEBUDGETSTERRITORY
              LEFT JOIN {{ ref('DIM','TERRITORYHISTORY') }} TERRITORYHISTORY
                ON LOADREVENUEBUDGETSTERRITORY.TERRITORYID = TERRITORYHISTORY.TERRITORYID
               AND LOADREVENUEBUDGETSTERRITORY.BUDGETDATE BETWEEN TERRITORYHISTORY.TERRITORYMANAGERSTARTDATE AND TERRITORYHISTORY.TERRITORYMANAGERENDDATE
        name: STAGEREVENUEBUDGETSTERRITORYHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSTERRITORYHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
