fileVersion: 1
id: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
name: VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2fc41c1-ae57-4936-b570-d16bc6a11aa2
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07ffd23b-3a41-4900-b279-3c999a5094b8
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1972f1e-81dd-4c5c-ac2d-ed0f2eb43a2c
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78b5f134-d508-401f-a3fa-aa59f4ae3e6a
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbd1efa0-1817-4ff9-83f7-3a946015bf74
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47351474-375a-4126-835e-c2df6ee340ae
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ZONENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1eac49c0-6fea-40c0-ae9a-aea265a9e54e
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLINJECTHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74d8bca9-3d96-40b2-adcf-332977562fe3
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a075ba3b-0e98-40be-99ba-ee661ec32d22
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLINJECTGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe3f3e03-eff2-4620-8c00-2807d78a916f
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c566c506-5fee-45ee-bc4e-75ace66a29df
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLINJECTWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 299cd664-02df-4580-b65d-0f6fd7a85fac
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 048b4d7d-73eb-4860-841d-3181ac4a130f
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLDISPWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0f6902d-f198-4675-88e5-54a06e332b7a
          stepCounter: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW: e4eb7586-37dd-4255-80b9-e1b6aa3881e0
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW') }} AS SELECT c.wellidb AS uwi,
                   c.completionname AS name,
                   p.dttmstart AS period,
                   p.durdown * 24 AS hours_down,
                   p.durop * 24 AS hours_on,
                   z.zonename,
                   p.volinjecthcliq,
                   p.volinjectgas,
                   p.volinjectwater,
                   CASE WHEN u.typregulatory LIKE 'Dis%' THEN p.volinjectwater
                        ELSE 0
                         END AS voldispwater,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(f.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvflownetheader f
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth p
                ON f.idflownet = p.idflownet
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON p.idreccomp = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON c.idrecparent = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcompzone z
                ON p.idreccompzone = z.idrec
             WHERE f.syssecuritytyp = 'Germany'
               AND p.dttmstart < DATE_TRUNC('MONTH',CURRENT_TIMESTAMP)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
