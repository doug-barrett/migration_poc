fileVersion: 1
id: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
name: VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35f6dabb-8473-498e-8c8a-fadab8e8771a
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 608ed18d-d1fc-4d27-9bb1-d63cd57bb97e
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c31c616e-eff5-4f81-a522-e49825ccd02e
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97ba6bc6-7c0d-40ad-8e64-d834984a6570
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d77391fc-baaa-41c3-b4fe-e026f6435319
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2540bb2c-8b70-4e10-a164-b1d05fed4789
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ZONENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43a2bc20-a014-4679-b54f-188820425584
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLINJECTHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4a0d36c-b8b5-40b5-acd7-4b9dfe3281ee
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 203c479f-fd82-4edf-a8b0-32e587bb4f28
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLINJECTGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b30a0bd-1871-4b09-a3f9-9429948c2f3c
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9f9ae6c-24cd-4f42-b50d-81a4ddd37c85
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLINJECTWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a6b2aa9-2068-46ef-bcb2-66e911fdd8d6
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9db66400-5c1e-42d0-9958-251d65e72bb0
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VOLDISPWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5aa39f4-027c-4a7d-bb24-ed2b9bbbc70d
          stepCounter: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW: b725877e-b3ea-47a0-b7d2-4f1af0c8540b
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW') }} AS SELECT c.wellidb AS uwi,
                   c.completionname AS name,
                   p.dttmstart AS period,
                   p.durdown * 24 AS hours_down,
                   p.durop * 24 AS hours_on,
                   z.zonename,
                   p.volinjecthcliq,
                   p.volinjectgas,
                   p.volinjectwater,
                   CASE WHEN u.typregulatory LIKE 'Dis%' THEN p.volinjectwater
                        ELSE 0
                         END AS voldispwater,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(f.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvflownetheader f
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth p
                ON f.idflownet = p.idflownet
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON p.idreccomp = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON c.idrecparent = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcompzone z
                ON p.idreccompzone = z.idrec
             WHERE f.syssecuritytyp = 'Germany'
               AND p.dttmstart < DATE_TRUNC('MONTH',CURRENT_TIMESTAMP)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_OFM_MONTHLY_INJ_GERMANY_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
