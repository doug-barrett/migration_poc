fileVersion: 1
id: cd927cac-6117-42be-9314-e175ac09c269
name: S_SHARED_INPATIENT_EVENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage in-patient events"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 407336fb-adfc-4f5f-b66e-6750236e4d60
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95d240cb-857b-4f42-a1b2-be95c3eb461d
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a17e1eb-db39-4b31-b919-f7a0a0de8340
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f474369-7ba5-4452-9f8a-4aa2b44abda4
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcb83293-4177-4b5a-b412-5f68e99e5381
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 555e4a98-0c02-4bfa-825a-4279bf8fd27a
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Specailty of the first inapteitn professional carer episode
        name: ADMIT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57e828e1-376c-4227-a3a7-fc8a20caf2b3
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b62a4167-a08f-4672-946a-9c02254c3f96
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f7da067-4c42-4d7f-ad67-9a5d218c5168
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc33cfd5-d251-429a-8e85-8bee6729ca27
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: event_service_point_code
        name: EVENT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30ccca1a-d162-4fd1-8b3d-46c08177246c
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4737ab49-863d-4e7c-a6ca-f733067b1afe
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: hospital_code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e236a9be-1643-4aa4-ba73-1fba703c167c
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 667c619a-2415-45e4-b017-cd1b90d568a4
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f97f367b-b615-4342-8006-ab358e4fc465
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09f799b8-40d7-4d1f-84a3-7230f165ac82
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbc078d3-75b8-4da2-b638-ae8647d88b38
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ae25d4c-277e-4d98-95cf-8aeebfb74e59
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68f8ee9c-565a-42b2-a088-b20e8a155ef1
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ea3cb2-90fd-4a96-a490-24aecb9d8ac8
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_NZNHI_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a6d09d0-c591-4143-9a66-edaf41885afd
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6f54465-1b60-4b7a-aedc-d519d33b9063
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a6d09d0-c591-4143-9a66-edaf41885afd
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a689aa8a-c33c-445f-8284-c7ebcc265d2a
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f767b438-59b7-468e-afa6-c915a628b211
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2a0bffb-5b4f-49e5-8a06-0f24d524684b
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0244b0a8-8514-4332-ba67-8c45753ce55b
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 349c85e3-6cca-4b63-80e8-b50a0a96f2ab
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: READMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9686351d-558c-45b5-878b-35d28c320882
                stepCounter: 9b060604-ca06-4eef-aaf1-8957f2377d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2909cc67-d431-4763-9412-aef37a522ad9
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLEVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3df06478-90eb-4bc3-bf32-342a05c82790
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93962470-b213-424e-a325-0a83c3b52539
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce4730b4-fab1-443e-902a-14678f252aaa
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc55d2a0-7314-493a-b154-a9f5ca79774c
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Professional_Code
        name: EVENT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393c87d-2bfd-47b3-a557-82745248467a
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a27f923a-5622-4386-b519-47414f15a552
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e27bad3-3f3e-4b12-8d4c-bde9f01dd0cd
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f529132f-bb21-4df1-a10b-7bf7dcdf541f
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f2c82a-2117-4093-8162-258a5459bd3d
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69a18f6b-d254-4c7c-9001-dcb278bccf23
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a385fb8-d492-4b43-b3fb-15ad16a242cd
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cb65873-c927-440f-84ae-77bf5cf8e8e6
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63829b4b-cb50-47c5-b8fc-df3a7548d9af
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c69d4b9-80f8-4981-8580-3f7fa0ec6935
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0cb2942-8124-45bf-a3d4-ced27cb882d9
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c22f930-c5e3-4a10-8e9b-307627f67f94
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f99a682f-e63d-4922-8159-7a5e668f11db
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2ba646a-c807-4d89-bf84-85d3740e0b76
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c76c93a-ec68-4299-afa8-ae0161c4dd62
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: The date the patient was born
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b49659a-1936-4204-9a89-43a545c95902
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd, dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death, s_shared_inpatient_event_01.admit_date) < s_shared_inpatient_event_01.admit_date THEN IFNULL(dim_patient.patient_date_of_death, s_shared_inpatient_event_01.admit_date) ELSE s_shared_inpatient_event_01.admit_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeddfb41-0197-45c3-82a3-3994499d33d2
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(mm, dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death, s_shared_inpatient_event_01.admit_date) < s_shared_inpatient_event_01.admit_date THEN IFNULL(dim_patient.patient_date_of_death, s_shared_inpatient_event_01.admit_date) ELSE s_shared_inpatient_event_01.admit_date END) % 12)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d81deefa-d51b-44ef-a3d7-2ded04385377
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61e511b9-2fe6-4901-811a-470969df0702
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc85e659-b09c-4294-ba3c-888e3a5202f5
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fb05c79-d395-4757-af99-6f25dd443edb
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25bbab5f-6410-444d-ae3b-0453e6b1dbdd
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 203413be-7d2c-463d-8f9d-fb069f24a780
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baa70493-f779-449e-9776-902ac82a4c0c
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88f4c767-d674-4d30-bbe0-2e7854d121e7
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3953e163-ad75-488b-9117-f33879d02ae6
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: event_length_of_stay
        name: EVENT_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 203413be-7d2c-463d-8f9d-fb069f24a780
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: DATEDIFF(dd, s_shared_inpatient_event_01.admit_date, s_shared_inpatient_event_01.disch_date) - IFNULL(s_in_patient_leave_05.event_leave_total_duration, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cd1012d-8ff9-485e-8f1d-6fde7d2e0b40
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68b0d09a-4008-4ac7-85d9-b00b63862b97
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10988379-643d-40a7-b575-0f88801a1329
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68b0d09a-4008-4ac7-85d9-b00b63862b97
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: "'R' + CONVERT(varchar, s_shared_inpatient_event_01.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9263d29-dd7e-42a6-af0e-bfe7620776ad
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6789de5a-aa82-424c-8b60-504b978d6036
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a610904-bc02-4aa7-85f8-e63591692d27
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6789de5a-aa82-424c-8b60-504b978d6036
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: "'A' + CONVERT(varchar, s_shared_inpatient_event_01.aeatt_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a05ccd3-263e-4a91-baad-cf1d7b1fb531
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REGULAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7dc1539-efac-4c03-b6da-ea3c0f010653
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a129b2f7-42f8-44eb-af7c-6a43a2520165
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0779bc5-bf7e-4001-8440-f3cc99dc5861
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d3bb244-ebf6-4fab-86aa-dcd2a73e3334
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bef5ae2c-aedb-4e25-babf-3fd1e9a8e6c9
                stepCounter: 3fdf4180-c40e-4f94-9cbb-852501d299b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1a40006-1410-45f1-8603-da39b3bfd3d2
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1048f865-a728-4e44-b371-cc5b66b8afd3
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 555a961f-d27c-4bf4-a325-d4b86629c55a
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85c51bfc-e1e1-469f-9c1e-6389c2643663
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19a1cb24-633b-4121-b298-e4173431b565
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54232582-e014-428e-a034-10318b5c7274
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34d3a08c-c5e4-40ee-80c2-ff826d4f2556
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 766c399e-8fbf-496a-a70c-846b6e902e66
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81af3ea0-b91e-4e13-99c1-205a7f217f18
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 711aac6d-d6b3-4ad1-8772-e1b54b58bb3e
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d098dd58-cf93-46af-adb4-d9e876687003
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FAST_TRACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 269dcc65-0019-498d-bdae-b55c060ba731
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea64a30f-f110-424a-9065-f0272239583c
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AGEBD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c91e68cd-d829-4542-b1ce-3b37e059ecb0
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7c98000-53b3-4ac6-88db-34827aad29cd
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NO_FUNDS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80b762a1-a6cb-46dd-b2a7-6acf0686fb95
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a82c1f9-f66b-4529-a989-e9d3b7df704a
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_START_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c045940-e028-4eb3-ba4d-f1ab9e76ac82
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95120343-ae7b-4661-a71d-633f26ac6542
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4a1a9d2-fccc-4da9-af51-4e6b38afdb2c
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d67451e0-230a-4cfe-9852-25a845cdc7b0
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe46941-c693-4564-9cd5-b52de854fbb3
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f299e29f-1e75-4e04-a647-25c468799901
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4bfb99b-11bf-4554-8ce3-721c455ea9d0
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 129096b1-76a5-4953-89de-5bf0c0292b6f
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3697b645-b0b8-4dde-a8dc-0921c73cddd9
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1a7cbca-0357-4c70-9252-3952892e5c0d
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7144b0e0-cdb0-41f9-b9d1-294b1ccc3b01
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e329032a-dcae-49a8-8213-c6491c1f0c68
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DSINF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96083243-5fd0-432a-98e3-5764178202dc
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 765bce53-983b-4275-afa9-0e97a1871fa4
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47bc1a16-3034-4362-a2d4-a10f164f93af
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecc2e298-343f-496f-b1cf-cfb00ecc1220
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e7da23f-5da0-4bfe-8b40-de68161ccd52
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0d1a89a-d2b1-4174-9577-9daf1f2b7351
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GP_ADVISE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bff8162-ebf3-4358-a442-e0bac4267d48
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b00757f-1640-4ff4-a66b-c2626cc4578b
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce3bf38e-bbfd-4b6e-b35e-651a88199f16
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd20eeb5-0fc2-4f68-b2dc-5585fdb09a77
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MECH_VENT_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c3b97f9-acfb-46dd-a4e5-5f5bba316d7a
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c2e2ae7-73c9-46f2-b397-e592e673261a
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AMBULANCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a560563-c54c-4f5b-810d-36f631e6776d
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c659335b-2890-4008-9ea2-9cffc9613af8
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b3bd8fe-509d-4616-b80c-20f1b0ce4870
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98b6b1b1-39d5-4f05-940f-1b122ec3c7de
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RELATED_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 124c6a23-4073-46fd-8125-74f5127dbf97
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3745b992-ef2b-405f-8bb9-e02f4b86ca82
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READM_REHAB_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dc0c782-b400-46a9-9af8-b331c3f2934f
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d04b9742-1e8c-4aeb-8152-8d07116a6b48
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d00d5a05-e3b8-410d-8535-427c2c1c184c
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a4dde7c-2fbc-4b53-945f-c3df3b7cc194
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6684c7e-b39a-486e-8263-eccaf5d57eb1
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b73abd32-60a4-4518-82a9-27ba625cd597
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6d50dac-7ec4-4be8-90b7-73dcd757fbb3
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b626bb0c-1b89-48d5-a595-a09c521f3687
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHAB_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 325f10c1-5584-44f9-96ff-d22c4fed48ab
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c23f1094-75c1-4345-86e9-ffb0b28ebecc
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c336df2-e0a1-4248-b8e2-51528903769b
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21aa6043-72ac-4136-8170-9f99951319de
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11e6f20d-60ac-4242-99c1-361f502ddd12
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f883206-e19b-4a5c-b692-29dffc6d31f0
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81f2bf0e-1c90-4699-afdb-dcb1785f8c28
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23064f14-ec59-4605-a41a-88faf714a5c9
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NMDS_EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 316c95d8-0518-42e0-b8c8-d6281d5dbd3d
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5f14bbd-7375-4a2d-ab37-6a9e4945d853
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fac3ac5a-e6c0-421c-a940-d3e33d1e7de8
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 483f2d0f-40eb-4d68-8e50-5846d4de9644
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 621c25e2-eb6d-4c90-839b-738ee50ca98b
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa3b76c-387c-4b78-a850-f2fcde0538d2
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 621c25e2-eb6d-4c90-839b-738ee50ca98b
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: "'W' + CONVERT(varchar, s_shared_inpatient_event_01.wlist_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83734427-da47-4959-b981-811c5fb589e9
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Carer Episode Outcome
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9557aa12-86f3-4ea7-834e-55d675697d11
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afbb3f1b-0012-4e1c-984c-ed7137d8d8be
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 093a16e9-2c48-43b7-9225-2761d6eca8bf
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91f22070-30e2-484c-a41a-37182961a329
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Specialty of the last inpatient stay episode. Dsicharge Specialty
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f57d2593-d25c-4c6b-a3f1-b65f711653d1
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4f8af96-5f1c-431b-9655-9f61d9aca739
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab525339-3f36-4625-ba0c-d207897f094b
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1de80906-f7a8-4e34-9b09-a8b4d3655248
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DISCHARGE_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7d99023-91e0-40cb-a020-ce08e643f9f3
                stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
            transform: IFNULL(s_shared_inpatient_event_02.discharge_health_specialty_code, dim_specialty.health_specialty_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8dde514-1b21-44ba-8cf9-7c08a6e450f0
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: 'Flags used to join IP events to s_inpatient_purchase_unit_RC. Updated by custom proc.  '
        name: PURCHASE_UNIT_FLAGS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f6bd8a-f17e-4a67-a189-544cf3b31f2b
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.bronchoscopy_flag = 1, 'Y', 'N') + IIF(s_inpatient_coding_flags.colonoscopy_flag = 1, 'Y', 'N') + IIF(s_inpatient_coding_flags.colposcopy_flag = 1, 'Y', 'N') + IIF(s_inpatient_coding_flags.cystoscopy_flag = 1, 'Y', 'N') + IIF(s_inpatient_coding_flags.gastroscopy_flag = 1, 'Y', 'N') + IIF(s_inpatient_coding_flags.hysteroscopy_flag = 1, 'Y', 'N') + IFNULL(s_shared_inpatient_event_01.package_of_care_flag, 'N') + IFNULL(s_shared_inpatient_event_01.SCBU_flag, 'N') + IIF(s_inpatient_coding_flags.skin_lesion_flag = 1, 'Y', 'N') + IIF(s_inpatient_coding_flags.outsourced_flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a98ea53-2b4e-45f1-82d4-87dfddd82c0b
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a bronchoscopy
        name: BRONCHOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f6bd8a-f17e-4a67-a189-544cf3b31f2b
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.bronchoscopy_flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baa94cd6-727b-42ab-bcc2-ae616c2ce794
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COLONOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3be31d29-f04b-4081-8cbe-deec7a3ae773
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.colonoscopy_flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c4e9754-8c82-4e9b-8503-5ef441d01b2d
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a colposcopy
        name: COLPOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5968be7d-7d41-4a41-894e-25769cf9fce1
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.colposcopy_flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99df54dc-b953-44e6-b79e-5fd642632977
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CYSTOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 645dcea7-5985-4596-bb23-80df7fd80df6
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.cystoscopy_Flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bf5aa73-7c73-4d3d-a6f3-e58cc57c1373
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GASTROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 321e5237-8feb-4f73-a763-fe8d24e2550e
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.gastroscopy_flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8b545ef-09a5-4005-a9ba-a7a401fd848c
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a hysteroscopy
        name: HYSTEROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3c6807f-a0a8-46ad-9cf3-305af4cab227
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.hysteroscopy_flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6512f44b-1095-432e-ad60-f6510e4d2a30
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a uncoded skin lesion
        name: SKIN_LESION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f1bb4ee-b6e6-4219-9a2b-5b16dea28a4f
                stepCounter: a09c3402-a3e8-469a-806b-a1716bf7138d
            transform: IIF(s_inpatient_coding_flags.skin_lesion_flag = 1, 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 099e3dc9-9a4f-4108-99fc-4839ba23b0c3
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Sets up the SCBU flag based on DRG. Flag is adjusted depending on whether a patient passes through SCBU too.
        name: SCBU_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0db690a-a8d5-415d-8bf9-b0781871a023
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f21bea-5dbf-494a-8743-def343e5cde7
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if one of the ward stays for the event is SCBU. This column not currently used. Only here for debuggint purposes.
        name: SCBU_WARD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1642b97f-d2c2-4e4b-8ede-8cfe0c181315
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af78bfc0-10c5-4ae5-9d59-6dad6b71b74f
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7539eb04-63e9-4501-828e-9a2bec8988c9
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: IFNULL(NULLIF(s_shared_inpatient_event_01.purchase_unit_code, 'EXCLU'), s_shared_inpatient_event_01.excluded_purchase_unit_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d818a81-d738-4aec-900a-33bdceebc230
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'This update of purchase_unit_code previously done in s_in_patient_event_10. Now done here so that non IP objects can use the 05 table for required data.  '
        name: PURCHASE_UNIT_CODE_FIXED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 086b3fe9-5d77-4333-be81-e022ac933bbc
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c44f3b-6800-423b-9b11-a3f76f54bc59
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47d7908b-520c-496f-8d00-5e4a2d516246
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4b88ffe-e910-4002-a54f-d77802cda6ab
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51b164b2-40a4-444d-8423-0ff90dbaeaca
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45dfc9d9-c10e-4fb1-a254-1e8b0bd701a8
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03ac8d34-fd6e-4e08-9807-14ab46af9787
                stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecd5cbec-67ae-463f-a672-c9b96ea327ea
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9834a237-5647-4077-bd26-c817c21d1bfa
                stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb92ffd9-f706-430c-bad3-15167dd5093b
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aba43e2-f012-484a-bce2-3dee4d7a213b
                stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5abab8f-8142-49c3-83d3-20d9a33b2c59
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0cb2942-8124-45bf-a3d4-ced27cb882d9
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ROW_NUMBER() OVER (PARTITION BY s_shared_inpatient_event_01.patnt_refno ORDER BY s_shared_inpatient_event_01.admit_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac77a41-e408-4d03-b719-8c59c11c979f
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0cb2942-8124-45bf-a3d4-ced27cb882d9
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: COUNT(1) OVER (PARTITION BY s_shared_inpatient_event_01.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d385684-407c-4aa1-af68-007533024d53
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 231e50ac-c868-42d8-8d1c-6eca7fa044d7
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d44457cc-8abb-49c1-9427-342cc6e8a8ac
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5e3ab0-4f85-4d10-ba7d-3b265222f05f
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35d4b91d-66a4-4288-abc0-48138dbcbc4a
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a07d21b7-0ae2-4026-a0c8-5de952087e78
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3779b44-959c-4d78-88fe-5678385a746b
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a0ab72c-5fef-4f13-8afe-d8162364898b
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8246048b-1cd8-4a0b-af50-e54964dc6cbe
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3796230a-7b33-4439-8686-5aac84e456b0
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 853c62ed-c8be-4de6-af13-a2b1e3b6e487
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccede749-5d03-4c00-92f3-df23f92d0c01
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449ba36a-5c2f-4473-bf33-0e94a08cc5ab
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a8bace5-76fe-4700-8096-b4d2fda74d32
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5081fa05-c8ad-4c07-acc7-cf67bedb66d6
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f1bef3-23d3-4719-9909-9fe059faed43
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47cc2368-a873-4790-af45-e4af2a418421
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f1bef3-23d3-4719-9909-9fe059faed43
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IIF(ds_shared_schedule.into_theatre_date IS NULL, 'N', 'Y')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90032e5c-ecf6-4620-931a-10305b6bbd79
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: surgical_theatre_group
        name: SURGICAL_THEATRE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0398c3fc-4aa4-4ba2-9985-b2e9ad883330
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ad15dd-cbf9-4125-a26b-35d62e4edaf8
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PACKAGE_OF_CARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d53d2fc-bfc9-4299-b007-2020a14b4254
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7609a09b-2113-4bc9-931e-6fa248481e73
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: Updated by custom procedure.
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd9cec5-59a8-4af5-aea4-7ff63404f924
                stepCounter: 0ebc37a1-c3d2-4bfc-877b-4f11d3b17d44
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74d11181-f622-4312-b552-6f1791c04b4d
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Updated by custom procedure.
        name: DEFAULT_PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80d3eaba-7054-4029-9629-b87c08a37aad
                stepCounter: 0ebc37a1-c3d2-4bfc-877b-4f11d3b17d44
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84eff42a-7bba-4729-89d3-ab4d57d5c99c
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Updated by custom procedure.
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79f6b844-e481-482b-b837-1ddf879d1293
                stepCounter: 0ebc37a1-c3d2-4bfc-877b-4f11d3b17d44
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2860ad2-4cc0-4e1a-b364-36e73518db76
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating event can be the initial one in an OS3 sequence.
        name: OS3_ADMIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9a40dc1-82ec-443e-82c8-29fd55a1f2df
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebcb26c2-e4cb-44a6-b335-d9829f31ab66
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating event can be the final one in an OS3 sequence.
        name: OS3_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b541711c-d7c3-4159-823a-a76f018fdf5d
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da8c0d63-506c-43a6-9f3a-a6f8fafbd598
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event identifier for the MoH OS3 ALOS measure that connects across events.  The event use is the last event in the sequence.
        name: OS3_MASTER_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IIF(s_shared_inpatient_event_01.OS3_discharge_flag = 1, s_shared_inpatient_event_01.event_encounter_id, NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a8af60e-4103-4b6d-a418-5202fc0a38a0
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: INT
        defaultValue: ""
        description: OS3 Event sequence 1= the first event in the series
        name: OS3_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              -- Will be updated by custom proc if more than 1 event for the master encounter
              IIF(s_shared_inpatient_event_01.OS3_discharge_flag = 1, 1, NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0140177b-c440-485c-b54c-52c6cac13956
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Event LOS in 30 minute units for the MoH OS3 ALOS measure that connects across events.  '
        name: OS3_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47b4e14e-a286-43a9-9e74-44feb0c74007
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2493b9b7-330f-4ca5-a748-6e5579fb1867
          stepCounter: cd927cac-6117-42be-9314-e175ac09c269
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SHARED_INPATIENT_EVENT_01
        join:
          joinCondition: |-
            FROM s_shared_inpatient_event_01
              LEFT OUTER JOIN s_shared_inpatient_event_02
                ON s_shared_inpatient_event_01.prvsp_refno = s_shared_inpatient_event_02.prvsp_refno
              LEFT OUTER JOIN s_inpatient_coding_flags
                ON s_shared_inpatient_event_01.prvsp_refno = s_inpatient_coding_flags.prvsp_refno
              LEFT OUTER JOIN s_in_patient_leave_05
                ON s_shared_inpatient_event_01.prvsp_refno = s_in_patient_leave_05.prvsp_refno
               AND s_in_patient_leave_05.event_leave_seq_num = 1
              LEFT OUTER JOIN dim.dim_admission_method
                ON s_shared_inpatient_event_01.admet_refno = dim_admission_method.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_discharge_method
                ON s_shared_inpatient_event_01.dismt_refno = dim_discharge_method.discharge_method_reference_no
              LEFT OUTER JOIN dim.dim_event_type
                ON s_shared_inpatient_event_01.inmgt_refno = dim_event_type.intended_management_type_reference_no
              LEFT OUTER JOIN dim.dim_healthcare_professional
                ON s_shared_inpatient_event_01.proca_refno = dim_healthcare_professional.healthcare_professional_reference_no
               AND dim_healthcare_professional.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_patient
                ON s_shared_inpatient_event_01.patnt_refno = dim_patient.patient_reference_no
              LEFT OUTER JOIN dim.dim_readmission_type
                ON s_shared_inpatient_event_01.readm_refno = dim_readmission_type.readmission_type_reference_no
               AND dim_readmission_type.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_specialty
                ON s_shared_inpatient_event_01.spect_refno = dim_specialty.specialty_reference_no
               AND dim_specialty.dss_current_flag = 'Y'
              LEFT OUTER JOIN (SELECT patient_reference_no,
                   MIN(into_theatre_date) into_theatre_date
              FROM ds_shared_schedule
             WHERE schedule_theatre_status_code = 'A' -- 'Actual'    GROUP BY patient_reference_no) ds_shared_schedule  ON  ds_shared_schedule.patient_reference_no = s_shared_inpatient_event_01.patnt_refno    AND ds_shared_schedule.into_theatre_date BETWEEN s_shared_inpatient_event_01.admit_date AND IFNULL(s_shared_inpatient_event_01.disch_date, '2999-12-31')    WHERE s_shared_inpatient_event_01.event_seq_num = 1 -- Check for duplicated event_encounter_id values
        name: S_SHARED_INPATIENT_EVENT
        noLinkRefs: []
  name: S_SHARED_INPATIENT_EVENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
