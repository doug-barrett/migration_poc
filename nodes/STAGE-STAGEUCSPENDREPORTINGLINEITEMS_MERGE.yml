fileVersion: 1
id: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed7d911d-259b-46d4-966f-cad5e30887c1
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: SPENDREPORTINGLINEITEMSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f58178-e148-45d9-8b81-e71625ba6a85
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aef09f3-c87c-4b5a-b539-b33be6226741
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a72165e-0abb-4d61-a81a-9b891c56d60f
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a1ad337-dbbb-4b16-b436-439c58804690
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83a44982-bd2b-465a-b3ff-b4bbe95edc4e
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26e5f977-5ea3-4ba4-abbd-a9c8d0b7b18f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 468dae76-6312-45f8-a2e1-0695085c14be
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44901eba-139e-418a-aa13-f3333e03edd1
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4842a81-8117-4885-8c87-c26fa2b5f73a
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e20027c8-220b-4c31-9c96-8c01e6c7966f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7bd4e14-0116-4405-a43b-34ec859af68c
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 076353f2-422f-49db-a5a8-b2c554a9e4e2
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UC_TIER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7be228a-4d6f-45c1-b00b-5f8d9f6cbb3e
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe40ca40-25c2-4c45-a697-14131badccd8
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UC_TIER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72a58c4f-a3f4-48f1-89f0-52ba54a91fdc
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d73a127-4d9b-41e8-8344-267d6f68ed7c
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UC_TIER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82ca0172-b987-441b-ae15-8a30b62ebd6e
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cb0e2bf-e45e-4994-9d9d-e9daa855993f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OBJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f76d09c8-7b14-40b7-97d9-de43cc62f359
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 178d2ea7-b027-4ddb-8f88-340971186e0f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PO_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41d684d5-15a6-43e7-8c24-4924133c39e8
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 412c0261-304b-4163-9102-b585b0264dd0
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PAYMENT_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2851b84-536b-4c3d-81e3-80fc1781a625
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0e815a3-df4d-4371-94ea-6b5a25648c2d
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LINEDESCCARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab19c702-e3b5-4831-a76c-3c78acf9a7a9
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85af3c7a-2679-4e05-ba90-c7b5f1e2b52f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LINEDESCINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73416966-0421-4671-af68-dcdf11995537
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2088479e-8ac0-45a3-94ef-23a2117edf9f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LINEDESCPO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2484fa2-078c-4a64-b637-ea084bd725b1
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14eef01a-7edc-45f8-8631-d2cfb2dc16cd
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UNITPRICEINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8f56bbb-7bec-469b-9591-1f70d33629f5
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fb09f85-e04d-4c3a-96f2-1bb5db39d274
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CAMPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fac2afa2-54f0-410d-bb0f-abae52b7f1f5
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d9c644a-d7ec-4a0c-8feb-64925384b41f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35bb3d2f-bce9-4377-bc21-913e47568a8c
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 436b4ff2-2135-4e19-9682-b134e555ebe4
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: caf7d77d-825c-4073-ab81-5481963ab74d
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2fc3c42-fd52-4d36-b469-6e7391fa2bcd
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bd5f965-2b72-4c87-89d6-bbe3c9f914bd
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63bc51c0-a761-43b4-8fa2-a5e024aa994b
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224033f9-dfdb-4d94-877e-4bb9de8c58dd
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3432f5ef-bb00-43a2-b9c7-67ada6a0624e
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TRANSACTIONDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e30c5d48-3755-4d6f-8f26-04f0a7747261
                stepCounter: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e78e6d8-8558-433c-bf5b-dbb4373ecc4b
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCCOMPONENTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff07022e-eaf9-4dde-8232-69b620b19b91
                stepCounter: d4ce7ccf-ef16-4207-be42-85fe7414dcfb
            transform: IFNULL(UCComponent.UCComponentKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32fafcc1-07ff-4c3b-846e-f16192c4f48c
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d390cf3-eb7f-4d50-ae56-00e3bb0ad33a
                stepCounter: d4ce7ccf-ef16-4207-be42-85fe7414dcfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c974b537-8cf6-416d-9b19-800e1d2af173
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPCONTRACTNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8074dcf-79db-4684-9375-d58c4009ae6f
                stepCounter: d4ce7ccf-ef16-4207-be42-85fe7414dcfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfc56962-0d04-41ac-9441-428f72355b7a
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERMATCHTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6962aa8-a195-4fd6-a064-8883625e7640
                stepCounter: d4ce7ccf-ef16-4207-be42-85fe7414dcfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d6a0d0-45bb-47bc-bc37-30beca371942
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCCOMPONENTMATCHINGOMNIASUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e9dd57e-3b18-4699-a413-28ada8c7dbc5
                stepCounter: d4ce7ccf-ef16-4207-be42-85fe7414dcfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07094fd5-1df9-455f-92af-eb50e5f0966f
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e80171b-d3f8-44b3-bc99-8c71ac30f26e
                stepCounter: d4ce7ccf-ef16-4207-be42-85fe7414dcfb
            transform: IFNULL(UCComponent.OPContractMappingStatusId,4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00699a94-353c-4675-bc22-aa4b2fefc1dc
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 316c95ba-6a20-4d1a-a39b-0d9cf99e382e
          stepCounter: 306bfa34-5dc3-4285-acfb-e2f7faf949e4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEUCSPENDREPORTINGLINEITEMS: aec80811-a3a3-4bd1-8fb9-3ffd47a48296
          UCCOMPONENT: d4ce7ccf-ef16-4207-be42-85fe7414dcfb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: UCCOMPONENT
          - locationName: STAGE
            nodeName: STAGEUCSPENDREPORTINGLINEITEMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEUCSPENDREPORTINGLINEITEMS') }} StageUCSpendReportingLineItems
              LEFT JOIN {{ ref('DIM','UCCOMPONENT') }} UCComponent
                ON StageUCSpendReportingLineItems.Campus = UCComponent.UCComponentCampus
               AND StageUCSpendReportingLineItems.Category_Level_4 = UCComponent.UCComponentLevel4Category
               AND StageUCSpendReportingLineItems.Supplier = UCComponent.UCComponentUCSupplierName
        name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
        noLinkRefs: []
  name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
