fileVersion: 1
id: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb160ce5-366a-40d5-ab7a-fa5061c59f73
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: SPENDREPORTINGLINEITEMSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4767b368-06e6-4113-9236-4fadb5cb6919
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d14b778-8f42-41bb-919d-294b7a013176
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fb367c3-a070-4d85-92f9-0f4ab797e6ff
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d66dfa9d-be2f-44ac-8bca-dc100656f908
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74fc20d6-308d-4b98-a56c-35ae9c998e9c
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb285ef6-f4f2-4498-ba35-a4293092ba04
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78d278dc-0a10-440d-9609-fa637fe60e3f
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45a51d0e-743d-489a-b7b0-6e09f67b06dc
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 348d88bf-c522-4ae6-b8a9-caea1a8606d2
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fbcc956-84dc-482e-bae9-c442ef90fe8a
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CATEGORY_LEVEL_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0d1d352-d298-4d67-bbff-9f7aa8f639bc
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5abf35c6-f70f-4884-b00c-a5c76b4b206a
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UC_TIER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bd1eb6a-4cef-4d61-bd8e-054068efd961
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fcd7077-9b9e-4285-912b-00906cd6213c
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UC_TIER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6802d95-9fc9-4f05-a313-15826c8c9077
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05c0af27-7017-426a-af36-a804205e0ed1
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UC_TIER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88e56960-b298-4764-a9de-43bfdf517e46
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 882846ae-87e8-44f6-ab8a-1102dc49c89d
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OBJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b10ec347-64c5-4334-8137-403ea426e987
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fca40192-936e-4409-934d-a392c5c6f543
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PO_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46fdd74e-c475-4575-9a1a-b757a1fed0e6
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbfdddb3-08c7-4145-94da-8332c0dc218a
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PAYMENT_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c9ab9da-1473-4ad0-a5b2-fbe601f8f2e8
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67475ad3-9479-412a-a9c0-50236897d8ce
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LINEDESCCARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a29ff28-e966-45e4-87c7-f5891d913547
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84526622-1c0f-4c16-9fe2-8b248b76f6ab
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LINEDESCINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5b2fe0e-c45e-4915-bd5a-59b265ec28f1
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cbb8b7c-60c5-4d35-862e-938dc3a5aac3
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LINEDESCPO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a815402c-2788-4680-845f-f84a64f21326
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a58bad76-5fac-4ba8-8ca8-32bf098d57f0
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UNITPRICEINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53e42b26-ff0b-4342-8112-f8f028260ca8
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bf4622e-6f2e-42ef-8f38-0eadd968a278
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CAMPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4f0e106-77d6-46fa-a73e-8cdff51f3727
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62ad179f-1f95-4c5d-a052-a0a278dd27ea
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39eac400-72c4-49d6-a15b-a1f7aabbd3a2
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06b67d05-f806-4b3e-a3da-31c02be09a09
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76749a1d-a848-48c3-96a9-f18190913308
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff8ed099-e0cc-4045-b00b-7114d1dbfd5e
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56dd8c48-43b8-438b-834d-952d44d745ff
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44cc3f42-1488-4ec0-844a-9ce03fd88853
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 873a9ee2-be81-4b42-beeb-1fa8da3ef25b
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe11e7d5-be95-4a8f-8ff1-bb049688ece7
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TRANSACTIONDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31d73d2f-018a-4705-b81b-d1141a7570b2
                stepCounter: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32192f0a-1f84-4fdd-9554-409204eabb46
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCCOMPONENTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d14f312-b4e7-4fbd-aeda-ccaf54b85446
                stepCounter: 825cc793-244a-403d-a521-14173d0fe5fc
            transform: IFNULL(UCComponent.UCComponentKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f48dd87a-5c7c-4d39-9935-3d183baf3c53
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31bb03d0-1cd7-4c89-af63-0c5a552200cc
                stepCounter: 825cc793-244a-403d-a521-14173d0fe5fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a74f17f-8cc2-48c3-a42b-2fd63cdf4ccc
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPCONTRACTNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44c801d4-eeea-4772-acb9-668984aa4ce1
                stepCounter: 825cc793-244a-403d-a521-14173d0fe5fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2d59fe9-bc4d-46cd-a3e6-967e489bec89
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERMATCHTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f859280-ff6c-4dc2-b424-72ff2090749c
                stepCounter: 825cc793-244a-403d-a521-14173d0fe5fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d657517-43d1-4ac1-9518-e25e7745a3bd
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCCOMPONENTMATCHINGOMNIASUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a3892af-cf1a-44e6-8510-cb8a053d8ab4
                stepCounter: 825cc793-244a-403d-a521-14173d0fe5fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d462a9f3-0b4e-4c2f-b0a9-7e736beeb5a4
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7afb0529-4c55-4f7f-a842-83e16b0b68c9
                stepCounter: 825cc793-244a-403d-a521-14173d0fe5fc
            transform: IFNULL(UCComponent.OPContractMappingStatusId,4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f603fbee-6ffb-4f7d-ad3e-4ffab8e24319
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e648bd1-f111-44f0-93ad-1703404f44b2
          stepCounter: b2c2c86e-3d03-48ed-91be-4ecbd9e09b51
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEUCSPENDREPORTINGLINEITEMS: 88a64e7f-a1d7-4c10-9011-5e79839d98cd
          UCCOMPONENT: 825cc793-244a-403d-a521-14173d0fe5fc
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: UCCOMPONENT
          - locationName: STAGE
            nodeName: STAGEUCSPENDREPORTINGLINEITEMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEUCSPENDREPORTINGLINEITEMS') }} StageUCSpendReportingLineItems
              LEFT JOIN {{ ref('DIM','UCCOMPONENT') }} UCComponent
                ON StageUCSpendReportingLineItems.Campus = UCComponent.UCComponentCampus
               AND StageUCSpendReportingLineItems.Category_Level_4 = UCComponent.UCComponentLevel4Category
               AND StageUCSpendReportingLineItems.Supplier = UCComponent.UCComponentUCSupplierName
        name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
        noLinkRefs: []
  name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
