fileVersion: 1
id: 361c3388-37a0-420f-9ce6-1513d0549bae
name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87bcfe91-2419-4c37-94cb-3e677e5bbd8e
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SPENDREPORTINGLINEITEMSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a00cac6d-6e06-481b-8387-dc0fdb993a62
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c22bd3f-b160-46ae-b1e5-50cfc2f02598
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76a1c39d-6651-42c7-ad4b-9a6598ee37c8
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3cdb4a9-e62e-4480-8e10-8c84d7e4cc39
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d44bfaf-ac1c-4661-b7a1-7cb97fa03ec1
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1da34b79-8603-4a5a-bba8-b9fb15f8269f
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 342294b9-c1fd-48d3-b327-0ec1d089b31b
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449b0478-9ef4-4e75-b5c8-527c7ca80225
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39be0442-3524-4e22-9b05-4194b646e574
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d0bb742-a46a-40bb-a498-ba238ad1e5ed
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c56d19ee-a2e1-46ec-9f5f-ec3f13c25dab
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e77539c9-e5c8-41a7-9663-285d7e4ad3b1
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bcbff9d-7bfc-4ac8-a6e0-6e84b0e34641
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16806615-897e-43d8-8c00-9ea84db69166
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6178c2d3-c39e-45c7-9ca3-160b2dcc44e9
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9c47d77-53d0-489d-9baa-835a78e77b17
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ace611e2-2ad5-4613-b6b6-e6265c8cb8df
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a25cff14-76fe-48db-bce3-97ae7a82f38e
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OBJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 768c7c86-5ff3-469b-a184-bbe48247a4b1
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40afaf60-c285-4b9c-9cf9-8b9691a0e785
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PO_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4644a02e-b191-4c51-9e2d-12919edd6a97
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a289f05a-3b52-40c1-889d-49df07a2b608
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PAYMENT_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57dff4be-5f51-4946-b3ea-672ca9da8788
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82e36ef4-e1a1-4ee2-a51b-61b46fcc9e0c
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCCARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 694d7137-4362-4821-8c7f-721345b0331c
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c284ed43-7147-4044-b7f4-998f5f2b208a
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c8ff934-3cab-467d-8888-470974e3527c
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38e28e3d-9f60-4d8b-b64e-f066bdd2cace
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCPO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f5b1dd6-eb77-446c-b8ad-3ff71e3432a3
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a2378f-b6c6-461b-9191-dde7ed2df189
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UNITPRICEINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bb0e704-5da0-4c82-a93e-f779705e7311
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04b3316f-9bf5-4a7a-8ccc-f5d06daf863c
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CAMPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8b8a6c6-bff5-4cf9-bc42-f29ffd1cc8df
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4962b0a-23e9-4de7-9393-3faa80591657
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dedd8ab2-902f-484e-be28-bdab7e83199a
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a50cb63-efa2-4a4b-9b4b-521a2c0b56bd
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05d869e1-7143-4dab-b3cf-7269015639e3
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76eadc2d-21db-4c6b-982e-ce9d46e3fe03
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6e5abc9-a304-4e19-ac42-630e7a49deee
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24cba1ab-b4a6-4408-b9ac-663c218890f7
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29b32e7a-6e6f-4c0b-9ee2-30f307bc5dec
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03453932-8e06-47f7-a528-73a5003ffb31
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48493d9b-30fb-465b-b8ba-506288186c28
                stepCounter: e06be9f2-1b49-45c9-a5fb-66aff53cca02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0202a783-d50a-4fa9-b101-ed0ac3c125b8
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e91fba47-6dfc-43e1-b609-a5023c9f0d8f
                stepCounter: 8a52a8bb-d8b8-4827-ade6-2c3207842218
            transform: IFNULL(UCCOMPONENT.UCCOMPONENTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6479a10-bde5-429a-b463-451da933eb80
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66ea3dd8-7356-4982-97b5-ac918c1ecc80
                stepCounter: 8a52a8bb-d8b8-4827-ade6-2c3207842218
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bbbc74c-f3e0-4153-b0a6-060be391b7f6
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4ba1436-7011-4d9c-889d-863157467cc1
                stepCounter: 8a52a8bb-d8b8-4827-ade6-2c3207842218
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a482631-310e-4927-9966-d7c9e6d00c82
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERMATCHTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8587933-7c56-4553-86e0-cc7a8f1afa41
                stepCounter: 8a52a8bb-d8b8-4827-ade6-2c3207842218
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7a1444c-24de-4810-8aae-40e2aa1d4119
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTMATCHINGOMNIASUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a502cb0-6a93-49d2-8bd3-e9ed6f43e808
                stepCounter: 8a52a8bb-d8b8-4827-ade6-2c3207842218
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c39a60d9-a9fb-4107-b7aa-dc7f2005cd5d
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db388e07-b0c4-418c-8383-7b850dedd41a
                stepCounter: 8a52a8bb-d8b8-4827-ade6-2c3207842218
            transform: IFNULL(UCCOMPONENT.OPCONTRACTMAPPINGSTATUSID,4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f00608df-1998-441c-ada0-7e32fa9ab6d5
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4676a8f0-e69d-4f62-8a07-f32968b26296
          stepCounter: 361c3388-37a0-420f-9ce6-1513d0549bae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEUCSPENDREPORTINGLINEITEMS: e06be9f2-1b49-45c9-a5fb-66aff53cca02
          UCCOMPONENT: 8a52a8bb-d8b8-4827-ade6-2c3207842218
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: UCCOMPONENT
          - locationName: STAGE
            nodeName: STAGEUCSPENDREPORTINGLINEITEMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEUCSPENDREPORTINGLINEITEMS') }} STAGEUCSPENDREPORTINGLINEITEMS
              LEFT JOIN {{ ref('DIM','UCCOMPONENT') }} UCCOMPONENT
                ON STAGEUCSPENDREPORTINGLINEITEMS.CAMPUS = UCCOMPONENT.UCCOMPONENTCAMPUS
               AND STAGEUCSPENDREPORTINGLINEITEMS.CATEGORY_LEVEL_4 = UCCOMPONENT.UCCOMPONENTLEVEL4CATEGORY
               AND STAGEUCSPENDREPORTINGLINEITEMS.SUPPLIER = UCCOMPONENT.UCCOMPONENTUCSUPPLIERNAME
        name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
        noLinkRefs: []
  name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
