fileVersion: 1
id: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f799fffc-2457-47bd-b873-1f4b08c2f882
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SPENDREPORTINGLINEITEMSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d82ca88-942c-4ac3-8815-a7e55ced0feb
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc1766a0-c890-4a50-b6ee-dbf834cbf298
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8312212d-7e91-4c53-b409-2fec2955af24
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab0949f3-0009-42b8-ba32-e44e86e5fc1b
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d44bb57-7458-4a7c-b51b-5fbcddc7c9a4
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03f922bd-5611-4b6c-80a9-850a4a427773
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f534c86f-c53b-4870-8fca-fabf07618951
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 667092b5-6930-4969-b292-9801b0075fcc
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2554f85-89dd-4ae5-b8d5-ff9455f29d87
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96738394-f0e6-4223-a3f5-32c480969bb0
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cac4b21-5ca9-472e-a748-dc5725b57be4
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b96657c-ca0a-4af0-bdf6-0d6da76c7618
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f2de454-2457-4217-8a9b-33bd28d1f166
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d004db5-2908-46aa-a92b-2297b08942d6
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 484d6f07-9a31-42eb-8aa0-24c53b95e1e7
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49126bcb-fdf5-4879-b2c0-031b937639b5
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8623007d-7043-4df0-beb1-3c613a854205
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61c6c504-f283-4d6d-92de-d124aa32971a
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OBJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19fe268e-7374-4624-90c2-e6a771e1695f
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b25abd3-f913-42ba-9fbf-84caba69dfec
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PO_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14287ba9-fb55-4484-8fab-5802ffdfa5a3
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce3a904d-72d3-40b3-8a68-8f423694573b
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PAYMENT_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c938289-8ba5-4b4c-8e87-17d7a6e80016
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34ed4948-4a92-4bcf-8b47-02fa34436683
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCCARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8bd23e3-081b-427f-90b8-d2ad5c7e4325
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6631527-0840-48ad-af21-b0bdba62f4c4
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3d903c0-765b-44db-bc14-bced271e468a
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7370609-c662-481f-b192-f522aef8a4b1
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCPO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e957bca7-17ab-467e-b335-72838d281d3d
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09c8575d-2e40-4f9e-86d4-03bf569d90ee
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UNITPRICEINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d610f7a-47b3-436b-977d-c2015c0070c9
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1b20ef2-e7bd-4141-8b1f-69eaaa3f4736
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CAMPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38bcfeaa-ada1-4c79-935c-b33d2bd473cb
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 897c8f1f-9959-4ab0-9426-a48ca5e99545
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4684449-f0fa-4ea7-a8c6-2a6c26289a7c
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfa1ae7c-4e46-4b65-ae2b-838a6e93b0e2
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d3df327-b99a-4608-81cb-6d67428bea1e
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f775412-889b-41d2-9274-d091f5aaf99d
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b00d3ecd-a0c4-445e-a8f2-e74a9b2979d3
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15928b4c-9bf2-421f-bb5e-24ece446b166
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daa24bca-fcc5-4406-9f65-2b5d2d6a721f
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d6e94ef-228d-483b-9898-76881464ee94
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c691e84-c661-4e7d-8321-6bb81bba2979
                stepCounter: 29b18a27-4b86-4f20-b124-5e75d34b06d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea569dc-e9db-4e24-ae7a-5360d63a62b3
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9798e8a7-7c2a-4ce6-a9d7-019ce66b809b
                stepCounter: 53d0d1d4-9ec8-48b1-a9c9-e4e82122e089
            transform: IFNULL(UCCOMPONENT.UCCOMPONENTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92241497-d3d3-4e6f-a62c-cd2b25c9d83c
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7446d4f1-8adb-4853-b322-a767a40dfcfa
                stepCounter: 53d0d1d4-9ec8-48b1-a9c9-e4e82122e089
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5169154e-c53f-4baf-b807-1214f27f6c87
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93bae62f-a58a-4d09-87df-45b641533e30
                stepCounter: 53d0d1d4-9ec8-48b1-a9c9-e4e82122e089
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21f51506-9d83-48cb-942e-7ee25e4a8bbd
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERMATCHTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba04a800-88e9-4619-a270-af8dcd1afa7c
                stepCounter: 53d0d1d4-9ec8-48b1-a9c9-e4e82122e089
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 241c1a25-85d7-4963-80b0-c9551ec95ef9
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTMATCHINGOMNIASUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f97e3ac-b512-4227-ba47-55ffc2b1857a
                stepCounter: 53d0d1d4-9ec8-48b1-a9c9-e4e82122e089
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42bce825-cbb2-40e9-ae70-6c011f3cd5a3
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46898193-f567-4b16-9860-e71f368290d3
                stepCounter: 53d0d1d4-9ec8-48b1-a9c9-e4e82122e089
            transform: IFNULL(UCCOMPONENT.OPCONTRACTMAPPINGSTATUSID,4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a87a2ef9-226e-491f-91c7-9dce490c1348
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e63b973-2d7f-4081-b9c8-62b024f7f7d2
          stepCounter: 3e71d71c-793c-44d2-8faa-15b3f268f8c5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEUCSPENDREPORTINGLINEITEMS: 29b18a27-4b86-4f20-b124-5e75d34b06d8
          UCCOMPONENT: 53d0d1d4-9ec8-48b1-a9c9-e4e82122e089
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: UCCOMPONENT
          - locationName: STAGE
            nodeName: STAGEUCSPENDREPORTINGLINEITEMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEUCSPENDREPORTINGLINEITEMS') }} STAGEUCSPENDREPORTINGLINEITEMS
              LEFT JOIN {{ ref('DIM','UCCOMPONENT') }} UCCOMPONENT
                ON STAGEUCSPENDREPORTINGLINEITEMS.CAMPUS = UCCOMPONENT.UCCOMPONENTCAMPUS
               AND STAGEUCSPENDREPORTINGLINEITEMS.CATEGORY_LEVEL_4 = UCCOMPONENT.UCCOMPONENTLEVEL4CATEGORY
               AND STAGEUCSPENDREPORTINGLINEITEMS.SUPPLIER = UCCOMPONENT.UCCOMPONENTUCSUPPLIERNAME
        name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
        noLinkRefs: []
  name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
