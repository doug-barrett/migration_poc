fileVersion: 1
id: 36cf5555-b43d-45fa-a452-8b92590b7cdd
name: OPC_ACCOUNT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: OMNIACONNECT.OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b51c7309-985e-4d41-8f5c-c6f313af6bc4
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be6c1b9b-064c-4f8c-835c-1298595196f6
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d435bd0a-2ba8-4bb8-8b52-552194c80662
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5618162-63a1-4114-905f-185fd2a82e5e
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dcdc149-395b-495b-a947-babe5c44c5a2
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87ff2608-de11-43ce-b5bf-cf03c385df9d
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc26ca61-a0e8-47c0-bcdd-b214ad2837fd
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff282386-85c3-443c-b75f-e7d3cdc5b237
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d6bed20-1b1f-4a7a-83b8-b8d4e4c5dc1f
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60a3e9e9-71ad-4580-975f-f8094931f6d9
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: COALESCE(INITCAP(ACCOUNT.USPSADDRESS),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8dfefaca-2a0f-4f23-a9bd-5acd2a0a34d7
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 924011bd-3c5f-4397-83ce-d66f11f04348
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f27aaaf-4eee-46db-a4d4-e9dd0bc44092
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3508bef0-fcea-4e44-981a-2b7f9f2f595f
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: COALESCE(ACCOUNT.USPSCITY,ACCOUNT.CITY,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff11b315-61fb-469c-bfed-ce1ebae0ec5d
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce04abe9-2cd3-4078-8f1b-67a4f819ff76
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21b8d3b4-bb71-4436-a467-00ab185d9231
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90b9ecaa-d86a-4395-90dc-c7e7f84c0856
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: COALESCE(ACCOUNT.USPSSTATE,ACCOUNT.STATE,'') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b444d0-2e38-4f7e-8fcd-b99c1314191e
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 190d1291-baf8-4463-81cc-53c904bfbc32
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: COALESCE(ACCOUNT.USPSZIPCODE,ACCOUNT.ZIPCODE,'0') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da0b98c9-5b8c-442d-958a-98c9e36b543f
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0872b7a6-8fe3-4d7e-8daa-17e9968b70a3
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5a6c24a-8783-48b4-bfd8-57d2bf1cc0ce
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03869272-1b10-4f34-b4ea-cea0961a2825
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: COALESCE(ACCOUNT.STRATEGICACCOUNTREASON,ACCOUNT.MEMBERSEGMENT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4870c870-6bff-4774-a984-04619798e603
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b628bdab-a97a-4d9a-bc4c-d7a7dc86818a
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be970beb-9197-4ffe-b8ae-170c0c1ba852
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e25f4b7-67eb-47d0-8ebf-dc00f0358dd8
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43d38b3e-2a14-42b1-ad3f-c6051df9b30e
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE_BAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3e6a5c4-b665-4f0d-a76d-91e90c4b9174
                stepCounter: 8bf30b51-5725-4671-9d72-5d3df107c6b2
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e67de50-c9f3-47d0-b624-82bc6d95b3af
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8954303b-fb64-4915-a41b-c992725a853f
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff1486c1-7e5a-48a4-8c25-15626d9585b0
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b8d29ea-12bf-4508-b805-3fcb742e84b3
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c880c11-a247-4db2-8cea-03706f8a87b6
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae9c318-63c2-4058-8e74-f5509f5b4522
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28761795-db39-430d-bd7e-0650e273d119
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87c5987-c3e8-4812-9a77-1c48580efc5f
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a11aefa7-382c-4c99-83d8-40f4ffbac37b
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SECTORKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa7bbc5-3fc8-45ab-8098-32704d9516fc
                stepCounter: 8c570149-b7fe-4278-931c-6a2e904ce078
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee958a66-3c9c-40f9-8528-9087c669b061
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE IDENTIFIER FOR WHICH SECTOR AN ACCOUNT BELONGS TO. 1 = PUBLIC SECTOR, 2 = PRIVATE SECTOR
        name: SECTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e420c8a1-9498-4d0d-a587-2594a3392373
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: |-
              CASE \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC' THEN 1 \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PRIVATE' THEN 2 \NELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c7c87e5-2dc9-467e-9b26-59ddb4f6d51e
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 1 MATCHED WITH USPS.
        name: USPSADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60a3e9e9-71ad-4580-975f-f8094931f6d9
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7174f974-b705-4839-b493-d29a5ee90477
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 2 MATCHED WITH USPS.
        name: USPSADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 924011bd-3c5f-4397-83ce-d66f11f04348
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df9f4c82-bbe6-49cc-a5a5-a8daf652dc92
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS CITY MATCHED WITH USPS.
        name: USPSCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3508bef0-fcea-4e44-981a-2b7f9f2f595f
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3221db8-2ca6-4193-b3b4-a3ceb1f1755f
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS STATE MATCHED WITH USPS.
        name: USPSSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90b9ecaa-d86a-4395-90dc-c7e7f84c0856
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d48ecf7e-2083-4aaf-8ebf-754a8a1b72b6
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS POSTALCODE MATCHED WITH USPS.
        name: USPSZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 190d1291-baf8-4463-81cc-53c904bfbc32
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24e8152f-4686-49aa-b8eb-dbb74168d9bc
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS COUNTY MATCHED WITH USPS.
        name: USPSCOUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce04abe9-2cd3-4078-8f1b-67a4f819ff76
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ede8832-73ca-4de8-a325-871dbf2f6bbf
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4606857a-e808-42bb-a462-0d1e320a2a47
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff5ef3bf-6c38-48b9-8b0b-488577bfc32a
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNTCLASSIFICATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff282386-85c3-443c-b75f-e7d3cdc5b237
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d7fa93a-de7d-4e09-877d-9cf8c2542654
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MEMBERSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d004f7b2-f150-47e4-9d93-0c1bce5844d3
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00d6bbb2-0866-4de1-b27d-91325a3cd6d5
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: DENOTES WHETHER THE ROW IS AN ACCOUNT, CHILD ACCOUNT, DUPLICATE, OR DELIVERY LOCATION.
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 398cea79-aff6-4a67-b9b8-9191a8912fef
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1ae58df-4b9c-45b3-8e91-355166a0492f
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTLINEOFBUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e420c8a1-9498-4d0d-a587-2594a3392373
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78b35ef9-d4e2-4504-929e-4bd43aaf3e04
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afc2c481-a4d0-45b2-91da-2f2d23f154f0
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9743677-54cd-47fb-b88a-2f2956a30e09
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: STRATEGICACCOUNTREASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03869272-1b10-4f34-b4ea-cea0961a2825
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0ae0026-9dc9-42f7-ab58-fba06c618a14
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE OMNIA PARTNERS ORGANIZATIONAL BUSINESS UNIT, OR DIVISION, THE ACCOUNT BELONGS TO
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a56df68f-9b1b-4351-be8a-dfa53f3aac3f
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c92d0bdb-508f-4577-8303-3eab98e615c4
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad940023-e461-4fea-8126-9a89a2fbcef8
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 745c47ca-9fe5-4f77-9520-446af4c05473
          stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5bb5a86-f819-4b97-bd2c-798c4fffbef7
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: d5234d5a-eb19-45e2-9c42-47221579f347
          SECTOR: 8c570149-b7fe-4278-931c-6a2e904ce078
          LOADOPC_CUSTOMER_SIZE_BAND: 8bf30b51-5725-4671-9d72-5d3df107c6b2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: SECTOR
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
        join:
          joinCondition: |-
            FROM {{ ref('DIM','ACCOUNT') }} ACCOUNT
              LEFT JOIN {{ ref('DIM','SECTOR') }} SECTOR
                ON ACCOUNT.ACCOUNTLINEOFBUSINESS = SECTOR.SECTORNAME
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LOADOPC_CUSTOMER_SIZE_BAND
                ON ACCOUNT.CUSTOMER_SIZE_CODE = LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
               AND ACCOUNT.ACCOUNTCLASSIFICATIONNAME =LOADOPC_CUSTOMER_SIZE_BAND.ACCOUNTCLASSIFICATIONNAME
             WHERE ACCOUNT.ACCOUNTCLASSIFICATIONNAME NOT IN ('SUPPLIER DEEMED ELIGIBLE', 'UNCLASSIFIED')
               AND ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC'
               AND ACCOUNT.ORGANIZATIONID <>14
        name: OPC_ACCOUNT
        noLinkRefs: []
  name: OPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
