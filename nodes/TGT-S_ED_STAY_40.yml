fileVersion: 1
id: 6e53d33b-f72a-46b0-85eb-c895bd24da69
name: S_ED_STAY_40
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Calculates the running totals (by location, clinician and specialty) for each encounter. "
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbfb9466-e50f-415e-8ca8-a785709a808a
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9d2c2f2-433e-4fb6-b338-dba23999170e
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb3e52f3-41e8-48dc-b999-1a78c859b944
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: first character of the attendance_encounter_type_code (A, H, etc...)
        name: ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE LEFT(s_ed_stay_30.encounter,1)
                          WHEN 'C'                       THEN 'CDS'
                          WHEN 'V'                       THEN 'VIP'
                          WHEN 'N'                       THEN 'NA'
                          WHEN 'X'                       THEN 'XW'
                          ELSE LEFT(s_ed_stay_30.encounter,1)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d237967a-c07f-4f90-9450-5bffee55b5ac
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance ref no.
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4fad752-1852-49d6-b044-80a53e733657
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d29d4ce5-422e-40ae-b361-73a10402f28c
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Event number for the encounter in chronological order
        name: ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c01aad0-efda-43f2-a6b9-3c8e3d701c0e
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e68c3d18-4ff6-4888-b0f4-a859998ecc5b
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Event number for the encounter in descending chronological order
        name: ROW_NUM_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2717ae2c-28f6-42ce-8f9a-f3af28588d97
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02e8ad7e-5c60-4e80-9a35-f599b1f8538c
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number of events for the encounter
        name: ROW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec29ba05-4e6f-4675-a9bf-eea18dea299d
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 712fcf63-ef24-490f-a3c7-64f7d39b9748
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS ward stay ref no
        name: AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6578fd3-56e0-4b15-aa39-e88944f844b3
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 625e4c14-dc17-49a7-ae57-0b12324253b6
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da60fbaa-99a9-4d8a-9ac9-58c8176adaa7
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a06a29e-7103-4941-9cfd-40aabdafaaa9
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Location stay start date and time
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acad4283-1cfd-49dc-9c89-a4b74d8b3866
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58e42b68-94b7-4b59-a2d5-892baa6ffe7b
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Location stay end date and time
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50b22db6-c72f-49c3-8eae-1d787b78f9d1
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 850827d6-6b6d-4b9c-a315-3e4ba3dd526d
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Code indicating reason why new stay record started; A=arrival, S=specialty change, P=prof carer change, T=transfer
        name: STAY_START_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9f5990b-171a-4bf6-bb6e-60c1a5e53ce7
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfa5e6be-9dde-4e6a-a2a2-d17234909867
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Code indicating reason why stay record ended; D=discharge, S=specialty change, P=prof carer change, T=transfer
        name: STAY_END_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c219d06-09ea-445f-9ae7-d770e73df737
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6b5fa7f-cd78-41ac-b54a-c2f458bff17a
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Location of ward stay.
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 939691da-8d1c-4dd9-82e2-865e66e1c10b
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc721afb-7295-49a6-80d5-d2f3f877688d
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa3ab217-97e1-4650-8eac-8c32ab8f458a
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c1c3316-680a-4cb0-90d3-8e75965cab55
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Clinician associated with the stay
        name: CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747bc376-dbf6-44af-a6f3-4eef05b5c801
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 042df74b-0f87-47b1-aff9-658bf93fbb84
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: healthcare_professional_reference_no
        name: HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 199b1b3a-b91c-410b-bcc7-1d8ea8b2ab34
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 655f6704-08de-4088-a693-da30564dd3a2
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay specialty.
        name: SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87c94a46-a9a8-4165-9efc-98688b04019f
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46cfe18b-0a71-4324-85cb-c5831621e603
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS specialty ref no
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61e9e182-e33a-4278-a41a-40afd3fd8f67
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea1d911-8a0f-41ae-8230-e197e47c5d9a
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient arrived
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99397cef-6b9c-459d-92ed-182c555daf8c
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72b89aed-da76-4fb1-b8bb-d1e2431dfbd4
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time seen by professional carer
        name: SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5e3b998-1c58-42d7-b512-0e5bd20a33ec
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3ff6175-b4e4-40b8-b691-8b868bf25d21
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient transferred to a new specialty
        name: SPECT_XFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed7d560b-b12c-41e4-aa53-5551e561742c
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6677be08-23ee-49b1-94c9-7dddbef87479
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient departed
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6758097f-a092-413d-8959-0a3f894a61e4
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c21872de-ecf1-4d7f-a879-64a651899e27
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: ""
        name: PREV_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfb31a26-7b0c-4b8a-bb85-727a85080fae
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d050e7e-1784-481b-907b-c9ee11631b85
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 455a5ec9-afaa-464c-840b-00818ad7c856
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a195b0f-d141-454b-9b58-cace6b75e4d1
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d11e8574-bc7d-4aa3-a0e7-4fbcfe4d5d97
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07a8085f-7cb9-4a1b-ab97-e3c11a1ab22b
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_SPECT_XFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32e79ca2-5325-491d-9187-a80d79b09c9a
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4093dfe-b9a5-42f1-8c3f-7152d932a16e
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c63e574-f894-4951-bb8d-834483e56b8c
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0a21d5a-c1ee-4f85-b318-e372689a305a
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ee33b8f-1233-4796-ae13-1f3d35d7ed8a
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ca815d5-0f88-4c49-b9a7-b84fe9bf0d21
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05abc510-d1a7-46e7-8d3b-baca77185895
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f427f57e-3f9f-473a-9bb9-a586adab8164
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 033d3754-da26-4119-af0c-a733c9710470
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e7205c2-ce38-42ca-9363-1acc2eb65660
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 279022f4-d685-4a1f-8d1d-3786b41d2c22
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d844f917-b09a-46a8-863f-c47aa3852a2d
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fd5d04b-7ea9-4d0c-9a59-e6c9528627dc
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38f61996-8a99-4f7b-9786-4635353fbda7
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 214946a6-37bb-41f9-98a4-c13c4d9259b2
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5f08dc8-8756-4b94-832e-db77e37e5c78
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb1f7721-cf74-43a9-ba28-d05a401685b7
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 093e17c7-edb2-419a-8a40-2017312794cc
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dd8d5ef-1e42-47f8-8163-3381fdaf5610
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9e77f28-5f7b-4a05-bcc3-0123ddd01469
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_SPECT_XFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff47744-c81d-4c0b-b178-f4c1998b8b5d
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05a73f0c-1efa-4e09-9cf8-9dfeddbd185c
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9863cd7-8f63-4add-ae00-7a94974114e6
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c1c7adc-8882-4966-87ef-fb122f583063
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab288e2a-cd2d-4136-be03-deefadb1ab11
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3d20ca7-d71c-40fa-86bb-0f53c8340b90
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82771d42-215a-4a78-abc2-3e63d4999fd7
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 825187ce-3a3b-4004-aff2-613c18cf7519
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eab0af2b-cf49-456c-bf01-85741fd02946
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5db11d80-a71e-4679-8e1a-3bc0d8b17802
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b52674f8-76fd-4722-82d6-a75bf235d2ee
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db6cdfb9-0cd6-4779-bd25-8947a66d7112
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 099b0426-772e-41a4-95bc-88eae51afb80
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edcb9061-a611-42a6-affd-4dbb66473b23
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration between the stay start and end dates
        name: STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a902e3d-7605-4a00-a6c2-9ba677f04b25
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c17daf7a-9eba-4ba0-9d07-a4390b92e695
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: min_seen_date_wb
        name: MIN_SEEN_DATE_WB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4022aaf3-5154-4173-a77d-3ae2dbc809bb
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 334b688a-5b04-44c9-8ba1-5f695613e7fb
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: min_attendance_stay_seq_num
        name: MIN_ATTENDANCE_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13dc3275-07f0-4368-b94b-49273df37b37
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59ea6d17-4acd-4af5-908c-2b59a905cb19
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: previous_to_current_stay_duration
        name: PREVIOUS_TO_CURRENT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10019b4b-5f85-479c-a592-64326011be55
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2354d55-ce44-4125-ba6a-61d03943f87a
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: current_to_next_stay_duration
        name: CURRENT_TO_NEXT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8220012f-d57d-4145-814f-7ced54087272
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b59a35-cc65-4293-baef-4cdbb18821aa
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between change in location.
        name: LOCATION_CHANGE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              (
                      SELECT IFNULL(SUM(s1.stay_duration),0)
                        FROM s_ed_stay_30 s1
                       WHERE s1.encounter = s_ed_stay_30.encounter
                         AND s1.service_point_reference_no = s_ed_stay_30.service_point_reference_no
                         AND s1.row_num <= s_ed_stay_30.row_num
                         AND s1.row_num > IFNULL((SELECT MAX(s2.row_num) FROM s_ed_stay_30 s2 WHERE s2.encounter = s_ed_stay_30.encounter AND s2.service_point_reference_no <> s_ed_stay_30.service_point_reference_no AND s2.row_num <= s_ed_stay_30.row_num), 0)
                     )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e8ac955-6feb-462a-90d9-0626883a6672
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between change in clinicians
        name: CLINICIAN_CHANGE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              (
                      SELECT IFNULL(SUM(s1.stay_duration),0)
                        FROM s_ed_stay_30 s1
                       WHERE s1.encounter = s_ed_stay_30.encounter
                         AND s1.healthcare_professional_reference_no = s_ed_stay_30.healthcare_professional_reference_no
                         AND s1.row_num <= s_ed_stay_30.row_num
                         AND s1.row_num > IFNULL((SELECT MAX(s2.row_num) FROM s_ed_stay_30 s2 WHERE s2.encounter = s_ed_stay_30.encounter AND s2.healthcare_professional_reference_no <> s_ed_stay_30.healthcare_professional_reference_no AND s2.row_num <= s_ed_stay_30.row_num), 0)
                     )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c2fb7c2-7e0e-44ea-9e10-cd603fe41e79
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration, N if not
        name: ADU_STAY_OVER_10_MIN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99ae0f89-0d8b-4294-b09f-37725ad30cde
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: |-
              CASE WHEN adu_stay_over_10_min_flag ='Y' THEN row_number() OVER (PARTITION BY aeatt_refno,adu_stay_over_10_min_flag ORDER BY aesty_refno)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e5484c9-d2bd-4b28-a679-1da29c0a62e5
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration, N if not
        name: ED_STAY_OVER_10_MIN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a69331c2-de89-4e6e-9841-757477c7a746
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e55398d-a5b3-44ca-b1ab-c6f5e222afdd
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration, N if not
        name: ED_STAY_OVER_10_MIN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a69331c2-de89-4e6e-9841-757477c7a746
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: |-
              CASE WHEN ed_stay_over_10_min_flag ='Y' THEN row_number() OVER (PARTITION BY aeatt_refno,ed_stay_over_10_min_flag ORDER BY aesty_refno)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2c3e259-f8d9-4904-8c4c-af9a2ad2c868
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration in ADU, N if not
        name: ADU_STAY_OVER_10_MIN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99ae0f89-0d8b-4294-b09f-37725ad30cde
                stepCounter: 519b7b54-37f3-47cb-b8ab-346649c612e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aef5357-8dc6-4e3d-ba8e-99cb708b03a2
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between change in specialty.
        name: SPECIALTY_CHANGE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              (
                      SELECT IFNULL(SUM(s1.stay_duration),0)
                        FROM s_ed_stay_30 s1
                       WHERE s1.encounter = s_ed_stay_30.encounter
                         AND s1.specialty_reference_no = s_ed_stay_30.specialty_reference_no
                         AND s1.row_num <= s_ed_stay_30.row_num
                         AND s1.row_num > IFNULL((SELECT MAX(s2.row_num) FROM s_ed_stay_30 s2 WHERE s2.encounter = s_ed_stay_30.encounter AND s2.specialty_reference_no <> s_ed_stay_30.specialty_reference_no AND s2.row_num <= s_ed_stay_30.row_num), 0)
                     )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4362af98-ef5b-49a5-866b-338c82d203fe
          stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ED_STAY_30
        join:
          joinCondition: FROM s_ed_stay_30
        name: S_ED_STAY_40
        noLinkRefs: []
  name: S_ED_STAY_40
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
