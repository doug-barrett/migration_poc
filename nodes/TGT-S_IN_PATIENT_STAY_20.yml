fileVersion: 1
id: e7aef810-225b-4888-aba4-f03d736ef32f
name: S_IN_PATIENT_STAY_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51e6d3b4-fcc0-41e2-8c85-98e86fc55056
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a141ff8-6c07-4ac7-8343-0e0a64072272
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 825b0b9b-67d7-48b5-a8a3-d3fc81e73737
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a4fa939-fc6a-4031-b0c5-f75958e4d6a3
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3c2014a-f1ca-43d8-b61a-1c050ec25a23
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_20.event_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: IFNULL(dim_encounter_type.dim_encounter_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2030a82b-3cfd-48b3-b8a7-75c9f3c72e62
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 790fc1a5-cfd0-4779-9476-2dc5995c43f6
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ba97ca5-08a5-42c2-8b97-197c714b2688
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Contains the numeric representation of the service point stay reference number related to the current record.
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff4644f-7ff3-4176-9a75-c9cd1d5155ec
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc61780d-eb6f-453d-8173-d61a771fb1d6
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd526170-660a-4278-8b89-2799cf1d8253
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9d1c6b-bffa-4cea-841d-0b0046f759e6
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event_Specialty Code
        name: EVENT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2efbcdc-8b42-4506-b451-06e97b8d12ee
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80106c75-759f-4640-87ff-2f1ef4e4909e
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event_Health_Specialty_Code
        name: EVENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82445afa-28c0-4bcd-aaa1-ecfcf3972b29
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e069d367-856c-4d11-85f6-74fbc986aa15
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_20.event_specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: IFNULL(dim_specialty.dim_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5cea759-b391-42b4-9148-fa68c43ae480
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_clinician_reference_no
        name: EVENT_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a080d348-7262-462d-b3dd-3a2900cd8ae2
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9d6b12c-724e-42fe-acb8-e31ab487d118
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3d43a0a-9f92-4b81-955e-e1aa5227685e
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d302ffc2-b741-49c5-8213-92a42f50c7d4
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay_Clinician_Code
        name: STAY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46aabcf6-679b-4a4e-a496-40a9fd62e24b
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a057c9f2-2a70-432e-b219-04b8feaa9538
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_20.stay_clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911a8788-86e5-4a5c-a00a-a957d59070b8
                stepCounter: e8e4a684-3ef8-4076-846f-48d5689e824f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c56e1ae6-0edd-4c3f-b896-b51c1a8eed18
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_patient_reference_no
        name: EVENT_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6426dede-f127-4ca6-af16-1a952173a2c3
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dc8662f-fdcc-4df0-8e56-ebd11c6707a2
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stay_patient_reference_no
        name: STAY_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4200031b-e952-4278-8cb1-a0970199ec1e
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b783808-dbd1-44c6-8ea4-df0bdfd6f0f1
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATIENT_REFERENCE_NO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac9c6596-286a-4869-99da-bea598b74751
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79c0062d-9b15-4586-9d76-63430be2c28f
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06104c8a-ad68-456b-8970-94455fc50362
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e63783c-df3d-4dad-8c09-9fb73a4af0e2
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_20.stay_patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f00ba04-bf50-4cca-be08-c5db9b3ee1e1
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_ward_reference_no
        name: EVENT_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27718396-1508-4198-87cb-7bb9a86aa18d
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0e5c733-2ce0-421b-8e66-c52aa9553c34
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stay_ward_reference_no
        name: STAY_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f336f5b-01f0-43ee-a885-795c0ab59fe4
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b38f2bf-1b5b-4f3c-bc7a-119dccea31dc
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: stay_ward_code
        name: STAY_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b57ffd7-44dc-4374-a500-3c4ebf465c7f
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76c6fd9d-b768-4f45-9847-8cdf8a0bb2fd
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_20.stay_ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: IFNULL(dim_ward.dim_ward_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ed9168-cd27-4240-abb4-5f9f154d52f7
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stay_current_Leave Reference No
        name: STAY_CURRENT_LEAVE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b00a5f95-efe7-4da9-a899-ef93537f6386
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba9716f9-3323-47d6-a513-f0bc4879e861
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_CURRENT_LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc9c9c5b-5dd4-4eed-9989-864610f17949
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04b20e44-e50f-4e7c-a89c-7ef960523977
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_CURRENT_LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 268468b6-9458-458e-af33-c75645ef76c7
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23f7cbc7-1daa-4f58-b8a2-aa6c61f5338b
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ED_FIRST_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04849c5f-44c4-4bf8-b711-81348b3f9b85
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4ab8d50-da65-4cf9-951f-4a7467c29eed
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0aa178d-06e4-4205-9492-609746c96b77
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: "'A' + CONVERT(varchar,s_in_patient_stay_10.ED_attendance_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 267b2c5d-6ebc-41e0-b841-fe3eca5d3b8a
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ED_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d8a8600-adb6-4f3c-b3df-21890e363e40
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67f3a5c7-cad3-419d-847b-e5ba798078b3
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 729ba026-d8fb-4795-8e1b-e5f79db6585d
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f61adadf-6591-4595-96fe-0843873aed5b
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b526dbe-efe7-43db-9bc9-36bbc12bbf22
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58fd9dc0-6a58-46d2-b51d-584033c26494
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed836bc6-7709-4b02-94e3-f884f0655530
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f64650bd-2eb0-4d1d-80e2-d6fb2cbf49ce
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08ef6c7f-2951-4571-a55c-227c3cda7c2d
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2536b26f-d68f-48c8-8226-eb156912f031
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d6b85ce-79d9-4886-a4f6-f7fb0c2c72da
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4e9f922-61ef-48c9-b40c-10e25802b458
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WARD_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb68d4fb-2951-4da3-9251-1276c8f5aa54
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86225f68-e092-475a-aaa6-3a6cc1674035
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87bb797-4278-46bb-9a33-3d3888a1e992
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb8931c3-11d8-4883-b409-a8cdf038d3a7
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_stay_20.CONVERT(date,stay_start_date)=dim_stay_start_date.stay_start_calendar_date
        name: DIM_STAY_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b442fea-c72d-4a06-ba4d-ed4b58ee5dbb
                stepCounter: f6a5fae2-5a40-4523-824d-c265ca1bc409
            transform: IFNULL(dim_stay_start_date.dim_stay_start_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95d1985c-f013-4764-8409-af7bfcdb81d2
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fed9bff9-76e1-4d14-9309-dce9b7999c68
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d47ea8c0-dd51-4544-9de6-56dd58a11112
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_stay_20.CONVERT(date,stay_end_date)=dim_stay_end_date.stay_end_calendar_date
        name: DIM_STAY_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8c85017-50dd-42e9-aadb-9f1aa7ee54d3
                stepCounter: 2d82251b-b816-4891-b02b-7b0b9160306d
            transform: IFNULL(dim_stay_end_date.dim_stay_end_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e14806c2-3149-42b0-866a-fd525ba30e0d
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referral_encounter_id
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c19198d-7cdd-4dd1-8263-e1c97a643348
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: "'R'+CONVERT(varchar,s_in_patient_stay_10.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13330215-985d-40ef-81ec-e812a0cf2a75
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: VISITORS_ALLOWED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95e21e38-1e30-4bd5-96d9-8a03df78d242
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 589df345-3e7b-4c7b-888f-dbf7d12516fa
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGE_TRANSFER_OUT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b9c25fc-09f3-46a4-a3e1-f128ac730ffb
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: |-
              CASE WHEN [nxt_service_point_reference_no] <> [stay_spont_refno] THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdfddb85-f23e-46c5-b036-899fb1582162
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_TRANSFER_IN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b9c25fc-09f3-46a4-a3e1-f128ac730ffb
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: |-
              CASE WHEN [prv_service_point_reference_no] <> [stay_spont_refno] THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e074dfc1-93d0-40d2-a711-41197060572f
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADMISSION_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b9c25fc-09f3-46a4-a3e1-f128ac730ffb
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: |-
              CASE WHEN s_in_patient_stay_10.event_stay_seq_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf25f9cb-a088-475c-9e09-2f56c1492238
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISCHARGE_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b9c25fc-09f3-46a4-a3e1-f128ac730ffb
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: |-
              CASE WHEN s_in_patient_stay_10.event_stay_seq_num = s_in_patient_stay_10.event_stay_count AND s_in_patient_stay_10.stay_end_date IS NOT NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f65d77c-69a3-40e7-bfbd-7ee20ab950d4
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dc2ef30-8b31-4e4d-a9c1-3a546d03b3ba
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648cd00c-738d-4868-ab8e-ef48c6befce0
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00777b59-7c82-4cbe-8890-295e50f7c251
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0704a73-3b9b-4f20-8ee7-c1d94ba074b6
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8be21d2a-c319-4064-8b17-58d629536d2b
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd5dc904-c0cd-4eb0-ae91-e553a2dd8a4a
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01f7af9c-e7ef-4d71-a96b-3e3fa354fc4e
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3052373-22f9-44fb-be0d-a66aa2af5733
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20a93720-280a-47fd-9d81-abb11d4ee093
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 733ed4ce-d375-485e-b440-5eadcb43fe01
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77afdbd-8379-41d9-bb1b-5f789829f247
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f1e664a-5ed0-466b-86cd-4042a52b6e14
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e94cdc86-e7dc-45c7-a42c-e77369620203
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de94509f-058d-4a40-9a48-994377d0b573
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d151ef0e-f13e-40b6-9702-6f08f134d7ab
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8858c35e-b63d-445f-96b7-5a0e15b8627b
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fa9f97d-a40f-4631-990c-ccf8da90341c
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 610b97bd-94ac-49e9-8c61-4b794d45b6e8
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d20c429-3f65-49db-a8d0-f0a1e7de4ccb
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39ead342-37ec-4a32-953a-45dc26a26ad0
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e77c5aa2-76ad-4647-bca4-8d18c1782341
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b7f513f-6c50-4695-ab58-ef04d967d4b9
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9490d2a1-b66d-4021-ab7a-0d0a1df775e2
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5257eca-4039-412d-86d2-5ddae9e0daa9
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfe7d61b-8e2c-42a2-82b3-5784333f8d32
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad1870ae-768b-4ac3-aacd-f1f008730b25
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fe06842-fa60-4262-9b35-65449b55f32a
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 884646cf-0631-4670-b4a5-d2869e97ad22
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77603557-a493-47f6-87a4-84464070fb02
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8038355-7d58-4736-8724-b908075ce6aa
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c36438bd-b3b3-44b4-a4c5-a748faf5439f
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca176351-e270-43ec-8b01-df04b061b92d
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 580c9fb1-1ec1-4f5b-8cdb-aea1687f5ef5
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbb2280b-e8b2-4461-8eda-a0ce51e3ed69
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed832390-2c07-4d94-9976-6a4ba82f9d19
                stepCounter: 67e69825-d78d-48e9-b9ef-630598392bfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0fb7c94-22d7-4373-9ec4-948c4cec6727
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b9c25fc-09f3-46a4-a3e1-f128ac730ffb
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db0fee40-3ad3-4ff4-8e79-cfba88485fea
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dd82dd7-e7e4-4250-99b4-63720d2149c4
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea3eab25-e307-4b05-a07f-e2bb0970e303
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ddcce77-de46-45a1-88ed-1b5cfd8f75f2
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6148561c-5949-40c8-87f8-fd3f782ca106
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0f148c3-0b57-4e88-930d-d35ea8f13fc7
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_WARD_STAYS_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a33331d-ac36-4fde-85d5-98c42b054de8
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 365c06b5-d4f6-4d8c-9efd-37a416fb5ceb
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_TO_CURRENT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87bb797-4278-46bb-9a33-3d3888a1e992
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: DATEDIFF(mi,s_in_patient_stay_prev_next.prv_stay_end_date,s_in_patient_stay_10.stay_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2162458b-d191-4db5-b408-a33043d8015e
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CURRENT_TO_NEXT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d6b85ce-79d9-4886-a4f6-f7fb0c2c72da
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: DATEDIFF(mi,s_in_patient_stay_10.stay_end_date,s_in_patient_stay_prev_next.nxt_stay_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7dd71e3-e5e4-4ddf-a3ba-e7bf95554635
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5613572-b5df-40c2-b577-8bb481b2f201
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07116ba3-233f-4bb9-8c9b-5fff6b36bcb1
          stepCounter: e7aef810-225b-4888-aba4-f03d736ef32f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_WARD: 50c31151-9204-4154-9caf-5d28244bde1a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_STAY_10
          - locationName: TGT
            nodeName: DIM_WARD
        join:
          joinCondition: |-
            FROM s_in_patient_stay_10
              LEFT OUTER JOIN s_in_patient_stay_prev_next
                ON s_in_patient_stay_10.event_encounter_id = s_in_patient_stay_prev_next.event_encounter_id
               AND s_in_patient_stay_10.stay_reference_no = s_in_patient_stay_prev_next.cur_stay_reference_no
              LEFT OUTER JOIN {{ ref('TGT','DIM_WARD') }}
                ON s_in_patient_stay_10.stay_spont_refno = dim_ward.ward_reference_no
               AND IFNULL(dim_ward.dss_start_date, GETDATE()-10000) <= s_in_patient_stay_10.stay_start_date
               AND IFNULL(dim_ward.dss_end_date, GETDATE()+10000) >= s_in_patient_stay_10.stay_start_date
        name: S_IN_PATIENT_STAY_20
        noLinkRefs: []
  name: S_IN_PATIENT_STAY_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
