fileVersion: 1
id: a520718c-dd33-4b6f-b424-866b8f20076f
name: S_REFERRAL_30_CHANGES_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Compares data in s_referral_30 and fact_referral so that only referrals that have actually changed are saved in s_referral_40."
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e41112e7-3d53-4e96-a7a1-7542a6030530
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abecc889-5337-4651-b864-d54896832dd4
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef0b020e-8b0e-42da-acb0-2ff2ed0a4bc1
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e22d64c-7e19-47ba-adfb-b67da88828c6
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a286e487-c619-4824-9938-28d806e81582
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cf7f920-9eb4-469a-b8bb-f6ffc08042e7
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3878114-1b2b-4e52-b3ea-4b628c30ed29
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 891d1d09-4c05-4de3-a980-16f596831a9e
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64b58b95-3391-4190-a2f9-1af8e0beaae5
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40d706c2-eee8-4996-8b8d-69d90394b555
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d7ea940-00e7-44b7-b8ff-fed3604eef0d
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.patient_age_at_referral_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8463d6fc-393a-42cb-bf79-afb5f271be4c
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e738012-069a-48b4-96d2-926ce115e2b5
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_reason_reference_no=dim_referral_reason.referral_reason_reference_no
        name: DIM_REFERRAL_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d13008e7-d4df-41d3-bf82-6d90531a799c
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23521203-b93f-4b62-be9e-af72518c86bc
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_type_reference_no=dim_referral_type.referral_type_reference_no
        name: DIM_REFERRAL_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d734766d-31d7-4b1d-8874-77dc282a6881
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17885a1c-32ba-46b2-91ee-04a8911366f8
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_status_reference_no=dim_referral_status.referral_status_reference_no
        name: DIM_REFERRAL_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 965b31e5-3a2e-4943-8bc8-3ec3e4d81332
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ea7fe98-0307-4553-a69d-cacbd12dcddb
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_priority_reference_no=dim_referral_priority.referral_priority_reference_no
        name: DIM_REFERRAL_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e318e1b-5cf8-43fe-8e18-fa4f0c41cda1
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88c6ecbb-b576-46c3-b050-a8f0d9f02b5f
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICAL_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b59d29f-d76a-4a1e-98d4-bfc6ba9ab2d2
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbd7b27a-0c72-4992-9413-071350fff25f
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.admin_category_reference_no=dim_referral_admin_category.referral_admin_category_reference_no
        name: DIM_REFERRAL_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12625c8f-65d8-4b2c-a2c7-c3aac6c91518
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9075af27-5530-4403-af47-51b9359313a9
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.CONVERT(date,IFNULL(referral_received_date,referral_sent_date))=dim_referral_start_date.referral_start_calendar_date
        name: DIM_REFERRAL_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a78dd8fc-9b08-4d13-bb97-7dd5d2e720c0
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bce07131-396c-4ddc-bcce-2f4696e21a01
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.CONVERT(date,s_referral_20.referral_sent_date)=dim_referral_sent_date.referral_sent_calendar_date
        name: DIM_REFERRAL_SENT_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec0c56aa-b953-4319-aba2-91d6efe1ff6a
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1070611-abbc-47c7-87be-5626053611e9
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.CONVERT(date,s_referral_20.referral_received_date)=dim_referral_received_date.referral_received_calendar_date
        name: DIM_REFERRAL_RECEIVED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98cd3450-120d-4cbd-828b-ce19fdd99d87
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14549d2e-7447-4f61-a64e-557a84854e36
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_source_reference_no=dim_referral_source.referral_source_reference_no
        name: DIM_REFERRAL_SOURCE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ace51f3a-b385-4b20-a194-c1644d88508d
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9c6a8a1-88fd-4b44-80b4-9e455eeb6f5b
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_authorisation_reason_reference_no=dim_referral_authorisation_reason.referral_authorisation_reason_reference_no
        name: DIM_REFERRAL_AUTHORISATION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 536541ef-ec50-43e2-8b4e-52e52a1b234e
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3e2bac-9b39-4adb-a9e4-afca19b42bbd
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_authorisation_clinician_reference_no=dim_authorising_clinician.authorising_clinician_reference_no
        name: DIM_AUTHORISING_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a96f4bd-076a-4703-8ada-0fd9931c52af
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c85ef01b-23b9-47b5-afaa-c952aad7c63a
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_cancellation_reason_reference_no=dim_referral_cancellation_reason.referral_cancellation_reason_reference_no
        name: DIM_REFERRAL_CANCELLATION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 995b9808-52fe-45f7-8f94-c195a607a24d
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e80976c-f39a-45e8-8019-d8983e57f9f5
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_referral_30.CONVERT(date,referral_completion_date)=dim_completion_date.completion_calendar_date
        name: DIM_COMPLETION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c6b41e5-20b9-49be-b2a3-a639ce5fb000
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b97fd7d-a7d9-4b13-baa4-5ab5d7a206a7
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_completion_reason_reference_no=dim_referral_completion_reason.referral_completion_reason_reference_no
        name: DIM_REFERRAL_COMPLETION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7874f2f-f103-4062-b30a-bbbbfc9d7966
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f2faba5-cdb4-4333-974a-e1df2393611f
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_rejection_reason_reference_no=dim_referral_rejection_reason.referral_rejection_reason_reference_no
        name: DIM_REFERRAL_REJECTION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3435dc2-f324-4f4c-8219-3cbc2089aa0c
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5f45293-ef5d-4632-82b8-533c0f34b406
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_by_health_org_reference_no=dim_referred_by_health_organisation.referred_by_health_org_reference_no
        name: DIM_REFERRED_BY_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b46471c-899f-4ae9-b854-2861a4151b56
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68750f11-afd1-4a2b-9530-50f3bc234e17
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_by_specialty_reference_no=dim_referred_by_specialty.referred_by_specialty_reference_no
        name: DIM_REFERRED_BY_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d04f23e7-239c-42b2-b53d-1c34bdce1a14
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80bfb13c-a8fd-43f3-ba0a-afb88e1f5ccc
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_by_clinician_reference_no=dim_referred_by_clinician.referred_by_clinician_reference_no
        name: DIM_REFERRED_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6328600-6115-4739-b64c-d0791bd717cf
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc3cead1-6e58-424b-8b3a-f7d42d27f0af
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_to_health_org_reference_no=dim_referred_to_health_organisation.referred_to_health_org_reference_no
        name: DIM_REFERRED_TO_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c802925-ab71-4c52-9522-e2173e9032c0
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 074fe9b9-388f-4654-b030-c66f9792d714
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_to_ward_reference_no=dim_referred_to_ward.referred_to_ward_reference_no
        name: DIM_REFERRED_TO_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 466bd0c6-a1c5-4668-bde7-02023c245745
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 410a39de-a740-459b-a8b8-73cb5f93ec17
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_to_specialty_reference_no=dim_referred_to_specialty.referred_to_specialty_reference_no
        name: DIM_REFERRED_TO_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95d4e848-8cdf-4255-bdb3-5cc0a0b3d4c1
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4295295e-9c35-4b36-87c8-1e322c34f048
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_to_clinician_reference_no=dim_referred_to_clinician.referred_to_clinician_reference_no
        name: DIM_REFERRED_TO_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db0f9bd4-8499-416e-a9a8-38667ddb8ac4
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebce2d77-66d9-4786-a0a2-9510625accb1
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referred_to_staff_team_reference_no=dim_staff_team.staff_team_reference_no
        name: DIM_STAFF_TEAM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32badc9b-21b2-4074-82d2-06838ec5240a
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de69d726-5a9e-429a-a618-ea1dd7890ff1
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.principal_diagnosis_procedure_code=dim_principal_diagnosis.principal_diagnosis_code
        name: DIM_PRINCIPAL_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7ebe3c9-b1ec-46bf-adc9-d7602b2b2360
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e5a036c-1ce1-4ea6-a282-2ddd0577c347
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.accident_related_status_reference_no=dim_accident_related_status.accident_related_status_reference_no
        name: DIM_ACCIDENT_RELATED_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a12a39f1-cf26-46fe-8fea-219144f5a373
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f0ae8ea-f6bc-400c-9b38-a76b598c61e5
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.accident_type_reference_no=dim_accident_type.accident_type_reference_no
        name: DIM_ACCIDENT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0bbaa45-b3c2-4929-ba48-05e63ca831eb
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16153a8f-9923-47de-a5b4-6f9ccd5065fc
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_referral_30.referral_reason_reference_no=dim_CADS_caseteam.referral_reason_reference_no
        name: DIM_CADS_CASETEAM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb5e4967-2873-4c19-84d8-be1396883d59
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74dfc2cc-5c4f-4345-8e0c-c1df5ef8bd71
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.ACC_status_reference_no=dim_ACC_status.ACC_status_reference_no
        name: DIM_ACC_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65cdc50b-5db1-41f1-93fe-5373e68b886d
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91ae5794-a4b8-49cc-933b-1fe6fdbf6412
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO_REPORTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d47fa0d6-a0ff-443c-8cbd-0176385dc9c0
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87b1d65a-92c0-406a-83c2-0a9cb1ec44ad
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_VALID_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b932ee19-3f13-40da-bcee-39868ad873cf
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0f9f2cb-e0b0-4200-abe5-bcc1baa0ec79
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d75a586b-f295-46c3-9e69-4c8acde58e79
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d94bd872-40fc-4563-87ab-6d4da904003c
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACC_INDICATORS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d96873c-c229-4f2b-b1fa-08879f402515
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2fae7f7-9fa2-43f4-b370-84a015ef3874
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.ACC_indicators_id=dim_referral_ACC_indicator.ACC_indicators_id
        name: DIM_REFERRAL_ACC_INDICATOR_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75e49c4a-c1c8-4ff3-8f9d-21128c0c4b8f
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e8da15-e498-44e9-ab09-961296069f02
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC45
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98a1acb0-ebfb-466a-ae0a-41c581b85fa8
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a12b9683-41e8-4163-9e98-7c935ba3baf4
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.disability_type_reference_no=dim_disability_type.disability_type_reference_no
        name: DIM_DISABILITY_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2215fa75-f7c0-47df-9294-5da4be5b56dd
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a661dc8-fdc1-4dca-9fc8-d60a3f157357
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_referral_30.court_reference_no=dim_MOJ_court.MOJ_court_reference_no
        name: DIM_MOJ_COURT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 473f4048-b395-4a53-aedd-3528f6820ae2
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0bc700-0871-4be3-b2ef-8d5777dd3638
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.prison_reference_no=dim_prison.prison_reference_no
        name: DIM_PRISON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d08aaee8-bb10-4d85-a951-07f6c5fa55a0
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d81083f1-4318-4bde-8e55-393843ed399c
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.prison_location_reference_no=dim_prison_location.prison_location_reference_no
        name: DIM_PRISON_LOCATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 502b7855-3ea3-4d74-9cf0-5e0b13d054c9
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53430eb9-1f8b-4ef7-96f5-f8f697b7b1bc
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CANCER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c868b366-5db0-4925-95b0-71573a4e6c35
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a363d0-4e4d-4cd6-b536-fca60cf6e87e
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_ACCEPTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c8f0ae-dead-4159-ac68-e8d3f0b44c9d
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb7b1e44-25ef-461f-9849-a4813e24fa07
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_AUTHORISED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44e123ec-c7bd-4ff1-9a94-7e9e599832c4
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ae7bc2-8987-4161-aea5-9218386a5826
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Was the ESPI 1 case processed and the patient notified within the compliance period.  As of 01-July-2016 the ESPI 1 compliance period change from 10 working days to 15 calendar days.
        name: ESPI1_PROCESSED_IN_TIME_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8b1236b-a2e0-4c88-88c1-352a0dbce8d6
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54e1de56-5e36-4fd2-814a-727be82dbf85
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is the case on at referral being assessed within 10 days as per the FSA waitlist criteria.  Note assessment may mean thay are not an FSA but they still need to be evaluated within 10 days  As of 01-July-2016 the ESPI 1 compliance measure change from 10 working days to 15 Calendar days.
        name: ESPI1_ELIGIBLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed103c1-23d1-4301-9b98-ba437de37d0f
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e685e44e-c4fe-4855-bf6e-fb2e82d3f474
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Has the referral been assessed and considered inappropraite for the service?
        name: ESPI1_REJECTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e90e972c-9678-4a2c-8427-5cc29e9b9ae0
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ece4ebb9-5509-43be-a465-2ef7ba2ae4b3
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this an NPF referral being sent ot the MoH.  Currently ESPI 1 referrals plus Surveillance cases
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b50ef1-2110-416a-af26-5c160664e883
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4021fc4-7a15-4ab1-90a0-11c9f5190024
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_REJECTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3f54f62-0334-4fc5-b754-c7888d4589b8
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7c550e1-dea0-4ffc-a5f0-0aa25bb20202
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: If an NPF referral is rejected it might be because the patient has opted not to be treated or the referral was mistakenly created.  These reason mean the referral is handled as an exception.
        name: NPF_EXCEPTION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f31ac487-4a9d-492a-b9a7-f3cb66989404
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff80c243-a38e-418f-b56e-98d0d131d61d
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Referrals with outpatient activity and no waitlists have this flag set to Y
        name: NPF_FOLLOW_UP_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d431f33-c98b-4ae5-94a9-b2e3d328dbb7
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84dc0cdf-da0f-467b-a283-351605d80d2f
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: NPF ESPI 1 is measured on the date that the patient is notified.  The best proxy for this is the waitlist create date.
        name: NPF_ACKNOWLEDGEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99d23768-0752-48f0-9889-4a766b8ea768
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60cd2a77-22d9-463b-86a2-076583e89d22
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: National Patient Flow processing indicator for NPF referrals closed with no activity
        name: NPF_CLOSED_NO_ACTIVITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a4f919f-4bc6-4cf3-a8f4-22aad80fdf62
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29bdfa40-f0e5-4af8-94a9-e18373b0682f
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Referrals no activity that are closed as transfered to another DHB have this flag set to Y
        name: NPF_TRANSFER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 543bf10b-9a5f-4a7c-b738-f3119ff16a9d
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9eec8adc-c309-4f75-b93f-dc4df6c87bd0
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(31)
        defaultValue: ""
        description: Is the referral accepted or rejected within the ESPI 1 time frame
        name: ESPI1_RULE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 625e3b98-74a2-4fd4-8cc9-fe3297ae5946
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8217b143-9fb9-4746-867b-7844dfbd47b6
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI1_WAIT_TIME_DURATION_CALENDAR_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 800e0a50-c76f-46cb-84ee-24d4362c944e
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5e2a361-9e85-44f7-87e3-dc0d05aaea54
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI1_WAIT_TIME_DURATION_WORKING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fad8cc7-e326-47ae-94c1-e2ba0093fbfb
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcdd11a5-4c9e-4246-9bd4-a61ffea23f3d
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The number of days the case took to be graded.  Pre 01-Jul-2016 this is working days, post 01-Jul-2016 it is calendar days.
        name: ESPI1_WAIT_TIME_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be4f5ec7-41a9-4727-a0f0-772bb8a5c628
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b7b2eba-79a3-4c9b-841f-e43c727cd5b6
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INJURY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d47ca756-0be7-481f-846c-47df4ac13ac6
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 778891f5-0736-4cf0-be66-e7c21109488e
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc707b1d-e385-4878-b9f1-d2772f8c0fb3
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40867265-303d-4e39-aabc-30d7af6ffcf6
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f289ccf-2be9-4071-af2d-fbaf62b54965
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ef0303f-c8d1-4666-b4c4-a7950f6460ec
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a5f4398-4837-4742-96e5-bdc155ec4c2c
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca702d19-74c1-4301-8532-3eac948f8a2d
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PARENT_REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2e82cf5-ea61-4cf6-84ae-b50d5d1928c3
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d47c89-dd74-44ed-8c88-83b7c59039ae
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c993a07-0350-42ff-ac1b-28dc2ba9f4c1
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7d10e07-dc5e-4fe4-8393-6ac88ae6ad97
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Clinician notes for the encounter.
        name: DISCHARGE_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c27f03c-b585-48e4-b7b2-462073ea231d
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e1b8a4d-c979-4d21-80ab-ed5449bf02e4
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 653afcb7-e153-4600-b73a-eb97afe5e90c
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a06ceb4b-2761-4e1d-9238-bf9e0fbf448a
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_count
        name: PATIENT_REFERRAL_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8a8af48-35a3-4dfa-9d53-7ff8e9244bc5
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2fee8d1-2d94-44c7-b311-cbc00f8adcdd
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Waitlists associated with this referral
        name: REFERRAL_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce4c14e0-8ec2-44b9-b0a0-b02c1fbc6362
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faa1befa-52b1-484a-8dd2-1766ea58d2f0
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Emergency attendances associated with this referral
        name: REFERRAL_AE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71a5ec58-327f-4432-9cb1-d0e982d66668
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdf59fbb-c17a-40fb-9415-2a5b3cbd698e
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Admissions associated with this referral
        name: REFERRAL_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3994fbad-b5b7-4b7a-9255-660eb5a54fc6
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 072901ea-3e42-4fe7-ac77-2d5f66e20e79
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Appointment (theatre/contacts/outpatients) associated with this referral
        name: REFERRAL_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fa22733-e18a-4dc3-96fb-ed422816d5cb
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce4e0020-84bf-43e3-9cf8-959e7c743d3d
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Suspension wailtists associated with this referral
        name: NPF_SUSPENSION_EXCEPTION_WAITLIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b49d9e11-205d-46e6-ab2a-5b2db651381b
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d761e37a-1e3b-4758-9913-bb5896487d66
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excluded wailtists associated with this referral
        name: NPF_EXCLUDED_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d64896a8-bcb1-4ec7-94b1-4aebad0d7230
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95ba2b86-d15f-47a3-bb1a-b3c417f90955
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 103ae84a-aea9-4474-9afa-bf8665c8280c
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4f0cec8-4387-492c-a5ca-547801c71545
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_seq_num
        name: PATIENT_REFERRAL_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6b0837f-ef72-498c-bc60-62e700485353
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc5167bf-0f51-45b3-ae97-c86f37fcec2d
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88887533-5cc7-4de2-b0be-1c0e61d42171
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a054436-e02d-4758-9dc3-fbff4b0e7c39
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed888b86-e63a-4dec-8fd9-d93329e94dd7
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fb2c815-d855-424d-90c6-29f8ba646953
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2165adea-904b-4e61-b04e-8a6cb95008ba
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcce6726-8a7d-46ce-be9c-105f9fea9d95
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7376f89-f88a-440c-82a6-2f14bd9e73da
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 428c297e-4342-4d62-ac4c-f545b1dec999
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f597671c-e3bb-4644-a521-5ba165042d24
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 365174c1-622b-4547-b096-b05a9a2f8cdd
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_CANCELLATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 097c1fcc-5424-4d8a-866e-b78f2752aa81
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0005472e-7ac8-45f7-af99-86f855ce2cbb
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a31b87a-75c1-40ed-bbd3-9e9194239c98
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49de1e0e-7b40-4b08-af84-c207d4e1339f
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: REFERRAL_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee244599-1712-403d-b55b-a6796b9fdf84
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c0d4b2d-1d7a-4240-878d-ee360f3f1f4f
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d1d7a17-6e1a-4bb7-81d9-15e41e4a9170
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e50fb60-69de-4e79-b40f-dde6463b85a1
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6442e987-03ac-4204-b444-c81ac50367fc
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a91d0b95-9588-4e36-8b4a-5d56ff557f97
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_SENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 488089d6-e291-4318-b5a8-11c51c99f6f3
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bde860f9-c51b-4981-be05-93af67a33de4
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCCOMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70529502-3313-4520-9ddc-132dafe4d945
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02263ef3-6d95-4116-beeb-9964d1332e18
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_OF_CHANGE_FOR_CLAIM_LODGED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d34b6972-4486-493f-952a-201f145f2425
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f33dae64-3237-4b8e-902b-5415dcd53833
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: CHAR(2)
        defaultValue: ""
        description: ""
        name: INJURYFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45ca43c3-efb8-4d45-aafc-b7e9b30f9aab
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cea88046-5ccb-4675-95d2-7f72f06f89c7
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Populated when the MH referral was created for a team that replaces old teams that have been merged.
        name: MH_LINKED_REFERRAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62de82d1-8d23-4c6f-a286-548c62351b85
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66e73f62-8632-4d0a-8fda-765ab7fc88af
          stepCounter: a520718c-dd33-4b6f-b424-866b8f20076f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Start date of the referral that was closed when MH teams were merged.
        name: MH_LINKED_REFERRAL_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bf52bfb-0509-458b-a489-ece80e015851
                stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT referral_encounter_id,
                   patient_NHI,
                   dim_encounter_type_key,
                   dim_patient_key,
                   referral_start_date,
                   dim_age_group_key,
                   dim_referral_reason_key,
                   dim_referral_type_key,
                   dim_referral_status_key,
                   dim_referral_priority_key,
                   clinical_priority,
                   dim_referral_admin_category_key,
                   dim_referral_start_date_key,
                   dim_referral_sent_date_key,
                   dim_referral_received_date_key,
                   dim_referral_source_key,
                   dim_referral_authorisation_reason_key,
                   dim_authorising_clinician_key,
                   dim_referral_cancellation_reason_key,
                   dim_completion_date_key,
                   dim_referral_completion_reason_key,
                   dim_referral_rejection_reason_key,
                   dim_referred_by_health_org_key,
                   dim_referred_by_specialty_key,
                   dim_referred_by_clinician_key,
                   dim_referred_to_health_org_key,
                   dim_referred_to_ward_key,
                   dim_referred_to_specialty_key,
                   dim_referred_to_clinician_key,
                   dim_staff_team_key,
                   dim_principal_diagnosis_key,
                   dim_accident_related_status_key,
                   dim_accident_type_key,
                   dim_CADS_caseteam_key,
                   dim_ACC_status_key,
                   ACC_no_reported,
                   ACC_valid_flag,
                   ACC_claim_no,
                   ACC_indicators_id,
                   dim_referral_acc_indicator_key,
                   ACC45,
                   dim_disability_type_key,
                   dim_MOJ_court_key,
                   dim_prison_key,
                   dim_prison_location_key,
                   cancer_flag,
                   ESPI1_accepted_flag,
                   ESPI1_authorised_flag,
                   ESPI1_processed_in_time_flag,
                   ESPI1_eligible_flag,
                   ESPI1_rejected_flag,
                   NPF_presenting_referral,
                   NPF_rejected_flag,
                   NPF_exception_flag,
                   NPF_follow_up_referral,
                   NPF_acknowledgement_date,
                   NPF_closed_no_activity,
                   NPF_transfer,
                   ESPI1_rule,
                   ESPI1_wait_time_duration_calendar_days,
                   ESPI1_wait_time_duration_working_days,
                   ESPI1_wait_time_duration,
                   injury_date,
                   duration_unit,
                   modify_date,
                   next_referral_encounter_id,
                   parent_referral_encounter_id,
                   comments,
                   discharge_comments,
                   create_date,
                   patient_referral_count,
                   referral_waitlist_count,
                   referral_AE_count,
                   referral_admission_count,
                   referral_appointment_count,
                   NPF_suspension_exception_waitlist,
                   NPF_excluded_waitlist_count,
                   dim_create_user_login_key,
                   patient_referral_seq_num,
                   prev_referral_encounter_id,
                   dim_modify_user_login_key,
                   referral_authorisation_date,
                   referral_authorisation_flag,
                   dss_data_quality_code,
                   referral_cancellation_date,
                   referral_completion_date,
                   referral_count,
                   referral_expiry_date,
                   referral_received_date,
                   referral_sent_date,
                   ACCComment,
                   date_of_change_for_claim_lodged,
                   InjuryFlag,
                   mh_linked_referral_id,
                   mh_linked_referral_start_date
              FROM s_referral_30
             WHERE referral_reference_dup_row_num = 1
            EXCEPT SELECT referral_encounter_id,
                   patient_NHI,
                   dim_encounter_type_key,
                   dim_patient_key,
                   referral_start_date,
                   dim_age_group_key,
                   dim_referral_reason_key,
                   dim_referral_type_key,
                   dim_referral_status_key,
                   dim_referral_priority_key,
                   clinical_priority,
                   dim_referral_admin_category_key,
                   dim_referral_start_date_key,
                   dim_referral_sent_date_key,
                   dim_referral_received_date_key,
                   dim_referral_source_key,
                   dim_referral_authorisation_reason_key,
                   dim_authorising_clinician_key,
                   dim_referral_cancellation_reason_key,
                   dim_completion_date_key,
                   dim_referral_completion_reason_key,
                   dim_referral_rejection_reason_key,
                   dim_referred_by_health_org_key,
                   dim_referred_by_specialty_key,
                   dim_referred_by_clinician_key,
                   dim_referred_to_health_org_key,
                   dim_referred_to_ward_key,
                   dim_referred_to_specialty_key,
                   dim_referred_to_clinician_key,
                   dim_staff_team_key,
                   dim_principal_diagnosis_key,
                   dim_accident_related_status_key,
                   dim_accident_type_key,
                   dim_CADS_caseteam_key,
                   dim_ACC_status_key,
                   ACC_no_reported,
                   ACC_valid_flag,
                   ACC_claim_no,
                   ACC_indicators_id,
                   dim_referral_acc_indicator_key,
                   ACC45,
                   dim_disability_type_key,
                   dim_MOJ_court_key,
                   dim_prison_key,
                   dim_prison_location_key,
                   cancer_flag,
                   ESPI1_accepted_flag,
                   ESPI1_authorised_flag,
                   ESPI1_processed_in_time_flag,
                   ESPI1_eligible_flag,
                   ESPI1_rejected_flag,
                   NPF_presenting_referral,
                   NPF_rejected_flag,
                   NPF_exception_flag,
                   NPF_follow_up_referral,
                   NPF_acknowledgement_date,
                   NPF_closed_no_activity,
                   NPF_transfer,
                   ESPI1_rule,
                   ESPI1_wait_time_duration_calendar_days,
                   ESPI1_wait_time_duration_working_days,
                   ESPI1_wait_time_duration,
                   injury_date,
                   duration_unit,
                   modify_date,
                   next_referral_encounter_id,
                   parent_referral_encounter_id,
                   comments,
                   discharge_comments,
                   create_date,
                   patient_referral_count,
                   referral_waitlist_count,
                   referral_AE_count,
                   referral_admission_count,
                   referral_appointment_count,
                   NPF_suspension_exception_waitlist,
                   NPF_excluded_waitlist_count,
                   dim_create_user_login_key,
                   patient_referral_seq_num,
                   prev_referral_encounter_id,
                   dim_modify_user_login_key,
                   referral_authorisation_date,
                   referral_authorisation_flag,
                   dss_data_quality_code,
                   referral_cancellation_date,
                   referral_completion_date,
                   referral_count,
                   referral_expiry_date,
                   referral_received_date,
                   referral_sent_date,
                   ACCComment,
                   date_of_change_for_claim_lodged,
                   InjuryFlag,
                   mh_linked_referral_id,
                   mh_linked_referral_start_date
              FROM fact.fact_referral
        dependencies:
          - locationName: TGT
            nodeName: S_REFERRAL_30
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_REFERRAL_30') }}
        name: S_REFERRAL_30_CHANGES_V
        noLinkRefs: []
  name: S_REFERRAL_30_CHANGES_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
