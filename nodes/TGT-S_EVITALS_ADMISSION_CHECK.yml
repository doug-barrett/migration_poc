fileVersion: 1
id: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
name: S_EVITALS_ADMISSION_CHECK
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Calculate sequence numbers/counts and look up any missing dimension keys."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e441feb-5f57-4d4e-9352-029258f15882
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99554ed8-642b-4a35-a107-cff39f58ef2e
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ff10dbe-fcad-4d7e-94ed-915efb9d2573
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 035ab457-9b9b-4c64-aea8-8d29a4e6bfec
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32663ad1-7fee-42a0-bbc4-f95cd1358882
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93964383-6862-4c8e-8cba-66c828fcc625
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41ed678e-86a3-477e-a384-0b18ce2a5862
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Sequence number for each NHI admission.
        name: ADMISSION_SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99554ed8-642b-4a35-a107-cff39f58ef2e
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ROW_NUMBER() OVER(PARTITION BY patient_nhi ORDER BY admission_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b95a36a4-65ca-4744-8a53-17ad6bafbc06
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Number of admissions for the NHI.
        name: ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99554ed8-642b-4a35-a107-cff39f58ef2e
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: COUNT(1) OVER(PARTITION BY patient_nhi)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc5997ea-5a86-4792-b2af-bdb49a5d013f
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a758c19-1645-40e5-b614-9b73bcb1ca5b
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b1bc040-fb43-4e70-ba6e-bd74ddb534a6
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_INSTANCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2598b2a-a631-4a9d-835d-bc28b5fc7d14
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8a939e8-133a-46ad-9482-26a97e69e538
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Has the form been changed?
        name: IS_CHANGED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aba041f3-589d-4dbc-9eec-ec894aef8fa2
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a258982-8763-44d7-b9e1-270b8d9b8b83
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ID Bracelet Present?
        name: ID_BRACELET_PRESENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aeea78c8-1c12-4c65-acac-35e5cb9ec99c
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 515a3c37-d603-42a4-a006-8a6d1ec1df2d
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ID Bracelet Correct?
        name: ID_BRACELET_CORRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdfea706-1a45-4a7a-8329-2f140817afe2
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b813c06e-83d6-4025-b85a-f95e79235350
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Is name display or bedside handover appropriate?
        name: IS_NAME_APPROPRIATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f2cd6a2-6e50-46e5-be5e-45a01f688a64
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 916155bf-c4f1-42f5-98ee-d9678abf37dc
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Emergency contact details correct?
        name: IS_EMY_CONTACT_CORRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6c72227-6888-4aab-8ef3-53b74e2b008c
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d661715-2f69-4ad1-9ec3-a877f6972d4e
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Patient property disclaimer explained?
        name: PPD_EXPLAINED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bed65aa-1d2a-43c5-a5e8-ba85ef255be4
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb731dca-38e6-4c4d-9855-7c48056fc1e4
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: False teeth required?
        name: FALSE_TEETH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27de72f2-ba00-4f1f-a54c-80756adf8ace
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbe5d7f0-6220-4a50-ae4d-a36372c3a6a5
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Are false teeth with the patient?
        name: FALSE_TEETH_WITH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f5815c7-a665-423d-be30-5684b71e7cb7
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c565f784-ef61-4f49-8aec-6eb76301d358
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Patient's understanding of reason for admission is similar to the clinical reason?
        name: PT_USTD_ADM_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab77cf16-4a65-4610-89f1-5c271b2b110d
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed7affcb-c693-4406-972f-a60dda734a4b
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Interpreter required?
        name: INTERPRETER_REQD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39ceaef9-771f-48cc-bfdd-43a171bbaf5f
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d468e2c1-05ad-4908-9336-9b5a9dddcd15
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Other communication impairment?
        name: COMM_IMPAIRMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff8cf7ab-a81a-422a-bf69-973f9e724a86
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bdf28b8-5b5e-4bc0-a3a6-e98f8cf5d587
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Impairment?
        name: IMPAIRMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 885f9d34-23a3-46fe-8819-af9839828a93
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 009347e5-a349-42aa-be68-ac4ee17d2b14
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Hearing Impaired?
        name: HEARING_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d188dc92-d988-4ba3-934b-217c04d1ce23
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b32ec8e-3165-48f3-b1e7-324561a72a16
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Hearing Aids Required?
        name: HEARING_AIDS_REQUIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83fe66c3-4128-4d17-a4de-db0bd3f281f0
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 546e30b4-d9cb-496a-955b-1b7837d86cc8
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Hearing Aid Present?
        name: HEARING_AID_PRESENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc7b84a2-5f5d-4140-b352-f5033b1b8ce2
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3063dd65-ed05-441f-afb8-514585596bc1
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Visually Impaired?
        name: VISUALLY_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31a1e21a-c944-4a51-82ec-65dcb7fa96c4
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca1ef00d-0cd5-4399-a235-fe58c45b77c3
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Visual Aids Required?
        name: VISUAL_AIDS_REQUIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9bc8c0f-b766-4023-9377-f7443df91857
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82956df9-572c-4e12-bf6e-dea6226e4691
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Visual Aids Present?
        name: VISUAL_AIDS_PRESENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3855aea7-6eb7-4431-8411-9ffbb1db408f
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48ae927a-b156-459a-a444-c7d49be12cc8
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Speech Impaired?
        name: SPEECH_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 364547b2-a01d-471f-a1b2-3441bcdd5146
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41c0be42-4cf2-406c-b072-04d7b5b6ae8a
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Cognitively Impaired?
        name: COGNITIVELY_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d23fb376-87fa-432a-b575-5199c7ea9f3f
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dacfe34d-98fd-4969-91be-083cb58fa66b
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Other Impaired?
        name: OTHER_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d25fd485-bd7a-490b-84f6-500d5798c792
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fda3157-0726-434d-b812-31847a7acf70
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Cultural or spiritual support services required?
        name: SUPPORT_SERVICES_REQD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e572ba1b-2239-4478-b162-c9da683d316b
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ce6a0c9-42a9-4f69-b80a-ce48e6002afa
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Would this patient have a higher risk of harm if they fall?
        name: HAVE_HIGHER_RISK_HARM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0f77ca6-1d5e-40eb-83bd-53bec3006549
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84b6f621-76e6-44b1-afae-3dbf4823741d
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Admitted post fall, or history of falls?
        name: ADMITTED_POST_FALL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bc92799-a15f-4789-b575-0f48d4118ec5
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6d87714-68f7-458d-b5d2-c53b1a66de04
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Nursing concern of increased falls risk?
        name: INCREASED_FALLS_RISK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6512c1df-7247-4456-bf6a-69cf7c493c54
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c6df0cf-0f1b-45e8-b184-4eee0ad877ae
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Is the patient mobile and independent?
        name: MOBILE_AND_INDEP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9df4bce6-ca8a-4904-bedd-42baf187159c
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2ea9e29-545e-412f-b018-6ca4a11d11be
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Evidence of history of pressure injury?
        name: HISTORY_PRE_INJURY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19a3e7b2-bdf1-48d5-9720-d15bcf0257ba
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7e87ea1-450c-4dc6-ad08-419f03f98336
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Evidence of poor nutrition or malnutrition?
        name: POOR_MALNUTRITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaa63a48-2a6a-40e4-b7f0-8f202d2b32cc
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faa17390-23ee-4ffd-b13f-c7ed607d2336
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Limited mobility, bed bound or wheelchair dependent?
        name: LIMITED_MOBILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4593f49e-b604-4b95-9ce0-35533e840903
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af620b80-13a7-4885-a375-56595d7e2ec4
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Prolonged Theatre time > 6 hours or bedrest?
        name: PROLONGED_THEATRE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a89e8325-244c-423f-b495-4152e3176e04
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e5e3b9-6ad3-4ae0-85fd-79a86edca719
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Nursing clinical concern?
        name: CLINICAL_CONCERN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8674b094-25c2-4c80-a250-0f37ed683e18
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b238726-24dc-47a7-b7e7-799922ed7f2d
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Severe medical illness?
        name: SEVERE_MEDICAL_ILLNESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aef38161-90b1-40ad-9d8c-31543ba48ee5
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b42464ee-f162-4e28-8528-1b2eb001580b
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Surgical admission with general anaesthetic?
        name: SURGICAL_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8eebf02-05e7-4453-bb25-f9162ac24e08
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0137d0e5-b589-43d7-93b0-edcd5f73b535
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Recent deterioration in function OR hospital admission within the last 3 months?
        name: PHYSICAL_FRAILTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40d28b09-5c0c-4548-86b7-433278756e53
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dfc7c60-027d-4d78-b5d4-b3922467f703
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Identify polypharmacy (>= 6 regular medications).
        name: IDENTIFY_POLYPHARMACY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4fe692b-c936-4299-b034-f06e74574ecf
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3c314e-368a-404b-8334-5600d5df52df
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Lives in Rest home or Private hospital OR needs another person to help with ADLs
        name: REST_HOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f8c5a71-888f-46f5-8ef9-5812c3b7f44e
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aecdd0b3-1ab6-46d7-8af3-bbe19cbd3d6f
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Frailty Score
        name: FRAILTY_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65682e2b-a6c7-487c-9344-f7626e8859d5
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbff2e7f-21ff-4bca-86b3-f10ae25106a2
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: PercentCompleted
        name: PERCENT_COMPLETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 383af74f-3e17-4ec7-87a2-4dcaf95cbf70
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8325d55-6be5-48d3-bda2-9bb64e9073a6
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Schedule Morse Falls
        name: SCHEDULE_MORSE_FALLS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03c972ac-ad9c-40b8-8ab3-3719798a1c37
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f124524-788e-4709-a580-7550263d2e6b
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Schedule Moving And H
        name: SCHEDULE_MOVING_AND_H
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e51b0ed3-c527-44dd-9174-429d2af2b055
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0da99fa-f9f5-409a-9eea-43c3c121b553
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Yes to any water low Qn
        name: YES_WATER_LOW_QN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf9a3d9c-3737-439a-b9a7-51882181f553
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5814ec7-df56-4e1c-8d5c-c36e30f4b572
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Schedule Must
        name: SCHEDULE_MUST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04f88172-6f1a-4756-9ebd-afdf868a1e45
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e948bbdb-500c-4e70-961c-6aa95ec9f8a2
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_EVITALS_ADMISSION_CHECK_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dim_eVitals_admission_check.dim_eVitals_admission_check_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a3b7a7f-086e-4856-908d-9d8fb971c84c
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.form_definition_id=dim_eVitals_form.form_definition_id
        name: DIM_EVITALS_FORM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2bc6682-0a2f-4b66-b844-658ceeea042e
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44d2f4f2-98c5-4f08-a819-82ed40be515d
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_eVitals_form.form_created_date=dim_form_created_date.form_created_date
        name: DIM_FORM_CREATED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc836262-605c-43eb-857d-71bc2ec44bde
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81acc0f2-4e60-4d98-87bc-4a1506df70be
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65bb327b-d126-4229-99bd-802e7b14eaf0
                stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7d02592-11a2-40fb-9882-b8f67eef10a0
          stepCounter: 3d0289c3-bff8-40fe-a001-bf2c28cc481a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EVITALS_ADMISSION_CHECK_10: 0bc007f1-702d-40d2-8560-3969ac9a3798
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_ADMISSION_CHECK_10
          - locationName: UNKNOWN
            nodeName: DIM_EVITALS_ADMISSION_CHECK
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_EVITALS_ADMISSION_CHECK_10') }}
              LEFT OUTER JOIN {{ ref('UNKNOWN','DIM_EVITALS_ADMISSION_CHECK') }}
                ON s_eVitals_admission_check_10.interpreter_languages = dim_eVitals_admission_check.interpreter_languages
               AND s_eVitals_admission_check_10.specify_language = dim_eVitals_admission_check.specify_language
               AND s_eVitals_admission_check_10.specify_impairment = dim_eVitals_admission_check.specify_impairment
               AND s_eVitals_admission_check_10.services_required = dim_eVitals_admission_check.services_required
               AND s_eVitals_admission_check_10.ethnicity = dim_eVitals_admission_check.ethnicity
               AND s_eVitals_admission_check_10.delirium_screening = dim_eVitals_admission_check.delirium_screening
               AND s_eVitals_admission_check_10.delirium_history = dim_eVitals_admission_check.delirium_history
               AND s_eVitals_admission_check_10.total_score = dim_eVitals_admission_check.total_score
               AND s_eVitals_admission_check_10.patient_risk = dim_eVitals_admission_check.patient_risk
        name: S_EVITALS_ADMISSION_CHECK
        noLinkRefs: []
  name: S_EVITALS_ADMISSION_CHECK
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
