fileVersion: 1
id: a039fea2-5704-4767-bdb2-b18b52ec254a
name: S_CENTRIC_PATHWAY_RECORD_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42a4aefc-2309-4ed8-b10a-47c1c7699184
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13a970f3-9ad6-47de-bf7c-850085948056
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1faa629-22e4-461b-99fc-4875cd4e764d
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11a0e700-31fd-4cca-bf8f-d449368be5f8
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5952e72d-b1b2-40d3-808e-d6ede797e66e
                stepCounter: 23fc3943-0e02-4770-8f01-e08a00eae3c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b3d2f76-9f2f-40d6-92cd-37309563826e
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e387f988-98b5-4069-9cb5-bd6377b45974
                stepCounter: 23fc3943-0e02-4770-8f01-e08a00eae3c4
            transform: l_IPS_Pathway.id + 1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e9b5051-ab6e-45e4-a78f-a7a159471ae3
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cd67ab8-f9de-4180-914c-dfe80f34ca2e
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: |-
              CASE WHEN s_IPS_Pathway_Record_v.nhi like 'Temp%' THEN s_ed_attendance_05.patient_nhi
                          ELSE s_IPS_Pathway_Record_v.nhi
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4cefbfb-01a0-4390-b0e9-bc285a681b34
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 943f4cf7-fd8e-4e39-8efc-7c0cc679a6c4
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c50c550-9836-4ef6-a6f8-a6514e3a4d6e
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATHWAY_ROW_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea970fae-4178-4ef3-9b05-f4eebdbedbc2
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25ad1454-21b7-4067-a40d-c2096a0288f4
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATHWAY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4bf0ce4-db07-400e-8628-be024f333e0a
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 953657d1-6890-4a04-9284-eae9e47693db
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ENROLLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f58767-4b08-40f4-a370-decc71e12378
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77217ee7-142f-4843-a058-4387a03612b3
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dc337ec-2a69-4879-97ce-4acada6bfa8e
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41a1a8b9-0b06-4b9a-b3a5-e1074a4f6b8b
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: CREATED_USERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54563c9a-636b-4280-aa35-f47f68ad1e68
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2360d114-d7a0-4742-984c-41722d5875af
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DELETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d783f37e-84b1-4033-960f-840fb7020093
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d22e501-09e2-4fb7-98b4-6b5f8381f3e9
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: DELETED_USERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 819355cf-4f9f-4fc8-805f-f423553a8673
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c79b67e0-b297-45e9-a4c9-9ba429e0203b
          stepCounter: a039fea2-5704-4767-bdb2-b18b52ec254a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_IPS_PATHWAY_RECORD_V: bd13b777-a329-4951-97c9-c2573930ff73
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IPS_PATHWAY_RECORD_V
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_IPS_PATHWAY_RECORD_V') }} s_IPS_Pathway_Record_v
              LEFT JOIN s_ed_attendance_05
                ON s_IPS_Pathway_Record_v.encounter = s_ed_attendance_05.identifier
              LEFT JOIN dim.dim_patient
                ON CASE WHEN s_IPS_Pathway_Record_v.nhi like 'Temp%' THEN s_ed_attendance_05.patient_nhi
                        ELSE s_IPS_Pathway_Record_v.nhi
                         END =dim.dim_patient.patient_NHI
               AND NHI_sequence=1
              LEFT JOIN l_IPS_Pathway
                ON s_IPS_Pathway_Record_v.pathwayId = l_IPS_Pathway.id
              LEFT JOIN l_reference_testpatients
                ON s_IPS_Pathway_Record_v.nhi = l_reference_testpatients.NMPI
             WHERE 1=1
               AND l_reference_testpatients.NMPI IS NULL
        name: S_CENTRIC_PATHWAY_RECORD_10
        noLinkRefs: []
  name: S_CENTRIC_PATHWAY_RECORD_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
