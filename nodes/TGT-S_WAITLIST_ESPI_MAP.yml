fileVersion: 1
id: 933afa12-2b57-4515-bf24-0dd38100df6b
name: S_WAITLIST_ESPI_MAP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ccb3ca2-f971-4966-9e6e-c2062e562b22
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40acb06e-bc14-4c12-8fba-c05af98ce6d9
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea97e72f-3ac4-4d27-aeb0-d806a0bf8075
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: ADCAT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de969438-5e09-44eb-bcc1-fd84cd3138f6
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8068e8d-3c4b-4071-89d4-4839cdad7153
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCEDURE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7059ee69-dc9d-478f-8f3f-c5009ec8e5ea
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63eadde9-af59-4576-8b67-236891392955
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: PROCEDURE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c546da68-78a0-45af-aad4-c29db8e73831
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0286962-f8ad-4a0f-a606-2431a372d02a
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SVTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad98a992-73ee-4b08-be19-0f5cdf698b54
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdc06f1f-d4ff-44b2-aec6-859e6a62d0be
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: SVTYP_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4473374-49d0-4b66-8181-5aa4e7391fd6
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37ec0e00-15c8-4c4a-98eb-34cf5a0dea2c
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bf1b95a-33d8-463c-9caf-70e23138977e
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed28063d-a266-4b45-af0c-56f17a24182f
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SPECT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a06abd3-4eb0-4761-bd5d-dc8331fc76e6
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19144514-f952-419c-ad01-1d946791388c
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5654a28-a208-4337-9a9e-2f5ae6fa7981
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 765892c6-9c83-42f1-b4f4-37be2b3b87d2
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f2c257-02f7-4052-8062-7b6ecbf29185
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2705a2c-f0c0-48f5-8d77-1622a14f72d7
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRITY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7717b077-0c5e-4db8-9ed8-7929d3f20dfa
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c15cf55d-058e-4392-a3f2-fd85ab4fef8f
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: PRITY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4cf6f53-6845-4a6b-9ba2-072e4557a8ee
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 681344ed-9759-49bc-81d3-d2d5622407a6
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c856d09-1007-47a1-9d5d-adaf084dfc1d
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: |-
              CASE WHEN ISNUMERIC(l_mappings_WaitList.proca_refno) = 1 THEN CONVERT(integer,l_mappings_WaitList.proca_refno)
                          ELSE 1999999999
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2a08726-a1f6-41eb-88a9-cf8da510250d
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(62)
        defaultValue: ""
        description: ""
        name: PROCA_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e1dc376-47e5-4c3d-9412-7f20e5f9f93d
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9792d426-8485-4b10-93d8-18e29aa944fa
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee2b68b3-3f84-4f79-9f4f-2a0da5042503
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37f1cbc5-15b4-4d85-beb9-f12072650050
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0437ec19-4586-4135-a81b-fa0931a73040
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5efd256-e1c1-45c6-8b88-6bd9a5f0e5dd
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MAPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9e3f42-3837-41c5-a299-3b3e53c6eb91
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0e07d6a-9854-4d42-b3ea-637fbb1385c4
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adca2b5e-afa0-4dbd-8934-372e0871dbfe
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 588f0244-ec58-41f8-8228-dcd25375841a
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64dc898d-6de8-4bb0-b524-84a0b2812bef
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b334639-0653-4050-848f-3a51829fd850
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3c9f74f-6002-41fc-956c-0c239409f120
                stepCounter: 868516a7-a8ad-4623-b272-3600113b2439
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcaf7a85-76c4-4d61-8fa9-4c5aebc5ecef
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: CHAR(4)
        defaultValue: ""
        description: ""
        name: SERVICE_SUB_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9781fd4a-7444-4bfc-85a8-93ebdd7c5d1e
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecb553a1-ec9e-450d-ac4c-8ff29b8c6867
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_SUB_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b73fe3af-315c-4e4e-8b90-df68e87da33e
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98d16270-025f-4ed7-8f47-7b28b55da0a0
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8dfc840-233d-4efe-8199-d480d2d001f4
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd2cff5d-3bf8-440c-8cf4-ef22e75372d7
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_MAPPINGS_ROWID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d0bf2ba-e17d-47dd-97f2-8eb271f93fe4
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25e05034-3a54-44ba-992d-9ee3239a8b28
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INT
        defaultValue: ""
        description: Suspension waitlists generate additional NPF Prioritisation and notifications
        name: NPF_SUSPENSION_EXCEPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 108745a8-e30a-4861-8c09-38539d9ad3c3
                stepCounter: 72f452f1-9019-48ad-84d5-32c30b227681
            transform: IFNULL(l_mappings_WaitlistCategories.NPF_suspension_exception,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c0fac26-76b2-4273-8769-078a1bf7eddf
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_ADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f050c18-e09c-487f-a15b-95c9750ca0e8
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abe9dd07-6dd5-496e-9041-11481b7d0191
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if this line is invalid data
        name: DATA_QUALITY_ISSUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ca0ae56-8004-4212-bed9-234f8bf11e34
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e655c3ab-051a-4e5c-9595-04bb0703ec69
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MAPPING_LAST_MODIF_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0317462e-df3c-4057-a3df-a8287c00f9c6
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ea051a3-3d2b-421c-b60e-1c55ac8c17d8
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: MAPPING_LAST_MODIF_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51784fe6-0ab3-4225-ae6d-dea02c20ed9a
                stepCounter: cf8e520f-6970-4d29-8305-994ed34f70cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b4f972c-21ff-4a62-8540-652a7778da39
          stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_MAPPINGS_WAITLISTCATEGORIES: 72f452f1-9019-48ad-84d5-32c30b227681
          L_REFERENCE_MOH_NPF_CODESETS: 868516a7-a8ad-4623-b272-3600113b2439
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_MAPPINGS_WAITLIST
          - locationName: TGT
            nodeName: L_MAPPINGS_WAITLISTCATEGORIES
          - locationName: TGT
            nodeName: L_REFERENCE_MOH_NPF_CODESETS
        join:
          joinCondition: |-
            FROM l_mappings_WaitList
              LEFT OUTER JOIN {{ ref('TGT','L_MAPPINGS_WAITLISTCATEGORIES') }}
                ON l_mappings_WaitList.localcategory = l_mappings_WaitlistCategories.wlrul_refno
              LEFT OUTER JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }}
                ON l_mappings_WaitList.service_type = l_reference_MOH_NPF_codesets.Code
               AND l_reference_MOH_NPF_codesets.Codeset = 'srv'
              LEFT OUTER JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} l_reference_MOH_NPF_codesets_sst
                ON l_mappings_WaitList.service_sub_type = l_reference_MOH_NPF_codesets_sst.Code
               AND l_reference_MOH_NPF_codesets_sst.Codeset = 'SRVSUB'
              LEFT OUTER JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} l_reference_MOH_NPF_codesets_e
                ON l_mappings_WaitList.encounter_type = l_reference_MOH_NPF_codesets_e.Code
               AND l_reference_MOH_NPF_codesets_e.Codeset = 'ENCTYP'
        name: S_WAITLIST_ESPI_MAP
        noLinkRefs: []
  name: S_WAITLIST_ESPI_MAP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
