fileVersion: 1
id: b00c29c9-9d43-44b5-a0f9-6ebb40068695
name: S_OUTPATIENT_APPOINTMENT_SUMMARY_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 903470fd-5294-405c-87d3-be723aa7b16f
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d600e497-6475-4456-bc99-f0b83cf0a491
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b4aa930-e064-42c2-a33d-39abf32a1e31
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.appointment_status_type_code ='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 143dc2d7-2425-4e4e-a1d8-d5210a96d5f8
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'N' AND ds_outpatient_appointment_30.appointment_status_type_code='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c892d0b4-b689-4a09-a4a0-598a81f2f38d
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'Y' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edf7e435-de48-424c-8219-cadee0458a45
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEW_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.appointment_status_type_code='A' AND NULLIF(ds_outpatient_appointment_30.appointment_outcome_reference_no,11586) IS NULL AND COALESCE(ds_outpatient_appointment_30.appointment_start_date,ds_outpatient_appointment_30.patient_arrived_date,ds_outpatient_appointment_30.patient_seen_by_date) < getdate() THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac6cd69d-aa28-4b4e-b75e-902d546b0575
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'N' AND ds_outpatient_appointment_30.appointment_status_type_code ='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9823e61-c400-47b3-9dd3-c79b52ef6f51
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'Y' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e46fa1-3a40-460a-becc-cae80009c6dc
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND NULLIF(ds_outpatient_appointment_30.appointment_outcome_reference_no,11586) IS NULL AND ds_outpatient_appointment_30.appointment_status_type_code='A' AND COALESCE(ds_outpatient_appointment_30.appointment_start_date,ds_outpatient_appointment_30.patient_arrived_date,ds_outpatient_appointment_30.patient_seen_by_date) < getdate() THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c675007b-9b02-4e12-a764-ce4c8121b656
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: MIN(ISNULL(ds_outpatient_appointment_30.patient_seen_by_date,ds_outpatient_appointment_30.patient_arrived_date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e8dc075-0195-406b-a0a0-0bf59fa8f3a8
          stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: MAX(ISNULL(ds_outpatient_appointment_30.patient_departed_date,ds_outpatient_appointment_30.patient_departed_date))
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_OUTPATIENT_APPOINTMENT_30: 95548c6d-4b83-4d1b-a940-eb0a38b41205
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_OUTPATIENT_APPOINTMENT_30
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','DS_OUTPATIENT_APPOINTMENT_30') }}
             GROUP BY outpatient_session_reference_no
        name: S_OUTPATIENT_APPOINTMENT_SUMMARY_V
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_SUMMARY_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
