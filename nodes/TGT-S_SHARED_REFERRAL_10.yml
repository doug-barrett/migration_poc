fileVersion: 1
id: 9e22a016-7a78-442e-a74f-dd546f65f8fe
name: S_SHARED_REFERRAL_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6c5b7cd-191d-4c62-9d73-5a1fe87ce73f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ea5d433-91ca-48a7-9ae4-faea9f093b1b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: "'R' + CONVERT(varchar,ds_pims_referrals.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 668e9f67-1942-460c-8fdf-4f7ddae76597
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_ELIGIBLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 155b5b8b-4dab-4dec-bcae-96de8a4a2655
                stepCounter: 410d8e56-9f7e-4108-8289-feac32247ef2
            transform: |-
              CASE WHEN RETYP_refno = 200800 AND IFNULL(l_mappings_referral_reason.ESPI1_inclusion,0) = 1 AND IFNULL(s_specialty_1.ESPI1_inclusion,'N') ='Y' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d488c1d-b430-424e-b61c-8a753f14fb38
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is the ESPI1 rule plus Surveillance
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 155b5b8b-4dab-4dec-bcae-96de8a4a2655
                stepCounter: 410d8e56-9f7e-4108-8289-feac32247ef2
            transform: |-
              CASE WHEN s_referral_activity_05.referral_waitlist_count > 0 AND s_referral_activity_05.referral_waitlist_count = s_referral_activity_05.NPF_excluded_WL                                                                                                                                               THEN 'N'
                          WHEN RETYP_refno =200800 AND ds_pims_referrals.recvd_dttm >= '01-Jul-2014' AND IFNULL(l_mappings_referral_reason.NPF_inclusion,0) = 1 AND IFNULL(s_specialty_1.NPF_inclusion,'N') ='Y' AND not(ds_pims_referrals.rject_refno IN(1400017800,1400019280) AND IFNULL(referral_waitlist_count,0) = 0) THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adb24493-bf3b-4ed8-aa10-94281e848c8e
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_INCLUSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69c52a4e-79bf-4dc0-830a-c11b6398d87f
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8aeb06d2-cce6-431d-98a7-7cc125b304bc
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_INCLUSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d258ee3-e063-47ef-ba2d-7b65dcfc0e79
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a368998d-8e34-49bd-a6be-8b9a2485d5f9
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'R'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c3fabd8-ab4f-4770-adc7-60700c5c1b0c
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ea5d433-91ca-48a7-9ae4-faea9f093b1b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d96d88d8-469a-420d-bf5e-2b6a4df593cb
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baf869b7-ae4e-4e86-9220-ee67c2486bec
                stepCounter: 9aec4d43-6334-4aa7-852c-860b52541e95
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50c57b5a-08e2-4e45-99ed-f5dd39147d60
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SORRF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cef6014-6f76-4c22-8173-e8ac42625bf2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18ece405-d0ea-47e2-a49a-c3ef65995f0f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fe73cfe-d31f-4f4c-b329-bd8709ea5b3c
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bf07eb5-1bfc-4185-908e-0de3dbe63058
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECVD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d559d91-e33e-47a7-a819-1f7cce3c6112
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: |-
              CASE WHEN ds_pims_referrals.recvd_dttm < '1984-07-01' OR ds_pims_referrals.recvd_dttm IS NULL THEN COALESCE(ds_pims_referrals.sent_dttm,ds_pims_referrals.authr_dttm,getdate())
                          ELSE ds_pims_referrals.recvd_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3e7a43d-bcba-4bf2-bdfe-46e31976bf96
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECVD_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d559d91-e33e-47a7-a819-1f7cce3c6112
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48fd88a5-a56e-499e-807c-75098490fe60
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REASN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40a7ad5-4af2-47cf-bd63-c1f6eb19c254
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c8596b6-44be-4744-a87c-809ba9e84522
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75df44dd-2792-486c-bb08-f4269de90912
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcfe4e4d-2e02-4e7c-8664-4f98f09b46d2
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANRS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7394ac28-f2b2-4e57-bcf1-9854ab3b93b0
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33d7b7c5-7120-4730-8a78-3cec42b7282b
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGNC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6c14013-e1e9-4e74-9a10-832c934fb14a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f60b767c-8331-4d39-afdc-efee7b6bf1f1
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRITY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82731dc1-37e7-489c-b7ac-9be4ca18d5b5
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4773f7a4-9031-494c-82bd-8515bb5d27ee
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: LETTER_SENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16891d6a-ba3f-40bc-a024-0cca2fda00e1
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35e2e562-073b-4c41-90f4-a652edf8493c
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CLOSR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b66ecb9-86fa-46cf-9e69-db13c44d34c5
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4753bbb6-13ad-48d0-ba96-0def6ead247b
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ORDTA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22960ffc-9e06-4457-bd7a-b3d27a6504a0
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ca03291-6884-4c21-a461-cbe1196c10d6
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: AUTHR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18288d3e-685e-4972-afd0-155358ab1ebe
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d258b2f8-9028-43d5-929b-5c4a8e3c8d07
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: AUTHR_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6d24db8-8306-4889-99de-ff9b22df4bab
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f7f899d-82b9-4bbc-8a97-221924c966e5
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AUTHR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 876a1072-e8be-4426-a1d0-b906d1f669a3
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec8241e2-a1e8-43af-b807-a7492a5500e3
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AUTHR_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3055d7ba-0014-4e16-afa4-5d81608e3f50
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1cf8ead-93e7-4bfc-b6cc-6c4034146ae9
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RESP_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a83907-d1d4-40e7-a42f-7acee11cc29a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fb0c8eb-7c6f-4842-a0fb-8a429ea8c2cc
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_STEAM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4402eb67-ba0a-43ec-8911-43c6fa853f13
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acf618b0-b05f-4fda-8280-08da4dc479ba
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb59e4d-ed8c-4413-895c-2f62daabf8bf
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb0728ce-0000-4c52-a06a-e6d8927ffdf0
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee463a13-670e-474e-909b-796ab470f0d7
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55160c6d-9a34-4217-92e5-4c797d8abcc0
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7fb66e4-e739-4e45-a716-2693f052ae2b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e73440a-5f8f-4cc2-8609-3fc1da55fd17
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_STEAM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 607aeda1-4505-4215-899b-76b76c362601
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 624f74cf-0431-4caf-83e4-fb860a1a129a
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53c236fa-c554-49c8-b648-f11ff0f4c5f9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2c7fec7-d62e-429d-bf88-26b582c41d02
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ad4814-be66-4584-a9de-289a9e5a8644
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fff5742-77f5-4f1d-9cb2-8dd1c89b3deb
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b11b1350-5282-48cf-a9eb-079e73946038
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf8afa6d-98c0-46d8-b1c3-c73858bd9bf3
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3921da58-758f-4a46-90dd-249b16569784
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82546ac3-5d5c-4180-9b68-12007936116d
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9165ec1b-551b-4836-833d-6b1499307ff6
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b43e329a-5975-47dc-a056-863965ea132e
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RJECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3feadcf8-22df-411a-9a6c-497126c713f0
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a2396ce-d18d-49de-9154-4bdeb1aa8cbe
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: POCAR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ede737b-3b22-49fb-8fb2-4eb7112416dd
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1515d9db-e915-4395-a821-ca3e6e214e25
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RETYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9329c99d-1236-4ba8-8a8b-1c7ac975df01
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea590669-7b3d-40a7-98bb-8ef5e5f3d8e0
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6898272a-7c31-4ab9-80b9-b71be42c8aca
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db8e2384-39e5-4e40-b556-4cd9b460c192
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_CONTACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64364c31-3aee-4a6b-b071-13b1754b6d57
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 201e8c27-a740-4c48-ac60-967e8c1b90f9
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_CONTACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abca1e41-da43-4a87-897e-f1cde7a775c1
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac2ee252-9833-472d-a8f2-bfebaa77bfbc
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUSP_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35d8a89d-adf4-44e3-bf3b-28dbdfae30a2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 889656ec-b935-4aca-a0d1-e41a8a5b69ad
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUSP_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70166445-4150-4220-8304-7d8836bde095
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cecdb976-8398-4ae1-b539-77042032779c
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SUSRS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d17a9bd-3e16-4a4e-ba67-6b7d1b15ae4f
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a0305e5-2975-4425-89f0-463afc0ada55
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RQURG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79e2efdc-6eca-4d79-a11a-90b8b496e893
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e38c0b31-1138-422f-8b9f-2da02415845f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AUSTS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4193ddcf-5a59-4747-aa8d-f2fe3abb0779
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 283ad2e2-4a7a-424e-9b15-40696bc9493b
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: AURQS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d2ce8d5-5d53-485d-bef9-ece735ff4cf9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb9b4e79-29ec-4ca5-ade8-26b3df272e67
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CNSLT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48d71369-f128-422e-847f-b60895aa1dc1
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e5f3d34-cece-4f99-b0e0-1be12bb19396
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a10881ec-5b84-4bee-89df-dc3401831a9d
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33cb8480-f42b-4d4a-9b51-5b2a8420ed4d
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0e93d68-4049-4bd3-aaf1-6478fbc2c3ad
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1e01cd5-5593-46de-aed3-3b8a8b972cf7
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4915849-dbef-4f19-ac98-420a0c7918a2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79e2631c-aee1-402f-a44b-7298db602683
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICAL_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26437200-2074-44e0-b446-6d6fc3550723
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7935ff2d-f586-42be-99bb-aedb3885bbc5
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5280228-c77a-4c44-ae3c-6dda54759c0f
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60a239ab-eb5c-4775-9a39-9fc4bc78576f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fb73b91-6f38-40bb-9716-841aed29d0b4
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48030b8c-9161-48d0-9176-f505b70ce15b
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7066f7a-f7c1-4eb4-ba52-82f4cb39659e
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 670d504f-663d-4001-910e-a968df7f999b
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: IFNULL(NULLIF(LTRIM(RTRIM(ds_pims_referrals.acc_number)),''),'None')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61cb9299-5fce-48e2-a0ab-93cc83e8d147
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO_DERIVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: IFNULL(IFNULL(LEFT(LTRIM(ACC_number),20),LEFT(LTRIM(ACC_claim_number),20)),'None')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: beaf1937-75df-4cb1-b88e-8a53d6d0fe1f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_VALID_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: |-
              CASE WHEN (LEN(LTRIM(REPLACE(acc_number,'/',''))) IN (11,10,8) AND ISNUMERIC(LTRIM(REPLACE(acc_number,'/',''))) = 1) OR (LEN(LTRIM(REPLACE(acc_number,'/',''))) IN (7) AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),3,5)) = 1 AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),1,2)) = 0) OR (LEN(LTRIM(REPLACE(acc_number,'/',''))) IN (11) AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),2,10)) = 1 AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),1,1)) = 0) THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0db70d79-89f2-4e95-8a87-d0fb525dcb8f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: INSURER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: LEFT(RTRIM(LTRIM(acc_number)),20)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6255f8a-2511-4e91-91e5-1b90779e5b94
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCAS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 830d35be-48e5-4cd3-bc2c-63bae1e30d69
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0bc320b-07aa-49d1-8da5-fdf3b71aba97
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ba09b0-2df4-4fba-a805-a49f2822c261
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dc0c3fe-8de9-4613-8f3c-c6082978bc2e
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_WARD_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54e00323-9627-48e6-928b-521cd5d366f6
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88566056-0530-4493-92f3-23f3c38901ec
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLMAS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 561ad531-e2ca-44ac-a06e-1c5352bbb166
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 012e33a6-640c-4c00-8551-8434950b1be6
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLORS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 520b0bc1-57bc-4efb-a31d-884e07b40b46
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6895889-d580-4b6d-ad2c-5b5e7a3424d6
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONSE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c87c9b1b-9af2-4b69-b88d-9e866fdd6567
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d79c9007-8729-4e83-b4b7-4ed7a5af47f4
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFOTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69de05e5-9e53-4971-94ee-ecce4699a8d5
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca2189fc-d003-441d-8e59-1b3e0a504141
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROGR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 165b8f36-7fb0-4170-99e0-18ec6ad7554a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e61c8b8-6d0e-4501-b8c0-b39fb3018396
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 101eeecb-cab1-4fd0-9d4d-1440996a134d
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab7c69b0-5dfd-45d4-9299-a667e6b1265f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFVPD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12f14f0b-740e-423a-872e-6f19e4e7edf2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cffb7cd-412a-4490-8eac-cbc875ff68b1
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SUBPR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd5b5997-251f-4b71-8c57-0f93ba2d7627
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2ce8557-bc99-4003-a6a9-e8407da3a104
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ecddc2e-10fd-4d81-bc00-ba480c92fd47
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ffc84b9-f245-4035-9815-19d682aad8ab
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 600c2568-61ea-4287-8e38-09d576abd668
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07c4e123-f28b-4e5c-a78b-e6d61071ee42
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_seq_num
        name: PATIENT_REFERRAL_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_referrals.patnt_refno ORDER BY ds_pims_referrals.recvd_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e4f516-ee22-4a85-bfa1-ee9389d80b1b
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_count
        name: PATIENT_REFERRAL_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COUNT(1) OVER (PARTITION BY ds_pims_referrals.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc731ea6-97b6-4652-b9d7-b715373c7546
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Waitlists associated with this referral
        name: REFERRAL_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da39fd7c-153f-4911-b412-629ade1aed60
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_waitlist_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4bfb35d-ac50-456e-9f61-3526797bd72e
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Emergency attendances associated with this referral
        name: REFERRAL_AE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ece5f080-9676-4edd-acb7-2ab6d5955a63
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_AE_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ec5ff6a-63e7-40e0-baf5-aaf1f5e81a75
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Appointment (theatre/contacts/outpatients) associated with this referral
        name: REFERRAL_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e05352e5-4147-4a28-b1d2-7aa04721160d
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_appointment_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89871685-ffd8-4efa-a49c-61885a61953f
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Admissions associated with this referral
        name: REFERRAL_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb12b639-fbf8-4620-aa22-9dffec28d552
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_admission_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd805292-d9ce-4bed-8a50-ad28414bb7c4
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excluded wailtists associated with this referral
        name: NPF_EXCLUDED_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b925f831-a16a-4830-be1c-ac0c037119de
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(NPF_Excluded_WL,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 823cbc0c-5e85-4042-9787-9b19e20e9d4e
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Suspension wailtists associated with this referral
        name: NPF_SUSPENSION_EXCEPTION_WAITLIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d748a4ef-d7f8-42ee-b360-1f54bec91ef4
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(NPF_Suspension_exception_WL,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ca3e810-8025-474b-a22d-4061dc53bcd2
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ca1a9cd-8411-404c-92ab-490295ef9674
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e9ad04-e11b-4642-9dc7-2b9977ca4f89
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9875e262-5e02-4b86-a2a9-30c6a19697b9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f30214-ca34-476e-a329-4426b9c6dafa
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbbfe493-c681-41b8-86ab-60ac638d6d9a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d55b4b60-d513-4d39-aacc-64ed3244014b
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b59a6ae-2cf6-452d-a0a0-a32973529e4b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15becb64-ee62-475f-a42b-49728dba0671
          stepCounter: 9e22a016-7a78-442e-a74f-dd546f65f8fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_REFERRALS
        join:
          joinCondition: |-
            FROM s_shared_referral_05
              JOIN ds_pims_referrals
                ON s_shared_referral_05.patnt_refno = ds_pims_referrals.patnt_refno
              JOIN [ds_pims_patients]
                ON ds_pims_referrals.patnt_refno = ds_pims_patients.patnt_refno
              LEFT OUTER JOIN [s_referral_activity_05]
                ON ds_pims_referrals.refrl_refno = s_referral_activity_05.refrl_refno
              LEFT OUTER JOIN [l_mappings_referral_reason]
                ON ds_pims_referrals.reasn_refno = l_mappings_referral_reason.RFVAL_REFNO
              LEFT OUTER JOIN [s_specialty_1]
                ON ds_pims_referrals.refto_spect_refno = s_specialty_1.specialty_reference_no
        name: S_SHARED_REFERRAL_10
        noLinkRefs: []
  name: S_SHARED_REFERRAL_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
