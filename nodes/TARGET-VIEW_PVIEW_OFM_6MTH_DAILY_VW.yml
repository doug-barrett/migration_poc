fileVersion: 1
id: acdaef22-aff1-4000-8077-20a8cd41fe6b
name: VIEW_PVIEW_OFM_6MTH_DAILY_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afd83fad-470c-4a27-81ec-52b2eeff6caa
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SITE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab60f979-fa29-4562-a432-30afc86848e9
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e275f143-edb4-436c-96ef-21cb3fe30a4b
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SITE_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47f8a18b-1555-41b2-9a09-2de136944f7f
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a08a374-31fc-491c-8b7f-20aa5bd200d9
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RAW_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1290f71-9e1a-4a4f-96e7-54d805d250ef
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe76bf44-8ea2-40e4-9ef6-f487063298ec
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SITE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95c2cf95-a591-4eaa-a9a3-21d8661dde91
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DATE_STAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b30f15f-461d-4906-99ca-18c94f9d021d
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96e7a309-45e0-44a5-8944-0d18abc4ecf5
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TUBING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10af379-bdbe-42bc-b41b-1fb7bb49e843
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b45a8ae-4ee2-427f-99f2-3b45c61718bd
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f47f5cce-108b-472c-a43a-5bc2d2562aa3
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28d54426-bf73-4acc-8143-c1b11c4bacd1
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CASING_FLUID_LEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6abeb42-2ee8-4735-bb33-32bc6d65773f
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: PIPELINE_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 184d7e78-6155-44fe-b2a4-a8a7752ca2d9
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: PIPELINE_TEMP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8e6cffd-54cf-4569-8ab3-19520eee07bc
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WELLHEAD_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e454f3a-d3f2-4583-b2cd-40ab96ad3ba4
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 917b7216-2f68-4bc3-932f-8de0c9d13e5e
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WELLHEAD_TEMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa908fa1-56f0-4d76-b4bf-b22cfcb1edba
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d26e96cf-f475-4ee3-b487-7d9c3d487009
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: WATER_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaaa81a0-c337-4975-abdf-79b5f0e60069
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: MANIFOLD_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6855c27e-feb3-4502-8bbc-d453e67051e0
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: MANIFOLD_TEMP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c7ca22c-c5ac-4ce0-ab5a-8a8370d317d4
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07b15b03-23c0-4b55-b2de-ce0997f6d260
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4031ff4b-6739-48c4-8325-b6680b93d351
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a8bf3e0-4605-42d8-952d-e12b80f99266
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e6880fa-1efb-4c07-8576-fbead232044b
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f342daf-352b-4bba-8d23-2cb8e4272900
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80321e3c-ce1b-40b9-b13b-999f8c9e0475
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CONDY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd7cb6f-3240-43b7-8466-e1f54574e4db
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14138f5b-e470-4c09-971f-c5dec86d281d
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8f6ae1-15cb-4bad-b309-5020a5336519
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4299ee40-0fbe-4151-baab-4017323aa2ff
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: INJ_SOURCE_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d11edc1-6d8c-4b3e-9a73-6b80565442cc
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90040229-c62c-42c9-bb07-2139dea4c0cc
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9beb3333-8623-4342-a88b-d50a0624f43e
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ae1142c-f798-421f-9f15-3d9839a4bc92
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56af0ab0-f80f-4382-9236-5939ab19ee61
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63084343-fd43-47f2-ad5e-b536abe68889
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54555480-95db-4e0a-a90c-3012c6af9ed3
          stepCounter: acdaef22-aff1-4000-8077-20a8cd41fe6b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_OFM_6MTH_DAILY_VW: acdaef22-aff1-4000-8077-20a8cd41fe6b
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_OFM_6MTH_DAILY_VW') }} AS SELECT c.compidb SITE_NAME,
                   c.completionname SITE_UWI,
                   c.compida RAW_UWI, /*producing 1 injecting 6 */  NULL AS SITE_TYPE,
                   a.dttm DATE_STAMP,
                   a.durop * 24 HOURS,
                   p.prestub TUBING_PRESS,
                   p.prescas CASING_PRESS,
                   NULL CASING_FLUID_LEVEL,
                   0 PIPELINE_PRESS,
                   0 PIPELINE_TEMP,
                   p.preswh WELLHEAD_PRESS,
                   p.tempwh WELLHEAD_TEMP,
                   0 WATER_PRESS,
                   0 MANIFOLD_PRESS,
                   0 MANIFOLD_TEMP,
                   a.volnewprodallochcliq OIL,
                   a.volnewprodallocwater WATER,
                   a.volnewprodallocgas GAS,
                   a.volnewprodalloccond CONDY,
                   a.volinjectwater INJ_PROD_WATER,
                   0 INJ_SOURCE_WATER,
                   a.volinjectgas INJ_GAS,
                   a.volnewprodallochcliq + (a.volnewprodallocgas * 0.9400516) BOE,
                   a.wihcliq WI,
                   (a.volnewprodallochcliq + (a.volnewprodallocgas * 0.9400516)) * a.wihcliq BOE_WI,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday a
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON u.idrec = a.idrecunit
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON c.idrec = a.idreccomp
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompparam p
                ON p.idrec = a.idrecparam
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompfluidlevel l
                ON l.idrec = a.idrecfluidlevel
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = a.idflownet
             WHERE UPPER(h.usertxt2) = 'FRANCE'
               AND a.dttm >= ADD_MONTHS(CURRENT_DATE(), -6)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_OFM_6MTH_DAILY_VW
        noLinkRefs: []
  name: VIEW_PVIEW_OFM_6MTH_DAILY_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
