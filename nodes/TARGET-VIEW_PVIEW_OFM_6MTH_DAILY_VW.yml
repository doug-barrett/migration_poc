fileVersion: 1
id: e7d936fe-a1d2-4436-8d72-cb11399c718a
name: VIEW_PVIEW_OFM_6MTH_DAILY_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e678426-7147-43dd-9efc-d58b6e4966ba
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SITE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 418a4507-283f-480e-8896-277ab99e1f5a
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f18d6a1d-08a5-4e8a-96e2-901c38b12546
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SITE_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b96ba6-fa62-4c0f-b013-fdbeffce9ce2
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 467d68bc-773d-46c4-9f3e-42d84d95be1f
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RAW_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5e40fd0-90ca-4e1a-af76-c2351d769584
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79c3d771-e5cd-43f5-ab7b-506d64762f59
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SITE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3e9c856-445f-4827-91a2-efb0c39b8ff6
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DATE_STAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d10e84c0-9f6d-4987-9778-ebc6b1d0281f
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e86f8e6d-b0b3-4293-b817-0ee907c8b201
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TUBING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee6f2c1-12c9-4465-b37b-154bba143d3c
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 857e0743-8f7e-4b9b-b91f-5e1d4351a2ad
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cc4c5c0-41bd-4baf-9231-65a7b10166d3
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 286b15df-6966-4c84-8add-79f67710b9a4
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CASING_FLUID_LEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e49ffdc6-4677-47b1-89a0-fbbccb04968f
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: PIPELINE_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ab3f40b-df81-4a88-96b2-5d1ad124b510
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: PIPELINE_TEMP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e86edf33-ba67-42d8-85a5-24e3e66a232b
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WELLHEAD_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e39e0f91-da22-4c5f-a206-240e833d3a8f
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19eeea9a-a09e-4e4c-8064-c1912ad8eb2c
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WELLHEAD_TEMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7367603d-5cef-4b08-94a3-cf6e7cb8699a
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c36d66b-bbed-44d2-b693-d9a7edf8a39f
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: WATER_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49528e2a-9e70-40c2-8bc9-8ba27dce15da
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: MANIFOLD_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec1110bd-4c26-45b3-93fb-0c28b3531efe
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: MANIFOLD_TEMP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 599c6d82-3dfb-43f8-98e8-2604445aa6be
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac26252-e9d5-4ac8-995d-04e038fcf25b
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a315384-053b-42f6-ba4c-8a67c1ccde4e
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d150863-195c-46f9-b422-962623c38c57
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d8ae114-aabe-476f-8fe8-e11df4dcb302
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed079b9e-40b2-4ef1-a22a-2af799344a29
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bab6ee7-5002-4cbe-bcb7-10c34f22c5fc
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CONDY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5839b94-93f3-48a5-80b9-9758740db524
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0004b540-faa0-481b-9f38-1c7bcb5e4094
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7984656-93a2-45f4-8fc0-3e4f11df74e8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56f04fca-f23a-485d-9aa5-154b8c4b50c8
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: INJ_SOURCE_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10767931-8f47-4499-b11a-21cefae96c06
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb6415a-5401-4be1-a750-7dc668fa02b5
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbb92b8e-69d7-40bf-a7f6-97da81da6d07
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 389b0938-8932-4ec0-b3c6-1e5cd5b09af7
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1025f801-aa3b-4996-9bb3-4e2358493c31
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c42bd35-5c1a-41b6-a37c-b2d68912c3ad
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad69f612-abe5-436f-a22d-6596240adbe2
          stepCounter: e7d936fe-a1d2-4436-8d72-cb11399c718a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_OFM_6MTH_DAILY_VW: e7d936fe-a1d2-4436-8d72-cb11399c718a
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_OFM_6MTH_DAILY_VW') }} AS SELECT c.compidb SITE_NAME,
                   c.completionname SITE_UWI,
                   c.compida RAW_UWI, /*producing 1 injecting 6 */  NULL AS SITE_TYPE,
                   a.dttm DATE_STAMP,
                   a.durop * 24 HOURS,
                   p.prestub TUBING_PRESS,
                   p.prescas CASING_PRESS,
                   NULL CASING_FLUID_LEVEL,
                   0 PIPELINE_PRESS,
                   0 PIPELINE_TEMP,
                   p.preswh WELLHEAD_PRESS,
                   p.tempwh WELLHEAD_TEMP,
                   0 WATER_PRESS,
                   0 MANIFOLD_PRESS,
                   0 MANIFOLD_TEMP,
                   a.volnewprodallochcliq OIL,
                   a.volnewprodallocwater WATER,
                   a.volnewprodallocgas GAS,
                   a.volnewprodalloccond CONDY,
                   a.volinjectwater INJ_PROD_WATER,
                   0 INJ_SOURCE_WATER,
                   a.volinjectgas INJ_GAS,
                   a.volnewprodallochcliq + (a.volnewprodallocgas * 0.9400516) BOE,
                   a.wihcliq WI,
                   (a.volnewprodallochcliq + (a.volnewprodallocgas * 0.9400516)) * a.wihcliq BOE_WI,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday a
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON u.idrec = a.idrecunit
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON c.idrec = a.idreccomp
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompparam p
                ON p.idrec = a.idrecparam
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompfluidlevel l
                ON l.idrec = a.idrecfluidlevel
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = a.idflownet
             WHERE UPPER(h.usertxt2) = 'FRANCE'
               AND a.dttm >= ADD_MONTHS(CURRENT_DATE(), -6)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_OFM_6MTH_DAILY_VW
        noLinkRefs: []
  name: VIEW_PVIEW_OFM_6MTH_DAILY_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
