fileVersion: 1
id: 71e9e69d-7a72-42b1-87d7-51249a1a178d
name: STAGE_RES_RECONCILE_BASE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bd64b79-cb1d-4200-903e-4fc746609eb0
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9d16927-b100-487c-ac1c-9f683f5791d0
                stepCounter: 7983e4cc-6de2-4f85-aff4-c624178dea05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f376946-afbe-4e17-82f3-a94935cdd61a
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: OPENING_CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38281573-e118-468b-9c0a-eeee087e9a22
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: OPENING_CASE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f85d4c2b-5b60-43eb-b4b7-5b9f48da883c
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CLOSING_CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2b51360-90dd-469a-bbaa-ce2b787daa1c
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CLOSING_CASE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6813f0e2-9b2d-4ae7-a422-ce296cb1ef41
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0bbff8a-bc95-4569-88d8-a7efe05f2fb5
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 928f0c2d-4311-4d37-bb40-cc0f38e73e8f
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: REPORTING_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e99a7d9a-debe-4ba8-b0ab-1602a67ee68e
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02789f7d-63e5-4824-8acd-277d204b9952
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CODE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 129b3add-af65-4d36-805b-4154a1fe545c
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE_SHORT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20ba26ca-9f08-4f6f-adea-9db8375a5f5b
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ec0b12d-95c0-4f70-8414-362de748fbcc
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd20ff71-afd4-488b-b708-dcb359fa4da2
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4521934-b314-49f9-8913-52d18e163325
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37bd3bed-0f49-4354-8245-ddb10874dcfb
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7d4bbda-73bc-4a05-83fa-b1762e026ff5
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31880610-e714-4109-b90f-4a9b2084dfbd
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_FCOND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0af270a-4db9-42d1-98d1-b794758fc1c4
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8673e511-60af-487b-8f4f-5d3b3e120441
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d9d9cdc-1661-473f-9427-ec43bd472b3b
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 189c8a54-79ef-4abc-89ae-8eb0c1ae4b85
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc723169-b35c-49e3-80a3-665a676d515f
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1398e8b1-a44e-48fd-9da1-02492fad0e00
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d068db81-7f50-43b6-afff-959b76f2ae8f
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f68d434e-f7b7-41d4-93df-59985bd4c091
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_FCOND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c435baba-681f-4daf-bdb1-cac6f124b08a
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a143999f-ea0e-413f-bb19-df25068d650b
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3258f578-0670-48d8-a2a9-65e2505b208e
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c97ecb93-74da-4c73-8b16-fde53d6b33ef
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b60e3499-2023-49cf-baf2-4a89b939229b
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52613c36-0496-48ec-8897-30b4079c82ae
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6cd114d-5c28-40bd-99ed-8d91f58e1641
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f2627df-f43b-4fee-aedf-a237533ddc98
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_FCOND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ecca7e-caed-4e7b-98db-d1b0e222a66e
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48051e74-b508-426c-a5c5-6d5dbcd5320e
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(39,8)
        defaultValue: ""
        description: ""
        name: RI_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 809d4834-baff-4933-8e97-c2a9e5d2acd8
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(39,8)
        defaultValue: ""
        description: ""
        name: WI_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b511db8-06f4-4f46-a661-ab0dc19d63f3
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(39,8)
        defaultValue: ""
        description: ""
        name: NET_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edc91b09-e310-4de1-ba56-25cbee40a846
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8d4976f-fcd4-477e-8b31-92c85da9489d
                stepCounter: 7983e4cc-6de2-4f85-aff4-c624178dea05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aad6edb3-e234-457d-8e77-4dd9685068be
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf0cd311-ce7a-4f7b-a4b9-56282219f742
                stepCounter: 7983e4cc-6de2-4f85-aff4-c624178dea05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f29165ba-7ff5-4fd0-ada5-768498594765
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab770656-1925-41e2-a139-a81661fa2744
                stepCounter: 88e6c4b1-73ab-4e1f-b172-8b579c41b96e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c7830e2-ce3c-4663-9228-049d3dedb190
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: OPENING_CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dcf0068-1306-4a20-a574-b65a0eef88e4
                stepCounter: 88e6c4b1-73ab-4e1f-b172-8b579c41b96e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cbb068e-2cf3-4ef9-a301-9eb9adfca9fe
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CLOSING_CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1529d3aa-7e9a-411a-9675-3cf854381539
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41b2c0ac-2d17-48ee-8a2d-5ef7d6da5cbd
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RECONCILIATION_CODE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db756599-1ebb-4c96-9813-7cde5e3b1480
                stepCounter: 471f754c-2af7-49b4-99a1-98e5cfaa55ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5612c5a-a3bd-4330-ba10-1514a3ccd1a1
          stepCounter: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        config: {}
        dataType: NUMBER(12)
        defaultValue: ""
        description: ""
        name: RECON_CODE_GROUP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 008d4b19-a12a-413a-a4cf-1ea0ec2c2cbd
                stepCounter: 333c5525-87a3-4817-a65a-925c989448f7
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_RECONCILE_BASE: 71e9e69d-7a72-42b1-87d7-51249a1a178d
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_RES_RECONCILE_BASE') }} AS SELECT e.entity_name AS ENTITY_NAME,
                   oec.case_name AS OPENING_CASE_NAME,
                   oec.case_description AS OPENING_CASE_DESC,
                   cec.case_name AS CLOSING_CASE_NAME,
                   cec.case_description AS CLOSING_CASE_DESC,
                   rcat.category_name AS RESERVE_CATEGORY,
                   rcat.alt_long_name AS RESERVE_CATEGORY_NAME,
                   rrg.group_name AS REPORTING_GROUP_NAME,
                   rcg.group_name AS CODE_GROUP_NAME,
                   rcod.name AS CODE_NAME,
                   rcod.short_name AS CODE_SHORT_NAME,
                   SUM(rc.net_oil) NET_OIL,
                   SUM(rc.net_gas) NET_GAS,
                   SUM(rc.net_ngl) NET_NGL,
                   SUM(rc.net_fcond) NET_FCOND,
                   SUM(rc.wi_oil) WI_OIL,
                   SUM(rc.wi_gas) WI_GAS,
                   SUM(rc.wi_ngl) WI_NGL,
                   SUM(rc.wi_fcond) WI_FCOND,
                   SUM(rc.ri_oil) RI_OIL,
                   SUM(rc.ri_gas) RI_GAS,
                   SUM(rc.ri_ngl) RI_NGL,
                   SUM(rc.ri_fcond) RI_FCOND,
                   ROUND(SUM(rc.ri_oil + rc.ri_ngl + rc.ri_fcond + (rc.ri_gas/6)),8) RI_BOE,
                   ROUND(SUM(rc.wi_oil + rc.wi_ngl + rc.wi_fcond + (rc.wi_gas/6)),8) WI_BOE,
                   ROUND(SUM(rc.net_oil + rc.net_ngl + rc.net_fcond + (rc.net_gas/6)),8) NET_BOE,
                   e.ENTITY_ID,
                   e.ENTITY_TYPE,
                   r.RESERVE_CATEGORY_ID,
                   r.OPENING_CASE_ID,
                   rc.CLOSING_CASE_ID,
                   rc.RECONCILIATION_CODE_ID,
                   rxgc.RECON_CODE_GROUP_ID
              FROM DS_MOSAIC_RES.reconciliation r,
                   DS_MOSAIC_RES.reconciliation_change rc,
                   DS_MOSAIC_RES.economic_entity e,
                   DS_MOSAIC_RES.economic_case cec,
                   DS_MOSAIC_RES.economic_case oec,
                   DS_MOSAIC_RES.reserve_category rcat,
                   DS_MOSAIC_RES.reconciliation_codes rcod,
                   DS_MOSAIC_RES.recon_x_group_code rxgc,
                   DS_MOSAIC_RES.reconciliation_code_group rcg,
                   DS_MOSAIC_RES.recon_reporting_group rrg
             WHERE r.entity_id = e.entity_id
               AND r.reconciliation_id = rc.reconciliation_id
               AND r.opening_case_id = oec.case_id
               AND rc.closing_case_id = cec.case_id
               AND r.reserve_category_id = rcat.reserve_category_id
               AND rc.reconciliation_code_id = rcod.reconciliation_code_id
               AND rc.reconciliation_code_id = rxgc.reconciliation_code_id(+)
               AND rxgc.recon_code_group_id = rcg.recon_code_group_id(+)
               AND rcg.recon_reporting_group_id = rrg.recon_reporting_group_id(+)
               AND r.reserve_category_id IN (201, 203, 205, 221, 223, 225)
               AND r.company_id = 801
             GROUP BY e.entity_name,
                      oec.case_name,
                      oec.case_description,
                      cec.case_name,
                      cec.case_description,
                      rcat.category_name,
                      rcat.alt_long_name,
                      rrg.group_name,
                      rcg.group_name,
                      rcod.name,
                      rcod.short_name,
                      e.entity_id,
                      e.entity_type,
                      r.reserve_category_id,
                      r.opening_case_id,
                      rc.closing_case_id,
                      rc.reconciliation_code_id,
                      rxgc.recon_code_group_id
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_ENTITY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_ENTITY') }}
        name: STAGE_RES_RECONCILE_BASE
        noLinkRefs: []
  name: STAGE_RES_RECONCILE_BASE
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
