fileVersion: 1
id: 426ab230-3c05-4851-b68b-c28ec017048e
name: STAGE_RES_RECONCILE_BASE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51d6b09f-7a10-4fe3-b8bc-85d56f8cb83c
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2fc22e-f90d-4d39-a1a3-20b55bdc81b7
                stepCounter: fcfe2c3f-26a1-4593-9ae8-832f5b53c465
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04f09ceb-7603-41eb-8130-68968cdbfca3
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: OPENING_CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a6e7fde-8002-417b-aa16-546e8515b309
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: OPENING_CASE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8275e477-301c-4e07-94d0-14c908c33b17
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CLOSING_CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de7e8c82-2050-4e1a-a611-bd9865da4e08
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CLOSING_CASE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54df0a8e-c312-4da8-a76c-269fb862e5bf
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59041ba4-418b-4fc2-81df-df84871298e2
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1b37707-8c83-4474-8cd0-d29ffddc4fcd
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: REPORTING_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fea51f84-c626-45be-ba07-21e81cea17c6
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae723053-bdf5-4298-b3d9-62716e83d4b1
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CODE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 364f65ed-e45d-4f93-a228-5b9ff20e6124
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE_SHORT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a990142e-1200-43c2-ae96-97ae2325be41
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 809c8c9a-efe8-45a7-be46-eb8f8bb16223
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0953370d-d978-486e-9bdd-0c093d8ee40e
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0db96b64-6340-4e1f-8c02-da3f1b5dcc0e
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 861ec799-c94d-400f-b2b3-7b5eedfdaf15
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce5fb4e7-63db-42ef-a81b-55d3c5d06779
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e52d3477-1827-422f-b1d9-fa839a1c815f
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: NET_FCOND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87eeafeb-4314-43aa-aa9a-37f1386e18c5
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88872dc0-47f9-4303-840b-56cb7e5aec78
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d4630cc-514a-4d8b-9a10-3ebe262a258e
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dca019cd-09c6-400c-afd6-549884877c31
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2aa4029-8b8c-4f4d-a863-e36be640a4eb
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd33207-84e4-4d99-bbc8-9c3d974ceb0a
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ed9f0bb-a449-4940-88aa-2681ebbfbe8a
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dea7ebd-0924-4312-92da-fb4367f95cb9
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: WI_FCOND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d554ecfa-7bb3-4870-ad55-a793b98b6101
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6be99e4-b877-4373-a62d-5893327e68ad
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9306b046-6dca-4192-9581-6fd0daf776f3
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ff275d0-3a2c-41ce-b82c-e61868c66dce
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3a86954-e85e-4778-95bd-e2cd0996c003
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 021acdea-6f65-4bc6-8bff-7be28639ee74
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0284ea75-4f6d-4c97-99d0-c4daf6d33706
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5b42b47-a098-4722-a292-821e14b75745
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: RI_FCOND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91605ca6-f816-4839-8c05-82cdce79fcf2
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 642bc611-59e8-4fbc-a27c-1f6ab2907416
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(39,8)
        defaultValue: ""
        description: ""
        name: RI_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dee6b8e1-a1cd-42f7-80de-c7fdbba36802
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(39,8)
        defaultValue: ""
        description: ""
        name: WI_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a28051e-2f24-4107-973d-176c52f18e20
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(39,8)
        defaultValue: ""
        description: ""
        name: NET_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2384ca4-c3fc-45e4-8124-a51224a6341d
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e0b1e2-0b38-42d0-8bb4-64a03e306556
                stepCounter: fcfe2c3f-26a1-4593-9ae8-832f5b53c465
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baaeecf9-d706-474b-a945-da5cae0fa114
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cca84d1-9071-4699-803b-8d29831f9c15
                stepCounter: fcfe2c3f-26a1-4593-9ae8-832f5b53c465
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efc899fc-88f1-441a-8f3d-d7ec587b9fc9
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2035b97c-21cb-405f-8643-fc2811af500e
                stepCounter: 24a40fb1-804c-4a18-bca6-b0bcb9b200fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 170bef56-2ce9-44d3-9277-b30109ae7a9a
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: OPENING_CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da71b8bd-be82-4c96-a863-4bf8f53e9d02
                stepCounter: 24a40fb1-804c-4a18-bca6-b0bcb9b200fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74dc7d66-a952-4bbb-bcc2-b8038310e4dd
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CLOSING_CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1e2fa4a-1191-419c-a21c-83e0db378df0
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a02876c6-af4a-4f43-a80b-3b7885d82f2d
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RECONCILIATION_CODE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 359e4428-676c-4685-b941-8589da20357f
                stepCounter: a647f951-1583-4805-9319-03d03a1d0e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5c3ef2a-0ff9-42e1-9601-d5550b7037a8
          stepCounter: 426ab230-3c05-4851-b68b-c28ec017048e
        config: {}
        dataType: NUMBER(12)
        defaultValue: ""
        description: ""
        name: RECON_CODE_GROUP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99732cec-f333-439f-a440-7c74124e9e7d
                stepCounter: 32e28db1-93c4-4442-8201-342310c24b29
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_RECONCILE_BASE: 426ab230-3c05-4851-b68b-c28ec017048e
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_RES_RECONCILE_BASE') }} AS SELECT e.entity_name AS ENTITY_NAME,
                   oec.case_name AS OPENING_CASE_NAME,
                   oec.case_description AS OPENING_CASE_DESC,
                   cec.case_name AS CLOSING_CASE_NAME,
                   cec.case_description AS CLOSING_CASE_DESC,
                   rcat.category_name AS RESERVE_CATEGORY,
                   rcat.alt_long_name AS RESERVE_CATEGORY_NAME,
                   rrg.group_name AS REPORTING_GROUP_NAME,
                   rcg.group_name AS CODE_GROUP_NAME,
                   rcod.name AS CODE_NAME,
                   rcod.short_name AS CODE_SHORT_NAME,
                   SUM(rc.net_oil) NET_OIL,
                   SUM(rc.net_gas) NET_GAS,
                   SUM(rc.net_ngl) NET_NGL,
                   SUM(rc.net_fcond) NET_FCOND,
                   SUM(rc.wi_oil) WI_OIL,
                   SUM(rc.wi_gas) WI_GAS,
                   SUM(rc.wi_ngl) WI_NGL,
                   SUM(rc.wi_fcond) WI_FCOND,
                   SUM(rc.ri_oil) RI_OIL,
                   SUM(rc.ri_gas) RI_GAS,
                   SUM(rc.ri_ngl) RI_NGL,
                   SUM(rc.ri_fcond) RI_FCOND,
                   ROUND(SUM(rc.ri_oil + rc.ri_ngl + rc.ri_fcond + (rc.ri_gas/6)),8) RI_BOE,
                   ROUND(SUM(rc.wi_oil + rc.wi_ngl + rc.wi_fcond + (rc.wi_gas/6)),8) WI_BOE,
                   ROUND(SUM(rc.net_oil + rc.net_ngl + rc.net_fcond + (rc.net_gas/6)),8) NET_BOE,
                   e.ENTITY_ID,
                   e.ENTITY_TYPE,
                   r.RESERVE_CATEGORY_ID,
                   r.OPENING_CASE_ID,
                   rc.CLOSING_CASE_ID,
                   rc.RECONCILIATION_CODE_ID,
                   rxgc.RECON_CODE_GROUP_ID
              FROM DS_MOSAIC_RES.reconciliation r,
                   DS_MOSAIC_RES.reconciliation_change rc,
                   DS_MOSAIC_RES.economic_entity e,
                   DS_MOSAIC_RES.economic_case cec,
                   DS_MOSAIC_RES.economic_case oec,
                   DS_MOSAIC_RES.reserve_category rcat,
                   DS_MOSAIC_RES.reconciliation_codes rcod,
                   DS_MOSAIC_RES.recon_x_group_code rxgc,
                   DS_MOSAIC_RES.reconciliation_code_group rcg,
                   DS_MOSAIC_RES.recon_reporting_group rrg
             WHERE r.entity_id = e.entity_id
               AND r.reconciliation_id = rc.reconciliation_id
               AND r.opening_case_id = oec.case_id
               AND rc.closing_case_id = cec.case_id
               AND r.reserve_category_id = rcat.reserve_category_id
               AND rc.reconciliation_code_id = rcod.reconciliation_code_id
               AND rc.reconciliation_code_id = rxgc.reconciliation_code_id(+)
               AND rxgc.recon_code_group_id = rcg.recon_code_group_id(+)
               AND rcg.recon_reporting_group_id = rrg.recon_reporting_group_id(+)
               AND r.reserve_category_id IN (201, 203, 205, 221, 223, 225)
               AND r.company_id = 801
             GROUP BY e.entity_name,
                      oec.case_name,
                      oec.case_description,
                      cec.case_name,
                      cec.case_description,
                      rcat.category_name,
                      rcat.alt_long_name,
                      rrg.group_name,
                      rcg.group_name,
                      rcod.name,
                      rcod.short_name,
                      e.entity_id,
                      e.entity_type,
                      r.reserve_category_id,
                      r.opening_case_id,
                      rc.closing_case_id,
                      rc.reconciliation_code_id,
                      rxgc.recon_code_group_id
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_ENTITY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_ENTITY') }}
        name: STAGE_RES_RECONCILE_BASE
        noLinkRefs: []
  name: STAGE_RES_RECONCILE_BASE
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
