fileVersion: 1
id: 6b2574c1-9da6-4f34-a93b-333b4d0371af
name: S_SCHEDULE_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: false
  description: "Schedule Type (Code)   'CNTCT' = Contact  'NPBAC' = Contact (Non-Patient Based Activity)  'OTPAT' = Outpatient  'THEAT' = Surgical Theatre"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26f29f82-4140-417e-adfc-6f1178b5765f
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c35865a3-4db2-4b00-a1be-fb7db5cb0ad9
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48766b11-0329-42ba-809c-f85fe1c4ca2c
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70387e1e-9071-4921-aa98-40ccdcff546c
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SCHEDULE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'T'+CONVERT(varchar,ds_pims_schedules.schdl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94c7c9d4-0347-4b0f-a5d4-568a2d8b1fab
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b65aed4a-e590-4756-8322-2be1e17fbf75
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.patnt_refno,ds_pims_schedules_p.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2215b7d1-2294-4a37-8843-ec16f2f7574a
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.spect_refno,ds_pims_schedules_p.spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 497c12e7-4042-4709-882c-d79df1070134
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb414c3f-058b-4444-87ba-04965186d7d8
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.proca_refno,ds_pims_schedules_p.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22bbc94a-5ddc-4e36-b4f2-269a6908d014
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.spont_refno,ds_pims_schedules_p.spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c45396-b1f6-4ba8-bd8e-f716d29661a1
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_TRANSFER_TO_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06089368-6075-40b2-b4e9-05d6b1482292
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8784f6da-8e4b-493b-a639-0d0476f94be4
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 003f3e59-a862-4c8f-a95e-822507723516
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 402b238e-cc7f-44b8-bb52-2c0c38c05dc8
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c2bdba5-cb26-4b9c-a5bb-11fb70d3f0e4
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8592d92-6c76-4416-99bd-bf0bdb00a164
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(ds_pims_schedules.start_dttm,ds_pims_schedules_p.start_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2846468e-cad2-4eea-90e8-38cf6c71292d
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(ds_pims_schedules.end_dttm,ds_pims_schedules_p.end_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7191d79-216f-4432-8aad-50bed867ed8e
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7760975c-4aef-4ba1-b03c-aa9969eeb3a0
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2184c03c-bdd4-4b4b-bec5-c9bf612dc1c1
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26fd19d0-d946-4b1e-ad74-6103f3a58a3d
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e701544-d62e-4e79-bb5a-60ae8a320671
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8220e54-73d6-45df-bd97-050d35c8ac88
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fa0089b-c475-473d-87a5-f84f70fa20f2
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0be74daa-05c4-4573-8768-7340237aa3d4
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f15c4f8-aabe-438b-8618-001acd4b113f
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d4b5316-0e55-4ca9-8fc4-ef4d103bb12b
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afd984c7-9d83-4de7-9583-ba9f3a8f48b9
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5e15acb-4c4a-46f6-9792-d46491e4766a
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 483a1d03-bade-41f8-8eab-3e068ad812ba
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DECIMAL(4)
        defaultValue: ""
        description: ""
        name: MOVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29b95d4c-c01b-4c45-897d-b72addd5a37a
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12bb19e6-da1e-4a9c-a6f9-fdde08e8a7d7
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69dc7b0e-be31-49c5-b65e-b68f39e1691d
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          ELSE CASE WHEN ds_pims_schedules.start_dttm IS NOT NULL AND ds_pims_schedules.start_dttm > getdate() THEN 'P' ELSE 'A' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77c27f24-2a90-4b20-a076-d8754c020ded
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_outpatient_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_OUTPATIENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          WHEN ds_pims_schedules.attnd_refno = 11540    THEN 'P'
                          ELSE 'A'
                           END -- Attendance "Not Specified"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66e4e587-5606-4df6-9377-4a2c83dd4686
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL   THEN 'C'
                          WHEN ds_pims_schedules.arrived_dttm IS NOT NULL THEN 'A'
                          ELSE 'P'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d96c4c9b-3db4-43a6-aaf5-58f721b3e330
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29396645-e942-48d0-b029-560fc6bea38f
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc77897e-2798-4c0e-b51a-b9beae6c8dff
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 311cc3de-af0f-4f7e-a6fd-96bfbe4885ad
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb63622b-4781-4480-ae62-c6374515b93f
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d52ffc2f-1ec4-4e52-b5fd-c623f85994c4
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b877d342-c148-4bb2-b2b0-9030b5fdc4d8
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2fe52a9-1dcb-4ae3-9f8d-e8a48cb8650e
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be47f3d7-0429-4112-bdca-b3ec53d43a6c
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 932fbbf0-ac3e-43fd-afc5-6fd24dccdf5a
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 999e7cb5-fc02-462c-9b06-daec29f558bb
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OLD_SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6791d0b5-015a-44aa-97c3-57f15a4cf4c4
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75103506-ee96-4fac-8b62-06a58f43c72c
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCATION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20c4fc67-d99b-444c-9276-fdaf973ebe13
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98d4fe4b-4915-4de8-aa07-c4dca2b5f26e
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0cddecd-487f-4711-b052-4c7cf3985b17
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RESOURCE_UNIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c17bc1ab-8337-4002-b59d-2c68553026b0
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAFF_ACTIVITY_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a8d31e9-cefe-4e03-95ad-bdd5b2622a49
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eb8f28e-b869-4953-b903-c6dc71af8b85
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5e30f7f-e062-4aea-9577-012c89caef40
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d3fd019-24c4-4d2f-adff-1161c92ad5d4
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MOVE_REQUESTED_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 578b263f-63ac-4541-8601-b0d96922c79f
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42c150d1-6a71-46a7-bbcf-442bf8b113b3
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3279e07e-7377-46fc-a76b-41fb91f7d9c0
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d995ef4e-2b16-45cf-8039-52a834b11608
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LATE_START_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 441a63f2-5fcc-49ea-a528-6a2799db0453
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b28f565b-6b82-40dc-83c3-b0d6f9583b84
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 231d7d42-ae03-439c-a996-b0597f7080b4
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIETARY_REQUIREMENTS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99586c98-6f59-4026-a6d4-0281da172493
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab8fe656-3641-4c5e-995a-857cf84619cc
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5312794-9edc-4874-8cab-7c5789529ff0
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b633037-3f69-422c-b2c2-2bf2d9e77c7d
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0618be8f-b156-4de8-8745-9c66df7c9786
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30e3bd94-fea3-422f-b911-d6eb5edbcebc
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151f066c-b825-442a-87d5-83742a103735
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd3f6f89-9ac4-4e81-90e4-db6091843fb9
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed893697-f73a-4140-b464-1202c9b7811a
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e165054-3247-48dd-a4a9-3799265ee675
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfb03916-f02f-4e40-8e23-298d86a05ee2
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DATEDIFF(mi,ds_pims_schedules.arrived_dttm,ds_pims_schedules.departed_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0d7b607-3ab6-4d03-a193-02b6e13ff3e0
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(CONVERT(integer,ds_pims_schedules.duration),DATEDIFF(mi,ds_pims_schedules.start_dttm,ds_pims_schedules.end_dttm))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6de2bfd6-d55b-4033-80d2-345752575f22
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5625894-c09d-4c14-beba-eb2b68bc6520
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31491dd4-cb6b-4aa1-8f12-350141f1ab7a
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.patnt_refno, ds_pims_schedules.sctyp_refno ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe54cab1-6148-49d5-ba67-ff4506f75f3f
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.patnt_refno,ds_pims_schedules.sctyp_refno))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 832cfadb-5a5d-4349-8e33-057c29cc81fc
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY isnull(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d619c282-2598-4933-ab11-6175f9d9607a
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY isnull(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc10344a-7e9b-4190-8898-8047b864ce22
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Count of appointments on this waitlist
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: count(*) OVER (PARTITION BY isnull(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4f69d8a-92ab-4c07-b266-e4c71cc29c90
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.refrl_refno ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 740685b8-dee9-4381-8959-832ed397569f
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.refrl_refno))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63661af2-8ba8-40ad-85f0-711f33080e10
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11215202-b562-4580-adf7-12259c11325e
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9791b9f7-a384-4b15-bf4d-331b85ae36d2
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 100df9f6-8557-4346-a88a-ee05788fd199
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c02bf1d9-519a-4cc8-b2bd-dd94d6998512
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb3c107-adaf-4c19-9585-6fd26d95b352
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ((ds_pims_schedules.start_dttm IS NULL AND ds_pims_schedules.end_dttm IS NOT NULL) OR ds_pims_schedules.start_dttm > ds_pims_schedules.end_dttm OR ds_pims_schedules.start_dttm < '1984-07-01') OR ((ds_pims_schedules.arrived_dttm IS NULL AND ds_pims_schedules.departed_dttm IS NOT NULL) OR ds_pims_schedules.arrived_dttm > ds_pims_schedules.departed_dttm) OR (ds_pims_schedules.reqst_dttm > ds_pims_schedules.start_dttm) THEN 'DT'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17d9d0c5-ab1f-4ccb-8f4a-95f1241a0eef
          stepCounter: 6b2574c1-9da6-4f34-a93b-333b4d0371af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: UNKNOWN
            nodeName: DS_PIMS_SCHEDULES
          - locationName: UNKNOWN
            nodeName: DS_PIMS_SERVICE_POINTS
          - locationName: UNKNOWN
            nodeName: S_HEALTH_ORG_2
          - locationName: UNKNOWN
            nodeName: S_PIMS_PROVIDER_SPELLS
          - locationName: UNKNOWN
            nodeName: S_HEALTH_SPECIALTY_V
          - locationName: UNKNOWN
            nodeName: DS_PIMS_REFERENCE_VALUES
        join:
          joinCondition: FROM ds_pims_schedules -- LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_parent     -- ON ds_pims_schedules.parnt_refno IS NOT NULL     -- AND ds_pims_schedules.parnt_refno = ds_pims_schedules_parent.schdl_refno       LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_p    ON ds_pims_schedules.parnt_refno IS NOT NULL AND ds_pims_schedules_p.schdl_refno = ds_pims_schedules.parnt_refno          LEFT OUTER JOIN dim.dim_schedule_status    ON ds_pims_schedules.scsda_refno = dim_schedule_status.schedule_status_reference_no    AND ISNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_schedule_status.dss_start_date AND dim_schedule_status.dss_end_date       LEFT OUTER JOIN dim.dim_cancellation_reason    ON ds_pims_schedules.cancr_refno = dim_cancellation_reason.cancellation_reason_reference_no    AND ISNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_cancellation_reason.dss_start_date AND dim_cancellation_reason.dss_end_date      LEFT OUTER JOIN dim.dim_attendance_status    ON ds_pims_schedules.attnd_refno = dim_attendance_status.attendance_status_reference_no     AND ISNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_attendance_status.dss_start_date AND dim_attendance_status.dss_end_date    LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_SERVICE_POINTS') }}  ON ds_pims_schedules.spont_refno = ds_pims_service_points.spont_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','S_HEALTH_ORG_2') }}  ON ds_pims_service_points.heorg_refno = s_health_org_2.health_org_reference_no    LEFT OUTER JOIN {{ ref('UNKNOWN','S_PIMS_PROVIDER_SPELLS') }}  ON ds_pims_schedules.patnt_refno = s_pims_provider_spells.patnt_refno      and ( COALESCE (ds_pims_schedules.into_theatre_dttm,ds_pims_Schedules.arrived_dttm,ds_pims_schedules.start_dttm)   between s_pims_provider_spells.admit_dttm and isnull(s_pims_provider_spells.disch_dttm,getdate())  or coalesce(ds_pims_Schedules.departed_dttm,ds_pims_schedules.end_dttm)  between s_pims_provider_spells.admit_dttm and isnull(s_pims_provider_spells.disch_dttm,getdate()))  and s_pims_provider_spells.hospital_id = s_health_org_2.hospital_id  LEFT OUTER JOIN {{ ref('UNKNOWN','S_HEALTH_SPECIALTY_V') }}  ON ds_pims_schedules.spect_refno = s_health_specialty_v.specialty_reference_no  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }}  ON ds_pims_schedules.sctyp_refno = ds_pims_reference_values.rfval_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }} cancr  on ds_pims_schedules.cancr_refno = cancr.rfval_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }} attnd  on ds_pims_schedules.attnd_refno = attnd.rfval_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }} scsda  on ds_pims_schedules.scsda_refno = scsda.rfval_refno
        name: S_SCHEDULE_05
        noLinkRefs: []
  name: S_SCHEDULE_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
