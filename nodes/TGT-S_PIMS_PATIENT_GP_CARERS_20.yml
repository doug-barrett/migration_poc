fileVersion: 1
id: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
name: S_PIMS_PATIENT_GP_CARERS_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b74f7c0-ced7-44ca-b61f-747acf5f1b44
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b505b3c-0aa5-46d7-b36a-686525ed8755
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db5ed710-9106-412d-9b6a-eb4fef143656
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96028361-e141-4ede-8f15-c5fce9998d6b
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edfc1aa1-c7d8-454f-b0b9-65b8168323d2
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8daf146-159d-4ec2-bcc0-16664a5cefd8
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35eacf0a-3b31-41db-bf38-eb399e84d108
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DATETIME2
        defaultValue: ""
        description: ""
        name: START_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a55ca2c-e8d3-4268-bf6a-db7d88d04246
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d6351b3-18c1-44d7-9dc9-6848ed131e2b
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DATETIME2
        defaultValue: ""
        description: ""
        name: END_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca85574b-2e47-47db-a473-a029cb1fe318
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3dcd26b-6be3-48d6-bc64-a35cd0adc4be
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: PRTYP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c641136-4b91-4497-8c58-bc9d152e6952
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 762d46e4-edd3-4f8b-b761-a93b60273a92
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: PROF_CARER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b68728a-bb04-4a24-af0d-2615f8a30fc0
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12a711e1-65e2-4545-adc1-515d6aae1616
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: HEORG_REFNO2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 143d5bea-7910-47ff-960e-f5b53740ff18
                stepCounter: 17c84dce-a03b-4c07-9d04-50059451ddd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee0944c8-d1ae-428b-b961-626d77fc1b8c
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: HEORG_START_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37648fec-6d76-46f4-b187-2659bed808a7
                stepCounter: 17c84dce-a03b-4c07-9d04-50059451ddd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7310d5dc-4cc8-4874-9b98-29e527fee2d3
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: HEORG_END_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4db678da-315f-4b1e-9eaa-677842e45490
                stepCounter: 17c84dce-a03b-4c07-9d04-50059451ddd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c49eb479-9f0a-47cf-a9bc-b3462d54f641
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94cef180-84bd-4860-90c1-5c9f2654d5f0
                stepCounter: 4f45d370-f46b-4d30-8837-83a353835394
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e50c639f-eabe-4f1d-8be0-58ee37cdceab
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: FORENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f65f709-fdf9-4c02-9694-144ca82c8dd1
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64c21d59-942d-4d42-9dc1-b0d4e2e4f12a
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 133ae46d-cb86-40a7-bb03-62683342a697
                stepCounter: 81be095d-925b-4c84-a8af-f849ace73472
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 290bf911-81b7-4e50-8a77-c6aec80dfc35
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: GP_FULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: s_pims_patient_gp_carers_10.surname + ', ' + s_pims_patient_gp_carers_10.forename
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a63308ec-d4e3-49b4-97ea-8289d2455c4d
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ac4d23-904e-4722-8c85-b8601b2032b1
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5058b4b7-cf84-4650-a2ab-f7286e84cd72
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4faff0b2-80fd-4262-a296-a7a2c33d8921
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0496f723-3b83-453e-939d-8aaa82d4dad7
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8437e06b-b820-4ca2-85e8-99c6df35732b
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faedd556-6996-4034-b6c8-1850434a6d9d
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d7d795d-569e-43e2-bf0d-e240b2a31faf
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 919b2676-2ce3-420b-b12a-cd413df7429e
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9865e955-7ff1-4f1f-a324-9524b1bfe3d4
                stepCounter: 46e38d59-f2b3-442a-b66d-77cc64a7186e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d744a00-ff4f-456f-8777-edc1c234301f
          stepCounter: 587b6cd2-49c3-45de-85e5-04fcb0a82d06
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PIMS_PATIENT_GP_CARERS_10
        join:
          joinCondition: |-
            FROM s_pims_patient_gp_carers_10
              LEFT JOIN [dbo].[ds_pims_prof_carer_health_orgs]
                ON s_pims_patient_gp_carers_10.PROCA_REFNO = ds_pims_prof_carer_health_orgs.proca_refno
               AND s_pims_patient_gp_carers_10.HEORG_REFNO = ds_pims_prof_carer_health_orgs.heorg_refno
               AND s_pims_patient_gp_carers_10.START_DTTM BETWEEN ds_pims_prof_carer_health_orgs.start_dttm AND IFNULL(ds_pims_prof_carer_health_orgs.end_dttm,getdate())
               AND [ds_pims_prof_carer_health_orgs].archv_flag = 'N'
              LEFT JOIN [dbo].[ds_pims_health_organisations]
                ON ds_pims_prof_carer_health_orgs.heorg_refno = ds_pims_health_organisations.heorg_refno
               AND [ds_pims_health_organisations].archv_flag = 'N'
              LEFT JOIN [dbo].[s_pims_heorg_address_Postal_v]
                ON s_pims_patient_gp_carers_10.heorg_refno = s_pims_heorg_address_Postal_v.heorg_refno
               AND [s_pims_heorg_address_Postal_v].end_dttm IS NULL
              LEFT JOIN [dbo].[s_pims_heorg_address_Phone]
                ON ds_pims_health_organisations.heorg_refno = s_pims_heorg_address_Phone.heorg_refno
               AND [s_pims_heorg_address_Phone].end_dttm IS NULL
             WHERE 1 = 1
        name: S_PIMS_PATIENT_GP_CARERS_20
        noLinkRefs: []
  name: S_PIMS_PATIENT_GP_CARERS_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
