fileVersion: 1
id: f13ab146-fa73-4cfa-a39b-17265a0f597b
name: S_IN_PATIENT_EVENT_05_OLD_OLD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage in-patient events"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a8a98a6-2609-4fed-a02f-8ba72a837f3a
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c270bc2e-71d8-4fad-8764-a54fc2904c8e
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e6ef1c9-e386-4ca4-9d8f-d68da6ff5e56
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a8915d9-12d0-45e9-bbe9-4e9351f403db
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Specailty of the first inapteitn professional carer episode
        name: ADMIT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad927836-39a3-48bd-87fb-cdf1a84b44ea
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18f6fb10-48d9-4f1a-b298-d4bdc653c53e
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: event_service_point_code
        name: EVENT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd8b5dc7-5f8d-48f1-96e5-e9f85b2dc97c
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3ff4c90-3a0b-4098-a73d-23ac723d64c7
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: hospital_code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b060a5be-3e78-40a1-96c9-11a9b2f6d0f3
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c67e9acc-d026-49ca-80f5-3897e3fab817
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c859f23e-870e-43b1-a6e4-7ff0f4ff7626
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b081801-5bcf-4835-bb16-e1fd14c0eddb
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75ac8b2e-bd3e-4e53-8e8a-834bf7128d19
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfd358e5-689e-4542-a972-0aba002b02cf
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b34d68b-5774-4d04-9b2e-6dcf31224104
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_NZNHI_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4d8604d-145f-40fb-b595-c1aa8d4d5a06
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17156743-da0a-467c-9393-00d886a79fac
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98142f0-f261-4055-ad8c-581c6636e853
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc35cf0b-298d-4996-97ae-3a45e9e8e639
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57671e5a-a521-4717-8c4d-4b0329224116
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6149d8e-12a6-4599-8bbe-5f5c766ddc7b
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLEVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea465959-0333-4094-9157-56c9125fcfe9
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dff3a078-94bf-445f-b427-0a44851adf65
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edba5223-af00-4ce5-b051-f6295a039770
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a48bb34a-b2bf-4159-a050-c36471e2ea45
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b62a9bc-18c3-4d2e-b6eb-0375cfa0f466
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95d66291-91c3-46bf-adaa-b8b1db9326f0
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64610cc4-4007-48d7-88bd-90515563114a
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8b2b5f7-7566-470a-95aa-97247f68df02
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8107e57a-985c-4fc7-b0b9-789ef9205ba1
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: The date the patient was born
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26eedaaf-44af-4862-84a0-f54a1f996647
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd, dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_04.admit_date) < s_in_patient_event_04.admit_date THEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_04.admit_date) ELSE s_in_patient_event_04.admit_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a276ce3-e86b-4055-8d7d-3fe27dcd0068
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(mm, dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_04.admit_date) < s_in_patient_event_04.admit_date THEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_04.admit_date) ELSE s_in_patient_event_04.admit_date END) % 12)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd191730-3675-4961-bcd6-b428814b3aaa
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab61d7b1-aad5-4fee-a95c-79817bcaf404
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c85a5656-ddbe-40a0-bee3-2de68bd76d2d
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eaf600f-025b-44ea-9d8c-864a1bf48c0a
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0db5bcba-e004-442c-8b95-f4e4d947b8f3
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a232b05a-0506-49ae-b8b6-97d26fea8be4
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'R' + CONVERT(varchar, s_in_patient_event_04.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d286cb53-060e-4ae1-91e9-f9cdc08775aa
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08f4be2f-6137-4fd5-848f-6e707eae054a
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'A' + CONVERT(varchar, s_in_patient_event_04.aeatt_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06384e88-15e8-4441-a721-3fc6586bb1fc
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REGULAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dce9f18-5f4d-4bbc-bc03-ae7335ff3718
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c9a2024-2d47-4817-b42e-a5ff42306965
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bef5ae2c-aedb-4e25-babf-3fd1e9a8e6c9
                stepCounter: 3fdf4180-c40e-4f94-9cbb-852501d299b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d6b4a1-2403-47da-b63f-b752a89c2974
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37073ae8-1b14-4ec0-bbff-27ed107cd37b
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f39b861d-5ef7-4510-a46d-5f35167a1b26
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b111582b-d658-44f7-942f-6da15424fea4
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2451c26e-5550-4938-bc0f-80b3ccd2f748
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4315fee5-d72b-4ff0-8857-b65ab60238de
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GASTROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 797dd318-f7d0-4dc0-a784-36dc88734183
                stepCounter: c7e465fb-5e39-471a-83ed-fa1d84af350b
            transform: IFNULL(s_gastroscopy_v.gastroscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57511d40-b33a-42b1-8567-4eceee18ab15
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COLONOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78065313-cc33-4775-9b31-d66d35fa8c27
                stepCounter: 331bfe2b-b23c-40b7-ba48-ba184da8e020
            transform: IFNULL(s_colonoscopy_v.colonoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42666917-e126-41df-a36c-28ba48a61142
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CYSTOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 235cd63d-7888-4d8a-a65b-439b198e54c4
                stepCounter: 795446e9-9fb5-4494-a424-4697208d1f42
            transform: IFNULL(s_cystoscopy_v.cystoscopy_Flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cb815ab-1324-43c1-a0bd-fd9af9e29bbe
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a uncoded skin lesion
        name: SKIN_LESION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 234a0d7d-99ab-4ca7-b239-337e0e8114ff
                stepCounter: 752c13c7-edb1-4554-a80c-cdd62045c9b0
            transform: IFNULL(s_skin_lesion_v.skin_lesion_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d22ed097-62a3-47f1-84f8-480015b98c4d
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a colposcopy
        name: COLPOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa086d05-7933-4e82-b0ea-0c288d45f38d
                stepCounter: 7dfea076-f05b-48db-b9eb-20749ed7eb56
            transform: IFNULL(s_colposcopy_v.colposcopy_Flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6170000-299e-4d24-a2e0-6a48b6437235
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a bronchoscopy
        name: BRONCHOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cb8a2cc-f9d4-4471-9128-24c2641ddedb
                stepCounter: 2696bece-78b1-4c6b-a213-e9c34d475a94
            transform: IFNULL(s_bronchoscopy_v.bronchoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f45940-e6fd-43a2-9194-38940115bd7c
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a hysteroscopy
        name: HYSTEROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6ec790-b4fd-4995-a3b8-6d96820acd8b
                stepCounter: fb7dc215-cf5b-4db3-a85b-fe0d513dc822
            transform: IFNULL(s_hysteroscopy_v.hysteroscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32bb55c3-1a0c-425f-b3ed-8f6589bee67f
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FAST_TRACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed3bc574-c218-425e-8fb1-e126ddf3029f
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AGEBD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 055d3150-6fbb-497a-8db9-b78f60ea9c31
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NO_FUNDS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c4714e6-8d7b-46a3-9f23-b2a622d2fa04
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_START_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9194067f-ccdf-49af-a74d-f2ba62fbd313
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8edb2518-f92c-4497-8d66-b908b6f7d58c
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32964412-52d1-41f0-b96a-91eead8caa83
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1503b10d-2f51-405e-922c-704ca70bdbc4
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cec114b-9b1d-4e98-a03c-33b88976a7d6
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2854979-754f-40b6-b4ff-cd60f798dcaa
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DSINF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54257ad3-3bfd-4183-8444-5fec9900efac
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8edff235-7bb7-48ad-8685-2ff4f945f7f6
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55e16a1d-75d5-49af-8a3c-f6fd7d5f1efc
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GP_ADVISE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f305338b-02ee-4dfd-8458-13324b75014b
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b56ac64-e5df-4ac9-ab82-4c5403876c31
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MECH_VENT_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d680f3cc-4650-43cf-8a81-98bebb3fdadc
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AMBULANCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c83c0286-8c33-4c3d-a172-c631c16f28f8
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0689de-ea8f-4a16-9802-7960f5108364
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RELATED_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4382b147-307d-44af-ba23-af228434444b
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READM_REHAB_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4543335c-6220-451c-b899-c110529e2e3f
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd061e74-1b84-4944-98ee-5ed0495e5b6d
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 453263a0-5040-4175-8b28-bec7da850393
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f5767aa-808d-4df2-8f5c-5e5f9028b7fc
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHAB_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47bda292-762b-4368-8a8b-5460540add92
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe7ef84-1dca-487e-affa-fe3c1e92e15a
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 175419b8-65df-46da-8e0e-48bfc59544a2
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f6e8c6a-b20c-4b30-9522-15c66332156b
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 231a16f4-14e4-4699-9559-5be8f98c6c87
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8196d8d9-5d63-4340-b088-c37a60fd79be
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NMDS_EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbd0c0df-350d-40ec-9506-fb0f852f6485
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cc9fe6a-7735-46a9-a873-ff3d5cb7c081
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: |-
              CASE WHEN ds_plato_event_details.drg IS NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92fad4d0-cda7-4cdd-8c89-28df97e66e31
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4e773e9-2c28-4d0f-bb31-170981bfbbbf
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'W' + CONVERT(varchar, s_in_patient_event_04.wlist_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eea31ec-851b-4b20-bb02-c051647592f5
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Carer Episode Outcome
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c620adb-a647-48b4-8c36-4048e9109b51
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbfff9b7-6cdd-477d-aa95-451e49e98293
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e18871f-b5ba-4741-ad41-02bbc9d231c5
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DISCHARGE_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 567bbd76-4341-4956-be24-c4e752cc1ea9
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e8fe48b-ae74-4c7a-a617-9211a60b0abd
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Specialty of the last inpatient stay episode. Dsicharge Specialty
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60801db1-8265-4a53-97c6-4c45f91f73ba
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45e174c-eb7a-42b6-99e1-0f5aab799629
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10b5005d-1828-4235-88ec-453333a0f252
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09aff1b5-9bd3-4618-8130-511df0b062ba
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 153c73dc-f731-43e8-9540-7e2a583b3d4d
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9afcc098-3dc2-487d-8912-87efc7633a16
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Sets up the SCBU flag based on DRG. Flag is adjusted depending on whether a patient passes through SCBU too.
        name: SCBU_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: |-
              CASE WHEN REPLACE(IFNULL(NULLIF(ds_plato_event_details.purchaseunit, 'EXCLU'), ds_plato_event_details.excludedpuc), '.', '0') = 'W06003' THEN 'Y'
                          WHEN s_in_patient_stay_05.prvsp_refno IS NOT NULL                                                                                   THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05e4bb4c-cd2c-485b-97d8-9fb2e00e8994
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if one of the ward stays for the event is SCBU
        name: SCBU_WARD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc57cb3b-ddad-41e0-aa89-1499f506679b
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: IIF(s_in_patient_stay_05.prvsp_refno IS NULL, 0, 1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52989d68-421b-43ff-b55a-9fcc1dd8b447
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY s_in_patient_event_04.patnt_refno ORDER BY s_in_patient_event_04.admit_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7204ae45-246e-4ae2-b2d1-f522891fa01a
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COUNT(1) OVER (PARTITION BY s_in_patient_event_04.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a7c011-42f8-4a95-ad3e-9fd0239056f3
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f075080a-6213-4977-b08c-ccb9b2991c58
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc2eb409-7338-42fd-883a-d26358999e58
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e07a509f-1d07-4089-95de-c4f5476bd0a8
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3128851-a40c-455e-bbd7-3077cb4af415
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a9fd0b1-8d70-4a9b-aaff-7490bae9c3ec
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de6a7f94-2e9f-4ef2-97eb-88a7041af0da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 359b060c-d5c2-430f-bb4f-8395aed1cb52
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 825a0fbe-d2ca-442e-8e51-3d2c9ff9b8da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8644a7b1-6ee4-4f65-a940-82b46a9f785d
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3267cd08-5fed-4f36-9f84-b284df240080
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22368a0d-f2bf-4bbb-a9f0-f7db3a39d13e
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PACKAGE_OF_CARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NULL --IFNULL(s_in_patient_package_of_care.package_of_care_flag, 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 841acde0-ab72-4e02-9f14-e21f4fbfe10a
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa0de52c-a209-4db9-ad22-7b5107c037dc
          stepCounter: f13ab146-fa73-4cfa-a39b-17265a0f597b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_EVENT_04
        join:
          joinCondition: |-
            FROM s_in_patient_event_04
              LEFT OUTER JOIN ds_plato_event_details
                ON s_in_patient_event_04.event_encounter_id = ds_plato_event_details.pimsencounter
              LEFT OUTER JOIN s_specialty_1
                ON s_in_patient_event_04.spect_refno = s_specialty_1.specialty_reference_no
              LEFT OUTER JOIN s_coding_gastroscopy s_gastroscopy_v
                ON s_in_patient_event_04.prvsp_refno = s_gastroscopy_v.prvsp_refno
              LEFT OUTER JOIN s_coding_colonoscopy s_colonoscopy_v
                ON s_in_patient_event_04.prvsp_refno = s_colonoscopy_v.prvsp_refno
              LEFT OUTER JOIN s_coding_cystoscopy s_cystoscopy_v
                ON s_in_patient_event_04.prvsp_refno = s_cystoscopy_v.prvsp_refno
              LEFT OUTER JOIN s_coding_skin_lesion s_skin_lesion_v
                ON s_in_patient_event_04.prvsp_refno = s_skin_lesion_v.prvsp_refno
              LEFT OUTER JOIN s_coding_bronchoscopy s_bronchoscopy_v
                ON s_in_patient_event_04.prvsp_refno = s_bronchoscopy_v.prvsp_refno
              LEFT OUTER JOIN s_coding_hysteroscopy s_hysteroscopy_v
                ON s_in_patient_event_04.prvsp_refno = s_hysteroscopy_v.prvsp_refno
              LEFT OUTER JOIN s_coding_colposcopy s_colposcopy_v
                ON s_in_patient_event_04.prvsp_refno = s_colposcopy_v.prvsp_refno
              LEFT OUTER JOIN dim.dim_admission_method
                ON s_in_patient_event_04.admet_refno = dim_admission_method.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_admission_type
                ON s_in_patient_event_04.admet_refno = dim_admission_type.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_event_type
                ON s_in_patient_event_04.inmgt_refno = dim_event_type.intended_management_type_reference_no
              LEFT OUTER JOIN dim.dim_patient
                ON s_in_patient_event_04.patnt_refno = dim_patient.patient_reference_no
              LEFT OUTER JOIN dim.dim_service_point
                ON s_in_patient_event_04.spont_refno = dim_service_point.service_point_reference_no
               AND dim_service_point.dss_current_flag = 'Y'
              LEFT OUTER JOIN (
                    SELECT DISTINCT prvsp_refno
                      FROM s_in_patient_stay_05
                     WHERE stay_service_point_code like '%SCBU%'
                   ) s_in_patient_stay_05
                ON s_in_patient_event_04.prvsp_refno = s_in_patient_stay_05.prvsp_refno --LEFT OUTER JOIN s_in_patient_package_of_care  --ON s_in_patient_event_04.prvsp_refno = s_in_patient_package_of_care.prvsp_refno
        name: S_IN_PATIENT_EVENT_05_OLD_OLD
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_05_OLD_OLD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
