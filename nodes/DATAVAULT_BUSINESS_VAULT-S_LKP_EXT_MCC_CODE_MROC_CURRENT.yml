fileVersion: 1
id: e8f487c6-1513-4f95-876b-26213f4c004e
name: S_LKP_EXT_MCC_CODE_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 106a707f-6ed5-4ef5-8174-95167e39463e
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_EXT_MCC_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90d5b609-8068-4588-aa00-dc56c2e3979a
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6174a714-1179-4f59-b238-c989f9e2533f
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: EXT_MCC_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7b80dcf-bc3a-411f-84e7-3e2169c00511
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb300e13-32e7-4cd3-a023-00c49c9704cb
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8de28637-67d9-4e31-afa6-8818c82e811c
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fd99012-9b8a-49b7-a65e-07014517006e
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: EXT_MCC_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98acb263-db87-4b91-b419-89701af0017e
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5672bbb2-f931-425a-a0eb-06490a8d49e2
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DEL_STS_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b59a91d7-7719-47e6-b1fb-5e2530214818
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db8eed1b-9102-4cae-9432-57611653b5b4
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 900c4b16-bf17-4e9a-96b6-d5e34105b1f9
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3fef783-6993-4dab-ba77-de224e9733ce
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff4dfe6-156f-4b03-abcf-73f1cee31381
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b76c508-3663-4480-863c-818513afc922
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8942702-52c7-43ba-b67b-ac5e93da7272
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2a252f5-3041-475b-b8b8-f8bdbeeb6ee2
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb67d6e3-9cbe-4e56-ac1e-1afef8d0e8db
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9be39d1-48c9-4b05-8664-7ab319a754b4
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 132f826c-ea64-4c38-bc65-55d9453847d7
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06308e56-f747-4f28-b108-078e65bf6c2e
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cae8c8d-d459-475c-8c30-35b78dde2479
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7628f15-2e76-4cef-9e8d-b55a4bef7de9
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaee2fd5-ca9d-4ad0-9925-5288696ff45b
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a41ed095-63aa-4e8e-b08f-f3e7b8b42181
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 817a893d-0f9b-4c02-b640-a8e432a29f4e
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 547629f6-1bc0-4180-bd69-7eae4f0c822f
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 527e74fe-2157-4237-822f-1750eb86b585
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f7816d-aefc-4fa3-a491-4adf9917fadf
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e006d93-f0ab-4a4b-b19a-ea21250ecd6f
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 031f3fd3-ff3f-4339-9926-b36b66a84ebe
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17ad0296-701f-480e-bc3f-7d74f6b3ae61
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d56cfbd0-b8fa-40cc-94b3-5f06c614b4f2
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3713ca29-2424-4114-b73c-e6542cb4c3dd
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ebe04d4-0f0e-43e2-98c9-7cfe84432c10
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb583a3e-c9f2-46ae-809a-148ae43493c4
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 098acc6a-bd51-44f3-bd69-378cb96f987a
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53808523-3067-42ae-98bb-2701f3952b7c
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1712c695-bcd6-4c2a-a398-1d2372d3a60c
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f4a042e-8889-4a40-bdad-f021510921da
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 936bea2a-370a-4283-96bc-2e94bfbb7787
          stepCounter: e8f487c6-1513-4f95-876b-26213f4c004e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec28dd99-2791-4794-b229-b63134d6ec27
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_EXT_MCC_CODE_MROC: 32bbcc38-644a-4540-807d-ecfb91a6e063
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_EXT_MCC_CODE_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_EXT_MCC_CODE_MROC') }} s_lkp_ext_mcc_code_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_ext_mcc_code,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_EXT_MCC_CODE_MROC') }}
                     GROUP BY hk_h_lkp_ext_mcc_code
                   ) curr
                ON curr.hk_h_lkp_ext_mcc_code = s_lkp_ext_mcc_code_mroc.hk_h_lkp_ext_mcc_code
               AND curr.dss_start_date = s_lkp_ext_mcc_code_mroc.dss_start_date
        name: S_LKP_EXT_MCC_CODE_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_EXT_MCC_CODE_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
