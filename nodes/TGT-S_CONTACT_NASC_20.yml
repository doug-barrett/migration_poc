fileVersion: 1
id: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
name: S_CONTACT_NASC_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33959fb6-e6d0-45e2-8fa4-82a88f9bd730
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca1c336b-4614-48b4-9e8a-2983cd82744c
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2c0f395-972d-4dd0-8878-242dbcfaac29
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96e0a090-540a-45fe-8e64-44edbf81f265
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3ec26ed-c067-40b3-97c0-06ed103bd142
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.contact_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 053b4d3f-1981-444c-8e87-b36b3974ad81
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dd79007-0423-414d-8fba-a8c65d9b3f1c
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ff69660-9a16-4177-8754-78e29964cb70
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed12a7d2-ec0c-41bc-88e9-6a4a66589ee8
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1921aba5-9336-4e0b-a617-dbb09445cd9b
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme_status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deaca730-b073-455c-bebd-717afac763b9
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65b6a3cc-86dd-4a67-8886-1e0782ebde46
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca16ff5b-ef38-4c83-b0ca-d210d74284ea
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7aeda13-6b8e-4cb6-92cf-df75cac9af2c
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0811ae52-37a3-4282-a845-87871316499b
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_AT_CONTACT_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_contact_NASC_10.observation_report_completion_date) < s_contact_NASC_10.observation_report_completion_date THEN IFNULL(dim_patient.patient_date_of_death,s_contact_NASC_10.observation_report_completion_date) ELSE s_contact_NASC_10.observation_report_completion_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22169c56-31cd-439f-bdd3-d98b6507f3b0
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.patient_age_at_contact_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2b2a1d7-54bb-46e9-84ba-5dffa2e5b1a7
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb101368-7b1d-43b1-b50a-cb625172d24f
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Inter District Flow Class
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469885dc-5bcc-4883-9cde-c89b07ac8997
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d81e0fb2-8b7c-4011-8d95-770bfcaea90c
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8b9a745-dc6e-41a8-9956-ce9cb0f65b4f
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_TYPE_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7efa1cc-f2e7-4b40-9ac3-33187a1390ea
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ac844f-a93e-4695-ad93-13f58d580200
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4ee1f6c-6917-4164-a367-caa0a25a6480
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: add72daa-a7b4-4e26-8815-5e843b8b2cd7
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.health_org_reference_no=dim_health_organisation.health_org_reference_no
        name: DIM_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78290bb6-3cd5-4503-8179-d1f65525ba15
                stepCounter: 0790fdf4-e815-4587-a9cd-954ea13f53c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 915b193b-c618-40b7-9cb9-0a073461bfc0
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39fd3f62-5bf4-428e-ae56-1956e96ac61f
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dff29ba-8370-45f3-8bb4-731428af2fee
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.seen_by_clinician_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d12dcd60-813c-473e-8442-ac1a3974db75
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44d1b2fc-58bc-4a23-ae57-dee6e751c3e9
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17d1d4dc-379f-4da3-b9c7-d5d9d016dc33
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0243254-9d01-4ecd-82b9-519976714e24
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cff0217e-5d79-4c5d-bd9a-b7332c94b874
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1edcecd2-30cc-4702-87f7-69cd615ef958
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2996450f-f36c-425c-a98f-5e43a5f75e50
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 147ff71d-7ed4-4e9f-9a15-fde056a21039
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aab9ac5a-ebfd-4bc5-a3b9-875022fcf1bb
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.provider_id=dim_provider_community.provider_id
        name: DIM_PROVIDER_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b90d7a-0e1c-4ff6-a2e5-e32763dfcbcd
                stepCounter: fe333361-f763-4fd4-b86e-f42e95e81344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5080f0e1-1884-480c-9cfc-48b5473e4489
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb5b8d1e-bb3b-45cc-b8f2-1b67a3d466ca
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc788bf3-51d8-4247-8096-4da705f05281
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e5d9a49-4548-49e8-bad7-5e76aa7b4c60
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf15c4ef-729a-4716-80c7-d6a8211aacfb
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.programme_role_code=dim_role_community.role_code
        name: DIM_ROLE_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acff4fff-07f1-43da-966d-53a96d429471
                stepCounter: ab48ab83-7613-4d28-acbd-ba81b413fe84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac66e05a-3686-4787-bd73-3332bb45ec11
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c27d0af4-98b6-4979-a5e7-c21ab2a2a8db
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 721b80cf-d13d-4516-b190-9dcec300b4be
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c61fde5-61fe-43a1-9dbc-93fbbe47943b
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8744bb6b-657d-4ca5-9909-ee021c447325
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceb111a0-5458-4d15-ba97-01db61c690e1
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19c710c9-f0be-4c47-88b3-28f14733573f
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contact_NASC_20.CONVERT(date,s_contact_NASC_10.task_request_date)=dim_request_date.request_calendar_date
        name: DIM_REQUEST_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 776fe4b8-0bb6-494d-a530-7fae3de7a539
                stepCounter: d1b797ef-4926-45af-a745-f75c3ed18b1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06e9b2ab-5172-43dd-97fb-b71d9d299a08
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62193a03-1293-46f1-a579-1bd61a1b6f57
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1c67b54-b87a-4238-ac6e-99dd50dbafb1
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_CONTACT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280a46e4-6875-4b9d-9c43-0b6167cf58e9
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: |-
              CASE WHEN s_contact_NASC_10.referral_contact_seq_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4b64ff7-de44-4ebe-b19f-a39f30f70ea8
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CURRENT_CONTACT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280a46e4-6875-4b9d-9c43-0b6167cf58e9
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: |-
              CASE WHEN s_contact_NASC_10.referral_contact_seq_num = s_contact_NASC_10.referral_contact_count THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 872f23eb-552a-435a-8e31-d070f4117910
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6efbd9bd-ee3a-4ef8-a2dc-32270049ff57
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dab9c6fd-d330-4e44-8443-d36916e73c76
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46bc6e92-af6c-471e-ad86-3a7087096164
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe906f07-8b34-49c8-b6b6-0923a7eac5ad
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc97620f-a2c0-45b0-8b9e-1e2e11ebabb1
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeeeec49-ec1e-4d9d-a7f7-9d06edec52dc
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONTACT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cc7b927-174a-49df-a299-828adf17dcb7
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6ad81b2-3c6a-4f5c-b958-6b3f21030951
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONTACT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b507160a-e6a7-4f81-853f-5b8d7d3d135b
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e91be53-d91c-46ce-8393-610b545229a3
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_CONTACT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280a46e4-6875-4b9d-9c43-0b6167cf58e9
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f43a4297-22f2-4357-b3a5-72b818550de2
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_CONTACT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5e017a5-8eed-49a1-a76e-fad5068d1cbb
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c229da4-4753-4137-a552-7f115a22df9c
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80fa566e-9aaa-4b1c-8cdb-83bd67f48e06
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a020ace-9ab4-48f9-b264-912132d08f45
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a3050a6-1152-4674-95d7-c8e415dafe49
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 711eb0ab-a1ed-48d8-8707-0c71501ea5d1
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_contact_NASC_20.create_user_login_name=dim_user_login_concerto.user_name
        name: DIM_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f2ac98-6185-439c-9a15-757698e43d58
                stepCounter: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
            transform: IFNULL(dim_user_login_concerto.dim_user_login_concerto_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58a2c093-b365-4ce7-a8ca-4cb35391e4ab
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PUCMAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbda39c8-8f43-4938-b96c-c24b3cec1aaa
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32de9227-343c-443f-ae8e-008cad8b586d
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contact_NASC_20.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: IFNULL(dim_purchase_unit.dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91527a87-dec2-4855-9845-8257c86e2588
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee713d32-5c27-4ecc-80e2-14461f3cbd3e
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20276bd3-f738-4134-868a-c883ccee333e
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e722663-977c-4574-b0ae-130d9c6494dd
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a15f51f-7a89-4a7a-b029-47beec3e3fce
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contact_NASC_20.replace(s_contact_NASC_10.responsibility_centre_code,'-','')=dim_responsibility_centre.responsibility_centre_code  s_contact_NASC_20.'120'=dim_responsibility_centre.company_code
        name: DIM_RESPONSIBILITY_CENTRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9a966f-0750-4c8b-a92a-a034376ca161
                stepCounter: a84cf165-8cc6-4510-8bae-53366e2d4ff7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18c1a0bb-fc2f-4b1b-adbc-b5583ca1b660
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DEFAULT_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15c5c3c5-bd22-4afa-8f31-2c37a89556c1
                stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
            transform: |-
              CASE WHEN s_contact_NASC_10.observation_report_status IN ('Completed','Finalised') THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf7e3b24-c4f3-45a8-8155-f4083f04bba6
          stepCounter: ffe7ae31-a9ff-4d91-9ff8-82716489f35c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_USER_LOGIN_CONCERTO: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTACT_NASC_10
          - locationName: TGT
            nodeName: DIM_USER_LOGIN_CONCERTO
        join:
          joinCondition: |-
            FROM s_contact_NASC_10
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_contact_NASC_10.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT OUTER JOIN dim.dim_purchase_unit
                ON s_contact_NASC_10.purchase_unit_code=dim_purchase_unit.purchase_unit_code
               AND IFNULL(dim_purchase_unit.validity_start_date, GETDATE()-10000) <= s_contact_NASC_10.task_request_date
               AND IFNULL(dim_purchase_unit.validity_end_date, GETDATE()+10000) >= s_contact_NASC_10.task_request_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_USER_LOGIN_CONCERTO') }}
                ON s_contact_NASC_10.create_user_login_name = dim_user_login_concerto.user_name
               AND IFNULL(dim_user_login_concerto.validity_start_date, GETDATE()-10000) <= s_contact_NASC_10.task_request_date
               AND IFNULL(dim_user_login_concerto.validity_end_date, GETDATE()+10000) >= s_contact_NASC_10.task_request_date
        name: S_CONTACT_NASC_20
        noLinkRefs: []
  name: S_CONTACT_NASC_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
