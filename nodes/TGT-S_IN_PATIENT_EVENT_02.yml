fileVersion: 1
id: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
name: S_IN_PATIENT_EVENT_02
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Get details of specialties associated with each event."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 213eb1cd-4107-471e-b82a-3b0c3decf637
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc57cb3b-ddad-41e0-aa89-1499f506679b
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fedfcd92-58c5-4bd2-82cd-41c5840ad774
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d71cef9-b29d-4789-9ddc-7323bb8d4560
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50a36581-95b1-4fb1-84f9-c0f53ad9b1c6
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAY_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2242de2-301a-4581-a13d-7f074201a25a
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1676a625-5694-4bb7-bd3c-a45611e330b1
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5a1e57d-a116-42f9-aeab-92b2bd78279c
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 996ddca6-f370-4ae5-b9b2-5726b4de6e0e
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EPISODE_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0091557b-7800-49c1-8b74-f7bbc1fdc2c5
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9575db12-31f5-447b-8ad1-f5021db268e5
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0091557b-7800-49c1-8b74-f7bbc1fdc2c5
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: COALESCE(s_in_patient_stay_05.episode_spect_refno, s_in_patient_stay_05.event_spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dadf0902-63f9-41c4-9cd3-ffe5c45be9ea
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: DISCHARGE_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 567bbd76-4341-4956-be24-c4e752cc1ea9
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bb2656d-9c28-46c7-8d5a-2cfdedced430
          stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_STAY_05
        join:
          joinCondition: |-
            FROM s_in_patient_stay_05
              LEFT OUTER JOIN s_specialty_1
                ON s_in_patient_stay_05.episode_spect_refno = s_specialty_1.specialty_reference_no
             WHERE s_in_patient_stay_05.event_stay_seq_num = s_in_patient_stay_05.event_stay_count
        name: S_IN_PATIENT_EVENT_02
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_02
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
