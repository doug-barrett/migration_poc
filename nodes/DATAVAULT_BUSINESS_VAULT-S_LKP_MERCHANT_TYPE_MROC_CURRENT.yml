fileVersion: 1
id: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
name: S_LKP_MERCHANT_TYPE_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b4f846f-3876-4adc-a8cc-ef9970402bcd
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_MERCHANT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9437e4e3-c236-4a3d-bc78-d1bbb2020cc3
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5dbfc2c-831c-4b6b-b669-e4a93745329b
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MHT_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbc80e68-aaa5-4b0a-b3fc-0f6acaba8e14
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef996ca6-2b4c-451f-a064-a041a650ac63
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e26e3a6-59cc-417a-8bc0-79b1ac22b652
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 536721f5-b17b-4e85-8b7c-ab3b86b00d16
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06aeb87d-ac4b-4098-a24d-cb1f3e1f264f
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99b32b58-8a1c-4feb-ab0e-7dd5586ddf98
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MHT_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0efa7430-3a90-4636-9870-eddf21a883e6
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 925a7d9a-7037-47b0-8211-fa4a587e7996
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: DECIMAL(38,5)
        defaultValue: ""
        description: ""
        name: MHT_TYP_PCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 815bf2f4-82ea-4229-aefe-1adf3749d538
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 859e52e4-745d-4c70-8f3d-42bc4a388795
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe4598c7-a10f-4207-b2b2-f42c05cc1229
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ae8e756-a2b8-4b12-96ba-b7ffa15c4a80
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2abb6230-ce9a-4431-a580-1bdf726825c3
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33025088-68ea-4fc1-a8ec-63e2487a4b0e
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2fde18a-d9fb-4050-8197-6ffcc6003934
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a6d669b-30d4-4c21-8cc9-51201b4f48f3
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2185a5e9-ae8e-4d12-a605-e78fb887d30c
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81f41d99-906c-4422-b585-21143edb71f8
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8153b267-1813-412b-a1e0-9be409931e77
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d46cbae-ad5b-4841-880b-4e66daafb246
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393b6f6-22da-4194-8eb9-bb339817b63d
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de5db6fa-f3d5-4a1a-b586-ad8bec8a7c51
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7589fdd-ccc9-4d52-86c7-c3a6ba51b057
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b23b644-bf07-4f94-bf4a-5222c79807e3
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d3f5e77-dd45-4efc-8d1c-7159db7c219d
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e32ca39-869f-4632-9a9d-dd0f5921f63f
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d250fe0-08fa-41a9-a52a-8a9f1b398fcc
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f236ed25-d9f7-4fd2-b730-10462bcbe97b
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0527d016-459e-4f4d-b367-3c559def04e6
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1bdab9c-24c7-487f-8cbe-faea7d5df86b
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54436a45-56ce-4cb4-a732-08f9fb6a4032
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b11a0cb0-e198-4097-b516-6bec757a9221
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed77a035-4897-4936-af34-d1b604d007c9
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11884adf-c910-4d37-b289-2696381aae97
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb92407-5a5c-419d-b9c9-dd0b2721dc0c
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc549350-508e-4f61-b419-d0a4b330931b
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 709b25d4-b463-4703-8294-7674116dcd24
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9e903fd-f133-4b3f-acb5-d01631c78dae
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bb82f94-0cd0-44a0-bbba-d839d811bf21
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9c31558-eaba-468e-9ac3-e76946634980
          stepCounter: a8f7b155-87b6-4b25-9f5b-8c3fb788bf0a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a69abeca-8fb9-496d-9315-6e1eb03ada7d
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_MERCHANT_TYPE_MROC: 82c4ea10-525f-488c-8e17-c95a9da869c3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_MERCHANT_TYPE_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MERCHANT_TYPE_MROC') }} s_lkp_merchant_type_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_merchant_type,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MERCHANT_TYPE_MROC') }}
                     GROUP BY hk_h_lkp_merchant_type
                   ) curr
                ON curr.hk_h_lkp_merchant_type = s_lkp_merchant_type_mroc.hk_h_lkp_merchant_type
               AND curr.dss_start_date = s_lkp_merchant_type_mroc.dss_start_date
        name: S_LKP_MERCHANT_TYPE_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_MERCHANT_TYPE_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
