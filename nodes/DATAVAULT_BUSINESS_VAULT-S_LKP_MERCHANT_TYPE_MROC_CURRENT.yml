fileVersion: 1
id: 3e631251-6dd6-46bb-a661-257d34100644
name: S_LKP_MERCHANT_TYPE_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05ad95e9-9479-4754-8a4e-57caabeb9f5f
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_MERCHANT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27965cc1-fc59-47ac-b9fc-dafa09a33b8d
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50af4548-0d51-4c6b-88ce-565b9118cf54
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MHT_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 319cada3-4e6a-4c8c-99fa-6c87acc6455a
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bd4bed2-7744-44dd-9001-5c9cde249196
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b149f1ed-6865-4402-ac54-4ca05be8045b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b15a3561-fb9c-42ad-a095-aedbf73ee844
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bb0ef5c-d8b0-4636-a246-bda4453e2d1b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92a490b8-4791-49f0-851c-00cfbc7b93ac
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MHT_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 874d13be-8ed0-4879-99d1-ec3882a7746e
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ad7be0e-c098-4120-876a-0dea2856edc9
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: DECIMAL(38,5)
        defaultValue: ""
        description: ""
        name: MHT_TYP_PCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 078a7edd-785d-43d6-9257-80b53a724225
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55f1dca7-c58a-48c9-ab47-8d9d21fc80e0
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2a3cf49-3a6a-41dd-b329-a758ea7a269d
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 317c3dd9-6943-4595-9205-c6bb368a3dde
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1efc8e5b-91f0-4451-9c30-94027e46c87b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e6f5827-50d0-4025-8a09-a1d18b0d954e
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75775e43-c75d-4653-9192-16cb9a69d3f1
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bfb35f7-c4c2-4c28-a5e1-1184d8fc1303
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8fc4698-4532-421a-a94a-b63a10e91b15
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1506d90-50c8-43ef-87c7-fb615c1a9c7b
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26f9eff9-5d94-46a6-a498-2ea5c3dcf2a5
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4531ec34-f35d-4d9d-bfad-52982f42e1e9
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31f54668-5532-4745-b691-218f44952699
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39ed1445-c76e-4aec-84cb-44ed28a934e7
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24e41c45-2035-437c-9ffc-82c64126657c
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4cb80c4-9b0e-4d36-a99d-e44171165ce7
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3b357c9-33ca-47c9-a47e-44222d2d4e99
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0978ba6d-1b7c-4b4b-b7a2-a4dcc8fbf1a3
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fee38e08-96b7-4169-a227-9428f2bd721b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c25f587-5c36-4c86-bc5c-6a6a2220f56c
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bc8ca58-60dd-403b-8765-221943ad48f1
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 145f8361-124d-4d3c-9d3e-6b514ae397f3
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 633226d4-289b-4816-87c1-e2522def8724
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03b5c034-ed9f-4d42-a005-0f23bd0dfcc8
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d1f9a7c-07f5-48b3-885f-e280e3008ed3
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfbfc36c-79a0-4473-81f7-fb2e1fcb6186
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91e3e287-b0ef-4ad1-9b0f-c4a9b4ca67c6
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dab8268a-61fe-40ff-b1a6-317941202d31
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b555310f-a945-48f6-8b86-6b1f7b1019a5
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22a13eb6-17fd-4e27-98c7-8751db5bb60c
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00d585e5-dd13-44d0-b724-47c9f461a09d
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dff7ac82-b601-4b5e-9762-79a8067a7992
          stepCounter: 3e631251-6dd6-46bb-a661-257d34100644
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b942857-e662-42f1-ae84-20c0b8d78f06
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_MERCHANT_TYPE_MROC: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_MERCHANT_TYPE_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MERCHANT_TYPE_MROC') }} s_lkp_merchant_type_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_merchant_type,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MERCHANT_TYPE_MROC') }}
                     GROUP BY hk_h_lkp_merchant_type
                   ) curr
                ON curr.hk_h_lkp_merchant_type = s_lkp_merchant_type_mroc.hk_h_lkp_merchant_type
               AND curr.dss_start_date = s_lkp_merchant_type_mroc.dss_start_date
        name: S_LKP_MERCHANT_TYPE_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_MERCHANT_TYPE_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
