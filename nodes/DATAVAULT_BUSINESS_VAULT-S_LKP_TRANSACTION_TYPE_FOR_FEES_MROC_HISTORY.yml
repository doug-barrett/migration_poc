fileVersion: 1
id: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16e70a9a-5832-4883-91a9-be007696cecd
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_TRANSACTION_TYPE_FOR_FEES
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14a05a07-3dbe-4890-a3d9-1fe2a40bc2e2
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c6c60c-cd3f-40d8-a359-dbe2bd4e24d1
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TXN_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d95e0e4a-cfe3-4de0-b105-71da8f8b42c8
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7773e38-ba0e-4ad5-a101-1c894ad391ff
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 197006fc-2dd6-4d74-b3df-1726a87499e1
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67e6a2a3-eac1-4e51-8c45-364c22a8c84a
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9570c73e-ec79-46aa-a1a2-6360eb42e522
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e36dbff5-5d2b-4e72-b3dd-b9d3ac570065
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TXN_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d20d83-7fb0-4577-a3b2-9edd6bccb86b
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbf04ddf-06c9-4eb7-873f-0f0aa1f7e486
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e03d1162-de78-46f0-888f-0f944eccb2ec
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c2de864-ba2e-47eb-b6ca-29ae7a7dbc5d
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cf69551-dea9-45f0-a692-30eb989aaa05
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63f1138d-6968-4595-b182-dfb92ee48291
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3912d891-b0fe-4888-8ba8-28008bd7f8da
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaa0da6c-bdd0-40e5-9bb3-1092a88e4c5b
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 093068d2-6088-443c-8968-72e534a0c9d8
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 173ab955-804e-4f4f-a263-99e9150feecd
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93a723e8-8a05-4988-b90e-212a58d71341
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 447ad300-e6ad-4915-babc-e669b71468a3
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e21f6f4d-c483-4595-b115-a5ad311a0669
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9aed870c-dd73-4a22-abeb-5aa37b40ae98
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 889b0657-1bef-4f25-8e79-f632475fdc4c
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c57233fe-a374-4ff4-bfa9-e1118aa16435
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b41b6881-ed2a-49c3-8bda-d639f2c7443d
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c5e3997-7eda-44a6-9bb2-c3de993748b4
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ec46085-6277-439f-aed3-505fd1acf404
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 518899d8-049a-457b-8348-67587d6532be
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65d09d2c-f031-4822-bc89-1dc315aec822
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02cfc9a7-a407-4381-8265-14dd4feb48cb
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c46bbb6-6086-4884-8440-e90ddb8cd608
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a047802-b208-44e3-b2bc-6815e66cae47
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ac71ac4-b97f-4598-8ae6-8b694722596f
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5a9342d-48b0-4ea1-9ecd-fb160dc4769a
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00768bf4-6be9-4b59-8f98-64c2a65e349f
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e18980c-d3ed-4eac-ba44-991269996ede
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 604fcf98-0952-4454-b28a-294fa7a87d2b
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30779ea7-51f6-4881-bdcc-963ca9a367a7
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 711032c9-e18c-4b20-ac76-2f258d85f28b
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eab8588-7aa2-4fac-9105-8e2cfaa7b5eb
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbbed972-3b98-40e1-a178-4c9826cb3db7
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6dc1e55-5882-4ab9-9025-5d6ad176a802
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_transaction_type_for_fees ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 048c98fd-4c9c-4730-9c70-e9bdd06c1f33
          stepCounter: d6b3fefb-3ca3-48e6-8716-2cd5fe57f006
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_transaction_type_for_fees ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC') }} s_lkp_transaction_type_for_fees_mroc
        name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
