fileVersion: 1
id: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e694f61-17a8-4f91-a3e1-06184375f15e
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_TRANSACTION_TYPE_FOR_FEES
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb34a039-8f36-4a12-aaaf-1bc6611e6615
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1dd5c84-1b83-437e-84b6-65d62a18c31f
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TXN_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcf1a556-a91a-482b-93ef-b86de0128eb6
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 059d5ffd-66d4-481d-8c69-4fea751e5a07
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 244294fe-9df7-476b-8beb-3dab2e54c56f
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73c594b1-64c5-4331-9100-2e5e18402778
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b710551-711b-4587-8940-f2ece10ff98e
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa8a7e03-7890-4393-84fb-6806ca31da7a
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TXN_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 298f393d-2727-42ce-b472-dfa9837fc90d
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 015daa64-1ba3-4774-92fc-1a85a21385e1
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f78671e-ebc9-4ba9-bd5c-4983ec976651
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25f8a4ea-a0fb-4ceb-87b6-21016e24555a
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ff0319-0621-4997-b649-7300808eab8d
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9da966a-92d6-4da1-9c56-25f0f58d29c8
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c900f8af-13df-40c5-bb0d-a582f7e1d948
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d94f4156-c3e4-4da3-b989-dc0202e7cade
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9677ed2a-531c-4327-aada-56784ab4eaa3
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17758add-c081-4502-80df-03fa364faea6
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 392f96e7-3b2e-4eed-8a73-5e1169360907
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 085d57ee-62a3-4be5-a084-2928f9a0c7df
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ed96262-161b-4d4e-89b3-81519ec4f80a
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c054044-cb65-4e41-9f90-d80195d812f9
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1c41c6a-41d4-4ec8-9ed4-20b794fb0b29
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfad0d13-75a0-48cb-9bfc-39cd58ae178f
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c2c06c5-a1d6-402b-aa7b-6157c23c0a2b
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df62e32a-f65a-49b6-adb1-1a3d806c18ce
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e35bcb00-e8d3-4337-b29e-9b4bb85bc635
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4241c7-aad9-4e1c-a409-50cc9018e0b6
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c717513-fd42-4f6d-a404-f5ce644ba914
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 553eb7bf-afcb-4935-8d90-c5ff4050289c
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d72e7ed-d626-4b4c-85ae-0b0bf06459ff
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89860dd1-82bf-4c8e-a4f9-f8fd817e14ff
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ebb11f-295d-4dc5-9c21-1c1943ef199d
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b925591e-252c-4bf1-94da-0f1abcece8b8
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cf30e24-93c5-4ab2-a33f-b86cee348748
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec3aa71c-28d3-44a0-9349-58cb6511b5a0
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffe717b7-cd55-46da-b703-c3235982f844
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1296b21e-2f5e-4b36-a388-b70223965888
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa409f2-e464-4032-8bc0-3a466082bdc2
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8dd27240-0281-4ca6-99a6-5d0f3ec7d53b
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ab34d39-b200-4e65-91c2-79f1a7825ca8
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b3deab2-7809-42d1-8270-7014f4990c24
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_transaction_type_for_fees ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1357482-3c28-486b-94e8-695097adf24e
          stepCounter: d4350c9f-736f-4aa6-b7b6-1b30070c38e7
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_transaction_type_for_fees ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC: e72aea18-4b7a-498b-866c-cc68c3e2094e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC') }} s_lkp_transaction_type_for_fees_mroc
        name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
