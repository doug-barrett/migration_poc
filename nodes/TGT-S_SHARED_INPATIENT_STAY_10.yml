fileVersion: 1
id: 1a96a856-be50-4d03-9090-467dc194794e
name: S_SHARED_INPATIENT_STAY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Initial Stage Table for common use of In-Patient Attendance Stay data"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22f269c4-b49a-43d1-9fc7-836503914e17
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd338d02-eac7-4d45-806a-1831b0f3775b
                stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 740bed9e-894e-4164-a034-cd80fc8bd458
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba1f3111-4bee-4797-ac4a-5e85709e233d
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN IFNULL(ds_pims_provider_spells.disch_dttm,CONVERT(date,GETDATE()))
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34a63315-6e01-440d-9805-6c41efd103f0
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 120c5e33-a05d-4ab1-9f9e-cb4d7ff0a7cd
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() OR ds_pims_provider_spells.disch_dttm < ds_pims_provider_spells.admit_dttm THEN NULL
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db19b48b-1431-4ad5-8de8-bb5a0ccf2549
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9065a05-282a-4138-9651-dd3fc0ce2869
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcdde15b-c90b-4378-8927-e921345657eb
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9fc1ad-a8cc-4c29-bd6b-b55c9007f7ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14aa5756-bcdd-4a0b-ba48-df5cd28b1267
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d682efad-8fd7-4911-beb0-f3a99784edd4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a63d52f-7cc4-4f65-8b5b-dc32e39242e7
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c018533-12b7-4065-b16b-5f92a9fb86f2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a09d61e-f059-484c-b3e3-eca6bd9dbf5f
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa596478-cc6c-4d9d-8ea3-bb838e5b59f2
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f097725-1edd-4539-b340-14de489b6fa2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fbd9ade-bf1a-494d-863f-f49cd5532840
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4414ecc-4c91-49ec-a055-6affc8dbde9a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6d80930-fd13-445e-9b1f-f9ebff6bd67c
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2db989-19c9-48be-ab15-47452de5e290
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edf042d2-7249-4c8a-937b-eafe43ccbb05
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPELL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 393b69e1-de21-4623-b7d7-6f2de29ab3bd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7941f16a-fb52-4508-a9b3-5cd2d3193604
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCH_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ed21a6-3045-4fea-965e-c903428d0444
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d64b343-2f17-4ba2-8fd1-3c1a3115ce37
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e5eecf-b3fb-4fc8-b661-b39389f47738
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: IFNULL(ds_pims_provider_spells.refrl_refno, s_shared_prof_carer_episodes.refrl_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29e8b8aa-b71d-4eb9-b6a3-8b0ff31000bb
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2098890a-c04f-42b9-8e4b-8d6e3df94578
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REGULAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9caf7d-206b-4215-923e-0a8fcf1d38fd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0a78396-4bb0-4793-ac45-8fabe1aaf376
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ce2d66-f620-4545-bd3f-71d1e5604f03
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 021e91d9-7280-4e55-a569-f87a05b75f88
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a5a335e-f714-4f3e-a830-98ebf37f63e8
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e7aaa3a-52e3-485e-9e76-163a78503c54
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b4dc46-790d-4855-996e-74e704416106
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b18e3849-c76b-4863-be83-07ab36fafc4e
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6604579-0800-40b1-867d-e59c721e91d4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42801660-d439-4f49-919b-8bb94c65ea42
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SILNT_REFRL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986b3049-fadf-49c3-8fc1-04e10d6a4d33
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb08ebb8-28f1-422b-b479-32151595aa00
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DTA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eadd3bd3-cfe0-46d5-afed-4b33c2285c5a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bf69443-c3b4-4200-8fb9-4fcacac6c91d
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d1ddefc-a73c-4486-a6a2-280c2804408d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2377bee9-4958-4f51-8096-d73eedd7e9fe
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FAST_TRACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 474c4ea1-defd-43a9-bbcc-24c1a12f7605
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8dd829bc-6264-4f6e-acb1-2664df06b7e0
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NO_FUNDS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adaf7607-d34e-4c33-a149-678ed4d276ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cfce71d-20a0-43ee-bd7b-14812557f247
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_START_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a37a08-2f83-4370-9738-9133ff8e3c00
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30c0e257-5cf4-456d-a8ae-7bd08f673981
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75adebc2-28b6-4c2e-81fe-a7029f349f41
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f72195e-c4db-4798-a225-232814550c6c
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dfd02a9-1ba2-4aa2-808e-04d07280dc1b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b7e5ac3-0edf-4880-a330-32c0ba01bf6c
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d60bae5-2fdc-4042-9986-dc96a84b9ede
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3644fefd-e190-4734-9fa9-5752d0cf61e4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3552f32-9f32-43cd-949b-eff586af7d11
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFECO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e192eb22-8e23-43d9-a6a1-7ec546eb37f9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c3cfb95-9b1a-4edf-b104-1ae4560e8dbd
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610a8953-82f0-459f-be85-6fb303187454
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aff01317-edc3-4730-9d59-dbee9c1e8ad0
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d148cfb-5932-4db9-9c47-425f101d8538
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d22d5672-3aa2-45ea-8d26-0ef153eeb12c
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADTAC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc37af32-4ed2-481d-94e6-53816f9c303b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e04e19c8-eec1-4e8c-8986-af6020478765
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FINSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f765fc8-cd96-4aaf-bff2-4dff1293bd77
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2677751b-6c59-4bc8-94a8-fdf71c64edde
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EMPST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9205802-fe1d-46f9-a5c9-4b7919146d2a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5676f456-b26d-4acd-9057-c4237d3a50f4
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PENST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32fc442b-f873-48aa-bf5b-1d62969675fc
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26002419-cd9d-4039-98ee-9afdc22f32ab
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 300e2654-6b58-4cf5-879e-85f966675fb4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7f00830-4cc3-4fe9-856a-6d79bc4d7f8f
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GP_ADVISE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 620ed001-b626-4a15-8bc6-0946baba77e0
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4ae4a9f-8d70-4427-a237-4716cb41f47c
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14ab4fe6-1fce-4b98-8199-a0a695c00493
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4bff2c9-a0f2-4d53-ab4f-455860be6ebd
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RELATED_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 442b4b35-07d7-4d71-838f-176e081c31fa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 227c60a1-f50d-4bd2-bd23-70f0fe711779
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CARAV_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b64bbbf9-4952-47ec-90fb-2c4bebc30331
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25f7c818-123d-47ba-bde5-fbf4e9d61516
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFRFC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 560d28d8-dae6-4154-8f25-e0291e086c2e
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 614be640-3b77-4600-b6ff-9a22bba32e70
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ONSET_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d92b3fe9-be48-45f7-a650-a62b267a07cc
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f044e804-1b87-4136-9674-c6786e6cec7b
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READM_REHAB_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45c7aa4-a942-4d04-80f4-f2a6d595fa4f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bc5f3d8-fc52-4c31-8765-665d84264f94
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d4d50fc-13d3-469c-9630-b41641ee3a7d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648c81c2-c0c4-42d9-b68a-6775a0a64109
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64690faa-b9d5-4e60-9be7-eafc067d95aa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9041704-3fc9-4204-b8b9-843ec8fe62ce
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 550e0fe6-5e63-4326-9718-c13735c22824
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d4eb0f3-c84b-4f61-9813-8beeb214e260
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f3f31c8-bbe1-4201-8de3-c084e0d5b519
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce21ca30-2168-4b95-87ad-292bda2ff81f
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: HARP_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6798782-c3b7-4a0a-b5dd-a9f4bce8b9e8
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a83d219a-0de9-49d2-8da8-ec4aee7ecac7
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADPST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78105a79-1268-4eb0-9357-62669735e01b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51ffa7ba-e2c1-410a-b169-778c4c3f594c
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 172a657e-3734-48d9-937c-b18947e2eb7f
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTAY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93c3258b-8fbe-4281-8cf6-6936dd79dfc2
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1961f9f7-c8e9-4f4e-9fdd-20bf33ba01d2
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Allows the most recent prof carer episode joined to a stay to be selected.
        name: STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93c3258b-8fbe-4281-8cf6-6936dd79dfc2
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ROW_NUMBER() OVER(PARTITION BY s_shared_service_point_stays.sstay_refno ORDER BY s_shared_prof_carer_episodes.create_dttm DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eca5f98c-bcc2-4955-9eb4-05bbc2b540d4
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9379797c-9329-4864-b6de-027efaccad59
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: |-
              CASE WHEN s_shared_service_point_stays.patnt_refno IS NULL OR s_shared_service_point_stays.patnt_refno <> ds_pims_provider_spells.patnt_refno THEN ds_pims_provider_spells.patnt_refno
                          ELSE s_shared_service_point_stays.patnt_refno
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0676664f-2c08-40c9-a72f-247430909b21
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATNT_REFNO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9379797c-9329-4864-b6de-027efaccad59
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 347be3a2-1858-40fc-929b-e334f030893f
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHSC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1eaa0edf-11f8-4603-b7eb-58a67ed2ffa7
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d9327c3-5bb1-4afa-8ef7-7092cee79900
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DELIV_FACILITIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f7e673-013b-437e-8e57-a84db0d8d498
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba3d075d-5570-4841-9f97-87d9edf62cc4
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a274b1d-d224-4883-8f0c-d260f5eda5c0
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: |-
              CASE WHEN s_shared_service_point_stays.start_dttm IS NULL OR s_shared_service_point_stays.start_dttm <= '1990-01-01' OR s_shared_service_point_stays.start_dttm > GETDATE() OR s_shared_service_point_stays.start_dttm > s_shared_service_point_stays.end_dttm OR s_shared_service_point_stays.start_dttm < CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END THEN CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END
                          ELSE s_shared_service_point_stays.start_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ce04a09-1b10-41b6-a442-e1446b05dbff
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a274b1d-d224-4883-8f0c-d260f5eda5c0
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66ae7ebe-792a-42dc-9b57-f5e4c4295e53
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a759fa-30e7-4148-ab24-0ae178ca0519
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: |-
              CASE WHEN s_shared_service_point_stays.end_dttm IS NULL OR s_shared_service_point_stays.end_dttm <= '1990-01-01' OR s_shared_service_point_stays.end_dttm > GETDATE() OR s_shared_service_point_stays.end_dttm < s_shared_service_point_stays.start_dttm OR s_shared_service_point_stays.end_dttm > CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN GETDATE() ELSE ds_pims_provider_spells.disch_dttm END THEN CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN DATEADD(ss,-1,CONVERT(datetime,CONVERT(date,GETDATE()+1))) ELSE ds_pims_provider_spells.disch_dttm END
                          ELSE s_shared_service_point_stays.end_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1099577-24a4-4695-b42e-20b206cb84e1
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a759fa-30e7-4148-ab24-0ae178ca0519
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28cf154a-d2f2-4d72-a0b9-f52aad1d39f9
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ab9c5a3-088f-4ee5-af4f-a9a3e56c4143
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f0a6fb0-401f-443b-8372-724a8d746917
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HPSTP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 617fdd9d-b0e7-4d48-8ce7-e7cc2af9a09b
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6a38a6e-6441-40e7-ac23-0adf8e015739
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PERCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8180a6e2-7440-4f46-892c-22a088e02cef
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2062a98f-6303-40cb-8dc5-e7ce510c485a
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c3ffd0d-3e4a-495b-a69f-43f23d86e326
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00c34a8a-64f1-4e2d-b2e2-4c71b8a0c523
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da074ef3-5d33-4d71-9555-9af9e2005e51
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: COALESCE(s_shared_service_point_stays.proca_refno,ds_pims_provider_spells.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6680ddab-9324-49bf-87bb-17ca90de0ade
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BDCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 621a6923-9767-42f1-921b-521cd307cab2
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cad693b-d8c9-4ffb-b9b5-df0c4cd3faad
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CHAPLAIN_VISIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e956b19-2afb-408b-91a7-f33ec8d085d6
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d5828c-e99e-4dc3-b34e-3ff8ee42f9c0
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: VISITORS_ALLOWED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c80fd98-65d9-4203-8ffa-d3abb3e6313e
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0038e0f2-eb0c-496a-a6c4-21999baeaa5b
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7350cdc6-87b9-494d-8bc1-bf455383ebe6
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adfbd65b-c889-436b-9a03-f47e9cfdbb4f
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WARD_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e1bdf3b-7e27-4056-9273-ecb0cced24b5
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d542f57-3e79-4485-8117-3ca13d66b9e4
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADTPS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c124f61a-4a7e-4b05-9218-3a889df55d42
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a53a8c-590e-4b04-a89b-2c8930244411
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10122fbd-669d-46b9-9c44-391179ebc131
                stepCounter: c8069b0b-c302-49c5-9b82-e703082a90aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3325541-7656-43a8-9eee-b4fb3b2964b7
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRCAE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec347ce4-3d51-4888-8a8d-5ac775e0ae13
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cefe7cd4-7a95-47a4-8eb9-7705772e34ad
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_CREATE_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d333585e-4eba-40b6-9bad-7d7e1eb9bbf7
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5bfc0bc-809d-4982-92d2-5d1d49f282b3
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b534494-3b6b-4502-a2b0-7755b3513e36
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: episode2.wlist_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da8b2fe8-ab58-489b-b676-602cea7e40e4
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b5f457b-71f0-419d-981d-1b5b92d12a99
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e576b045-1c7a-4cca-94fd-3ae219d6b765
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b4070f-d6cc-4e89-aed1-4916e0fefaf4
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a23100b-a6be-4266-863d-fcc40a697c35
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d152984-576f-4c8f-95b2-25f61745ef1a
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6df594ae-2c84-4c8f-a390-60744ea0cc58
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6648160-fb57-4a8b-83e5-590ba152caf5
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0757a61-d2d0-4406-abee-f1e8748d33ba
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 526b70c7-7277-4e43-ada2-e2f2d3a2d97d
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4636ca-3fb3-4a14-8ada-351addf790b0
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68827c48-a7ee-437e-8e9e-ad96a52adffd
                stepCounter: 09bca5c9-ddc3-4ecf-a3f3-e96572715636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebd41c33-70d7-49eb-a0bf-3dcc2bf62dd8
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 066f9341-1a0c-4123-8b72-7b2791365e3a
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78fda6ee-50e6-4fe7-9143-7e566be75730
          stepCounter: 1a96a856-be50-4d03-9090-467dc194794e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SHARED_INPATIENT_CHANGES
        join:
          joinCondition: |-
            FROM s_shared_inpatient_changes
              JOIN ds_pims_provider_spells
                ON s_shared_inpatient_changes.prvsp_refno = ds_pims_provider_spells.prvsp_refno
              JOIN s_shared_service_point_stays
                ON s_shared_inpatient_changes.prvsp_refno = s_shared_service_point_stays.prvsp_refno
              LEFT OUTER JOIN ds_shared_referral
                ON ds_pims_provider_spells.refrl_refno = ds_shared_referral.refrl_refno
              LEFT OUTER JOIN s_shared_prof_carer_episodes
                ON s_shared_prof_carer_episodes.prvsp_refno = s_shared_service_point_stays.prvsp_refno
               AND COALESCE(s_shared_service_point_stays.end_dttm, s_shared_service_point_stays.start_dttm) BETWEEN DATEADD(s, 1, s_shared_prof_carer_episodes.start_dttm) AND COALESCE(s_shared_prof_carer_episodes.end_dttm, ds_pims_provider_spells.disch_dttm, GETDATE())
              LEFT OUTER JOIN s_shared_prof_carer_episodes episode2 -- Used to get wlist_refno  ON  episode2.prvsp_refno   = ds_pims_provider_spells.prvsp_refno  AND episode2.wlist_seq_num = 1    WHERE s_shared_inpatient_changes.event_changed_flag = 1  AND ds_pims_provider_spells.prvsn_start_flag = 'N'
        name: S_SHARED_INPATIENT_STAY_10
        noLinkRefs: []
  name: S_SHARED_INPATIENT_STAY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
