fileVersion: 1
id: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
name: VIEW_FACT_FDC_ACTUALS_ACTVY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79f0886f-6753-4873-96d3-0c852edb19e2
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0156489-f6ae-498f-8b98-61d56ce806cb
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c780fceb-f387-4c10-ab6f-2e4e17370b56
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a021fcd8-d234-4706-b632-0064dbe3e216
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1097a531-1180-441c-b2ee-d7d62c37c765
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb58c3f3-f2cc-4bcb-b6ff-0a6b6fe46a14
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb8d0682-b453-4e3a-ac1f-7c95f7ce7cf0
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8fafeb1-018d-4aae-8ac3-7bf4940c7c85
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648e9169-6528-4df3-9a89-6a20926c8867
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fde4c827-5c20-4bdb-ab5e-82cc7c796b5c
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b770fec-8e11-4656-bb2b-509b6f8ae65e
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54daab07-e9a7-41b8-a296-751c8c511572
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82282881-a8de-4f40-ab01-a92b48f7e5ef
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2012ff46-a3a6-4dd4-a19a-9f3887968d05
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0917398c-4fb0-4742-a73f-52b529b422ab
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4dd2ebc-d6e2-46cd-808f-30cfbb66d299
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3099e719-9575-4373-aba3-2ce8ca83592d
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c312e2e-ea3c-4634-8e47-50ca19d47cc6
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dba106f-fa19-4d31-8a3c-8a246195a7cd
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5d33dd9-b00d-458a-a083-58ff3476a8fa
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4521a988-e49e-4787-9132-3d96891c86f2
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3912791f-877a-412b-9216-fbd4e4a2a7d3
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5338793-6fea-4508-83cd-2a81b0360df0
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 068130a4-45cf-4794-9188-dbee0072b308
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cebde587-abfa-47bf-85a1-676563c728d6
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99ff505a-f60b-4eba-b753-d3cf66448ec2
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6fb8913-4184-4332-add8-a43e9298dcbf
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58313d3b-3b51-42c5-bcbb-5c0ec2e60828
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31092b87-b58c-4ecc-a205-ddcd224cc76c
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6c40de8-453a-483e-b569-aad573aca45a
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0926a5d2-d431-47ca-96e3-feba9d90894e
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22d73f8f-6711-4f4a-8633-c7083d2b39b6
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa58081c-a124-465a-944c-8595d2a87572
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81304477-ccb2-42c8-8db8-f96b61d548c8
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b075c60-2d26-4378-bcd0-6c070e028b7e
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35fb0f87-f63a-4c97-bbe6-6534636eb3f2
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cb5b639-94ff-4ba9-b908-de4ea0009b81
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab2eb0cf-365e-492d-bc08-0f0ed0ffeff5
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e13cdd9d-c349-42bb-b5f7-ca7e003e2200
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf1971c2-9bda-44e3-a7ea-1fd1811fe16a
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf14c032-aaf2-4768-8be3-5a6d4579711d
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4702125-3d33-47c8-87b7-b711d9220515
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e4ff957-8217-465f-8fc8-08971a95c2a8
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ad9f11f-b384-441c-a47e-75d765dbaed8
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5ba825b-2e48-4e40-a276-99f250d7fb28
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21f051d2-cfcb-44c3-b14d-0cbee5023340
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aa82c7d-27ea-41bf-bcda-db247ada5d25
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea00a7b7-602d-47f4-a611-f7ce089cacf0
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6a47e4f-36d8-4d2d-90c4-3e5ed7ab323b
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15dbe84e-e1e5-4557-8f24-d61debf416e7
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad90536c-b938-4f68-bb23-0ea7fde51acc
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b3f2304-8796-4bf6-b141-8dc0d0c4ac3c
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0f0d4d9-5b07-4e94-b0a7-f3d1ea4ad402
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d95060a-5b71-49d4-8f37-2ed01dea5d6b
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6c132bc-bd5e-43e3-b287-cfabc6be952f
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b119778-845a-4f7d-a11c-9ed2369a45f6
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff6fe639-35d7-434a-83ee-d55cd9a7ba4d
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43062549-c3c2-49e7-9a35-ae1d62e26de9
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9e7392-99af-48ff-be11-cc0e910603b3
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7be8cca9-87db-463e-b665-107b1988714b
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bed7088a-a982-4127-9cd9-862be8088bd8
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4062a71-50c9-41a0-ab09-112979c35807
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b49dd264-a447-4d65-bd7f-e155d3db3866
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c8a2cd-6cab-4320-a30f-d024a492ed32
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 916c87a5-05a7-4e7e-8dcf-437149b1a080
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eea1157-e695-4202-bf15-d1147cc18809
          stepCounter: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_ACTUALS_ACTVY: e5f136cb-7ad3-41e9-b86b-8cb5946480b9
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_ACTUALS_ACTVY') }} AS WITH PRODUCTS AS (
                    SELECT '20.1' AS GLOP_LINE_NO,
                           'OIL' AS PRODUCT
                 UNION ALL SELECT '20.2' AS GLOP_LINE_NO,
                           'CON' AS PRODUCT
                 UNION ALL SELECT '20.3' AS GLOP_LINE_NO,
                           'NGL' AS PRODUCT
                 UNION ALL SELECT '20.4' AS GLOP_LINE_NO,
                           'GAS' AS PRODUCT
                   ),
                   VOL AS (
                    SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                   ) SELECT CASE WHEN PVT.CC_NUM IS NULL THEN '-1'
                        ELSE 'CC-' || PVT.CC_NUM
                         END AS ENTITY_KEY ,
                   'qbyte_sales' AS SCENARIO_KEY ,
                   GROSS_NET_KEY ,
                   DIM_ACTVY_PER_DATE_KEY AS ACTIVITY_DATE_KEY ,
                   DIM_ACTVY_PER_DATE AS ACTIVITY_DATE ,
                   -1 AS NORMALIZED_DATE_KEY ,
                   -1 AS PRODUCING_DATE_KEY ,
                   -1 AS ON_PROD_DATE_KEY ,
                   PVT.CC_NUM AS CC_NUM ,
                   NULL AS HOURS_ON ,
                   NULL AS HOURS_DOWN ,
                   NULL AS HCLIQ_METRIC ,
                   SUM(PVT."'OIL_METRIC'") AS OIL_METRIC ,
                   SUM(PVT."'OIL_IMPERIAL'") AS OIL_IMPERIAL ,
                   SUM(PVT."'OIL_BOE'") AS OIL_BOE ,
                   NULLIF(NVL(SUM(PVT."'CON_METRIC'"), 0) - NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS CONDENSATE_METRIC ,
                   NULLIF(NVL(SUM(PVT."'CON_IMPERIAL'"), 0) - NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS CONDENSATE_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'CON_BOE'"), 0) - NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS CONDENSATE_BOE ,
                   NULLIF(NVL(SUM(PVT."'NGL_METRIC'"), 0) + NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS NGL_METRIC ,
                   NULLIF(NVL(SUM(PVT."'NGL_IMPERIAL'"), 0) + NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS NGL_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'NGL_BOE'"), 0) + NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS NGL_BOE ,
                   SUM(PVT."'GAS_METRIC'") AS GAS_METRIC ,
                   SUM(PVT."'GAS_IMPERIAL'") AS GAS_IMPERIAL ,
                   CASE WHEN W.COUNTRY_NAME IN ('GERMANY', 'NETHERLANDS') THEN SUM(PVT."'GAS_BOE'") / 1000
                        ELSE SUM(PVT."'GAS_BOE'")
                         END AS GAS_BOE ,
                   SUM(PVT."'GAS_NM3'") AS GAS_NM3 ,
                   SUM(PVT."'H20_METRIC'") AS WATER_METRIC ,
                   SUM(PVT."'H20_IMPERIAL'") AS WATER_IMPERIAL ,
                   SUM(PVT."'H20_BOE'") AS WATER_BOE ,
                   NULL AS SAND_METRIC ,
                   NULL AS INJECTED_GAS_METRIC ,
                   NULL AS INJECTED_HCLIQ_METRIC ,
                   NULL AS INJECTED_SAND_METRIC ,
                   NULL AS INJECTED_WATER_METRIC ,
                   NULL AS RECOVERED_GAS_METRIC ,
                   NULL AS RECOVERED_HCLIQ_METRIC ,
                   NULL AS RECOVERED_SAND_METRIC ,
                   NULL AS RECOVERED_WATER_METRIC ,
                   NULL AS REMAINING_LIFT_GAS_METRIC ,
                   NULL AS REMAINING_LOAD_HCLIQ_METRIC ,
                   NULL AS REMAINING_LOAD_WATER_METRIC ,
                   NULL AS REMAINING_LOAD_SAND_METRIC ,
                   NULL AS METHANE_METRIC ,
                   NULL AS METHANE_IMPERIAL ,
                   NULL AS METHANE_BOE ,
                   SUM(PVT."'ETH_METRIC'") AS ETHANE_METRIC ,
                   SUM(PVT."'ETH_IMPERIAL'") AS ETHANE_IMPERIAL ,
                   SUM(PVT."'ETH_BOE'") AS ETHANE_BOE ,
                   SUM(PVT."'PRO_METRIC'") AS PROPANE_METRIC ,
                   SUM(PVT."'PRO_IMPERIAL'") AS PROPANE_IMPERIAL ,
                   SUM(PVT."'PRO_BOE'") AS PROPANE_BOE ,
                   SUM(PVT."'BUT_METRIC'") AS BUTANE_METRIC ,
                   SUM(PVT."'BUT_IMPERIAL'") AS BUTANE_IMPERIAL ,
                   SUM(PVT."'BUT_BOE'") AS BUTANE_BOE ,
                   SUM(PVT."'PEN_METRIC'") AS PENTANE_METRIC ,
                   SUM(PVT."'PEN_IMPERIAL'") AS PENTANE_IMPERIAL ,
                   SUM(PVT."'PEN_BOE'") AS PENTANE_BOE ,
                   NULL AS FLAREGAS_METRIC ,
                   NULL AS VENTGAS_METRIC ,
                   NULL AS FUELGAS_METRIC ,
                   NULL AS WIGAS ,
                   NULL AS WIHCLIQ ,
                   NULL AS WIWATER ,
                   NULL AS WISAND ,
                   NULL AS BAT_PRO_GAS_METRIC ,
                   NULL AS BAT_PRO_GAS_IMPERIAL ,
                   NULL AS BAT_PRO_GAS_BOE ,
                   NULL AS INJECTED_LIFT_GAS_METRIC ,
                   NULL AS INJECTED_LIFT_GAS_IMPERIAL ,
                   NULL AS INJECTED_LIFT_GAS_BOE
              FROM VOL F PIVOT( SUM(VOL)
               FOR PRODUCT IN ( 'OIL_IMPERIAL',
                   'OIL_METRIC',
                   'OIL_BOE',
                   'OIL_NM3',
                   'GAS_IMPERIAL',
                   'GAS_METRIC',
                   'GAS_BOE',
                   'GAS_NM3' ,
                   'CON_IMPERIAL',
                   'CON_METRIC',
                   'CON_BOE',
                   'CON_NM3',
                   'NGL_IMPERIAL',
                   'NGL_METRIC',
                   'NGL_BOE',
                   'NGL_NM3' ,
                   'H20_IMPERIAL',
                   'H20_METRIC',
                   'H20_BOE',
                   'H20_NM3',
                   'BUT_IMPERIAL',
                   'BUT_METRIC',
                   'BUT_BOE',
                   'BUT_NM3' ,
                   'ETH_IMPERIAL',
                   'ETH_METRIC',
                   'ETH_BOE',
                   'ETH_NM3',
                   'PEN_IMPERIAL',
                   'PEN_METRIC',
                   'PEN_BOE',
                   'PEN_NM3'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_FACT_FDC_ACTUALS
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_FACT_FDC_ACTUALS') }}
        name: VIEW_FACT_FDC_ACTUALS_ACTVY
        noLinkRefs: []
  name: VIEW_FACT_FDC_ACTUALS_ACTVY
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
