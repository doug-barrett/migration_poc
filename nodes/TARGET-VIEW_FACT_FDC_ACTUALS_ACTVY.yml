fileVersion: 1
id: 96ddf879-1fa4-4494-8cb2-565dfca000b3
name: VIEW_FACT_FDC_ACTUALS_ACTVY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ddcae97-f01e-4246-b002-2dd02fe20dda
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3cd15ad-d90d-4863-b4ee-bea16dc388c4
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87782e0c-ef71-4664-96f0-282e3256b703
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56184f11-c88b-4751-b3f4-8a19078eb474
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 367e1fd9-995a-46d9-87a7-63b48ac4c7a4
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bface40-f3f0-4415-a69f-1c69da814de3
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b07a5f1d-5707-4465-badc-41598a0d3c1b
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 568a95eb-3156-4a5c-a678-8e1d4004c007
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b12a55b7-877c-40cd-aa02-8b1315120346
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7baecaa8-2e9a-4102-84e1-cd29472c3535
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06575dbf-2095-4f04-b5bc-497b4ef669ef
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60fc6b40-23b6-4265-8a36-788842cf990f
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c01aa3a-1cc8-4f17-b6ad-284398d65e23
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdf89e2b-b2e6-4d86-9834-d974167f69fa
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ec7e1dd-1052-4588-b5ae-bc89fe42044d
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd2cfe26-c4b3-464f-b949-e10f0d91696f
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b558160-bfb2-4be0-9fa5-7b4eb17347d4
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a39d267-3064-47f4-bb8e-f01fee8ff53f
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13666572-89f5-44ac-9661-179d4eb8a293
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fd2124c-b489-4ed2-b975-2e85ef50db99
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da2fae8f-c438-48b8-94d1-ee38f0649832
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04db0528-cc17-444f-b8ed-cfe64e88bd14
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3231d43-f193-48ee-91cd-0b106f87d4a6
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f8d00db-fd09-468b-b7b3-a03f3a307a9a
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61e6e4ab-6184-4e18-afda-11cd64a4e8bc
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff7a26b6-dc5f-48ef-8267-95aa2d879ece
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c2fbffb-c9cc-4422-8a54-0a2b9a68434b
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1466322-08ad-4209-a2a0-299cf30946b0
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a18459ff-f4b9-4eb0-9d93-584b786e5139
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b54a09ca-2059-406e-b617-4518eab7169c
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45177de8-487d-431e-a9bb-a2c959f3a040
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94eb0e76-d2b2-42bb-b114-3c546d6284ae
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52f3745c-abe3-471d-beb8-a7a6e69452e0
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 072fde53-df14-4105-9f8f-4dc3edd84808
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba3fa8df-2c35-4fc1-a4f6-18a73978e307
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f3f762b-071a-4ffa-80e6-06f85fce1c0d
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22edcce1-160b-466e-aea6-d32634e659b3
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18b06d23-1d45-4b64-9a45-56f2ca79b3d6
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe30fbcd-3728-478b-b031-6bc90796096b
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdd3afc5-0434-4e4e-9062-389fda8b1806
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c94744b-057a-49db-9eaf-787e4ceb7f03
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cae46eb-55bf-41fc-8c3f-0f6c6298f8f5
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72209567-ea2d-46ee-b575-4e524bcd921a
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b660b5ec-bc27-4fa8-b96e-d976311986da
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4beb318b-7221-4511-9d4c-47a40b6007e2
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e604b15-12d7-498a-886e-27e55894103f
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11654e9c-ac73-41fc-8495-b6897c429815
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3923e35a-1707-452f-875e-822e3ab3657c
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dce4e75-cbb2-48c0-8ee9-a84dfcd89914
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12654ea3-3cd4-4d81-a7cd-3809cef428d1
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89177e55-d611-4e33-b5c5-783b1ba8c8fc
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e0a78b9-41d6-43f8-91c7-ed081f634010
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 596f94ac-fbbe-45c6-b7af-0507b42175af
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f5220ed-c756-4461-9515-5900e86dbbe9
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07ee77ee-04b6-46a8-82db-4777bd3d3ca8
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 387f660d-329b-4ac3-b058-36695de0147b
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 789c12e0-f71e-46c8-a76a-ecc2dd6b1956
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 896e5656-ddfa-4627-a42d-61fcd8505916
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27190a9e-40e9-4211-90e3-9deddb9447d5
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0d88739-01fb-4118-9150-d1d43feff7dc
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d45513b3-9a98-4ec6-bbae-babef4c52e27
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 268f4d6c-63df-4bcc-99a3-2746dabb64da
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4b3149f-5a3f-4ff0-898d-f0e5ba05ed88
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71ca5a83-860b-419b-b103-aedb30c748ab
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8b16754-cf5e-4904-8637-321fc55d2efc
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6724b078-9d09-40e3-87a5-c7f1efd3b1e2
          stepCounter: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_ACTUALS_ACTVY: 96ddf879-1fa4-4494-8cb2-565dfca000b3
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_ACTUALS_ACTVY') }} AS WITH PRODUCTS AS (
                    SELECT '20.1' AS GLOP_LINE_NO,
                           'OIL' AS PRODUCT
                 UNION ALL SELECT '20.2' AS GLOP_LINE_NO,
                           'CON' AS PRODUCT
                 UNION ALL SELECT '20.3' AS GLOP_LINE_NO,
                           'NGL' AS PRODUCT
                 UNION ALL SELECT '20.4' AS GLOP_LINE_NO,
                           'GAS' AS PRODUCT
                   ),
                   VOL AS (
                    SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACTVY_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACTVY_PER_DATE IS NOT NULL
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACTVY_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                   ) SELECT CASE WHEN PVT.CC_NUM IS NULL THEN '-1'
                        ELSE 'CC-' || PVT.CC_NUM
                         END AS ENTITY_KEY ,
                   'qbyte_sales' AS SCENARIO_KEY ,
                   GROSS_NET_KEY ,
                   DIM_ACTVY_PER_DATE_KEY AS ACTIVITY_DATE_KEY ,
                   DIM_ACTVY_PER_DATE AS ACTIVITY_DATE ,
                   -1 AS NORMALIZED_DATE_KEY ,
                   -1 AS PRODUCING_DATE_KEY ,
                   -1 AS ON_PROD_DATE_KEY ,
                   PVT.CC_NUM AS CC_NUM ,
                   NULL AS HOURS_ON ,
                   NULL AS HOURS_DOWN ,
                   NULL AS HCLIQ_METRIC ,
                   SUM(PVT."'OIL_METRIC'") AS OIL_METRIC ,
                   SUM(PVT."'OIL_IMPERIAL'") AS OIL_IMPERIAL ,
                   SUM(PVT."'OIL_BOE'") AS OIL_BOE ,
                   NULLIF(NVL(SUM(PVT."'CON_METRIC'"), 0) - NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS CONDENSATE_METRIC ,
                   NULLIF(NVL(SUM(PVT."'CON_IMPERIAL'"), 0) - NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS CONDENSATE_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'CON_BOE'"), 0) - NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS CONDENSATE_BOE ,
                   NULLIF(NVL(SUM(PVT."'NGL_METRIC'"), 0) + NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS NGL_METRIC ,
                   NULLIF(NVL(SUM(PVT."'NGL_IMPERIAL'"), 0) + NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS NGL_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'NGL_BOE'"), 0) + NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS NGL_BOE ,
                   SUM(PVT."'GAS_METRIC'") AS GAS_METRIC ,
                   SUM(PVT."'GAS_IMPERIAL'") AS GAS_IMPERIAL ,
                   CASE WHEN W.COUNTRY_NAME IN ('GERMANY', 'NETHERLANDS') THEN SUM(PVT."'GAS_BOE'") / 1000
                        ELSE SUM(PVT."'GAS_BOE'")
                         END AS GAS_BOE ,
                   SUM(PVT."'GAS_NM3'") AS GAS_NM3 ,
                   SUM(PVT."'H20_METRIC'") AS WATER_METRIC ,
                   SUM(PVT."'H20_IMPERIAL'") AS WATER_IMPERIAL ,
                   SUM(PVT."'H20_BOE'") AS WATER_BOE ,
                   NULL AS SAND_METRIC ,
                   NULL AS INJECTED_GAS_METRIC ,
                   NULL AS INJECTED_HCLIQ_METRIC ,
                   NULL AS INJECTED_SAND_METRIC ,
                   NULL AS INJECTED_WATER_METRIC ,
                   NULL AS RECOVERED_GAS_METRIC ,
                   NULL AS RECOVERED_HCLIQ_METRIC ,
                   NULL AS RECOVERED_SAND_METRIC ,
                   NULL AS RECOVERED_WATER_METRIC ,
                   NULL AS REMAINING_LIFT_GAS_METRIC ,
                   NULL AS REMAINING_LOAD_HCLIQ_METRIC ,
                   NULL AS REMAINING_LOAD_WATER_METRIC ,
                   NULL AS REMAINING_LOAD_SAND_METRIC ,
                   NULL AS METHANE_METRIC ,
                   NULL AS METHANE_IMPERIAL ,
                   NULL AS METHANE_BOE ,
                   SUM(PVT."'ETH_METRIC'") AS ETHANE_METRIC ,
                   SUM(PVT."'ETH_IMPERIAL'") AS ETHANE_IMPERIAL ,
                   SUM(PVT."'ETH_BOE'") AS ETHANE_BOE ,
                   SUM(PVT."'PRO_METRIC'") AS PROPANE_METRIC ,
                   SUM(PVT."'PRO_IMPERIAL'") AS PROPANE_IMPERIAL ,
                   SUM(PVT."'PRO_BOE'") AS PROPANE_BOE ,
                   SUM(PVT."'BUT_METRIC'") AS BUTANE_METRIC ,
                   SUM(PVT."'BUT_IMPERIAL'") AS BUTANE_IMPERIAL ,
                   SUM(PVT."'BUT_BOE'") AS BUTANE_BOE ,
                   SUM(PVT."'PEN_METRIC'") AS PENTANE_METRIC ,
                   SUM(PVT."'PEN_IMPERIAL'") AS PENTANE_IMPERIAL ,
                   SUM(PVT."'PEN_BOE'") AS PENTANE_BOE ,
                   NULL AS FLAREGAS_METRIC ,
                   NULL AS VENTGAS_METRIC ,
                   NULL AS FUELGAS_METRIC ,
                   NULL AS WIGAS ,
                   NULL AS WIHCLIQ ,
                   NULL AS WIWATER ,
                   NULL AS WISAND ,
                   NULL AS BAT_PRO_GAS_METRIC ,
                   NULL AS BAT_PRO_GAS_IMPERIAL ,
                   NULL AS BAT_PRO_GAS_BOE ,
                   NULL AS INJECTED_LIFT_GAS_METRIC ,
                   NULL AS INJECTED_LIFT_GAS_IMPERIAL ,
                   NULL AS INJECTED_LIFT_GAS_BOE
              FROM VOL F PIVOT( SUM(VOL)
               FOR PRODUCT IN ( 'OIL_IMPERIAL',
                   'OIL_METRIC',
                   'OIL_BOE',
                   'OIL_NM3',
                   'GAS_IMPERIAL',
                   'GAS_METRIC',
                   'GAS_BOE',
                   'GAS_NM3' ,
                   'CON_IMPERIAL',
                   'CON_METRIC',
                   'CON_BOE',
                   'CON_NM3',
                   'NGL_IMPERIAL',
                   'NGL_METRIC',
                   'NGL_BOE',
                   'NGL_NM3' ,
                   'H20_IMPERIAL',
                   'H20_METRIC',
                   'H20_BOE',
                   'H20_NM3',
                   'BUT_IMPERIAL',
                   'BUT_METRIC',
                   'BUT_BOE',
                   'BUT_NM3' ,
                   'ETH_IMPERIAL',
                   'ETH_METRIC',
                   'ETH_BOE',
                   'ETH_NM3',
                   'PEN_IMPERIAL',
                   'PEN_METRIC',
                   'PEN_BOE',
                   'PEN_NM3'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_FACT_FDC_ACTUALS
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_FACT_FDC_ACTUALS') }}
        name: VIEW_FACT_FDC_ACTUALS_ACTVY
        noLinkRefs: []
  name: VIEW_FACT_FDC_ACTUALS_ACTVY
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
