fileVersion: 1
id: 975e1eed-79fc-4aa2-9572-13fa473dae8c
name: STAGE_WVIEW_WELL_INVOICE_ACTUALS_PUT_DATA_CTE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d397770f-5613-4223-a2cc-fe3c878368e5
          stepCounter: 975e1eed-79fc-4aa2-9572-13fa473dae8c
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDWELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 852699d9-f732-42f8-928e-59676bbeb793
                stepCounter: c6015070-b7c3-498f-9d21-f0fa8c01d392
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d85d5fd1-a64d-4623-8c93-3a4b4a207b26
          stepCounter: 975e1eed-79fc-4aa2-9572-13fa473dae8c
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 893da283-d92e-49a6-b3d5-a99a7150f73f
                stepCounter: 969fa71b-6565-4be0-b4da-02758ff182c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf614939-9590-4a78-bcb6-a52cf9546ed4
          stepCounter: 975e1eed-79fc-4aa2-9572-13fa473dae8c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: IDREC_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48d9ef5b-7fa1-4eb2-be2e-cb9ba48cff8c
                stepCounter: 969fa71b-6565-4be0-b4da-02758ff182c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0700e44e-4d22-4342-b221-e5f1cf428693
          stepCounter: 975e1eed-79fc-4aa2-9572-13fa473dae8c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30164ec7-da3b-42c6-86f7-375ec13850e5
                stepCounter: c6015070-b7c3-498f-9d21-f0fa8c01d392
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW WS_STAGE_DT.STAGE_WVIEW_WELL_INVOICE_ACTUALS_PUT_DATA_CTE AS SELECT WELLHEADER_IDWELL AS "idwell",
                   load.idrec AS "idrec",
                   sum(wvInvoiceCost.amount) AS "idrec_amount",
                   sum(CAD_AMT_FLPD) AS "amount"
              FROM WS_EDW.VIEW_WVIEW_WBS_INVOICE_ACTUALS VWWIA
              LEFT JOIN MAT_LOAD.LOAD_WVIEW_WVJOBAFEFINALINVOICECOST_RTN LOAD
                ON VWWIA.WELLHEADER_IDWELL = load.idwell
               AND VWWIA.GL_ACCOUNT = load.code3
               AND VWWIA.JOBAFE_IDREC = load.idrecparent
               AND coalesce(VWWIA.BUSINESS_ASSOCIATE_ID, 'UNKNOWN') = coalesce(load.vendorcode, 'UNKNOWN')
               AND coalesce(VWWIA.INVOICE_NUM, 'UNKNOWN') = coalesce(load.invoicerefno, 'UNKNOWN')
              LEFT JOIN DS_WELLVIEW.WVT_WVJOBAFEFINALINVOICECOST wvInvoiceCost
                ON load.idrec = wvInvoiceCost.idrec
             WHERE VWWIA.GL_ACCOUNT <> '600020'
               AND load.idrec IS NOT NULL
             GROUP BY VWWIA.WELLHEADER_IDWELL,
                      load.idrec
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_WVIEW_WBS_INVOICE_ACTUALS
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_WVIEW_WBS_INVOICE_ACTUALS') }}
        name: STAGE_WVIEW_WELL_INVOICE_ACTUALS_PUT_DATA_CTE
        noLinkRefs: []
  name: STAGE_WVIEW_WELL_INVOICE_ACTUALS_PUT_DATA_CTE
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
