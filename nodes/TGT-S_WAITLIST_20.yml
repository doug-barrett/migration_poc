fileVersion: 1
id: df89da50-5c82-4d59-8da2-abc1e37c3c02
name: S_WAITLIST_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9ae004b-bf73-4f93-8a8d-52e361aea883
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKING_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5582895-debb-4752-b9d7-fb6ff2350792
                stepCounter: 272e0314-c604-41ca-a707-8dd7461e69ea
            transform: coalesce(s_schedule_05_OP.create_date ,s_admission_decision_05.create_date ,s_schedule_05_ST.create_date ,s_admission_offer_05.create_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7b0a169-4395-433b-8ae1-2bfff688b054
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CARE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32cd97c9-410f-4d0d-b29b-cc930e1d9247
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49cfe248-60e3-455f-84c2-8e8ffbd942e6
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_GIVEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8119a21-cc44-4db9-a8e8-4783a1558285
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62b3dd9a-ca2d-42bb-a3d7-42a392a8c97e
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Clinical Priority Assessment Criteria assessment_date
        name: CPAC_ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 520f4bda-eb66-4f92-b2a8-79c4018e1fa3
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 647ad19c-fc4e-4031-9880-e95541471fca
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31c49e8c-74d1-42af-92bf-72225f194ec9
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b0a1df5-8bd8-452b-abc6-c2cacd07252d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: date_outsourced
        name: DATE_OUTSOURCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b61c93a-8429-49eb-a7ea-2ae386bd3ac4
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 241314f4-41d9-4c26-a391-a23eae22cb16
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89464021-f33d-42a4-9df7-2e7408285d2b
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Removal Date or Last Day of Current Month
        name: ESPI_COMPLIANCE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1496dce0-79a2-4901-96cf-2708fdfb072a
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27aa6124-471c-4fb8-b3b2-e38b71a82c37
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 151fbae4-b594-417b-af1b-028982a03418
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1f7aa3e-49af-4517-9ece-7c806bebe861
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Actual admission date (if admissions has commenced)
        name: INPATIENT_ACTUAL_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7de1c8b4-9356-4549-85b3-4c6561f9c10b
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3de2efbc-817a-4273-933b-8354d8756632
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ba6ac2e-ecdb-4509-b6a6-6e7c5938412d
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71b493cc-375d-4968-bd5c-148c0c78f2b3
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 039bd3cd-08fc-4c8a-bc4d-5ed31aea2e83
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKING_DATE_DNA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15d18e78-2bc2-4397-b221-0a50f4ca7efd
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTSOURCED_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f79aa3-cdf4-444a-ae9a-74f52c10a352
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83dcb206-e14e-4f9a-af08-eb629eaf3497
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 420475cc-8ea6-4a6c-805f-2832f852d142
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 644b232b-3304-462c-ace4-0e7976a50d3c
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb914ace-b753-4712-96ba-262274c158a6
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94137555-3ff1-46c5-8917-5eb21177817c
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date on which the referral/waitlist was prioritised
        name: PRIORITISATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70bcd0f7-523e-43c9-8601-ade5641a7aa1
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: |-
              CASE WHEN s_waitlist_10.NPF_referral = 'Y' AND s_waitlist_10.NPF_related_referral = 'N' AND s_waitlist_10.authr_date < s_waitlist_10.waiting_start_date THEN s_waitlist_10.authr_date
                          ELSE s_waitlist_10.waiting_start_date
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d52f2b81-0717-4e01-8cf6-dc75ef496b9c
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROPOSED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4da12a5c-e8ab-40aa-b7c5-331fc74e6644
                stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee28429-dc61-4866-a6cd-f3c96d3a4e4b
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bed6c6d7-c43a-4c2e-8280-577aab59a712
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f633b3c5-39a3-403b-b296-730a02a1fc93
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfd0f9c6-efb7-4896-a509-f47fef4380df
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TCI_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5582895-debb-4752-b9d7-fb6ff2350792
                stepCounter: 272e0314-c604-41ca-a707-8dd7461e69ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14e0f294-789b-48c9-bcb2-729eda7fba07
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bde1e7eb-4de5-4d63-82f5-84c6f361b0d4
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e09e7670-1fb1-48ba-b032-6e024a71284d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1af8cb29-7de1-4333-958a-cc859695caab
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d44c27c6-1bba-4488-9a3b-852aedc5fe2d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_ACKNOWLEDGEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 147fe194-4ce0-4123-a5b3-69e1b8e86368
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15f309a9-66b1-44f2-8110-990951c6f2ac
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 392a3ce5-0a03-4256-b4ed-9df91f7af28f
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f1f204a-b45b-4c86-b86d-9ebd87fc1883
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b347b94-7d1c-40ef-883a-eee03fd0c9c1
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: |-
              CASE WHEN s_waitlist_10.waitlist_group = 'Colonoscopy' AND waitlist_procedure_type_reference_no NOT IN (1400020940,1000010307,1000001978) THEN CASE WHEN IFNULL(ds_shared_referral.authr_date,'1984-07-01') < waiting_start_date THEN waiting_start_date WHEN IFNULL(ds_shared_referral.authr_date,'1984-07-01') > waiting_start_date AND IFNULL(ds_shared_referral.authr_date,'1984-07-01') > waiting_end_date THEN waiting_end_date ELSE ds_shared_referral.authr_date END
                          WHEN s_waitlist_10.waitlist_group ='Surveillance'                                                                                    THEN CASE WHEN DATEADD(DAY,IFNULL(s_waitlist_ldd_data_value.surveillance_period_days,0),waiting_start_date) > waiting_end_date THEN waiting_end_date WHEN DATEADD(DAY,COALESCE(s_waitlist_ldd_data_value.surveillance_period_days,s_waitlist_ldd_data_value.NBRS_period_days,0),waiting_start_date) > waiting_end_date THEN waiting_end_date ELSE DATEADD(DAY,COALESCE(s_waitlist_ldd_data_value.surveillance_period_days,s_waitlist_ldd_data_value.NBRS_period_days,0),waiting_start_date) END
                          WHEN s_waitlist_10.waitlist_group ='ESPI 5 (NBRS)'                                                                                   THEN CASE WHEN certainty_given_date > IFNULL(waiting_end_date,getdate()) THEN waiting_start_date ELSE IFNULL(NULLIF(certainty_given_date,'1984-07-01'),DATEADD(DAY, IFNULL(s_waitlist_ldd_data_value.surveillance_period_days,0),waiting_start_date)) END
                          ELSE CASE WHEN DATEADD(DAY,IFNULL(s_waitlist_ldd_data_value.surveillance_period_days,0),waiting_start_date) > waiting_end_date THEN waiting_end_date ELSE DATEADD(DAY,IFNULL(s_waitlist_ldd_data_value.surveillance_period_days,0) ,waiting_start_date) END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba53590f-4c0d-49db-ad25-6bee9dcd15bc
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_STOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bde1e7eb-4de5-4d63-82f5-84c6f361b0d4
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2ef74ff-fdd9-482b-8bf5-9c74e28eb502
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89896bb3-200b-4b13-997a-8ce7afe5dae7
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c1a7d3a-c04e-454e-b07d-937ea5bbea92
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 275b0357-d863-4566-ba6b-8a19fcbf7d0a
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa810411-8107-4939-bccb-c3946cc92eab
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4592bb99-91fb-4a10-aa60-436fc45d5890
                stepCounter: a4c83cc6-133c-4dfe-8a46-8928097c96e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f172194-0e4c-41ad-882f-bfdb6f279131
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: A value is required here if the lead in time for booking is greater than the period of time to book
        name: ADVANCE_ALERT_FOR_BOOKING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4aeacdbc-6150-4c9c-a658-0e2733a488cd
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab235337-2d6d-4d0a-be2d-fe48a0a188b0
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence to show reverse order of waitlist types within a referral.  Needed for NPF to identify the last FSA waitlist.
        name: NPF_SEQ_REV_ESPI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c99c2922-825f-45b6-8ba8-0e09c92fb8f7
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b52468e9-d6b5-4e20-87a7-8737c627dcc9
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: Suspension waitlists generate additional NPF Prioritisation and notifications
        name: NPF_SUSPENSION_EXCEPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5042f4c4-e515-4fed-84a2-7e7860c0ab0b
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b87821a-deb9-4512-a133-2001c0e7c4df
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OUTSOURCED_RETURN_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1b5a1dc-3829-4bd4-9e72-ec3937da6d44
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6647dbdf-f2dc-4dda-a5a5-08faabfd2e53
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P1_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65bf5eea-e51f-4ae4-bfa8-d695c611e720
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7451e0ba-3dc6-4e5f-8be9-74499d62f8a5
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P2_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dc2f9b6-8345-4b8d-a330-92e9b0c85d86
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17116a65-a60d-4a72-b49d-afe1b88c38f0
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P3_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59317736-baba-471b-887b-51ba3deac896
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bf8adcc-9298-4fd7-97bc-6caf2d01ad0f
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: Time from clock start to desired waiting time end.  Period type indicates if this number indicates days or months
        name: PERIOD_TO_BOOK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdc91542-2052-4313-b834-0f6adff24d8c
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b1c82af-63bf-4177-bb94-c58ce48873e0
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date by which you'd expect the patient to be seen.  Based on timings per priority provided by the services
        name: OPTIMAL_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05220a71-4156-4ac9-a296-69d20d4dde4c
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1bb4a64-f73a-45dc-a797-daa87380576a
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b43af6c5-c5ad-4dca-91f2-3f937fc0f447
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80a2d0c1-5235-49ee-8a47-7865df65ded5
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35c17829-cb40-42d2-8baa-87f3020b4bc4
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eba8dbf-7855-4b11-a471-56b64cee0ac9
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16ba6647-0602-4dc3-8990-76025d032784
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: waitlist_days_to_breach relative to the clock start date
        name: WAITLIST_DAYS_TO_BREACH
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e20051c8-bf01-4c0a-8f6f-267740c3b556
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_MAPPINGS_ROWID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 891a05ef-aa7f-4638-b86b-826a652cc17d
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 139ce2dc-ac0d-494d-bfce-34d7f1995eae
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea56d0c3-ec91-42bc-9b31-3c6c3f95e84e
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ce088b-f27b-4b26-a772-d71f6b7f625d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3208699c-ff57-4840-ae5a-b01027aea96f
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0278a5a9-af07-4959-882c-a2dc812c81b2
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 392f31c6-063f-44e3-8c59-c1881c6f6044
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec966b38-aafe-4e8c-a273-8e5fe48723d3
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9fcbf1f-9418-4299-b724-1fc6a0d47215
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64512ec9-34b5-4d33-a015-5d249d668ba2
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria Assessing Clinician
        name: CPAC_ASSESSING_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 166eba81-ebfb-474a-beb7-a51a204aef46
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 123473a0-2f4b-424e-a1b2-9c377ac4a774
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria Score
        name: CPAC_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56607510-2b34-4a8c-909d-19b64dec3aa8
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c3fa2d5-c630-42bf-9618-0f8acba963a4
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria reference_no
        name: CPAC_SCORING_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02132240-5c69-4452-8b36-0ebd182e18e0
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 982d4b53-1a0f-46bb-a92e-ade65b28d9b8
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI_TYPE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b792e81-6c0e-42e6-9ca6-4c346cd4e0eb
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db2e8c3e-71d5-4d96-8d71-2dc06155d6c9
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is the patient currently admitted for theis waitlist episode
        name: CURRENT_INPATIENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(current_inpatient_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0249d37-1a80-40e0-a108-737f73d064b7
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOSPITAL_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fbb7012-88cb-406f-b1fd-1f49e7b10091
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d467c5a3-4472-48e7-9cc1-2834f0129f6b
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NBRS_PERIOD_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b93c21c9-c751-4815-a89e-d60f0e1ca450
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75081974-c436-42b0-bcb9-d17c7e73ad62
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NBRS_PROCEDURE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a01d9303-950c-423f-8a6c-16d5b6dcd654
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 948ebd6e-8baa-4f20-8a02-92d0afe2396f
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: If outsourced the facility outsourced to.
        name: OUTSOURCED_FACILITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3acfa04b-af6c-419b-b81c-5ce8470abf5b
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6734fb22-8ef7-4b3d-9295-a2cd6b270651
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_MANAGEMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6ad31ce-e2fe-4490-abde-d662c71270b8
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cbf5423-d6de-4efd-85de-14c77f869f1a
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c367a790-a0fc-4472-9376-7beb92b94ee9
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31293fe4-9092-49a8-9678-7bebafd78495
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd0c6d2b-3a7e-41d2-a01f-2ecc176dae71
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a533812-dd23-4eed-903d-134419162bd9
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f78f9b80-3b5b-4f15-9382-e79319c77044
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47194309-8dd0-4731-87be-fc71ef71f764
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 166ba7d9-8e21-44d7-9137-8f9284b731b9
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26bcad47-0b02-42c4-9219-fec6da73d67f
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9246e566-fb40-4446-a208-8df3ea89afc1
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f905cc9-b359-49d3-95b9-29b1db3adbb2
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4c05bb0-6d2e-4d29-abb9-7b541adc91d3
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf7760f4-ef86-4659-8532-24a3327e6fa9
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9f67f30-1ea0-4255-9ff5-a8b259a878bc
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d759a576-334e-4c52-ae03-d65d345fc46b
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b452151e-8f23-4d16-9e70-0738c7dfe808
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f530dd73-1e2c-484d-b001-4128764cab2e
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50b33d01-903c-4048-89af-a4744e35b96c
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3523d575-5640-42a7-a496-9f5014a8f0d8
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence of the waitlist withing a referral
        name: PATIENT_REFERRAL_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5113eb73-f576-41fe-bdd1-1aa7ad86bf30
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ed75f28-43af-4ae7-8ac9-4d842274bade
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26f49f3e-ae46-4f36-a661-16f8e596f49f
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9d132cc-9fa2-4a27-9040-e8d682a75702
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: outsourced
        name: OUTSOURCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76b34351-736a-401c-84ae-f18d6009ba5e
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: IFNULL(s_waitlist_ldd_data_value.outsourced,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4773322d-95b8-434b-9ce9-c2f88d93c1ff
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83ce3dab-0cfc-4014-bfb6-90921036c6db
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcb2708a-90cd-4f1b-be12-aa30785e54f7
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 464f979c-d2a5-4821-96af-5ced23031b8c
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d71338ca-c412-4b54-99be-27367b8c1e7f
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b57c6de-0e7c-4f21-8151-347a4fea3609
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bc0cd3e-e8c6-4a51-a115-b6798e6a1a8d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96ad0c0e-5a7b-47e2-89a0-3a59cf5448c3
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ce4dd2a-9bd2-4b7f-85b9-c51521d0e1ac
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d31ee08-892d-4bf0-9a5c-9cba7fe00b8c
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1185844d-b811-4274-a057-2571f701b315
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADMISSION_READY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f55c0660-f5d0-431e-b4f5-c9e4b0b83971
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3392a63-47e9-4d05-9359-7dc1c57cb17e
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SHORT_NOTICE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66e6d3cf-c472-46ea-8305-22873e083f86
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0aec14b-80e8-4424-b521-e2a3100d74da
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5810a0bc-c56a-4bfd-8986-cb21429c78eb
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d4c9d59-034d-4288-ae69-ad3c46c0b3e1
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89b40142-217a-4e84-ad51-3b06d4636e30
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e9686be-aeed-4565-b075-ff1de45852d2
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a271a877-00ef-412d-91ac-bbe5be1f73b8
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82919a53-43e1-4ccd-a447-c9e675f2889f
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb531148-9b3b-46de-abe5-83532adf3b8d
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fe2d1cb-1235-4f3f-a0e8-cbe238478ea2
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Provisional Attribute - Rules TBA
        name: CANCER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'N'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab2c1743-6a0c-49ca-a1d4-a2805cabb243
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURVEILLANCE_PERIOD_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e5d1051-7545-47bb-b0ef-6605549b5be8
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf667e59-c7be-416e-bd3e-41311a840863
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURVEILLANCE_PERIOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35276d16-946f-4c5d-b932-cb2bb879b5dd
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12ecd335-54c8-42cd-8784-cf1460bdcadc
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deb507d3-215c-4822-9ea9-c7d8232fc56c
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08215a2f-6a55-41fc-9fe0-d17586f52b5f
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_COMPLETION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad99da1f-fb3d-43da-8239-cbcd79a4ca31
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9157836-c408-4efa-909f-ad9306317327
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_CONSULTANT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b568d517-a6db-453e-9197-5be6ede740f8
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d66b824-92e1-4045-9d70-c2a6de976593
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0df5cd3e-6802-4b16-b494-0c307882f412
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dc5360f-03ba-4074-908f-ded11549acfa
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_LOCAL_RULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aafeb4c0-d6f6-4991-bd5f-aa3c48a713c8
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0cb9528-7b71-4411-9608-2e6180a06438
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_MODE_OF_DELIVERY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b14eb08-ac26-4f8d-aaf5-b99cc54fdec5
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 348da432-0ad6-4b12-972f-e36b2a11444f
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_PROCEDURE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 147bde53-498b-40a2-bbc9-c71b5207fd68
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ffb5fbd-8aad-4d64-9d98-b117dba69e63
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c69fabd2-f9d8-49ea-93af-9e4eda621f22
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7e17938-6e82-4aa0-89fa-cd87929f45b5
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4aae2a1c-43fa-4844-8454-4b672a72ae27
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: accc4533-f7be-4c0f-ae19-e943d707d309
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is currently the same as the ESPI1 rule over time it will evolve to include more data than ESPI 1.
        name: NPF_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb0b6743-e8b3-4da1-97bc-fb011e826be4
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 689e9238-78c1-4b5c-98d8-c12e94b0411d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow related referral, related referrals are all waitlists on a referral except the first.  The first is considered a presenting referral.
        name: NPF_RELATED_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46aab946-a4fb-4109-83fb-498843c96ef5
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a63ad320-5ed4-447b-9209-575922fefc53
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_RULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e18599d-f751-4184-9908-6fe712a2cc20
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ad5e79-ff88-4825-80a2-f3ed2462d401
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be7a6859-a7e5-439e-8ba6-b196c3e1eade
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fc44b30-573a-4fbd-9476-17d540a9ade8
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this waitlist a National patient flow preseting referral, presenting referrals are the first referral waitlist.  FSA waitlists can be recreated for DNAs so the last FSA waitlist on a referral is the only one counted for NPF.
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46aab946-a4fb-4109-83fb-498843c96ef5
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: |-
              CASE WHEN NPF_Referral ='N'                                                                                                                        THEN 'N'
                          WHEN s_waitlist_10.patient_referral_waitlist_seq_num = 1 AND NPF_suspension_exception = 0 AND s_waitlist_10.waitlist_group NOT IN ('General') THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3509f81-5e6b-4d84-ac11-9b103ebbe991
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c4b9224-78dc-43da-8962-ff2b08939ae4
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ac3436c-3e74-4ca0-b77d-6abc6a63b784
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Days that the wailist has been suspended including any future suspension period '
        name: WAITLIST_SUSPENSION_DAYS_PLANNED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 191a8924-dbd5-4454-a09b-fc5a27eb92ee
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d217f054-5a7a-4a54-a55f-2f1795ddbb96
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TRANFER_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8904e81-438b-4340-86f5-7abfa63e4b27
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e96095-244e-439f-b584-15c7c508b8bd
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e55de186-e560-4e4b-90f4-855e0d0bbae8
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39700af0-24b6-4c5f-8ce8-64ea53a0eb59
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WAITING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05c293b8-e646-46ff-baf0-669b27b19071
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 894154e6-9a0f-49ca-9c38-3cef8b52b309
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Days waited at the end of the current month, if waitlist still open
        name: WAITLIST_WAITING_MONTHEND_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ee99b1-d976-4d61-8bc0-c3be2974eb57
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db598fb2-d15c-445a-a6ad-454d78475e4d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b55e4453-d52e-422a-a68f-53aa9d7975a7
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a97ee38-bbb5-4251-ab85-2f8881bf3b89
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(4)
        defaultValue: ""
        description: ""
        name: SERVICE_SUB_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89c49489-6347-4e49-b02b-dd0c3873e8e8
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69ef1f9f-f1ca-42e2-b7a4-5aeef17afd45
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec869db8-8be3-4da7-b31a-a72c30044207
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27bca667-d215-4e22-835a-e842b9259343
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94958a58-2ffc-4989-a7d0-82ac68361f79
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 514eab92-028e-4f22-a745-0bb54c75b959
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Y/N flag does the due date get calculated at the end oy the month as in EPSI 2 and 5
        name: DUE_DATE_AT_END_OF_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6879663f-3d94-4ad9-981f-01ab3026e78f
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95fa5adc-edeb-43a6-8936-db55a84dda9c
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Indicates if the period to book is in days or months
        name: PERIOD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cae6654-dac6-40fa-8221-4a03eb0a7ced
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eafc0b5c-ea1f-48d9-8e14-b385d11311aa
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541b1bae-a9ac-4f16-bc1e-b823e64832bc
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c1a2b93-7fa0-4c37-be46-83d1240ec7ad
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Grouping of ESPI types into a group representing the measure
        name: WAITLIST_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 109fb318-ef36-47c2-aca2-253cfc5f3784
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c46b047-94ae-45fd-bc93-aa34fe632a0c
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NBRS_PROCEDURE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c139c7-80d8-4c36-847b-4b720a511685
                stepCounter: 0786b164-a18e-44f0-bb0d-c226cce58737
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc71172b-00c5-4403-8d9f-50a1c8f16356
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 873b192b-86a0-4370-8061-5472660d9e1b
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b274f64-f0a4-419a-aa3c-434095cb147d
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_LOCAL_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e82b8b0e-c31f-4356-839d-87a72600aa93
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 241d983f-5cf2-4e8c-90da-db75da2bbeb9
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0634a2d-d921-4719-a1f1-7c3fa7578091
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05d6392f-86bb-4fc2-ba7b-14e0a56d3dac
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9af70bc-6da3-4b53-8c39-68c99008335d
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5115acf-fa00-49cf-8076-29e4de8f4ff2
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11c34ffb-994b-456f-a88b-6896698611d1
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27fbb800-1370-4cb4-b529-8ada40f9d639
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb73680a-75b8-47ce-a6ea-1d4526e392d2
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77503c62-40ce-4a09-a729-5fb9e89673c3
          stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45814d7e-3d7a-44c9-8cc5-c95e72db55e6
                stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ADMISSION_OFFER_05
        join:
          joinCondition: |-
            FROM s_waitlist_10
              LEFT OUTER JOIN (
                    SELECT waitlist_reference_no,
                           MIN(start_date) surgical_theatre_booking_date,
                           max(Create_date) Create_date
                      FROM ds_shared_schedule
                     WHERE schedule_type_code = 'THEAT'
                       AND schedule_theatre_status_code IN ('A','P')
                     GROUP BY waitlist_reference_no
                   ) s_schedule_05_ST
                ON s_schedule_05_ST.waitlist_reference_no = s_waitlist_10.waitlist_reference_no
               AND s_schedule_05_ST.surgical_theatre_booking_date >= s_waitlist_10.waiting_start_date
              LEFT OUTER JOIN (SELECT waitlist_reference_no,
                   coalesce(min(CASE WHEN attendance_status_code ='5' THEN start_date ELSE NULL END) ,min(CASE WHEN attendance_status_code <>'DNA' THEN start_date ELSE NULL END) ,MIN(start_date)) outpatient_appointment_date,
                   max(Create_date) Create_date ,
                   min(CASE WHEN attendance_status_code ='DNA' THEN NULL ELSE getdate() END) outpatient_appointment_date1 --added on 29.06.2023 SR          FROM ds_shared_schedule WHERE schedule_type_code = 'OTPAT' --AND attendance_status_code <> 'DNA'       AND schedule_status_code not in ('PLAND','CANCD') and cancellation_reason_date is null        and not (attendance_status_reference_no =  11306 and schedule_outcome_reference_no in(1000011609,201943) )              GROUP BY waitlist_reference_no) s_schedule_05_OP        ON s_schedule_05_OP.waitlist_reference_no = s_waitlist_10.waitlist_reference_no        AND s_schedule_05_OP.outpatient_appointment_date >= s_waitlist_10.waiting_start_date           LEFT OUTER JOIN (SELECT episode_wlist_refno, MAX(episode_start_date) episode_start_date      ,max(case when IFNULL(s_in_patient_stay_05.disch_date,getdate()+1) > getdate() then'Y' else 'N'end ) current_inpatient_flag          ,max(admit_date) admit_date      FROM s_in_patient_stay_05 GROUP BY episode_wlist_refno) s_in_patient_stay_05      ON  s_waitlist_10.waitlist_reference_no = s_in_patient_stay_05.episode_wlist_refno      LEFT OUTER JOIN (SELECT wlist_refno, MAX(to_come_in_date) to_come_in_date ,max(Create_date) Create_date      FROM s_admission_offer_05      WHERE s_admission_offer_05.cancel_date IS NULL       --AND s_admission_offer_05.patient_confirmation_status_code IN ('NSP','ACCEPT','INIRES')       AND s_admission_offer_05.offer_outcome_code IN ('NSP') --('CANCD','PATDC','DEATH','C','RMNWL','RFWL','NCONT','REJCT','P')      GROUP BY wlist_refno) s_admission_offer_05      ON s_waitlist_10.waitlist_reference_no = s_admission_offer_05.wlist_refno      --AND s_admission_offer_05.to_come_in_date >= s_waitlist_10.waiting_start_date        LEFT OUTER JOIN ds_shared_referral      ON s_waitlist_10.referral_reference_no = ds_shared_referral.refrl_refno      LEFT OUTER JOIN s_waitlist_ldd_data_value       ON s_waitlist_ldd_data_value.wlist_refno = s_waitlist_10.waitlist_reference_no            LEFT OUTER JOIN  s_admission_decision_05       on s_admission_decision_05.admission_decision_reference_no = s_waitlist_10.admission_decision_reference_no       and s_waitlist_10.referral_reference_no = s_admission_decision_05.referral_reference_no     AND s_admission_decision_05.proposed_date >= s_waitlist_10.waiting_start_date         LEFT OUTER join s_waitlist_suspension_summary_v         on s_waitlist_suspension_summary_v.waitlist_reference_no =s_waitlist_10.waitlist_reference_no
        name: S_WAITLIST_20
        noLinkRefs: []
  name: S_WAITLIST_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
