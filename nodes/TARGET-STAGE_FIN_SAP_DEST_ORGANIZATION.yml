fileVersion: 1
id: f855fd95-5d51-4361-9f0b-9737157c7afa
name: STAGE_FIN_SAP_DEST_ORGANIZATION
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfea301a-df45-4f65-9834-f989f3e9c546
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e24af2ee-132d-438a-b209-84c8ceaf2bb2
                stepCounter: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e4d1360-b9e9-4cf3-aa48-1dbbe44a7fb5
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e063e94c-f948-49aa-854c-1e1627c372f1
                stepCounter: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 676bd5cb-b653-4db6-bee1-fc096e7ab74c
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcf1d999-9d34-4b07-9e2f-80a0f4c7ff4f
                stepCounter: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de0f934a-6093-4475-8acd-0721d170a385
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: REPORTING_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'CAD'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6d3b268-6bbc-4dea-b7c5-81609a4b1c3b
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a96614c-663c-4d2e-bb75-dd84d3e0a8e7
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LAST_UPDT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a271908-3e56-438a-8303-08b6368aa07e
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: PROFILE_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb9d157a-97ad-4a90-bded-16285ff5ec08
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Boolean field indicating if this is a GAAP entity
        name: IS_GAAP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c3e93ea-5c1e-40e1-b0c1-f3cf074b7e27
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: IS_OPERATIONAL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28adec70-b246-46bd-9f2e-278d944b40f0
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: COUNTRY CODE
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8f2f01-31e2-48b1-8067-b0fc488c9733
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31e176c9-4f7f-4678-8d2c-7612c35dd72b
          stepCounter: f855fd95-5d51-4361-9f0b-9737157c7afa
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: Organization Country
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5762a6-a0d3-4039-b29e-82d024940177
                stepCounter: 142d1196-5f9a-4f07-a28a-43d43f678f01
            transform: ODS_SAP_HRRP_NODET_COUNTRY.NODETXT
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_T001: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
          ODS_SAP_T005T: b251a047-8d77-44ee-8632-1c3e4432df4b
          ODS_SAP_HRRP_NODE: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
          ODS_SAP_HRRP_NODET: 142d1196-5f9a-4f07-a28a-43d43f678f01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_T001
          - locationName: TARGET
            nodeName: ODS_SAP_T005T
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODE
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODET
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T001') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T001
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T005T') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T005T
                ON ODS_SAP_T001.LAND1 = ODS_SAP_T005T.LAND1
               AND ODS_SAP_T005T.SPRAS = 'E'
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_ORG_HIER_HRYID }}'
                       AND HRYVER = '{{ parameters.SAP_ORG_HIER_HRYVER_CURR }}'
                       AND NODETYPE= 'L'
                       AND HRYLEVEL = 2
                       AND HRYVALFROM <= CURRENT_TIMESTAMP
                       AND HRYVALTO >= CURRENT_TIMESTAMP
                   ) ODS_SAP_HRRP_NODE_ORG
                ON ODS_SAP_T001.BUKRS = ODS_SAP_HRRP_NODE_ORG.LEAFVALUE
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_ORG_HIER_HRYID }}'
                       AND HRYVER = '{{ parameters.SAP_ORG_HIER_HRYVER_CURR }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 1
                       AND HRYVALFROM <= CURRENT_TIMESTAMP
                       AND HRYVALTO >= CURRENT_TIMESTAMP
                   ) ODS_SAP_HRRP_NODE_COUNTRY
                ON ODS_SAP_HRRP_NODE_ORG.PARNODE = ODS_SAP_HRRP_NODE_COUNTRY.HRYNODE
               AND ODS_SAP_HRRP_NODE_ORG.HRYID = ODS_SAP_HRRP_NODE_COUNTRY.HRYID
               AND ODS_SAP_HRRP_NODE_ORG.HRYVER = ODS_SAP_HRRP_NODE_COUNTRY.HRYVER
               AND ODS_SAP_HRRP_NODE_ORG.NODECLS = ODS_SAP_HRRP_NODE_COUNTRY.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_ORG_HIER_HRYID }}'
                       AND HRYVER = '{{ parameters.SAP_ORG_HIER_HRYVER_CURR }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_COUNTRY
                ON ODS_SAP_HRRP_NODE_COUNTRY.HRYNODE = ODS_SAP_HRRP_NODET_COUNTRY.HRYNODE
               AND ODS_SAP_HRRP_NODE_COUNTRY.PARNODE = ODS_SAP_HRRP_NODET_COUNTRY.PARNODE
               AND ODS_SAP_HRRP_NODE_COUNTRY.HRYID = ODS_SAP_HRRP_NODET_COUNTRY.HRYID
               AND ODS_SAP_HRRP_NODE_COUNTRY.HRYVER = ODS_SAP_HRRP_NODET_COUNTRY.HRYVER
               AND ODS_SAP_HRRP_NODE_COUNTRY.NODECLS = ODS_SAP_HRRP_NODET_COUNTRY.NODECLS
        name: STAGE_FIN_SAP_DEST_ORGANIZATION
        noLinkRefs: []
  name: STAGE_FIN_SAP_DEST_ORGANIZATION
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
