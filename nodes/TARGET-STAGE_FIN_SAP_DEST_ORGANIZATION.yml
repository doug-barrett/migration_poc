fileVersion: 1
id: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
name: STAGE_FIN_SAP_DEST_ORGANIZATION
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e1e0f51-5b66-4b9e-aa0b-7f5e67338f5e
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aa7cd3f-0b22-40ff-889d-c7dc8bccf4aa
                stepCounter: 380b20ff-1088-454d-94c3-b7fc7688cca8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3db245f-4877-4c63-b0d4-3825e2ffc409
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c88df64-0b02-454e-98bb-f429ee21f644
                stepCounter: 380b20ff-1088-454d-94c3-b7fc7688cca8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50459ed2-2b5f-49fa-9d96-031aff8e7362
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52f34ac0-931a-40bc-b5a1-c6adf0942ffe
                stepCounter: 380b20ff-1088-454d-94c3-b7fc7688cca8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71d62d37-d21c-4bd3-bb9a-21ef9c4c8e30
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: REPORTING_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'CAD'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d5c3a37-f017-4b39-aeea-48ac68fe6cdb
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfb7c72e-5ef2-4149-b060-1c51d238ea98
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LAST_UPDT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30ba75c2-c860-4f3a-b9f5-f78342087716
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: PROFILE_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cedbef6-bf84-47ef-8c58-13133f3e9b02
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Boolean field indicating if this is a GAAP entity
        name: IS_GAAP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6708dd74-5a1e-4d71-858c-2fe03373168c
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: IS_OPERATIONAL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b607b50e-ff1f-459d-8b40-6515e9227db0
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: COUNTRY CODE
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4c3307-3453-4118-85b9-bf87830129a4
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d3445b6-6051-4810-8d9e-1d231e773579
          stepCounter: 68ff1aa1-c088-4bfd-82ee-12ea0a2ca697
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: Organization Country
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d6b59a9-750b-4306-9e88-0da463abed6b
                stepCounter: 4246f7de-3060-4b03-a92c-fa843d18bb32
            transform: ODS_SAP_HRRP_NODET_COUNTRY.NODETXT
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_T001: 380b20ff-1088-454d-94c3-b7fc7688cca8
          ODS_SAP_T005T: a33fc14a-3560-4ef2-ae35-d48eac2526aa
          ODS_SAP_HRRP_NODE: d2a87675-2043-44ed-828e-73f3eda32e04
          ODS_SAP_HRRP_NODET: 4246f7de-3060-4b03-a92c-fa843d18bb32
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_T001
          - locationName: TARGET
            nodeName: ODS_SAP_T005T
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODE
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODET
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T001') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T001
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T005T') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T005T
                ON ODS_SAP_T001.LAND1 = ODS_SAP_T005T.LAND1
               AND ODS_SAP_T005T.SPRAS = 'E'
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_ORG_HIER_HRYID }}'
                       AND HRYVER = '{{ parameters.SAP_ORG_HIER_HRYVER_CURR }}'
                       AND NODETYPE= 'L'
                       AND HRYLEVEL = 2
                       AND HRYVALFROM <= CURRENT_TIMESTAMP
                       AND HRYVALTO >= CURRENT_TIMESTAMP
                   ) ODS_SAP_HRRP_NODE_ORG
                ON ODS_SAP_T001.BUKRS = ODS_SAP_HRRP_NODE_ORG.LEAFVALUE
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_ORG_HIER_HRYID }}'
                       AND HRYVER = '{{ parameters.SAP_ORG_HIER_HRYVER_CURR }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 1
                       AND HRYVALFROM <= CURRENT_TIMESTAMP
                       AND HRYVALTO >= CURRENT_TIMESTAMP
                   ) ODS_SAP_HRRP_NODE_COUNTRY
                ON ODS_SAP_HRRP_NODE_ORG.PARNODE = ODS_SAP_HRRP_NODE_COUNTRY.HRYNODE
               AND ODS_SAP_HRRP_NODE_ORG.HRYID = ODS_SAP_HRRP_NODE_COUNTRY.HRYID
               AND ODS_SAP_HRRP_NODE_ORG.HRYVER = ODS_SAP_HRRP_NODE_COUNTRY.HRYVER
               AND ODS_SAP_HRRP_NODE_ORG.NODECLS = ODS_SAP_HRRP_NODE_COUNTRY.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_ORG_HIER_HRYID }}'
                       AND HRYVER = '{{ parameters.SAP_ORG_HIER_HRYVER_CURR }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_COUNTRY
                ON ODS_SAP_HRRP_NODE_COUNTRY.HRYNODE = ODS_SAP_HRRP_NODET_COUNTRY.HRYNODE
               AND ODS_SAP_HRRP_NODE_COUNTRY.PARNODE = ODS_SAP_HRRP_NODET_COUNTRY.PARNODE
               AND ODS_SAP_HRRP_NODE_COUNTRY.HRYID = ODS_SAP_HRRP_NODET_COUNTRY.HRYID
               AND ODS_SAP_HRRP_NODE_COUNTRY.HRYVER = ODS_SAP_HRRP_NODET_COUNTRY.HRYVER
               AND ODS_SAP_HRRP_NODE_COUNTRY.NODECLS = ODS_SAP_HRRP_NODET_COUNTRY.NODECLS
        name: STAGE_FIN_SAP_DEST_ORGANIZATION
        noLinkRefs: []
  name: STAGE_FIN_SAP_DEST_ORGANIZATION
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
