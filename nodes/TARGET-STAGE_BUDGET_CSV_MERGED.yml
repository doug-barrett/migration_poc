fileVersion: 1
id: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
name: STAGE_BUDGET_CSV_MERGED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "re-combine CSV data into one source file "
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d82579c-7dbd-46f3-9c25-44a01df0c680
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Common ID amungst all csv files (last 14 digits - timestamp)
        name: FILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ce0a475-c79e-4de9-a1d5-2ba22fcb888c
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: SUBSTRING(TARGET.LOAD_FILENAME,POSITION('.csv',TARGET.LOAD_FILENAME)-14,14)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59ad2b9f-e781-4cc7-89ce-564036975116
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Type of data in source CSV file. Prefix code of CSV file
        name: LOAD_FILE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ce0a475-c79e-4de9-a1d5-2ba22fcb888c
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: SUBSTRING(TARGET.LOAD_FILENAME,1,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea0f3a80-509e-4cab-9988-fdbb0ea583c2
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01c20db3-6952-45d9-97b3-8d1da0382e96
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.ORG_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3765d102-9ca1-4c7c-afaa-4d4c60129611
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: COST_CENTRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80fcc11a-428d-471f-8e09-7f7d3b7b857c
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.COST_CENTRE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 440b96a9-fd4c-483a-91dd-df92be7a7f88
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8867cd43-164c-4030-aeb8-a60bccba80d9
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.FUNCTIONAL_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d2c94ea-74ac-4e6a-9aad-7e7a67ebf999
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fe13209-25ef-4b81-abd6-1ba56fd99378
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.ACCOUNT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ac0a417-63c4-420d-b7bd-cb6d15b2bfca
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b9f6f4-5482-4aa9-8566-9c7d796ed5ca
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.AFE_TYPE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8870443-2c09-466a-8f53-1efb6904b801
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: GROSS_OR_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f38de065-ea74-4787-a336-8246a58c2f17
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.GROSS_OR_NET
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a720327c-38aa-49e7-92db-5a7e92bd391c
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: AMT_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49b517dd-5bc8-4044-b973-dba64ea00a28
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.AMT_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a728b502-4edc-4720-8489-8f9a43e1e59f
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: VOL_UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6edf3f0a-bd7b-4c92-b791-576258640c21
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.VOL_UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e702cc9d-36ca-440a-8a3b-651e4b5231a6
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: JAN_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cad0899-3e9a-49e4-b972-d35eefed6942
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.JAN_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54c79bdb-1bf8-42ed-80b9-2d20c351e3e9
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: FEB_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1edf4b1-0205-4dab-83d0-cad262c34460
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.FEB_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3302ae4e-5d8b-4b40-85a7-9cd24ae1f9a6
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MAR_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fde0f44-3ee9-4692-9ff6-693da00b80d4
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.MAR_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b84bd69-8b57-4666-80dc-fe8ed589ca7c
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: APR_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d7447e5-85f8-46a4-a88e-d23b85c9307c
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.APR_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 974e177f-b68b-4143-a354-2829b4eb5ccd
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MAY_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223f6d76-d04b-4c68-99d7-ec19c3bd4618
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.MAY_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b3e6e0b-ae57-4ac3-9ccb-c4ac18d938ea
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: JUN_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f69eb784-1e1e-476f-bb32-64f4548699a3
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.JUN_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81346833-cba3-4b47-a53a-b2b21559f206
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: JUL_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16d65313-5d7b-45ee-967e-0911c0f85671
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.JUL_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d0cbc32-05e3-4531-9c73-6da75b68a25c
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: AUG_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c27a9a3f-e39f-469d-9a15-246868a1cfef
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.AUG_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67256c7e-c9ea-4b7c-988a-2ab8ce6b87ee
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: SEP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c91a2613-190c-402b-b6c3-07312c4aa92e
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.SEP_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07e12baa-b7f7-4967-93a2-d4ede2a43d66
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: OCT_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d71857e2-64b9-44ce-96d3-98c4c3550fec
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.OCT_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9fba8ae-c682-4e88-828c-84dbf0b80648
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: NOV_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0457f61-756b-43bc-9dde-f023931e2156
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.NOV_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d1e888-dc2b-46cf-8722-b367b47e06e4
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: DEC_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c14d6da-a4ed-4aaa-b5b2-da216ef201f8
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.DEC_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cbc6e82-d393-4ff2-98a2-dd6b792c063f
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ORIG_FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9365a56-05cf-452a-956e-63cdc66d941a
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.ORIG_FILENAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 781f54c1-0948-4331-812a-a5b4a6238b94
          stepCounter: fae5b5bc-ed57-42dc-91a9-3fa9efc79408
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: LOAD_FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ce0a475-c79e-4de9-a1d5-2ba22fcb888c
                stepCounter: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
            transform: TARGET.LOAD_FILENAME
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_BUDGET_CSV_GAA: 78d52cdb-b1e3-4a18-baee-5c44cccf5cd1
          LOAD_BUDGET_CSV_HEG: db9f4a84-9842-4552-85aa-1dd3d2a64050
          LOAD_BUDGET_CSV_OPX: 59f36797-aabe-4df3-a15d-4558d62e4a00
          LOAD_BUDGET_CSV_REV: cb044e7d-aba2-4ab9-9842-c6debeb87dda
          LOAD_BUDGET_CSV_ROY: 8f7f540c-de99-464f-b401-5adc11ac5fcd
          LOAD_BUDGET_CSV_TRA: 0223ad7b-88d9-423c-8074-7139691e22ce
          LOAD_BUDGET_CSV_TAX: ea825a62-bc1b-4f69-a890-b1f900cc2769
          LOAD_BUDGET_CSV_CAP: a7b02812-c4fb-48d4-8f42-de62ac38dccb
          LOAD_BUDGET_CSV_VOL: 5e72dadb-af3a-47d1-9130-22d3b9bcb912
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_GAA
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_HEG
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_OPX
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_REV
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_ROY
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_TRA
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_TAX
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_CAP
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_VOL
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_GAA') }} LOAD_BUDGET_CSV_GAA
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_HEG') }} LOAD_BUDGET_CSV_HEG
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_OPX') }} LOAD_BUDGET_CSV_OPX
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_REV') }} LOAD_BUDGET_CSV_REV
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_ROY') }} LOAD_BUDGET_CSV_ROY
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_TRA') }} LOAD_BUDGET_CSV_TRA
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_TAX') }} LOAD_BUDGET_CSV_TAX
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_CAP') }} LOAD_BUDGET_CSV_CAP
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_VOL') }} LOAD_BUDGET_CSV_VOL
                   ) AS TARGET
        name: STAGE_BUDGET_CSV_MERGED
        noLinkRefs: []
  name: STAGE_BUDGET_CSV_MERGED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
