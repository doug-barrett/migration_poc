fileVersion: 1
id: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
name: STAGE_BUDGET_CSV_MERGED
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "re-combine CSV data into one source file "
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c3991f7-a82d-47a9-a99b-5cb5891ee5d9
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Common ID amungst all csv files (last 14 digits - timestamp)
        name: FILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f54f1c0-285c-4d20-bf26-4fff423a33b7
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: SUBSTRING(TARGET.LOAD_FILENAME,POSITION('.csv',TARGET.LOAD_FILENAME)-14,14)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a40e0589-e316-42db-99b3-3336e5dc7973
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Type of data in source CSV file. Prefix code of CSV file
        name: LOAD_FILE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f54f1c0-285c-4d20-bf26-4fff423a33b7
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: SUBSTRING(TARGET.LOAD_FILENAME,1,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2492b69e-023e-49b5-8037-f0c833ba4dfc
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc2d2d8a-657f-46da-8090-cdc63a5e06cd
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.ORG_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f6df525-b267-48f7-a220-4ba0d8a3d334
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: COST_CENTRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f60eb08a-34d6-4217-ae99-cd49627d4e4f
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.COST_CENTRE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4568a37b-8b2a-4847-b829-5d964598e838
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd1de6e8-0a9c-4d2d-ada8-c9c61abe013b
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.FUNCTIONAL_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a510e23-7184-4bcb-9006-28685eecb53e
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34e55bab-b956-4149-818d-e3157b6ccdd1
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.ACCOUNT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dfa50d1-e6fe-4def-a062-7993ccd04900
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca7f94c9-a4ca-4948-b9e4-d44b903f30c0
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.AFE_TYPE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b467ec90-0249-49e7-ba72-3b0bbc255449
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: GROSS_OR_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf8d5029-0743-4aab-ae3f-eb8ea07b5436
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.GROSS_OR_NET
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85bc38ea-0f5c-454d-be1a-04a578f808a5
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: AMT_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e7f1586-db5c-463e-8e4e-1b0a3edb2a19
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.AMT_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9fc2ec4-4734-46e6-a07d-d2071bb73325
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: VOL_UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 430f6482-987d-44cd-adaf-5e782626ffc4
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.VOL_UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4afad83-3fb1-4d3b-ad57-7407d0d41eb3
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: JAN_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a60fa60f-3f94-4455-b017-7e8684de88e1
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.JAN_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dd45c6d-7d9a-43db-8573-dd0cea26aa8b
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: FEB_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8870d368-c143-4f71-920b-6fd4783a51a9
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.FEB_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d13e577c-4578-4c6e-87cf-4dde588f3a39
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MAR_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04969ce6-d2a9-48d6-bc41-66324cc97454
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.MAR_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb9d963b-c0b1-4757-a672-fbbca5d01b31
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: APR_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01c25b35-0ea9-4c7c-a4f9-10c7e591fe7e
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.APR_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6756870-b3e5-4c29-99bf-e3ab4ab4eac1
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MAY_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e01ac40c-c53d-4f1b-9a49-c5f5c01a67e1
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.MAY_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 176ef048-603f-4178-85d9-7ba796a2fef9
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: JUN_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00287483-b3e3-4687-961f-b35807ba32a3
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.JUN_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36e05e6c-2212-4f77-9f5b-d44ab252570a
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: JUL_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dd5c856-7581-4e81-9616-5022c2884248
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.JUL_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0c54b99-3b1c-41f3-b53a-486297b3eefd
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: AUG_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43520fdc-84de-423e-b61b-3342f88d4b33
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.AUG_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eac53410-2717-4ec7-ae7b-06245e70d23a
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: SEP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8edfd3b-e453-464a-b0c8-205a25b96aa0
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.SEP_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07c04085-3289-415d-b308-7f74431ad0ad
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: OCT_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 199eb543-b000-43d2-99c6-70cf4cf7066e
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.OCT_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fd0c30f-c57e-480c-9c2a-1bd1f566f261
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: NOV_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3b6e086-6f8c-4bc1-aac2-a53452285232
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.NOV_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b37dcbd-d198-4371-a1db-d9d4f7cfc7a0
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: DEC_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea2ed886-3477-4ec9-bc0d-255832cb3320
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.DEC_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb93bde3-13bc-47aa-a236-9ad82078753e
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ORIG_FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67d20116-d49d-4018-a551-7a25f72215fc
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.ORIG_FILENAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d57141f1-e241-485b-8c00-07809935272d
          stepCounter: 7076e83f-2407-40e7-bdbe-b899e0bfb4e5
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: LOAD_FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f54f1c0-285c-4d20-bf26-4fff423a33b7
                stepCounter: 9e5727b2-fb57-479c-9167-581cc45736a1
            transform: TARGET.LOAD_FILENAME
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_BUDGET_CSV_GAA: 9e5727b2-fb57-479c-9167-581cc45736a1
          LOAD_BUDGET_CSV_HEG: 36c216f4-1bdb-49e0-b0f7-235882dfaca2
          LOAD_BUDGET_CSV_OPX: f481eb81-8791-4fca-b3a4-3187d6b10fe4
          LOAD_BUDGET_CSV_REV: a5827dfb-cf83-482f-8b59-067abbbb0661
          LOAD_BUDGET_CSV_ROY: 141c2927-eddc-4f09-80be-4fcb285c9b2b
          LOAD_BUDGET_CSV_TRA: cafd9219-990d-4c4e-9e5d-bd161f086ce1
          LOAD_BUDGET_CSV_TAX: 1999efb5-1fe3-4d66-a972-c00f8f9a364b
          LOAD_BUDGET_CSV_CAP: 8fb4db6b-203c-4d56-adf9-a2b8d6c8442b
          LOAD_BUDGET_CSV_VOL: 72b01852-d9f4-42fe-9021-418c9d07212a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_GAA
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_HEG
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_OPX
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_REV
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_ROY
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_TRA
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_TAX
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_CAP
          - locationName: TARGET
            nodeName: LOAD_BUDGET_CSV_VOL
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_GAA') }} LOAD_BUDGET_CSV_GAA
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_HEG') }} LOAD_BUDGET_CSV_HEG
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_OPX') }} LOAD_BUDGET_CSV_OPX
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_REV') }} LOAD_BUDGET_CSV_REV
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_ROY') }} LOAD_BUDGET_CSV_ROY
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_TRA') }} LOAD_BUDGET_CSV_TRA
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_TAX') }} LOAD_BUDGET_CSV_TAX
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_CAP') }} LOAD_BUDGET_CSV_CAP
                 UNION ALL SELECT *
                      FROM {{ ref('TARGET','LOAD_BUDGET_CSV_VOL') }} LOAD_BUDGET_CSV_VOL
                   ) AS TARGET
        name: STAGE_BUDGET_CSV_MERGED
        noLinkRefs: []
  name: STAGE_BUDGET_CSV_MERGED
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
