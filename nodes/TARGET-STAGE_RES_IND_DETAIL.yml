fileVersion: 1
id: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
name: STAGE_RES_IND_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "This staging view contains all of the field mapping and calculations that translate field data from ECONOMIC_INDICATOR into Variable data in the Reserves Model. Created as UDV due to Wherescape statement length limitations (12000 chars, 170 lines)"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4ca7c82-adc7-4c16-94d0-84d7886a5690
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d8e331a-517f-46f0-a9d8-b9b1b85df092
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6286804-75b9-4550-9d02-0b40a9252a81
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 098bc570-5dd9-4bbb-aeeb-778b02f4c6cb
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc83b58c-abd7-4d27-b1e8-8218d2b404f5
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5773afd5-b3ee-4391-b6de-8f3298e4ea55
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10ac6702-7975-46e6-989c-9416811c12bf
                stepCounter: 9d6c0752-b0d7-434d-9272-d6cea2151615
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fccc1b6-e41a-45ca-bfcb-7864f4c79e2f
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffadff7d-17ab-4045-8e94-7e3e155d78e8
                stepCounter: 9d6c0752-b0d7-434d-9272-d6cea2151615
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43911d5d-2cd6-478f-a64f-544020857a3a
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 742aef7f-a280-48c3-9261-ca2c12edf918
                stepCounter: 9d6c0752-b0d7-434d-9272-d6cea2151615
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b15ae954-8e6b-4c95-bfe6-6f408fb80d90
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_UOM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9de5ed41-cc90-471c-8fd1-21a34afe55c5
          stepCounter: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_IND_DETAIL: c50b3273-2dd4-4c87-ab89-1cfb9447cac7
          ODS_MOSAIC_RES_ECONOMIC_INDICATOR: ef7c0219-5c46-4d11-9a05-d34b210c098a
          DIM_RES_VARIABLE_TYPE: 9d6c0752-b0d7-434d-9272-d6cea2151615
          DIM_RES_UOM: f0e180d9-ef3f-4224-9cf5-3357b905ad07
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_RES_IND_DETAIL') }} AS SELECT TARGET.RESULT_ID AS RESULT_ID ,
                   TARGET.RESERVE_CATEGORY_ID AS RESERVE_CATEGORY_ID ,
                   TARGET.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                   NVL(TARGET.DIM_VARIABLE_TYPE_KEY,0) AS DIM_VARIABLE_TYPE_KEY ,
                   TARGET.UOM_CODE AS UOM_CODE ,
                   NVL(DIM_RES_UOM.DIM_UOM_KEY,0) AS DIM_UOM_KEY ,
                   TARGET.VALUE AS VALUE
              FROM (
                    SELECT ODS_MOSAIC_RES_ECONOMIC_INDICATOR.RESULT_ID AS RESULT_ID ,
                           ODS_MOSAIC_RES_ECONOMIC_INDICATOR.RESERVE_CATEGORY_ID AS RESERVE_CATEGORY_ID ,
                           DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                           DIM_RES_VARIABLE_TYPE.DIM_VARIABLE_TYPE_KEY AS DIM_VARIABLE_TYPE_KEY ,
                           DIM_RES_VARIABLE_TYPE.UOM_CODE AS UOM_CODE ,
                           DECODE(DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE , 'NPV_INVESTMENT_ATAX_0', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_investment_0_atax,0) , 'NPV_CASH_FLOW_BTAX_0', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_0_btax,0) , 'NPV_CASH_FLOW_BTAX_5', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_1_btax,0) , 'NPV_CASH_FLOW_BTAX_10', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_2_btax,0) , 'NPV_CASH_FLOW_BTAX_12', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_3_btax,0) , 'NPV_CASH_FLOW_BTAX_15', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_4_btax,0) , 'NPV_CASH_FLOW_BTAX_20', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_5_btax,0) , 'NPV_CASH_FLOW_ATAX_0', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_0_atax,0) , 'NPV_CASH_FLOW_ATAX_5', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_1_atax,0) , 'NPV_CASH_FLOW_ATAX_10', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_2_atax,0) , 'NPV_CASH_FLOW_ATAX_12', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_3_atax,0) , 'NPV_CASH_FLOW_ATAX_15', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_4_atax,0) , 'NPV_CASH_FLOW_ATAX_20', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_5_atax,0) , 'NPV_DISC_INVEST_BTAX', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_detail_btax,0) , 'NPV_DISC_INVEST_BTAX_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_investment_detail_btax,0) , 'BTAX_DISC_ROR', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.btax_dcf_ror,0) , 'COST_OF_RESERVES', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_investment_0_btax,0)*1000 , 'COST_OF_RESERVES_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0)*1000 , 'AVG_COSHARE_BURDEN_RATE', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.net_burdens_total,0) , 'AVG_COSHARE_BURDEN_RATE_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_co_share_revenue_total,0) + NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_co_share_revenue_total,0) + NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_co_share_revenue_total,0) , 'AVG_OPCOST_PER_COSHARE_BOE', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.total_opcosts,0)*1000 , 'AVG_OPCOST_PER_COSHARE_BOE_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0)*1000 , 'NETBACK_PER_COSHARE_BOE', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_op_income_0_btax,0)*1000 , 'NETBACK_PER_COSHARE_BOE_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0)*1000 , 'OIL_TECH_REM_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_tech_rem_rec,0) , 'OIL_TECH_ULT_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_tech_ult_rec,0) , 'GAS_TECH_REM_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_tech_rem_rec,0) , 'GAS_TECH_ULT_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_tech_ult_rec,0) , 'NGL_TECH_REM_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_tech_rem_rec,0) , 'NGL_TECH_ULT_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_tech_ult_rec,0) , 'OIL_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_gross_total,0) , 'OIL_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_wi_total,0) , 'OIL_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_wi_total,0)) , 'OIL_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_company_share_total,0) , 'OIL_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_company_net_total,0) , 'GAS_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_gross_total,0) , 'GAS_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_wi_total,0) , 'GAS_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_wi_total,0)) , 'GAS_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_company_share_total,0) , 'GAS_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_company_net_total,0) , 'NGL_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_gross_total,0) , 'NGL_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_wi_total,0) , 'NGL_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_wi_total,0)) , 'NGL_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_company_share_total,0) , 'NGL_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_company_net_total,0) , 'BOE_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_gross_total,0) , 'BOE_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_wi_total,0) , 'BOE_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_wi_total,0)) , 'BOE_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0) , 'BOE_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_net_total,0) , NULL) AS VALUE
                      FROM {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_INDICATOR') }} ODS_MOSAIC_RES_ECONOMIC_INDICATOR
                     CROSS JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
                             WHERE VARIABLE_TYPE_SRC = 'IND'
                           ) DIM_RES_VARIABLE_TYPE
                     WHERE ODS_MOSAIC_RES_ECONOMIC_INDICATOR.DSS_CURRENT_FLAG = 'Y'
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_RES_UOM') }} DIM_RES_UOM
                ON TARGET.UOM_CODE = DIM_RES_UOM.UOM_CODE
             WHERE VALUE <> 0
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_INDICATOR
          - locationName: TARGET
            nodeName: DIM_RES_VARIABLE_TYPE
          - locationName: TARGET
            nodeName: DIM_RES_UOM
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_INDICATOR') }}
            {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
            {{ ref('TARGET','DIM_RES_UOM') }}
        name: STAGE_RES_IND_DETAIL
        noLinkRefs: []
  name: STAGE_RES_IND_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
