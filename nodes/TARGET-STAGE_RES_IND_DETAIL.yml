fileVersion: 1
id: 0b046900-e6b6-45fe-919e-5a8683ece34c
name: STAGE_RES_IND_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "This staging view contains all of the field mapping and calculations that translate field data from ECONOMIC_INDICATOR into Variable data in the Reserves Model. Created as UDV due to Wherescape statement length limitations (12000 chars, 170 lines)"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6612503e-b2d6-4940-8265-79a22cf9f733
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76657691-817c-4c04-8958-0771a4a998a9
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62570d03-53cb-4642-885e-896c4ad2e248
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0ede14f-581b-406c-a65e-803534532f24
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16685c0b-452d-4f6b-bb80-08e2089ce6cf
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30eb1423-fc38-4b15-8267-a60131d9127a
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f2e5825-f361-4b61-868c-7659417837ef
                stepCounter: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17364d1d-4287-451f-bd11-1cb4760f6516
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04e84d20-5874-43da-b85e-3f14ff1846c6
                stepCounter: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd262c94-118f-45f2-9c49-81a0cdd44119
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e8d5f8d-975f-4091-9bb9-f31906ae2223
                stepCounter: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87e92134-9acc-4531-ba1d-4f7e6ce9f958
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_UOM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a99bbe60-b367-431f-abce-d434c359c617
          stepCounter: 0b046900-e6b6-45fe-919e-5a8683ece34c
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_IND_DETAIL: 0b046900-e6b6-45fe-919e-5a8683ece34c
          ODS_MOSAIC_RES_ECONOMIC_INDICATOR: 0421b95d-f6de-470a-bbba-510d3f56a6af
          DIM_RES_VARIABLE_TYPE: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
          DIM_RES_UOM: dedd823c-0562-4243-bfc9-1a49f49322d4
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_RES_IND_DETAIL') }} AS SELECT TARGET.RESULT_ID AS RESULT_ID ,
                   TARGET.RESERVE_CATEGORY_ID AS RESERVE_CATEGORY_ID ,
                   TARGET.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                   NVL(TARGET.DIM_VARIABLE_TYPE_KEY,0) AS DIM_VARIABLE_TYPE_KEY ,
                   TARGET.UOM_CODE AS UOM_CODE ,
                   NVL(DIM_RES_UOM.DIM_UOM_KEY,0) AS DIM_UOM_KEY ,
                   TARGET.VALUE AS VALUE
              FROM (
                    SELECT ODS_MOSAIC_RES_ECONOMIC_INDICATOR.RESULT_ID AS RESULT_ID ,
                           ODS_MOSAIC_RES_ECONOMIC_INDICATOR.RESERVE_CATEGORY_ID AS RESERVE_CATEGORY_ID ,
                           DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                           DIM_RES_VARIABLE_TYPE.DIM_VARIABLE_TYPE_KEY AS DIM_VARIABLE_TYPE_KEY ,
                           DIM_RES_VARIABLE_TYPE.UOM_CODE AS UOM_CODE ,
                           DECODE(DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE , 'NPV_INVESTMENT_ATAX_0', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_investment_0_atax,0) , 'NPV_CASH_FLOW_BTAX_0', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_0_btax,0) , 'NPV_CASH_FLOW_BTAX_5', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_1_btax,0) , 'NPV_CASH_FLOW_BTAX_10', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_2_btax,0) , 'NPV_CASH_FLOW_BTAX_12', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_3_btax,0) , 'NPV_CASH_FLOW_BTAX_15', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_4_btax,0) , 'NPV_CASH_FLOW_BTAX_20', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_5_btax,0) , 'NPV_CASH_FLOW_ATAX_0', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_0_atax,0) , 'NPV_CASH_FLOW_ATAX_5', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_1_atax,0) , 'NPV_CASH_FLOW_ATAX_10', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_2_atax,0) , 'NPV_CASH_FLOW_ATAX_12', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_3_atax,0) , 'NPV_CASH_FLOW_ATAX_15', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_4_atax,0) , 'NPV_CASH_FLOW_ATAX_20', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_5_atax,0) , 'NPV_DISC_INVEST_BTAX', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_cash_flow_detail_btax,0) , 'NPV_DISC_INVEST_BTAX_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_investment_detail_btax,0) , 'BTAX_DISC_ROR', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.btax_dcf_ror,0) , 'COST_OF_RESERVES', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_investment_0_btax,0)*1000 , 'COST_OF_RESERVES_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0)*1000 , 'AVG_COSHARE_BURDEN_RATE', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.net_burdens_total,0) , 'AVG_COSHARE_BURDEN_RATE_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_co_share_revenue_total,0) + NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_co_share_revenue_total,0) + NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_co_share_revenue_total,0) , 'AVG_OPCOST_PER_COSHARE_BOE', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.total_opcosts,0)*1000 , 'AVG_OPCOST_PER_COSHARE_BOE_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0)*1000 , 'NETBACK_PER_COSHARE_BOE', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.npv_op_income_0_btax,0)*1000 , 'NETBACK_PER_COSHARE_BOE_DENOM', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0)*1000 , 'OIL_TECH_REM_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_tech_rem_rec,0) , 'OIL_TECH_ULT_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_tech_ult_rec,0) , 'GAS_TECH_REM_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_tech_rem_rec,0) , 'GAS_TECH_ULT_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_tech_ult_rec,0) , 'NGL_TECH_REM_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_tech_rem_rec,0) , 'NGL_TECH_ULT_REC', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_tech_ult_rec,0) , 'OIL_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_gross_total,0) , 'OIL_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_wi_total,0) , 'OIL_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_wi_total,0)) , 'OIL_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_company_share_total,0) , 'OIL_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.oil_company_net_total,0) , 'GAS_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_gross_total,0) , 'GAS_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_wi_total,0) , 'GAS_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_wi_total,0)) , 'GAS_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_company_share_total,0) , 'GAS_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.gas_company_net_total,0) , 'NGL_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_gross_total,0) , 'NGL_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_wi_total,0) , 'NGL_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_wi_total,0)) , 'NGL_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_company_share_total,0) , 'NGL_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.ngl_company_net_total,0) , 'BOE_GROSS_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_gross_total,0) , 'BOE_WI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_wi_total,0) , 'BOE_RI_TOTAL', (NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0) - NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_wi_total,0)) , 'BOE_COMPANY_SHARE_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_share_total,0) , 'BOE_COMPANY_NET_NRI_TOTAL', NVL(ODS_MOSAIC_RES_ECONOMIC_INDICATOR.boe_company_net_total,0) , NULL) AS VALUE
                      FROM {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_INDICATOR') }} ODS_MOSAIC_RES_ECONOMIC_INDICATOR
                     CROSS JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
                             WHERE VARIABLE_TYPE_SRC = 'IND'
                           ) DIM_RES_VARIABLE_TYPE
                     WHERE ODS_MOSAIC_RES_ECONOMIC_INDICATOR.DSS_CURRENT_FLAG = 'Y'
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_RES_UOM') }} DIM_RES_UOM
                ON TARGET.UOM_CODE = DIM_RES_UOM.UOM_CODE
             WHERE VALUE <> 0
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_INDICATOR
          - locationName: TARGET
            nodeName: DIM_RES_VARIABLE_TYPE
          - locationName: TARGET
            nodeName: DIM_RES_UOM
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_INDICATOR') }}
            {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
            {{ ref('TARGET','DIM_RES_UOM') }}
        name: STAGE_RES_IND_DETAIL
        noLinkRefs: []
  name: STAGE_RES_IND_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
