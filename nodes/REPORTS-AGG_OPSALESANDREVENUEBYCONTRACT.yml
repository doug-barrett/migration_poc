fileVersion: 1
id: 8f60b63c-7470-4168-aa9e-3ae207725dbd
name: AGG_OPSALESANDREVENUEBYCONTRACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "CONTAINS ONLY UC CAMPUS SALES RECORDS ONLY."
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63d4b515-ce9c-453d-8df5-b87290c1f058
          stepCounter: 8f60b63c-7470-4168-aa9e-3ae207725dbd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: AGGOPSALESANDREVENUEBYCONTRACT.CONTRACTID=CONTRACT.CONTRACTID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa56b5fa-e1a4-4b2c-9835-38977ac98672
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cf933f4-9ec4-489b-880d-c3fc1b470936
          stepCounter: 8f60b63c-7470-4168-aa9e-3ae207725dbd
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d890024d-a49c-4151-8fb1-94da39d45de6
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02a81959-3fd5-48f6-aa74-83a358b59d6e
          stepCounter: 8f60b63c-7470-4168-aa9e-3ae207725dbd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72e0a5ad-993a-436d-a39d-e7e8d5642bed
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d048c0e-bcaf-49ac-afa9-7df8f817e1a9
          stepCounter: 8f60b63c-7470-4168-aa9e-3ae207725dbd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CAMPUS=UCCAMPUS.UCCAMPUS
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03272029-1989-49d8-960d-2c8a50596959
                stepCounter: f40ae327-6f80-42a9-8c61-95ea4e2660a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 517131d6-aa38-48d5-80e6-d074aaae1843
          stepCounter: 8f60b63c-7470-4168-aa9e-3ae207725dbd
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: IS THE SALES AMOUNT, OR GROSS TRANSACTION VOLUME (GTV), ASSOCIATED WITH A TRANSACTION IN US DOLLARS. A SALES AMOUNT IS TYPICALLY NOT AN INDIVIDUAL SALE, BUT A MONTHLY AGGREGATE OF ALL SALES FOR A CUSTOMER IN A GIVEN MONTH.
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88d891f1-4009-4fad-846f-67b858ce11b0
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024c8264-7de4-47bc-abf4-3caf4bb9804a
          stepCounter: 8f60b63c-7470-4168-aa9e-3ae207725dbd
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: IS THE AMOUNT OF GROSS REVENUE, ALWAYS IN US DOLLARS, OMNIA PARTNERS RECIEVED FOR THE ROW.
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0764b9a5-3c5c-46b8-bc39-4769f4f16eac
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: SUM(SALESANDREVENUE.REVENUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          SALESANDREVENUE: bc791129-d159-4fb2-a8c8-429979cdade2
          ACCOUNTHIERARCHY: 1ed1fca5-de55-4617-811c-452425d1a2d9
          UCCAMPUS: f40ae327-6f80-42a9-8c61-95ea4e2660a7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: FACT
            nodeName: SALESANDREVENUE
          - locationName: DIM
            nodeName: ACCOUNTHIERARCHY
        join:
          joinCondition: |-
            FROM {{ ref('FACT','SALESANDREVENUE') }} SALESANDREVENUE
              JOIN {{ ref('DIM','ACCOUNTHIERARCHY') }} ACCOUNTHIERARCHY
                ON SALESANDREVENUE.ACCOUNTHIERARCHYKEY = ACCOUNTHIERARCHY.ACCOUNTHIERARCHYKEY
              JOIN {{ ref('DIM','UCCAMPUS') }} UCCAMPUS
                ON ACCOUNTHIERARCHY.LEVEL1FORCEID = UCCAMPUS.OPCAMPUSFORCEID
             GROUP BY SALESANDREVENUE.CONTRACTKEY,
                      SALESANDREVENUE.TRANSACTIONDATEKEY,
                      SALESANDREVENUE.CONTRACTID,
                      UCCAMPUS.UCCAMPUSKEY
        name: AGGOPSALESANDREVENUEBYCONTRACT
        noLinkRefs: []
  name: AGG_OPSALESANDREVENUEBYCONTRACT
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
