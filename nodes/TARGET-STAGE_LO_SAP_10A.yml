fileVersion: 1
id: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
name: STAGE_LO_SAP_10A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84bfbbb3-ff6c-404e-9dc9-3aff65ada7ab
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1258423-8bca-495c-b394-c81ac9f2d989
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7421cb05-054d-457f-ba7f-e80c73da2a77
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 859de73e-b5ec-430d-b4d8-ccad7f881b7a
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4820b427-7596-4150-b88f-9193ef842af9
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ed788e7-ce47-4741-a23f-bdfb436b4d80
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 960e0e37-65eb-44c9-8f96-50d0a0d8d42a
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fbf13ff-d5b4-44e8-a63c-4081f19e2a94
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d79f291-e9ba-4ca9-a68c-51b50bf63a36
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 436912b6-ca30-4068-bf09-41f8a9d91997
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db90c00a-75e2-4e23-94d3-9333855147f7
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 094ed09a-0bcb-49f4-864f-55031605ff52
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b21617f5-4981-49b3-99e5-f931b3752027
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6557a85-93d1-4f38-a780-2c04db739e6d
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 003c3bd3-dbce-4ecc-aefd-51ec1c93cf89
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4c7b980-0b62-4e74-ba17-2502fd44d53a
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09f74adc-f250-4314-92be-bd8af6b71815
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c75f806-8f0a-4f5b-89e7-3cf9f91d146d
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72aab4e0-ff91-4296-a8da-c1a68e1688e2
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac10fd3f-57d3-4b95-8273-e8f960ff17f2
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 488a571d-afa8-4dbf-9b18-0cfc5c30596e
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2410146-79e8-4897-b336-578574f670a3
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21150472-32d7-4a7c-a743-2c9c91ab1a26
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6acc76ae-4f3e-4360-a20f-370c05b039bf
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a978f651-4000-4e45-b5b3-7dbe16df821f
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3c14653-d6e2-452f-b70b-1545b5d554fa
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3f1d628-2271-4df1-88f6-7a7aacbd74b4
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81145607-b5d2-46d1-9815-b47df14fbfba
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: SUM(STAGE_LO_SAP_10.LI_VOL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1bac5e5-79a0-452d-8a58-c176baca9414
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54d6074e-69c7-4529-a783-283248126480
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: SUM(DECODE(STAGE_LO_SAP_10.LINE_NO, '10.4',STAGE_LO_SAP_10.LI_VOL_M3*'{{ parameters.M3_BOE_FACTOR }}', STAGE_LO_SAP_10.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5ff38a1-7576-441a-9322-3308e9afd221
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a7c5b9-419d-47f0-a170-31133ccde8c0
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: SUM(DECODE(STAGE_LO_SAP_10.LINE_NO, '10.4',STAGE_LO_SAP_10.LI_VOL_IMPERIAL/'{{ parameters.GAS_IMPERIAL_FACTOR }}', STAGE_LO_SAP_10.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f482ff53-27e0-40d7-9f70-a36a47a11604
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95e6dca3-166e-49d4-a217-48f7a916751a
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: SUM(STAGE_LO_SAP_10.LI_VOL_BOE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa4244ee-4863-4ce5-a29c-b99ba432f511
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfac5b1b-2d2a-4be0-a235-129a1969ba1d
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: SUM(DECODE(STAGE_LO_SAP_10.LINE_NO, '10.4',STAGE_LO_SAP_10.LI_VOL_NM3*'{{ parameters.NM3_BOE_FACTOR }}', STAGE_LO_SAP_10.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c37bdd-ac82-405f-97bc-df690e728f14
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e29e7037-fcd1-4f2e-b968-6cd5009eb88e
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f65ab253-ac4d-4430-b673-5b85c95060b2
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45dd3721-517c-4f04-a801-12b12cc97205
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17bec0d0-940a-47c0-a273-45d75152655d
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dd912d9-6833-49c5-aff6-1a82b71a6c24
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f6c7311-e5b3-4023-abd4-ed6593e157db
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6df83e0-e869-4599-9a37-087b4329141e
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57d4dd59-cc2d-43a4-bb8f-9790d8cff937
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de842ef1-7efb-47e4-9c29-3d717c4e1a2e
          stepCounter: 4f6d9e58-7d85-4d7e-b995-f32c6a8104c1
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_10: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_10
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_10') }} STAGE_LO_SAP_10
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '10A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY STAGE_LO_SAP_10.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_10.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_10.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_10.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_10.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_10.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_10.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_10.EXCHANGE_RATE,
                      STAGE_LO_SAP_10.OP_CURR_CODE,
                      STAGE_LO_SAP_10.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_10.OP_NONOP
        name: STAGE_LO_SAP_10A
        noLinkRefs: []
  name: STAGE_LO_SAP_10A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
