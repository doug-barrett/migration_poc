fileVersion: 1
id: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
name: STAGE_LO_SAP_10A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63f72aed-7364-445e-bf7c-40b5ba9a54d9
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8c663ac-22f4-4b46-877d-11cc2bc78d31
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df9ee68b-6de4-4adf-bfcb-7df1a084acd1
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ebf187f-83ac-43eb-9d1f-b1d949f27441
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ced6ab-aac3-4253-bc10-9644f5fec587
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed153bb2-007b-4e88-8f6d-53b6df77792a
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20045299-c50c-45d2-abcf-55b0fac46ae1
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50825b23-7cbb-40bd-a90f-8a2262f38ff5
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 409aad57-94b5-4bc9-8e30-53f31cfdc7e7
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbc9a22d-aee7-4188-b8e3-8ce6ce71e345
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f28a07f3-e352-422d-9e60-73099b1b57b4
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e65425a3-8aab-4b82-9f96-c0e65a9e6f5c
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a795c57-7121-46ee-b12f-4a4827cff77d
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36846aaf-3755-4e0b-b5d8-6abee9bba8c2
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e228038-4f80-41e3-b763-3fcb637008f1
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9afe614-a06f-401d-b4d1-faa98dacf858
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80c98d84-2f63-4474-b8cd-1887a8d9e2f6
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2bc8e21-e1be-4920-8b28-d2937440fef4
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db740c81-35db-4afd-8407-fd90948803bd
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29bfb66c-6181-4b93-8c16-8b306a5d349c
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d61839f-52dd-4ce4-8915-433ade7f4374
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc0dbb7d-0e55-442f-b322-b5282f14b74a
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b1b11f7-fb87-4617-9018-26e8dae31c3c
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87243d28-0031-41b4-b340-175f4fa27f15
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faaf8d2a-a6b2-4e18-a16e-32267028bf66
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8041a62-27a0-4792-a264-7bbd915a3be3
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f673208-b281-41b0-b868-4b125e35774a
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32ee36f5-6451-490f-b2ec-0189e00711c9
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: SUM(STAGE_LO_SAP_10.LI_VOL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e655f90-ec23-4872-a900-a13a6daa9300
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d9315aa-70f8-4609-aba3-24e59e9cb8f2
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: SUM(DECODE(STAGE_LO_SAP_10.LINE_NO, '10.4',STAGE_LO_SAP_10.LI_VOL_M3*'{{ parameters.M3_BOE_FACTOR }}', STAGE_LO_SAP_10.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac0546af-209a-44bb-8d5e-9143aed46016
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45da04bb-0470-4209-b468-3d1afcc65d45
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: SUM(DECODE(STAGE_LO_SAP_10.LINE_NO, '10.4',STAGE_LO_SAP_10.LI_VOL_IMPERIAL/'{{ parameters.GAS_IMPERIAL_FACTOR }}', STAGE_LO_SAP_10.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 805220e5-abd0-471d-b5dc-597265d64076
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 680d4736-d1b0-4e9e-b600-76fea8411fe8
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: SUM(STAGE_LO_SAP_10.LI_VOL_BOE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64655d18-2645-443b-a072-a2aaee625607
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33235167-725e-4ec9-a76d-fa5161bb6cdb
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: SUM(DECODE(STAGE_LO_SAP_10.LINE_NO, '10.4',STAGE_LO_SAP_10.LI_VOL_NM3*'{{ parameters.NM3_BOE_FACTOR }}', STAGE_LO_SAP_10.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec8bbacf-a4de-4b29-82c5-cd73a461d319
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0daaf71-af9e-4d23-8184-6e7e08f046e3
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d799f65-e93a-4686-abfe-ae162f93b3a4
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f268ba6f-773f-4100-9323-9d176c2b5052
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e82cb45-1c9b-44e7-8e78-0c8777e417f9
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89e4de54-9744-4eb1-b0c7-cc422d74e26d
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ae4452a-0c96-45c5-9993-a0e0b9b22a4b
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8917a657-3745-4961-8725-2b0cbee8f715
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1134b240-fe55-4ff3-829a-d3591d1c2c63
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eb1a9f8-ae0d-4c85-be89-ecc7c5a206c8
          stepCounter: e1e6b9e5-83e3-4241-b1b7-a8bd4c27ad52
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_10: 586a89ed-3877-4311-b120-e8c408fcbbbb
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_10
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_10') }} STAGE_LO_SAP_10
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '10A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY STAGE_LO_SAP_10.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_10.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_10.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_10.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_10.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_10.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_10.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_10.EXCHANGE_RATE,
                      STAGE_LO_SAP_10.OP_CURR_CODE,
                      STAGE_LO_SAP_10.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_10.OP_NONOP
        name: STAGE_LO_SAP_10A
        noLinkRefs: []
  name: STAGE_LO_SAP_10A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
