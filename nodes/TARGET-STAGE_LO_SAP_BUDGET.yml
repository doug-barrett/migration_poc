fileVersion: 1
id: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
name: STAGE_LO_SAP_BUDGET
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "First Pass on FACT_BUDGET to extract Lease Ops data. Contains any source specific transformations to values (ie normalized volumes)"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a1b1877-e381-4aa3-a625-631dd5f3561f
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c6eaabd-83b6-418f-ae1f-3ab2b6ea4e3d
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79d37a27-3fc4-4f58-a466-84703932d3ea
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a93613b3-05c0-4444-95cc-709e86b308fd
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_ACTVY_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6195b991-439a-4240-af47-b27b5d38f257
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbb7e306-6b7f-4db3-a09b-d54146399f0a
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_ACCT_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d28ca0ae-9356-4930-9889-2a294615677e
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17dcd313-6dd9-4da3-8e22-4547954322c7
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cadb41f-75c5-490e-8f30-0780b25e81f9
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6d8cc1f-758f-4f66-88be-f38924947790
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56a9b040-8e2a-4b7e-8868-948f5b9b68b0
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a33a388d-c7a7-41b2-b949-5e4eb411bf2b
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3607eee-c6a8-4e84-8c18-05124bf4f85a
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e814deb7-898b-42f7-9b05-0c92d2a4a964
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ee14622-c173-40a1-a6da-7531adeea451
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd54ab8-f9ef-44c2-ab9a-37d05f093f1c
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93ced2ff-f18a-4599-b296-72798267c0a3
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: NVL(DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24197d6e-ec20-4d5d-8ed0-2e159f57be1a
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a1f4fcd-7833-411a-9397-f334eb729f13
                stepCounter: 5f11ba91-fb8d-4d07-bc17-616726032eee
            transform: NVL(DIM_LO_SAP_LEASE_OPS_VERSION.DIM_LEASE_OPS_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a9cc8ee-3372-49ae-af83-183698a39d58
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40d2906f-a88d-4739-903e-37e7f75ad2b6
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d0dce6d-5154-4546-9e5e-f347cf28d6b5
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9e5489f-99b9-4fc0-b3b1-3c9000e9e595
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31a7a737-dd30-4f6e-9363-0c1bb04a3068
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d4b136c-9a8f-42df-a9f8-8c74ae0271f5
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 242b0438-1917-48ff-8040-5f2a0319d62c
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d42eb8b3-83f4-4cfe-b3f1-31ce32a7d9de
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86325ce3-5bf7-42d2-bf37-530e0f0decb5
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 817a3e36-fe52-423d-b601-e1271c7e64e8
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: SUM(FACT_LO_SAP_BUDGET.OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12bed858-df4b-41f3-85d1-41aa074b991c
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dbf666f-c6d6-4915-ab16-47e91a06c27e
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: SUM(FACT_LO_SAP_BUDGET.GLOP_CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3450eca9-8f7b-4816-a0c0-2f233f349571
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da93c620-9c41-4bd4-a3f6-9c9262778d8d
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d7aa539-1061-4765-ba3f-c85f9f046b26
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: MAX(FACT_LO_SAP_BUDGET.OP_CURR_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c04c159-1500-4d6c-bd5a-95cfe3cb8460
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 579ae1a7-e98b-47db-9c07-eeb58ba56799
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: MAX(FACT_LO_SAP_BUDGET.GLOP_EXCHANGE_RATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66eddecb-89b0-4b77-8530-893ddbae6896
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d38de63-f493-4a6a-8de2-416fae42e351
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b75097c3-7bf8-4e6f-98a8-ea64bac4a1b3
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: SI, M3, BOE, IMPERIAL
        name: LI_VOL_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2593e650-85c5-410d-9dea-8529bb00f11a
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: MAX(FACT_LO_SAP_BUDGET.LI_VOL_UOM)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35031e0f-663d-4492-96ec-36d67601c22a
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1b44c37-4852-48e3-a180-f1b3c77961c4
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_M3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c79871fc-121b-42ed-bef5-558041bdc38e
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb4a63c9-b058-4929-890b-9ea0de99be0a
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_IMPERIAL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dda2637a-3c0a-482f-bb65-d88ad32a662c
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1c310d8-f93b-4678-a77d-adcfe57e1552
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_BOE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60000eae-2601-4f52-8ddf-f015b0428f81
          stepCounter: bf0d9eb3-5c78-44d4-858d-2e075eddaa66
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9218d741-ccae-48bd-a80d-e96b1390146e
                stepCounter: bdef9b91-1e30-4d78-a525-767b23737e70
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_NM3)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FACT_LO_SAP_BUDGET: bdef9b91-1e30-4d78-a525-767b23737e70
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
          DIM_LO_SAP_LEASE_OPS_VERSION: 5f11ba91-fb8d-4d07-bc17-616726032eee
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: FACT_LO_SAP_BUDGET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_VERSION
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','FACT_LO_SAP_BUDGET') }} FACT_LO_SAP_BUDGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON FACT_LO_SAP_BUDGET.GLOP_LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_VERSION') }} DIM_LO_SAP_LEASE_OPS_VERSION
                ON FACT_LO_SAP_BUDGET.DIM_BUDGET_VERSION_KEY = DIM_LO_SAP_LEASE_OPS_VERSION.DIM_LEASE_OPS_VERSION_KEY
             WHERE FACT_LO_SAP_BUDGET.GLOP_LINE_NO IS NOT NULL
             GROUP BY FACT_LO_SAP_BUDGET.DIM_LEDGER_KEY,
                      FACT_LO_SAP_BUDGET.DIM_ACTVY_PER_DATE_KEY ,
                      FACT_LO_SAP_BUDGET.DIM_ACCT_PER_DATE_KEY,
                      FACT_LO_SAP_BUDGET.DIM_COST_CENTER_KEY,
                      FACT_LO_SAP_BUDGET.DIM_AFE_TYPE_KEY,
                      FACT_LO_SAP_BUDGET.DIM_DEST_ORGANIZATION_KEY,
                      FACT_LO_SAP_BUDGET.DIM_GL_ACCOUNT_KEY,
                      FACT_LO_SAP_BUDGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_VERSION.DIM_LEASE_OPS_VERSION_KEY,
                      FACT_LO_SAP_BUDGET.DIM_PRODUCT_TYPE_KEY,
                      FACT_LO_SAP_BUDGET.GROSS_OR_NET_CODE,
                      FACT_LO_SAP_BUDGET.GLOP_LINE_NO
        name: STAGE_LO_SAP_BUDGET
        noLinkRefs: []
  name: STAGE_LO_SAP_BUDGET
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
