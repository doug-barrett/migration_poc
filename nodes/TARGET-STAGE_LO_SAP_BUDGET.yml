fileVersion: 1
id: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
name: STAGE_LO_SAP_BUDGET
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "First Pass on FACT_BUDGET to extract Lease Ops data. Contains any source specific transformations to values (ie normalized volumes)"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59105f16-daf1-4d74-b9c5-284ac7f691c0
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b51792e-9bd4-4ad6-ac6b-6fdbf8283204
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 618ad527-42c8-4894-9e1b-9c92682a3a97
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3dc3711-bde2-4c3f-b9a5-75775a51f254
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_ACTVY_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9733b3d-a719-4e62-8ae6-b7462166bc54
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8a044a6-6010-4a09-9327-7157d8298603
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_ACCT_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7896a14e-dca9-4e71-a828-7ed3216d34ab
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98b558d6-63dc-4a3c-9951-62153c0b14ec
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a5b593f-eb0f-43c4-a290-48f0f672070d
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf7fe5e4-a3d5-4773-80a5-67db9487a46d
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c1ea535-df1d-43bc-ae62-b8eca0dc35c8
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d102545-7d87-42c8-bea5-60acf9277c43
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89553f8f-1feb-47a0-bf56-a9058cde71b5
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4007355f-f8c6-4b52-ba2a-1fe160cd1316
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc9eb19f-5f16-4cbf-ae72-d707864a422a
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33980701-5499-4cd0-afed-14adf7afcdbb
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30d389ab-86f4-4c95-8667-7819684d0379
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: NVL(DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ed56405-e3d0-4664-955c-91eb6872d128
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 229d76c5-e976-46d2-84ce-8623a3e8d9c3
                stepCounter: e575d1a1-f47c-47ec-b457-d837fc9a6b39
            transform: NVL(DIM_LO_SAP_LEASE_OPS_VERSION.DIM_LEASE_OPS_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c3036b5-92ac-4851-9b89-6cf6fbcc6d22
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13a6dccd-cdab-4ce0-b28b-3eaecd4e4264
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43c77717-1bc9-4c2f-bb4a-25ef2368e7d6
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f73abf0f-9337-4453-b181-ea31ffab1f84
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d56e6bac-5538-4574-af78-968030953fa2
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14aac575-62fe-47d1-8802-5632f5bd0e4c
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: NVL(FACT_LO_SAP_BUDGET.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 611e9461-63fd-4bd1-abeb-2d0bcd9fae97
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 701c1d34-9913-49c8-af17-bd2607f521ab
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cdf4135-fb85-4aa0-9f75-c7631127f221
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95df991e-9f16-45b7-b77e-7107c0f94f35
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: SUM(FACT_LO_SAP_BUDGET.OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc3c06c3-350e-44f7-bb09-4f120cc2c6df
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 692d593f-06c8-41e5-8adb-b3535e8ce029
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: SUM(FACT_LO_SAP_BUDGET.GLOP_CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17f6fc3c-dd47-44ad-b3d8-1e26f906cdfc
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e191d62d-0ce5-4d5b-8adf-64f98139486e
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0882969-c3f9-4cb2-a1a2-57d9e6af0f97
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: MAX(FACT_LO_SAP_BUDGET.OP_CURR_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57e45aca-5115-4120-a744-992a174b6292
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c65b0a31-c5fa-4247-b2fd-70e8183e1345
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: MAX(FACT_LO_SAP_BUDGET.GLOP_EXCHANGE_RATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32436a50-d229-4766-a73b-4571f1e5a4ac
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e76aeccd-5b3a-4a0b-a1f1-726ba352ac28
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b361321-6b57-424d-b5fe-396847db376b
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: SI, M3, BOE, IMPERIAL
        name: LI_VOL_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba366337-07c6-4c4a-b145-bb414380077d
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: MAX(FACT_LO_SAP_BUDGET.LI_VOL_UOM)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59158913-3716-44ac-ac91-4c9231726a4c
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20d98e3d-c8d0-4d3b-bd2b-61160235fbd0
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_M3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 857d6961-fd30-4a88-a1e7-44f793f9d453
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4128ae4d-348c-4852-a35a-8d673435162b
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_IMPERIAL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd28e89d-9f79-41b1-9f52-f30dbd0a5c70
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f261ba56-a4b6-4916-8553-5f0ad9856524
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_BOE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91d60477-e885-40d8-b51d-a8760a8019a0
          stepCounter: 6deb08a6-5492-45d4-9e6e-0a7654c3f6f1
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98d97e74-c453-40f1-aa3c-82c8cb51a7c7
                stepCounter: 7e438fd1-adbd-4032-8159-9e112a85b5ee
            transform: SUM(FACT_LO_SAP_BUDGET.LI_VOL_NM3)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FACT_LO_SAP_BUDGET: 7e438fd1-adbd-4032-8159-9e112a85b5ee
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
          DIM_LO_SAP_LEASE_OPS_VERSION: e575d1a1-f47c-47ec-b457-d837fc9a6b39
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: FACT_LO_SAP_BUDGET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_VERSION
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','FACT_LO_SAP_BUDGET') }} FACT_LO_SAP_BUDGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON FACT_LO_SAP_BUDGET.GLOP_LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_VERSION') }} DIM_LO_SAP_LEASE_OPS_VERSION
                ON FACT_LO_SAP_BUDGET.DIM_BUDGET_VERSION_KEY = DIM_LO_SAP_LEASE_OPS_VERSION.DIM_LEASE_OPS_VERSION_KEY
             WHERE FACT_LO_SAP_BUDGET.GLOP_LINE_NO IS NOT NULL
             GROUP BY FACT_LO_SAP_BUDGET.DIM_LEDGER_KEY,
                      FACT_LO_SAP_BUDGET.DIM_ACTVY_PER_DATE_KEY ,
                      FACT_LO_SAP_BUDGET.DIM_ACCT_PER_DATE_KEY,
                      FACT_LO_SAP_BUDGET.DIM_COST_CENTER_KEY,
                      FACT_LO_SAP_BUDGET.DIM_AFE_TYPE_KEY,
                      FACT_LO_SAP_BUDGET.DIM_DEST_ORGANIZATION_KEY,
                      FACT_LO_SAP_BUDGET.DIM_GL_ACCOUNT_KEY,
                      FACT_LO_SAP_BUDGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_VERSION.DIM_LEASE_OPS_VERSION_KEY,
                      FACT_LO_SAP_BUDGET.DIM_PRODUCT_TYPE_KEY,
                      FACT_LO_SAP_BUDGET.GROSS_OR_NET_CODE,
                      FACT_LO_SAP_BUDGET.GLOP_LINE_NO
        name: STAGE_LO_SAP_BUDGET
        noLinkRefs: []
  name: STAGE_LO_SAP_BUDGET
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
