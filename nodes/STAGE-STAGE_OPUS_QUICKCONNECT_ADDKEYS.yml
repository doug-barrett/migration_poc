fileVersion: 1
id: bade0d4f-0142-4750-acb2-82ec87079f57
name: STAGE_OPUS_QUICKCONNECT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c65eb0d-e10e-4a58-af14-b0a2f33041b2
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7284217-1be5-4550-b871-d3c057a5c106
                stepCounter: d63040c1-6075-45f1-a723-d8667ae09cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4386ecf0-7bc2-4fb7-b6d4-fc55b9e994f8
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a6f9af9-be7f-4d21-8fa2-113279b41bca
                stepCounter: 92b541a9-bde9-4589-83f2-dc55c69a0757
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 894478d0-1613-4385-894e-d7b91b37ef78
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83cf9f2b-90d3-43c6-a6b1-c06956fa7f02
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48bfcbe4-725a-479d-a81a-ce6a0550e125
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9809deca-da5b-4fe0-a80a-ab6cafa8782e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb8efbf6-b236-4777-a601-befdf56cad65
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_QUICKCONNECT_ADDKEYS.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11f9a13a-8aa9-47bc-81b6-a5a6d4d0ee80
                stepCounter: 9a72d1e4-1aba-4fd2-8b64-b6f16fb0a880
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91b884e1-94d8-4120-b8cf-54a30ada4cc9
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED KEY FOR THE DATE DIMENSION. NOMINAL FORMAT IS YYYYMMDD, BUT DD EQUAL TO 0 AND GREATER THAN 31 PERMITED FOR SPECIAL DATE HANDLING.
        name: QCCREATEDDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9fa5e2f-1f2f-420f-9bbd-e7c23227acad
                stepCounter: e662704d-b336-4f76-afc6-62399ba0aed5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b4a9be3-1bdc-4608-aec4-d7e35ffe5d96
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f0297e-fa6c-47ad-a92b-176b626a7804
                stepCounter: 9a72d1e4-1aba-4fd2-8b64-b6f16fb0a880
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa55f7f9-c876-4807-aeb8-c9fb27962c67
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 796b86b7-6af7-4060-9ff3-fc8de8b2d22e
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2d12617-a5c2-463b-9b1c-9973d269e214
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 092ead07-e6f1-4e70-a54b-7019bc6c4a17
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2a7dea5-a7d9-4d9b-a29e-87de84032486
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2a26358-ffb8-48b0-8566-724dcbd350f8
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8e1759c-3119-47dd-88e6-d9b69949af2e
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3449cef1-3243-452a-82d8-6f97e3cb86ab
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44b5f764-57cf-44cb-ab22-dd52f74a1bb4
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a15d4c12-2307-4707-a844-58b68ff982a0
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b16941f-27b7-4cbd-ac32-85107e1ca38b
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 029dd1bc-4b33-43e5-87e6-1b314e1f9a00
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7239712-8b63-4577-8253-e62f0ba8bfc2
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aeaa1a32-9d75-4ef7-8765-9af015284186
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9fb7384-badb-4bdf-98b1-38961aa2c463
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PURPOSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 804da001-2c61-49b7-8195-2922877897b8
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4e493ab-23a1-4ca0-a7b8-3c926c1ee90b
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e9d771d-ce5a-4913-be6f-f4df1d22f023
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eaa2473-f6f0-4a04-b6dd-0933c16124a0
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SEARCHPHRASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62d69b38-c379-4b71-9eb4-26d94bf5d738
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca5ddef7-79e3-4cad-b9cf-aadd18ff1dfd
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0979c8a-6564-48d4-bf0c-1470fc21d169
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a373f122-7403-4756-be6a-ed9f129ccd35
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba3295eb-e6ae-4047-8a76-4bc1810e9669
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a68faf9b-5d4b-4355-9941-3d071b32ce93
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72207def-494d-4f53-9360-c6edea54b15a
                stepCounter: 3ed073d8-af1c-47b5-bfa8-5ea8a9e669a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f5b499c-eaa0-4a19-93b0-e72a1aee6eaa
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abf7fc06-ab64-40c2-83d8-6627735666fb
          stepCounter: bade0d4f-0142-4750-acb2-82ec87079f57
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPUS_PRODUCT: d63040c1-6075-45f1-a723-d8667ae09cf5
          CONTACT: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
          ACCOUNT: 745ecacb-59f4-457a-9a6f-e827d225494e
          OPUS_CONTACT: 92b541a9-bde9-4589-83f2-dc55c69a0757
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VW_OPUS_QC_DATE
          - locationName: STAGE
            nodeName: STAGE_FACT_OPUS_QUICKCONNECT
          - locationName: UNKNOWN
            nodeName: STAGEFACT_OPUS_QUICKCONNECT
          - locationName: UNKNOWN
            nodeName: VWOPUS_QC_DATE
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','STAGEFACT_OPUS_QUICKCONNECT') }} STAGEFACT_OPUS_QUICKCONNECT
              LEFT JOIN {{ ref('UNKNOWN','VWOPUS_QC_DATE') }} VWOPUS_QC_DATE
                ON STAGEFACT_OPUS_QUICKCONNECT.CREATEDDATE = VWOPUS_QC_DATE.QC_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_QUICKCONNECT.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_QUICKCONNECT.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_QUICKCONNECT.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_QUICKCONNECT.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_QUICKCONNECT.ORGANIZATIONID = OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_QUICKCONNECT_ADDKEYS
        noLinkRefs: []
  name: STAGE_OPUS_QUICKCONNECT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
