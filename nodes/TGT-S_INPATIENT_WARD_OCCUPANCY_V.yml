fileVersion: 1
id: 0566bce5-6569-488d-8b3b-85b7aa421840
name: S_INPATIENT_WARD_OCCUPANCY_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Daily ward occupancy totals."
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e227c78d-00f9-440a-8fa2-b6722dfd06f5
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: fact_inpatient_stay_detail.stay_ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63bd7cd7-a4b2-46fc-9fbb-04c1462fa09e
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc2fb2ed-9dce-4df2-ba18-a995a106bb6f
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: fact_inpatient_stay_detail.CONVERT(date,stay_calendar_date)=dim_date.calendar_date
        name: DIM_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92e33024-faed-49d7-9749-a1c5724d1d04
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cfcebe7-6728-4d85-9990-69dfdd18b271
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 12am (00:00:00)
        name: OCCUPANCY_TIME_SLOT_00
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3896acc7-1d18-47fc-aba4-c36d3eba3f3e
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H00)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24557891-e38c-4c29-8f04-52b7c2997562
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 1am
        name: OCCUPANCY_TIME_SLOT_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a11c8744-44b2-4a47-9247-3ea975514bf6
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H01)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f2b32cc-b90b-49c4-9406-086a7f068f30
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 2am
        name: OCCUPANCY_TIME_SLOT_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e92b3285-eb88-41a9-9cd2-c9b9429de1d2
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H02)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83058298-4a53-4cb0-a0de-e5e78c9f393f
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 3am
        name: OCCUPANCY_TIME_SLOT_03
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e300a3c-bb4d-46f0-a87d-f624bd68d97c
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H03)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91c382ce-547c-479d-a4c3-57ae93a1783e
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 4am
        name: OCCUPANCY_TIME_SLOT_04
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a86e926-66a2-44cf-9154-19b5c9e8a564
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H04)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b7e67dc-97dd-430d-b888-dcaa4f698509
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 5am
        name: OCCUPANCY_TIME_SLOT_05
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9073de22-95b9-4520-ba63-7e1075fb1f7e
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H05)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2762251d-086c-4113-beb6-0b19b1729066
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 6am
        name: OCCUPANCY_TIME_SLOT_06
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 119ec093-6809-481b-809f-2eeb92dbab5c
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H06)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f86a17d7-4539-4c48-87ac-0b1770ad1726
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 7am
        name: OCCUPANCY_TIME_SLOT_07
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3325ff1-829e-4d6b-8da3-86bf43e60b4f
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H07)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd36560d-82c0-47a9-aa4a-df29b578f449
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 8am
        name: OCCUPANCY_TIME_SLOT_08
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38ae2a70-d471-4f30-a3ec-ee1cfcea648f
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H08)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ab5ddd5-2906-4b7f-93ae-63af1d202b01
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 9am
        name: OCCUPANCY_TIME_SLOT_09
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f6cf99c-421f-43b0-bdee-23ad61a0f795
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H09)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e32d5a6a-5dfc-45d3-9d9d-af7a0285c024
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 10am
        name: OCCUPANCY_TIME_SLOT_10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66f41e7a-9ad7-4eac-a58f-ca7c313988b8
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H10)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e13ff2f-774d-471a-b3b3-60d84a017011
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 11am
        name: OCCUPANCY_TIME_SLOT_11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92a951fc-2554-4c6a-826b-5c9f4efd7c33
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H11)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9aea7d95-62c6-40e9-b45e-ad24c3ccb918
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 12pm (12:00:00)
        name: OCCUPANCY_TIME_SLOT_12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51a7f7d0-3dcf-42a5-bb2c-5c77bad92abd
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H12)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e162ca1-2d38-4ccf-bbd7-b57eba5d05a7
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 1pm
        name: OCCUPANCY_TIME_SLOT_13
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fca2e09-bf97-43da-bce8-f6bf6e56a8db
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H13)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1662ed26-757e-4af0-a055-d5e482d4b1f0
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 2pm
        name: OCCUPANCY_TIME_SLOT_14
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4434144-5bbe-477b-86d7-5fce6c9c1e18
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H14)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 373dc638-b788-4ab8-ac2c-bbe236a15bae
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 3pm
        name: OCCUPANCY_TIME_SLOT_15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25f3e5f6-eeed-4d29-a17f-c1255c684e40
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H15)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c6610f2-ad53-4e06-b3f2-87f649b7b4bd
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 4pm
        name: OCCUPANCY_TIME_SLOT_16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e078b5c1-653e-4104-b9b2-3b3df1180987
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H16)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 583b9797-0602-4bb5-9274-1d94a4156649
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 5pm
        name: OCCUPANCY_TIME_SLOT_17
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e76d877-7a24-49b8-b42c-f1b3c09c16c7
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H17)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3305cd8-b554-4b0d-b9ee-6de994cc2b19
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 6pm
        name: OCCUPANCY_TIME_SLOT_18
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cb74834-b210-4a60-bed1-d0408d07ec45
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H18)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df182a36-c5ec-4240-b044-40fb995d75cf
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 7pm
        name: OCCUPANCY_TIME_SLOT_19
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26bfdb45-f173-4936-ba4d-b11706d47d38
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H19)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76d28660-7ea3-4b10-9009-7c966b70c769
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 8pm
        name: OCCUPANCY_TIME_SLOT_20
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7a2b383-9d29-43bf-9671-8b1e1b0f3aa6
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H20)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 897f871c-32ad-43cb-9b84-7cb9209fc8cc
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 9pm
        name: OCCUPANCY_TIME_SLOT_21
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 963011e8-a498-4e80-8786-db91f7be8262
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H21)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7e8fd0a-3ac9-4b90-8db4-5238accb02eb
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 10pm
        name: OCCUPANCY_TIME_SLOT_22
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d2f6a04-452a-45e7-bd60-45e1f262cf6e
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H22)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bfb08fb-5369-4fa9-bea0-bf47314a26bf
          stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 11pm
        name: OCCUPANCY_TIME_SLOT_23
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c06e1cfd-9691-4440-a660-802a4c5dfaaa
                stepCounter: 0144b63b-d759-4042-a3e5-2629038325fe
            transform: SUM(fact_inpatient_stay_detail.H23)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: FACT_INPATIENT_STAY_DETAIL
        join:
          joinCondition: |-
            FROM fact.fact_inpatient_stay_detail
             GROUP BY dim_date_key,
                      dim_ward_key
        name: S_INPATIENT_WARD_OCCUPANCY_V
        noLinkRefs: []
  name: S_INPATIENT_WARD_OCCUPANCY_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
