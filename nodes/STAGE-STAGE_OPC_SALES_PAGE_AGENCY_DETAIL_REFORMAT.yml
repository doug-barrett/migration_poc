fileVersion: 1
id: 4aef393e-a259-4317-9c89-c4adaf2705f3
name: STAGE_OPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19a66f58-636d-46ec-b582-6050d9fb0964
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11dc3730-a223-42da-97fc-2780ed431686
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aec21ea0-403b-4cf5-9884-cf3f55613a97
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ad84a90-3785-416d-8956-6ae0a778cb88
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3d7b59f-5885-4ced-b955-d626de6f7b02
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 230b6c80-e131-4983-87a7-b8008d93d1f7
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f83943ab-5ace-4d84-8b95-4068c82dd13a
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76911727-4ce7-436e-bd2c-c000c1e5cc52
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 222e0b58-53a5-40fb-ae65-34b71eb0f5a0
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8238452a-254b-4f14-a195-7cc04d198780
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0293dde-ee37-41ab-bdc0-4f1311d18db3
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8238452a-254b-4f14-a195-7cc04d198780
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',1)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44d67faf-d90c-4e75-bd67-7f04f2418b9a
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8238452a-254b-4f14-a195-7cc04d198780
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: INITCAP(SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',2))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c218638a-c8eb-4476-9264-0d7a3319f0cd
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: EVENT DETAIL
        name: GA_DIMENSION15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9fe5e9b-9595-4bf8-bad1-7f230adb46a5
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 094d8a24-c983-4433-aa95-f2de02c96711
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: FORCE ID
        name: GA_DIMENSION16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1764089-3742-40b9-bc96-9b746c9896f7
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION16,''), '<[^>]+>|/.*', '')) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.FORCE_ID,''), '<[^>]+>|/.*', ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b01d06e-36c3-4e51-9733-e068ab82e35b
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bbf8f7a-be43-47d5-aa2e-d916278e996f
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d624b8c2-ec58-474a-98d9-ab2251079080
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 460c76a6-7a2f-4fe6-8cb7-5407292f04f6
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6cd389e-fd6f-4c95-a6f3-aab0e3654cb0
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d97c0e3-8b3f-458f-b87a-fe6b94365b68
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fa3cde3-2bd8-404b-8bfe-eb851ca71ca1
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8590b2dc-8783-427f-9798-1298388e1a51
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3be96e52-a458-46ec-b0ea-1b68ddd70333
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2805244-e305-4e84-8cb3-cd6d5149902e
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8c63337-69ef-4624-aa4d-0549e63dee45
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 106a92b7-88e2-4f30-9691-6dc02266d301
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1ad3f9b-e299-47aa-b8db-0d9fd9043b53
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b0f5cff-048c-42f0-be44-6104eebc139e
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c16c756-dd0d-43e5-9762-90803e409ffc
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a46c597e-6cbb-4c8b-8da0-df5634a35a3f
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab894890-1332-4588-9267-eccde6718850
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deaef332-ea61-4cc4-8bcb-f0533429d85b
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__INGESTED_AT,3) \N \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75389317-6916-43e3-a8cb-1ea362a67b75
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fdb91ef-36dc-4193-84de-7a29a5281c32
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ae2973f-f06e-4784-a475-f3b5aadd11d0
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7ddf383-0742-41f9-bd23-64fa9143b961
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dea3304-fb29-4ca4-8c81-14e3c7649584
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62814661-6e44-4949-a3b0-216a20558aa5
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3fc8ce1-65e5-40c0-a094-daca3648d0b3
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9d33280-a480-4604-ab42-d7fdc25f8cde
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adde6d48-ceda-4f38-945c-c54397cde785
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4c7f07f-a9c7-4eaa-b18c-e920ac5d231d
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7816a73a-388a-4c75-97f3-3132220d0610
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4c7f07f-a9c7-4eaa-b18c-e920ac5d231d
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: CASE GA_HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faeb58f8-ef4c-454e-aabc-626973f619ff
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a47e0aea-943a-46bb-9037-ad49cf57e6dc
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a4549d0-04ef-4579-ac64-99edde8d6ceb
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10d25f62-086d-42ac-b5e1-e2cec8cb3af2
                stepCounter: 23c4f9cb-59bf-4bc8-9d53-77abdc13d91c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eab9561b-75cc-4d68-a2e8-9af62be26e98
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bfdd890-9ef4-429a-80bf-e9c0d372d7af
          stepCounter: 4aef393e-a259-4317-9c89-c4adaf2705f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPC_SALES_PAGE_AGENCY_DETAIL
          - locationName: UNKNOWN
            nodeName: LOADOPC_SALES_PAGE_AGENCY_DETAIL
        join:
          joinCondition: FROM {{ ref('UNKNOWN','LOADOPC_SALES_PAGE_AGENCY_DETAIL') }} LOADOPC_SALES_PAGE_AGENCY_DETAIL
        name: SRC_STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT_1
        noLinkRefs: []
  name: STAGE_OPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
