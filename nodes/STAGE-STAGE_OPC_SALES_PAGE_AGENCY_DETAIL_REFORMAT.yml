fileVersion: 1
id: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
name: STAGE_OPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c82d97a7-c8d3-4b09-80ec-3742fe02fe5f
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 955b20e8-b776-4558-a368-74c0eb386483
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e04d8216-0114-4e8f-b7c7-1676c57c42a3
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4cf3cf2-0784-4e29-8ab7-b66d9f1ac888
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74a742ea-56f1-427a-bf98-96571b7d2b41
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78d695b6-d31b-4d6a-b77e-c8af8ecf0ec2
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33bb2a96-72b0-4de4-8471-a30d882dc71c
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92557bf3-75b9-4e4c-95ac-5108b4719b19
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f6cb1d-e3b3-4bde-9bc4-f94e4d1b3b90
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6a3bb8b-12cd-4e05-96d0-75a6824a8d88
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80c350f1-3df9-4839-ad52-49f04d2b0755
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6a3bb8b-12cd-4e05-96d0-75a6824a8d88
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',1)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38a0cedb-64dd-47ec-b525-7d64034a630b
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6a3bb8b-12cd-4e05-96d0-75a6824a8d88
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: INITCAP(SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',2))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73aa5863-a52e-4dd8-a46d-2d3e5da69304
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: EVENT DETAIL
        name: GA_DIMENSION15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c6c6155-dfff-4195-9de3-f18b4f6c9f0a
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64a9cebf-463a-44b5-95df-ad866f9bfad6
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: FORCE ID
        name: GA_DIMENSION16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11f22e0e-4438-41c3-9db4-a1ee04561ef8
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION16,''), '<[^>]+>|/.*', '')) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.FORCE_ID,''), '<[^>]+>|/.*', ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c5a3d0b-01a5-4ec7-b5ab-cc6905fae0c5
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02b181eb-3be5-4c34-a2b4-b3438520a1d3
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 611393dc-a671-45c3-bad0-af02226e8da4
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2290b59-92df-46f3-bde7-47ced6f63503
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35768be7-765e-4f7f-9db9-a3b56a3de8a6
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98e6c41d-9dab-4f12-bb78-a255a1be8721
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e4e7e7d-35ff-4252-87aa-e87830307b23
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f95a4401-319f-438c-9b7b-fcc428a021ec
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3631215b-88ff-40b9-817e-89c4e301129c
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4d9430a-0083-4bf8-ae3a-a6c776d08654
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2024c594-2b0d-4b1a-9250-aa5258cb9f7b
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4821ea41-a4d0-468b-afe9-7bbea80d0fdf
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4136745-983f-4043-a21a-39dd61fd0e0e
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cde4ad5-bd13-43e8-8fd9-edf51fe6bec1
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1ea982f-49a8-4620-8b87-c7b6ec747ff8
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51aca0ad-40c4-4ed2-a256-bb06250b031d
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d244ab46-6442-4893-8dad-96dab480da5b
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a31e730-49f1-460d-8159-81b6df65aaf9
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__INGESTED_AT,3) \N \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c4acb72-bc39-45db-bbcb-57bb90ce658a
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 483b8c29-b5a1-4580-9e44-e132f5f92e05
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daa65a8c-6781-40b5-b45d-7f2aaf508410
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3dffeb3-f3d1-4704-b09e-030dae653063
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52209e42-82e1-41e6-9402-c104da23b506
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b7188d4-a968-49d1-b220-2188f6a9ad72
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e923a5d3-aa7d-46be-83f8-455a4f48985b
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36d84f2b-47ec-4fba-aa3a-6679167d6fb6
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99e5480a-53c6-4ca1-b89e-63b1fe02bae5
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e11541c5-3acd-47da-a2df-86b070ae18e2
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1879f212-2d60-48e3-a5eb-e882fbff6a47
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e11541c5-3acd-47da-a2df-86b070ae18e2
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: CASE GA_HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be07f778-bd52-4133-a14f-b142b73ebf3c
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f40c5aa-3bb4-4331-b34f-4e78604b20bb
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06e8b8ee-64a5-4454-8b28-eb2cfeeaf48a
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 638b1399-ca52-44ff-a9bb-2f36b398176b
                stepCounter: 153ce4a5-6594-40a0-b50d-08362137c111
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 875a593c-7150-4510-ae74-e0e8d071891e
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38665646-f196-4647-a947-79600be21500
          stepCounter: 4b4d6c1f-5fb0-4d29-88b1-90ef0c6f61b3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_OPC_SALES_PAGE_AGENCY_DETAIL: 153ce4a5-6594-40a0-b50d-08362137c111
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPC_SALES_PAGE_AGENCY_DETAIL
        join:
          joinCondition: FROM {{ ref('LOAD','LOAD_OPC_SALES_PAGE_AGENCY_DETAIL') }} LOAD_OPC_SALES_PAGE_AGENCY_DETAIL
        name: SRC_STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT_1
        noLinkRefs: []
  name: STAGE_OPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
