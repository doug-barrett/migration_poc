fileVersion: 1
id: b1d1f06e-f672-4111-8570-9ab68d4ef792
name: VIEW_CSLAND_WELL_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c83e0254-d2de-4cb3-a55d-9602bc0a79dd
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Well File Number
        name: WELL_FILE_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb5e83e4-8241-489a-a342-a723c2726c60
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e4db97a-d06f-4e67-9040-474995373d38
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(48)
        defaultValue: ""
        description: ""
        name: RAW_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5861d01-5cf3-487e-89f4-322846f51d8a
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 595cfb39-2231-4ac3-a064-988a1a96fb19
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(101)
        defaultValue: ""
        description: ""
        name: FORMATED_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5861d01-5cf3-487e-89f4-322846f51d8a
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e43a5fb-ac3e-4aca-aabe-c3953f107b2a
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(128)
        defaultValue: ""
        description: ""
        name: SORT_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5861d01-5cf3-487e-89f4-322846f51d8a
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc8bd5a9-5475-4f34-a46c-16647c6a775c
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(180)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74169778-d3d2-429b-a16e-3a759e12f2b8
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 206dd4da-1710-435d-a358-5015080c97c5
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aae5339e-4c0a-49ec-a09a-69beabee17d8
                stepCounter: 9f5cfb9e-1791-49e7-abbe-cddec48b39b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d8e150c-4b26-4d26-a695-1b53a07aedb2
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_LICENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5837a1f6-1709-4c8f-8ece-4865ae7e5409
                stepCounter: 9f5cfb9e-1791-49e7-abbe-cddec48b39b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ca8fc4d-c165-4ea7-8d96-711238db74db
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_LICENSEE_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5837a1f6-1709-4c8f-8ece-4865ae7e5409
                stepCounter: 9f5cfb9e-1791-49e7-abbe-cddec48b39b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82bffaba-918f-4cd9-bc2d-8a24e39bc165
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_LICENSEE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ec4c152-5e46-4ed7-8066-d7c7c0e196cc
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc15221e-5f0e-4a9a-8720-0434a6781028
                stepCounter: 9f5cfb9e-1791-49e7-abbe-cddec48b39b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5ca025c-330d-4b71-a8ce-76ad08aacfd6
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97b0d403-b94a-4416-aec6-25f7eb0c74e0
                stepCounter: 250c3271-f34f-46da-994a-8c335b143783
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddce2469-ad2f-4340-83af-4e0c30216f2c
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3469fbfb-1f9f-419b-bc01-0c2227269950
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4537e556-7f33-4a48-826f-951e0f55f4e6
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bcede6c-cd02-46fb-b2b5-8729ccf3fb90
                stepCounter: 250c3271-f34f-46da-994a-8c335b143783
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f45da90-a5f0-4dd4-b69b-ba079bc88669
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9230e4f5-a91b-46d5-bd6a-5d10d9f85629
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4636c1a7-f774-4f8c-91b6-410ddfa587d1
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76d8745d-fb69-49e6-aba9-a811146e5d11
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeac5b86-d905-44da-9144-92b70830dc10
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 617154e5-3693-4d85-aacf-43f78e3103d6
                stepCounter: 576a8f9e-1768-4371-b9db-c455850c426b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d228294-adee-4b1b-9632-5eb99ee99038
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: WELL_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 785d6588-3e36-4582-987f-aadccb705956
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f126181a-d4bc-44d5-8a04-9f091158cccb
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64d7c4c3-d1d8-467a-a41e-6287ae30593a
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a3d1519-540a-4548-9391-f1f7a6ded8c1
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5529b19-9726-4b39-8a7e-ee60b32779b5
                stepCounter: dd07543e-630c-417f-b010-97fdd5d83a08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ffaa077-50c6-4ecc-953a-aec26cfd6f9e
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0787e032-6e9a-40a8-b310-e3f041171157
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 523c2b1b-c8a2-4e27-b302-a2263780f648
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d1b75dd-f46a-4298-bed2-16f8d08f3c50
                stepCounter: c1ee5439-922c-4ab1-bed9-7f3eb0d4002f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88e5c5c5-53f7-4da8-9242-ba04235a786e
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db5f8d32-f48a-4577-a385-877316a949f1
                stepCounter: c1ee5439-922c-4ab1-bed9-7f3eb0d4002f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9172d567-64d6-4e71-b8a2-405478fa1a3c
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIELD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad5a5967-9c20-40f5-8e1c-b1258b928a87
                stepCounter: 9f5cfb9e-1791-49e7-abbe-cddec48b39b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be1cf0cc-0520-4b87-8055-d4d89bf545d3
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FIELD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db4dd853-3459-4c33-8e27-06e8aa4177cb
                stepCounter: 5cc33ade-519a-4226-946b-7f9c73dfe9db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e76f3ff-3698-4453-9b83-d1d696a8ddab
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RIG_RELEASE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff1dddab-1181-40b5-925e-22df79712f18
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0232bdf-100f-4ce9-9ba2-960a017dfcb9
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: SPUD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ad11f6d-dbc6-489d-9e0d-232640459d68
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 148c1a2f-1dea-456d-a7e0-84a99a714202
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d28e2fad-8a12-4fa6-b8f7-83ac52a3ba27
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85a7846a-9219-411e-931e-2e199fa85023
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ON_PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 925f8c80-029c-4bfd-b901-0b2e2eeb0d66
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9de1b48b-6812-4940-bd93-01478bf0db13
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LAST_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 008f38c9-dfca-44c9-b4fb-8891aaf7d157
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f84b6036-8633-4c36-94f3-fea9ab8436c4
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ABANDONED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7d30dd3-502c-465d-af6a-a88b55f3a27d
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e3923da-06e2-4e32-bdbd-c286702af5ac
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: NUMBER(7,1)
        defaultValue: ""
        description: ""
        name: TOTAL_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 097a564f-081e-4b6b-adcf-aa57b0f80303
                stepCounter: 9f5cfb9e-1791-49e7-abbe-cddec48b39b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02d02552-58e1-4141-8a56-fa352f708af4
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: NUMBER(7,1)
        defaultValue: ""
        description: ""
        name: TRUE_VERT_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3d8e9f0-8175-4cd8-80e2-c83906cdefde
                stepCounter: 9f5cfb9e-1791-49e7-abbe-cddec48b39b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 346aae24-df5a-46bf-adb2-606d40df5c59
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: NUMBER(23,8)
        defaultValue: ""
        description: ""
        name: WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4390719f-f647-4285-96c0-635bec86b40c
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18c38193-9d5c-4e74-a630-1a0c4b6eab57
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: OP or NONOP
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44d0ab4a-fac5-4653-9b8e-cec8e672afb9
                stepCounter: 7d1c0def-cbcd-49c8-bb14-0ee1ccba7672
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 654d16a1-0dd6-4940-9d58-8a7669c50dda
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: REMARKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 686ef6f9-4278-42f2-b5d2-062a8e84e9ff
                stepCounter: a3fdaf81-1ea9-4b34-9059-c5cc9f8c413c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b16560b-39b7-4cb0-8b6e-79679471343e
          stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb5e83e4-8241-489a-a342-a723c2726c60
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_WELL_DETAIL: b1d1f06e-f672-4111-8570-9ab68d4ef792
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_WELL_DETAIL') }} AS SELECT WD1.FILE_NUMBER "WELL_FILE_NUMBER",
                   UPPER(WD1.WELL_UWI) "RAW_UWI",
                   DECODE(SUBSTR(WD1.WELL_UWI,1,1) ,'1',SUBSTR(WD1.WELL_UWI,1,3)||'/'||SUBSTR(WD1.WELL_UWI,4,2)||'-'||SUBSTR(WD1.WELL_UWI,6,2)||'-'||SUBSTR(WD1.WELL_UWI,8,3)||'-'||SUBSTR(WD1.WELL_UWI,11,4)||'/'||SUBSTR(WD1.WELL_UWI,15,2) ,'2',WD1.WELL_UWI --NTS format TBD
             ,WD1.WELL_UWI) AS "FORMATED_UWI",
                   DECODE(SUBSTR(WD1.WELL_UWI,1,1) ,'1',SUBSTR(WD1.WELL_UWI,1,1)||SUBSTR(WD1.WELL_UWI,13,2)||SUBSTR(WD1.WELL_UWI,11,2)||SUBSTR(WD1.WELL_UWI,8,3)||SUBSTR(WD1.WELL_UWI,6,2)||SUBSTR(WD1.WELL_UWI,4,2)||SUBSTR(WD1.WELL_UWI,2,2)||SUBSTR(WD1.WELL_UWI,15,2) --LOC Type, MER, RGE, TWP, SEC, LSD, LOC EVT, DRILL EVT
             ,'2',WD1.WELL_UWI --NTS sort TBD
             ,WD1.WELL_UWI) AS "SORT_UWI",
                   UPPER(WD1.WELL_NAME) "WELL_NAME",
                   WD2.SURFACE_LOCATION,
                   WD2.LICENCE_NUMBER "WELL_LICENCE_NUMBER",
                   WD1.WELL_LICENSEE "WELL_LICENSEE_BA",
                   BA1.NAME "WELL_LICENSEE_NAME",
                   WD2.ACCOUNTING_PROJECT "COST_CENTER",
                   TWFS.AI_FLAG,
                   WD1.FILE_STATUS "WELL_FILE_STATUS_CODE",
                   TWFS.DESCRIPTION "WELL_FILE_STATUS",
                   WD1.STATUS_DATE "WELL_FILE_STATUS_DATE",
                   WD1.WELL_STATUS "WELL_STATUS_CODE",
                   TWS.DESCRIPTION "WELL_STATUS",
                   WELL_STATUS_DATE,
                   WD1.WELL_TYPE "WELL_TYPE_CODE",
                   TWT.DESCRIPTION "WELL_TYPE",
                   WD1.AREA "AREA_CODE",
                   TA.NAME "AREA",
                   TA.PROVINCE "PROVINCE",
                   WD2.FIELD "FIELD_CODE",
                   TF.DESCRIPTION "FIELD",
                   WD1.RIG_RELEASE_DATE,
                   WD1.SPUD_DATE,
                   WD1.COMPLETION_DATE,
                   WD1.ON_PRODUCTION_DATE,
                   WD1.LAST_PROD_DATE,
                   WD1.ABANDONED_DATE,
                   WD2.TOTAL_DEPTH,
                   WD2.TRUE_VERT_DEPTH,
                   NVL(D.WI,0) "WI",
                   DECODE(TOS.OWNER,NULL,'NONOP','OP') OP_NONOP,
                   WR.REMARKS,
                   WD1.DIVISION "DIVISION",
                   WD1.FILE_NUMBER "WELL_FILE_KEY"
              FROM DS_CSLAND.W_DETAIL1 WD1,
                   DS_CSLAND.W_DETAIL2 WD2,
                   DS_CSLAND.T_WFSTATUS TWFS,
                   DS_CSLAND.T_WTYPE TWT,
                   DS_CSLAND.T_WSTATUS TWS,
                   DS_CSLAND.T_AREA TA,
                   DS_CSLAND.T_FIELD TF,
                   DS_CSLAND.T_OWNERS TOS,
                   DS_CSLAND.BA_TABLE BA1,
                   (
                    SELECT DX.FILE_NUMBER,
                           SUM(NVL(DD.PARTNER_PERCENT,0)) WI
                      FROM DS_CSLAND.D_XREF DX,
                           DS_CSLAND.D_DETAIL DD,
                           DS_CSLAND.T_OWNERS TOWN
                     WHERE DD.PARTNER = TOWN.OWNER
                       AND DX.ACCOUNT_GROUP IS NOT NULL
                       AND DX.DOI_ID = DD.DOI_ID
                       AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
                       AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
                       AND DX.SUBSYSTEM = 'W'
                       AND DX.DOI_TYPE = (
                            SELECT MAX(DOI_TYPE)
                              FROM DS_CSLAND.D_XREF DX1
                             WHERE DX.FILE_NUMBER = DX1.FILE_NUMBER
                               AND DX1.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
                               AND DX1.EXPIRY_DATE > CURRENT_TIMESTAMP
                               AND DX1.SUBSYSTEM = 'W'
                           )
                     GROUP BY DX.FILE_NUMBER
                   ) D,
                   (
                    SELECT FILE_NUMBER,
                           REPLACE(LISTAGG(TO_CHAR(REMARKS_DATE,'YYYY-MM-DD')||': ['||TRIM(REMARKS_TYPE)||'] - '||REMARKS, '~'),'~',chr(10)) "REMARKS"
                      FROM (
                            SELECT *
                              FROM DS_CSLAND.W_REMARK
                             ORDER BY FILE_NUMBER,
                                      REMARKS_DATE,
                                      OCCURRENCE
                           )
                     GROUP BY FILE_NUMBER
                   ) WR
             WHERE WD1.FILE_NUMBER = WD2.FILE_NUMBER
               AND WD1.AREA = TA.CODE(+)
               AND WD2.FIELD = TF.CODE(+)
               AND WD1.FILE_STATUS = TWFS.CODE(+)
               AND WD1.FILE_NUMBER = D.FILE_NUMBER(+)
               AND WD1.WELL_LICENSEE = TOS.OWNER(+)
               AND WD1.WELL_TYPE = TWT.CODE(+)
               AND WD1.WELL_STATUS = TWS.CODE(+)
               AND WD1.FILE_NUMBER = WR.FILE_NUMBER(+)
               AND WD1.WELL_LICENSEE = BA1.PRIMARY_KEY(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_W_DETAIL1
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_W_DETAIL1') }}
        name: VIEW_CSLAND_WELL_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_WELL_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
