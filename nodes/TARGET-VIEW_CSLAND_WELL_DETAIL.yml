fileVersion: 1
id: 2393d61c-a07b-428f-ad0e-948208327c38
name: VIEW_CSLAND_WELL_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0978086b-aad5-4b4b-a198-9aaa04f7a4e5
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Well File Number
        name: WELL_FILE_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 536089c6-5508-4b08-90e4-416273afec75
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b5313e2-d58e-4316-bdc5-63edea62466e
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(48)
        defaultValue: ""
        description: ""
        name: RAW_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 984250f7-369b-4059-8a28-889af155173e
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f84eb990-30f1-46ff-b280-b78a26a724bf
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(101)
        defaultValue: ""
        description: ""
        name: FORMATED_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 984250f7-369b-4059-8a28-889af155173e
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b7bd3d2-3b55-474b-911f-052f9d9570c8
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(128)
        defaultValue: ""
        description: ""
        name: SORT_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 984250f7-369b-4059-8a28-889af155173e
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 728d505d-1f1f-4632-bfd6-b8fc6aa440ec
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(180)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f423b0dd-084c-435a-bb2a-f0d988d30e79
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d27d5efd-2835-4b4d-8a4f-67422e136093
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dfec537-6e2b-46b3-8772-13730feac166
                stepCounter: 1dd57755-d0f7-492b-bfa0-d64cd40514d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbd71cd8-0e3f-40b8-918b-7157991ca598
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_LICENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cd29a3d-2563-4488-9d44-1816e871f49d
                stepCounter: 1dd57755-d0f7-492b-bfa0-d64cd40514d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7331b558-a97d-4e1d-ad4e-822418612b50
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_LICENSEE_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cd29a3d-2563-4488-9d44-1816e871f49d
                stepCounter: 1dd57755-d0f7-492b-bfa0-d64cd40514d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e261d7db-6a48-4121-ad3d-a3bd9c62b72b
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_LICENSEE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0992b3a4-68f8-4793-8227-49602f300234
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8125f2c-84cb-4e5a-8d47-97a9ff176c37
                stepCounter: 1dd57755-d0f7-492b-bfa0-d64cd40514d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f348bc1-8499-499c-be8d-472894f20516
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b10f0b4-de8a-447a-93ce-862ecfea19d2
                stepCounter: 56f42c85-ca1f-476d-b6ce-0577235c7ecc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f531954-5c58-471a-8bac-fd4fe3ca8982
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 641e1662-da64-4e7f-8e25-121b096f7aef
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48c44091-17b3-48f0-b9ed-a16326998fd0
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5a22cda-bccc-455c-b763-d19de77708f4
                stepCounter: 56f42c85-ca1f-476d-b6ce-0577235c7ecc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9171615e-24d0-4935-a252-ad50b93ccc22
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb04b2e8-f2b6-4881-942a-5627dff440ba
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75d64d7a-b53f-4020-b1ad-5cbca70f4477
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63e40f7b-394c-4402-b278-6f97f7fec234
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9014276-960b-4b2d-a375-248d24f55420
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c64c5d84-a152-4fd5-b0a7-9afb349729f9
                stepCounter: 0f957407-c662-4f3f-b63b-bb967c73672a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62c58ada-8aa9-4ea6-955d-00dcbb232d67
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: WELL_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8d150b2-3249-4841-b024-0ab5fe958b54
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bab2273-2649-4840-9bae-e73b997010db
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe1423d1-6189-4f67-8df9-29fa07595805
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8dfcfdce-4142-45c7-8d10-8bb83ca46874
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0f9e485-7a47-4117-8898-82b8150dad6a
                stepCounter: c8cff36f-cf3a-4f27-a8b5-de8b97a2b41c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7ae061e-fe9c-4021-82f8-5118f5e4ecf7
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c37d60ac-ab4e-4e22-82ce-b3afc95c9b12
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca207488-d893-4379-9aa3-57cf3e2a205f
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 841013fd-fb5b-47a4-93d7-19d873889349
                stepCounter: 3a2577e9-f7eb-4fea-beab-0fe9e54f2830
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce9b637e-28a5-4904-ae84-cbb7c1141c80
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63346fa8-d71f-4bcc-8249-29054f456da0
                stepCounter: 3a2577e9-f7eb-4fea-beab-0fe9e54f2830
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1f2f843-04de-4ad3-8b95-deb1d73ee24d
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIELD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0d33e08-3cae-4c21-8a1c-a7e74a345e99
                stepCounter: 1dd57755-d0f7-492b-bfa0-d64cd40514d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df58c5b9-b241-4481-b5ce-4a4483205ffa
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FIELD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5464d1b2-5162-4d56-8422-654e639f2141
                stepCounter: efdbddce-1992-4e87-8f69-3ca58ec10a75
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91a29153-0eef-4903-8d60-2740d046ed74
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RIG_RELEASE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ecc697f-dd41-440d-9962-7733a843fff7
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c29fbb50-aa8c-4642-84e3-6dbe252cd036
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: SPUD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c5eb11-316a-4c8b-80c9-c7b8ed94ca01
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3df7cd3-abf0-4e48-8b6a-756dc1a908ee
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9a8fbf3-e035-4e99-836b-909425633637
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 045bc4fc-581a-4aa7-ac40-4d9007b478a0
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ON_PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d1de065-fbd2-4590-b6b6-d72005a11c4a
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09ef1818-ea3d-433b-a7a6-4930246f6341
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LAST_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f7819ad-4a5a-4495-9ab7-b7f89df642a6
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07428640-82ad-4bdc-be09-c9b2b72d92fa
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ABANDONED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74e2fdf3-b072-4ed9-abbc-bd236b0e182b
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44d79835-1b39-431e-9a24-780ef8469138
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: NUMBER(7,1)
        defaultValue: ""
        description: ""
        name: TOTAL_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ac3dae0-a252-4ca1-9a75-df1db50fad78
                stepCounter: 1dd57755-d0f7-492b-bfa0-d64cd40514d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 635fa3a9-d5b7-4b21-a878-e0612093a5c6
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: NUMBER(7,1)
        defaultValue: ""
        description: ""
        name: TRUE_VERT_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34b14582-1f20-45c6-bfc2-6fa66c2ee284
                stepCounter: 1dd57755-d0f7-492b-bfa0-d64cd40514d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60fa58c0-a515-4b5e-bef0-def480fb56d7
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: NUMBER(23,8)
        defaultValue: ""
        description: ""
        name: WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0286f0e-21c4-426a-8cee-a0d0b6882ac4
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41c710b7-4522-4b26-b760-cafb8aab3016
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: OP or NONOP
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b031bb-27e5-42ed-ae99-c37a1446a25e
                stepCounter: 001fcc0c-faa3-492e-990b-29437efcbbc0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb7cfd66-3209-4e1c-a105-3c86330cc2c1
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: REMARKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a990c25-9c76-4052-a2c6-7318fab86a84
                stepCounter: 11d54bf8-1cfc-4250-970b-7ee6cf2d3ea7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccf77d0a-7b28-4186-89e5-f964390828ee
          stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 536089c6-5508-4b08-90e4-416273afec75
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_WELL_DETAIL: 2393d61c-a07b-428f-ad0e-948208327c38
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_WELL_DETAIL') }} AS SELECT WD1.FILE_NUMBER "WELL_FILE_NUMBER",
                   UPPER(WD1.WELL_UWI) "RAW_UWI",
                   DECODE(SUBSTR(WD1.WELL_UWI,1,1) ,'1',SUBSTR(WD1.WELL_UWI,1,3)||'/'||SUBSTR(WD1.WELL_UWI,4,2)||'-'||SUBSTR(WD1.WELL_UWI,6,2)||'-'||SUBSTR(WD1.WELL_UWI,8,3)||'-'||SUBSTR(WD1.WELL_UWI,11,4)||'/'||SUBSTR(WD1.WELL_UWI,15,2) ,'2',WD1.WELL_UWI --NTS format TBD
             ,WD1.WELL_UWI) AS "FORMATED_UWI",
                   DECODE(SUBSTR(WD1.WELL_UWI,1,1) ,'1',SUBSTR(WD1.WELL_UWI,1,1)||SUBSTR(WD1.WELL_UWI,13,2)||SUBSTR(WD1.WELL_UWI,11,2)||SUBSTR(WD1.WELL_UWI,8,3)||SUBSTR(WD1.WELL_UWI,6,2)||SUBSTR(WD1.WELL_UWI,4,2)||SUBSTR(WD1.WELL_UWI,2,2)||SUBSTR(WD1.WELL_UWI,15,2) --LOC Type, MER, RGE, TWP, SEC, LSD, LOC EVT, DRILL EVT
             ,'2',WD1.WELL_UWI --NTS sort TBD
             ,WD1.WELL_UWI) AS "SORT_UWI",
                   UPPER(WD1.WELL_NAME) "WELL_NAME",
                   WD2.SURFACE_LOCATION,
                   WD2.LICENCE_NUMBER "WELL_LICENCE_NUMBER",
                   WD1.WELL_LICENSEE "WELL_LICENSEE_BA",
                   BA1.NAME "WELL_LICENSEE_NAME",
                   WD2.ACCOUNTING_PROJECT "COST_CENTER",
                   TWFS.AI_FLAG,
                   WD1.FILE_STATUS "WELL_FILE_STATUS_CODE",
                   TWFS.DESCRIPTION "WELL_FILE_STATUS",
                   WD1.STATUS_DATE "WELL_FILE_STATUS_DATE",
                   WD1.WELL_STATUS "WELL_STATUS_CODE",
                   TWS.DESCRIPTION "WELL_STATUS",
                   WELL_STATUS_DATE,
                   WD1.WELL_TYPE "WELL_TYPE_CODE",
                   TWT.DESCRIPTION "WELL_TYPE",
                   WD1.AREA "AREA_CODE",
                   TA.NAME "AREA",
                   TA.PROVINCE "PROVINCE",
                   WD2.FIELD "FIELD_CODE",
                   TF.DESCRIPTION "FIELD",
                   WD1.RIG_RELEASE_DATE,
                   WD1.SPUD_DATE,
                   WD1.COMPLETION_DATE,
                   WD1.ON_PRODUCTION_DATE,
                   WD1.LAST_PROD_DATE,
                   WD1.ABANDONED_DATE,
                   WD2.TOTAL_DEPTH,
                   WD2.TRUE_VERT_DEPTH,
                   NVL(D.WI,0) "WI",
                   DECODE(TOS.OWNER,NULL,'NONOP','OP') OP_NONOP,
                   WR.REMARKS,
                   WD1.DIVISION "DIVISION",
                   WD1.FILE_NUMBER "WELL_FILE_KEY"
              FROM DS_CSLAND.W_DETAIL1 WD1,
                   DS_CSLAND.W_DETAIL2 WD2,
                   DS_CSLAND.T_WFSTATUS TWFS,
                   DS_CSLAND.T_WTYPE TWT,
                   DS_CSLAND.T_WSTATUS TWS,
                   DS_CSLAND.T_AREA TA,
                   DS_CSLAND.T_FIELD TF,
                   DS_CSLAND.T_OWNERS TOS,
                   DS_CSLAND.BA_TABLE BA1,
                   (
                    SELECT DX.FILE_NUMBER,
                           SUM(NVL(DD.PARTNER_PERCENT,0)) WI
                      FROM DS_CSLAND.D_XREF DX,
                           DS_CSLAND.D_DETAIL DD,
                           DS_CSLAND.T_OWNERS TOWN
                     WHERE DD.PARTNER = TOWN.OWNER
                       AND DX.ACCOUNT_GROUP IS NOT NULL
                       AND DX.DOI_ID = DD.DOI_ID
                       AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
                       AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
                       AND DX.SUBSYSTEM = 'W'
                       AND DX.DOI_TYPE = (
                            SELECT MAX(DOI_TYPE)
                              FROM DS_CSLAND.D_XREF DX1
                             WHERE DX.FILE_NUMBER = DX1.FILE_NUMBER
                               AND DX1.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
                               AND DX1.EXPIRY_DATE > CURRENT_TIMESTAMP
                               AND DX1.SUBSYSTEM = 'W'
                           )
                     GROUP BY DX.FILE_NUMBER
                   ) D,
                   (
                    SELECT FILE_NUMBER,
                           REPLACE(LISTAGG(TO_CHAR(REMARKS_DATE,'YYYY-MM-DD')||': ['||TRIM(REMARKS_TYPE)||'] - '||REMARKS, '~'),'~',chr(10)) "REMARKS"
                      FROM (
                            SELECT *
                              FROM DS_CSLAND.W_REMARK
                             ORDER BY FILE_NUMBER,
                                      REMARKS_DATE,
                                      OCCURRENCE
                           )
                     GROUP BY FILE_NUMBER
                   ) WR
             WHERE WD1.FILE_NUMBER = WD2.FILE_NUMBER
               AND WD1.AREA = TA.CODE(+)
               AND WD2.FIELD = TF.CODE(+)
               AND WD1.FILE_STATUS = TWFS.CODE(+)
               AND WD1.FILE_NUMBER = D.FILE_NUMBER(+)
               AND WD1.WELL_LICENSEE = TOS.OWNER(+)
               AND WD1.WELL_TYPE = TWT.CODE(+)
               AND WD1.WELL_STATUS = TWS.CODE(+)
               AND WD1.FILE_NUMBER = WR.FILE_NUMBER(+)
               AND WD1.WELL_LICENSEE = BA1.PRIMARY_KEY(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_W_DETAIL1
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_W_DETAIL1') }}
        name: VIEW_CSLAND_WELL_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_WELL_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
