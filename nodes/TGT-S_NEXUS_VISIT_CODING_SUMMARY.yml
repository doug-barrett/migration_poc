fileVersion: 1
id: 70539b7e-b7c8-4cf9-9982-10ecb5476683
name: S_NEXUS_VISIT_CODING_SUMMARY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Summary of Clinical Coding Diagnosis data for each Theatre Visit  "
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a69b1eb-1372-45fe-9449-46fd3e98e0a1
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 959b440f-53b9-4a86-bfa0-7614113f0cd2
                stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60a8bee2-edc3-4e4f-ae31-0cea7b3cf5a7
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8b57704-de08-4427-b570-d75e4ba7c222
                stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a0de5b2-1309-4a2b-a1c2-afe342de5348
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b161bd0-c405-4a37-9048-d07dded89460
                stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d96305f-ce9d-4d84-8bdf-cc6c46665c61
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d9e1ef8-b1cb-4567-8280-78ba189db234
                stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6a3826e-fccd-4084-b950-7f17220ba488
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_clinical_coding_summary.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b87ab135-0f50-4449-8675-fd8388bf0242
                stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79f9ddd9-a109-4a2f-97f0-a5db35c9f02c
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c495c639-e54d-4207-901a-04a876f14e7a
                stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f238202-d48e-4fd8-a4eb-74ac5f8e688a
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8df1272-f019-4375-90e1-375c3856f5c4
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acbf4c45-d06a-4c92-8371-096f67663861
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_03
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdb157aa-4067-445a-80ef-057d86e8715d
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_04
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b87768b-a8b8-41b8-a3f8-1213f1c31057
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_05
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa0f5635-90b4-4868-949c-1b06b1b5bc57
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_06
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04a63272-ddab-4fe3-a392-e6dc8cf9e904
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_07
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d7babe9-1c08-4c42-b4a6-1c137e1d4dc6
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_08
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6714bdd1-4226-45c1-90c0-d2b98cbcb754
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_09
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 191db98a-1ede-4c19-9e3c-ce363daeffc8
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0830f13-bceb-415f-87ab-ddae4dd3f78e
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ba7c385-a93a-4fdd-893d-137def2f8d69
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89e43663-b797-4a44-abab-4dd9024d78e0
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_13
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25cf9215-a2b3-4124-a66a-d0697f07309b
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_14
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0dd272e-636d-49f3-924d-ddf202aff228
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71c0e48d-3a63-4cd3-8132-822487eb0681
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d02a95be-4a58-4fc5-8226-0c3b1a2a5384
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_17
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7090f700-2ef8-47c2-978f-bac4f6030046
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_18
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 615db620-effd-4c6d-a254-586c380117ff
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_19
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47ea0590-2bf1-41a7-97ac-27f93f23c629
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE_20
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2573cfb8-7456-41b7-998f-df23974ebfc3
          stepCounter: 70539b7e-b7c8-4cf9-9982-10ecb5476683
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_NEXUS_DIAGNOSTIC_PROCEDURES_20
        join:
          joinCondition: |-
            FROM (
                    SELECT theatre_visit_encounter_id,
                           schedule_reference_no,
                           patient_reference_no,
                           patient_NHI,
                           dim_patient_key,
                           diagnosis_procedure_type_code,
                           [1] AS diagnosis_procedure_code_01,
                           [2] AS diagnosis_procedure_code_02,
                           [3] AS diagnosis_procedure_code_03,
                           [4] AS diagnosis_procedure_code_04,
                           [5] AS diagnosis_procedure_code_05,
                           [6] AS diagnosis_procedure_code_06,
                           [7] AS diagnosis_procedure_code_07,
                           [8] AS diagnosis_procedure_code_08,
                           [9] AS diagnosis_procedure_code_09,
                           [10] AS diagnosis_procedure_code_10,
                           [11] AS diagnosis_procedure_code_11,
                           [12] AS diagnosis_procedure_code_12,
                           [13] AS diagnosis_procedure_code_13,
                           [14] AS diagnosis_procedure_code_14,
                           [15] AS diagnosis_procedure_code_15,
                           [16] AS diagnosis_procedure_code_16,
                           [17] AS diagnosis_procedure_code_17,
                           [18] AS diagnosis_procedure_code_18,
                           [19] AS diagnosis_procedure_code_19,
                           [20] AS diagnosis_procedure_code_20
                      FROM (
                            SELECT theatre_visit_encounter_id,
                                   schedule_reference_no,
                                   patient_reference_no,
                                   patient_NHI,
                                   dim_patient_key,
                                   diagnosis_procedure_type_code,
                                   diagnosis_procedure_code,
                                   medical_problem_level_no
                              FROM s_nexus_diagnostic_procedures_20
                           ) dp PIVOT (MAX(diagnosis_procedure_code) FOR medical_problem_level_no IN ([1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20])) dp
                   ) s_nexus_diagnostic_procedures_20
        name: S_NEXUS_VISIT_CODING_SUMMARY
        noLinkRefs: []
  name: S_NEXUS_VISIT_CODING_SUMMARY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
