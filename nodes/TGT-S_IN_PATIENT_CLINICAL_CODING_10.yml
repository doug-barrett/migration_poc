fileVersion: 1
id: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
name: S_IN_PATIENT_CLINICAL_CODING_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Provisional Staging Table to implement WDHB/Manual Clinical Coding Rules when available"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b8db10f-5652-4bae-9619-dd69f02bc714
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1c7a3a3-1474-4270-ae9b-54e5b66ee6e1
                stepCounter: a7d7c8ec-88ee-49a8-b500-e3f4bce83e59
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d574b2dd-ae88-447d-b521-70d9854ba2ee
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ebe6be-3684-4644-9dcd-5c7bc5decbe3
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a11a590-c7f3-4cb8-b03e-7be13b4a0fb9
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: ORIGINAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50c0abde-970b-4d04-8cff-e8e6cbcdc6f7
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff3da67d-649d-477b-8fd1-ac0141f5be82
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb26cb4-65c9-4900-87d1-84fe70d71e8a
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0b8c4fb-b851-4959-8507-fd897c81e764
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_NEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: effb6b0d-eb5e-4903-93d2-6250cac50858
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac733ab6-6958-4df3-a2b9-64e23b9a21f5
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e37605f-b168-4f80-88f7-1c59bb05b07c
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59f1cf3f-a5d0-4bbe-b06a-3efc90953c4a
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a6bbb2f-c02e-4b85-a5a2-49bd8dfab83a
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3befdf32-afb3-49b5-8bdf-d854922bf6fd
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CONDITION_ONSET_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e46af41-ba38-4a07-9fd8-668433b075d1
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2b30fb3-c83f-4995-89bf-8244df79268a
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf697f5b-3a46-40ee-8853-22907d82e848
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a485a95e-69cd-4ef2-ac34-fbb18cc0b2d4
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ea141fc-685c-421c-906e-c81d2cdf11b2
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d749776-771a-481c-ac5d-86b2f4cada95
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ae37640-1f6a-47b5-b4ec-169fc3342402
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a1fc4b8-c07f-45d2-b929-00f4752074c0
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f337b6c-08c0-48a5-abfb-2f1476308800
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8d6e011-f85f-4c01-9a67-e5405ff8d3fb
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce54f89c-5c40-4ad2-ae5e-c2bd38e8fe9f
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a8126d6-2dfc-4e86-b5c3-07ba2dc92e2d
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_clinical_coding_10.diagnosis_procedure_code=dim_ICD_code.ICD_code
        name: DIM_ICD_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bb26a8e-9f81-482a-ac66-564fe7f367e2
                stepCounter: 14296dc0-a536-4a05-bd68-f298f228f590
            transform: IFNULL(dim_ICD_code.dim_ICD_code_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdad8423-9d9b-4d64-87bb-7d3969f8ec69
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87a55d2c-315b-4487-90f0-8c97cfffcd85
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 507bfb60-57cb-428d-967a-473b8a372c23
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed9732aa-bece-4858-afae-47cef1754168
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18619c3f-4140-425c-8ab4-cbdabdfa05f7
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 102e2abb-5c25-4491-8700-9befa5788e11
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db8ec63b-65d9-45bd-a12c-a50fffef32b1
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37c4f16b-5283-4301-85a0-aa4380a56fb5
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c671397a-3caf-40c5-bdfa-2ca24bd64e16
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c5a760-3fa4-437a-b235-0d3d8e919868
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95278522-96c3-4abe-822a-ca416aec8891
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de882e3d-6b91-4cbd-a581-4e58a2ad5b95
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3565a872-574b-4d95-957f-14bf38f2d17e
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de0ef3c4-94d4-43f5-8394-f4350cf21809
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed7ba841-19fd-4d6d-9ed7-0f38e0b79147
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 934f293d-14b7-4a1a-ba7b-2cc4465fc622
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 148b73dc-671e-4f97-996d-f5639566eaa1
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c31ee4a-fdcd-4ede-b080-42fc0809f8e1
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed2712c-6577-41a7-a5a6-847041c363b8
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 642c8550-be43-4244-8ee7-b673a9cdcacc
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 733212d6-669d-419c-b3c1-f2526cd87cab
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cd2022f-73c6-45fd-af66-bc8bfe606e0f
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c220be1-dde6-4284-beb6-92404f0b10e0
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DISCHARGE_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a20cce7-e428-42be-b241-7e4668c93133
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 306a400d-9a77-45ec-ac29-7214893dd594
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0971aa16-001f-46de-b781-7823e3e2a262
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b16b2b71-5593-4e0f-91be-13936636b288
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfed95ea-806a-4025-9a15-7acb5d9dc85b
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 633c1d31-1eb3-4c96-9be4-b31854ec725d
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad16d476-c6f6-4fcc-9f33-efde6c2933fc
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeef1c5c-3caf-4d42-a2eb-aa470d89717f
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7861727d-f154-4cc3-b869-a3067c819e24
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f779854a-6902-4956-b68d-7eddca153a6b
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4468d013-e6b5-4e07-aa96-b53cf1ef39c4
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 334a4d2c-e03b-466e-ab2a-874ae1c8d06c
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa9cb6e9-438b-457a-b246-8b920be867ae
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b145006-b35d-4ffa-ac5a-55fe499e75db
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2fcdc81-3813-4350-8044-d6a306364cb1
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ff844f4-b391-473c-b9fe-9f7bfa0a9df3
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35bfa0cb-15be-4dec-879f-b8916796a36b
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8338e861-47c1-479f-8721-f71845c679f5
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: discharge_Financial year (YYYY)
        name: DISCHARGE_FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CONVERT(varchar,dim_discharge_date.discharge_fin_year)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19b72702-36d0-4f72-87e9-d016b01a4743
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Based on ICD coding 'Z720', 'F171', 'F172'
        name: SMOKER_IDENTIFIED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ae37640-1f6a-47b5-b4ec-169fc3342402
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: |-
              CASE WHEN IFNULL(s_in_patient_clinical_coding_05.diagnosis_procedure_code,'x') IN ('Z720', 'F171', 'F172') THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fd07d36-fef5-4c1f-abba-28d89f3f1e25
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: smoking_advice_given based on ICD codes Z716
        name: SMOKING_ADVICE_GIVEN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ae37640-1f6a-47b5-b4ec-169fc3342402
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: |-
              CASE WHEN IFNULL(s_in_patient_clinical_coding_05.diagnosis_procedure_code,'x')= 'Z716' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b6e79de-7c9a-4ba8-bbb7-21113bcc6ee8
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf35f0f9-a759-4f91-aada-8803d42ced07
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: REPLACE(IFNULL(NULLIF(s_in_patient_clinical_coding_05.purchase_unit,'EXCLU'),s_in_patient_clinical_coding_05.excluded_purchase_unit),'.','0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ce7267b-129c-4578-957f-529e47b2c701
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf35f0f9-a759-4f91-aada-8803d42ced07
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a292a042-495c-438d-965f-fe51563bc740
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3062abb1-d7e8-4a34-a1a0-55fc49343b4d
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20315069-8192-4b27-a879-56bc21d5abc9
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: ACC_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9535214-06d9-4d54-b383-f21515143469
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 149cce3f-811e-4f15-a522-bb43e6e78ce2
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: NZ_RESIDENCY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62f9cd57-0590-46bf-8120-2b387b35c065
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7933ff80-f6e5-4e8a-af48-142a0b69871f
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a33e120b-52ec-42c0-bf68-2bdb62fdbffa
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14351023-1edb-43ec-8273-e3ec3a968ca1
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfb38d9e-995b-4bdf-8e45-1f9d3205154b
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06abd8e2-fcdc-4e81-b376-5e32d405ed7e
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VENTILATOR_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cacfb85a-875c-4081-bec8-a9c6841d15e7
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de3dc018-6782-47be-bd51-997cb98bfaa6
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3f96156-ce38-4624-9630-4a511bae74c4
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eff946f-18fc-4189-b02e-76aacaba0cc7
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b30eef9f-b422-4d52-bb98-3a5b9bb07636
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ae0b81d-5fd3-42be-83e3-8b7488759909
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6217047b-9af5-4d6c-8c6b-d471a59d14ec
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 174cd0b8-fd06-488b-a629-55ec72ce9c4c
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8070ab4-8bdb-4b1f-ab95-a9b82bbbe015
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 007c1a1c-b706-4c92-879d-16ece3cf051c
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: RECORD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d040657a-0428-47b6-afdc-358b9c449b07
                stepCounter: f55c5f77-34a6-4c68-a736-15db5f862945
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b89079ca-5e75-41db-9f67-e065b8a40bb1
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN (s_in_patient_clinical_coding_05.admit_date <> s_in_patient_clinical_coding_05.admit_date_orig OR s_in_patient_clinical_coding_05.disch_date <> s_in_patient_clinical_coding_05.disch_date_orig) AND s_in_patient_clinical_coding_05.patient_NHI <> s_in_patient_clinical_coding_05.patient_NHI THEN 'DT,NHI'
                          ELSE CASE WHEN (s_in_patient_clinical_coding_05.admit_date <> s_in_patient_clinical_coding_05.admit_date_orig OR s_in_patient_clinical_coding_05.disch_date <> s_in_patient_clinical_coding_05.disch_date_orig) THEN 'DT' ELSE CASE WHEN s_in_patient_clinical_coding_05.patient_NHI <> s_in_patient_clinical_coding_05.patient_NHI THEN 'NHI' END END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e84292c9-a89f-4920-ac2e-f40ec260a49a
          stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_INPATIENT_CHANGES
        join:
          joinCondition: |-
            FROM s_inpatient_changes
              JOIN s_in_patient_clinical_coding_05
                ON s_inpatient_changes.prvsp_refno = s_in_patient_clinical_coding_05.prvsp_refno
              LEFT OUTER JOIN dim.dim_discharge_date
                ON CONVERT(date, s_in_patient_clinical_coding_05.disch_date) = dim_discharge_date.discharge_calendar_date
              LEFT OUTER JOIN dim.dim_ward
                ON s_in_patient_clinical_coding_05.spont_refno = dim_ward.ward_reference_no
               AND dim_ward.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_ICD_code
                ON s_in_patient_clinical_coding_05.diagnosis_procedure_code = dim_ICD_code.ICD_code
               AND s_in_patient_clinical_coding_05.disch_date BETWEEN dim_ICD_code.validity_start_date AND IFNULL([dim_ICD_code].validity_end_date,getdate()+1000)
        name: S_IN_PATIENT_CLINICAL_CODING_10
        noLinkRefs: []
  name: S_IN_PATIENT_CLINICAL_CODING_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
