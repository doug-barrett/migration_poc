fileVersion: 1
id: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
name: S_CONTRACT_MANUAL_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e70ea479-745f-496c-b200-6e936a81913d
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_FUNDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2450970-ec2e-4a13-87ef-4ebf85590da9
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4770ebb4-ed2b-4105-8d20-0e02c711e981
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99f977b0-d137-486b-a48c-07b1277ef9d5
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7366c5ac-3754-469d-b2c7-cacf66f8adc0
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15de23d2-b98a-4b60-91f2-524498e3b630
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edcc4f00-cd62-4b7c-ab3a-b8381773175b
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a51e987e-4165-4648-b088-d6b1df196e07
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d98b73e-1b7d-45ed-822f-094a0d270e64
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REPORTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf0780e0-8150-4749-a4a6-0c97dedc839b
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f13fb73-6c4b-4c38-81e1-d56935362694
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b4b55f8-1401-435b-993f-0702949636d9
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: "'MAN:' + replace(purchase_unit_code,'.','0') + ':'+ cast(fiscal_year AS varchar)+ RIGHT('00'+CAST(month(reporting_date)AS VARCHAR(2)),2)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fb6a642-f9e5-42cb-ba9d-916e9ede972e
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25954a48-783c-4b8c-b325-774cfacf9e8f
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cbb7e8c-22d6-42c3-a6b8-eaa4779d96c2
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ba6580f-e907-40cb-8e2a-edc4ef377bfe
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8316b258-3895-4d5d-aac5-4869eb3806a9
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2f63665-6419-41df-96fb-2837977ea863
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2de85428-3811-437d-98c8-7c7bfe70a2cc
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fcb39cf-3844-4297-be9d-a78712d2c905
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4e0b842-9274-4671-8c10-df3c3cf07623
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f97a00db-7caf-4d1d-aef4-3a819e95906c
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87c8aacd-a9f5-45ac-bfff-7c71cf23708c
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5baed71d-c3a2-47c2-99ac-e153df14d8d1
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CONTRACT_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c64b80b-8d58-40db-afe9-7ab31f7264cc
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9720bc90-4d91-42b0-8070-78c3fd630ef5
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d02a2d52-159c-4e98-ad64-27cd100c12eb
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b886e7d4-66e4-42ca-92b4-1fa649e9c189
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bbd7d81-3986-495b-90be-535f6c18d7d3
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f2138e7-2524-433f-834c-bc93d7a8af15
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a81ee57-d6f6-4912-8219-c98a17bfd0f6
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8648d261-3927-41a8-bd13-453365583d6e
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5c19dee-0e4e-402a-97db-a1144f935869
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afeb3a56-51c9-4b08-bfae-05b1c978f186
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: AGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0508e09d-cdcf-4fa8-934f-b5845efacb6f
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c8ae4b-eded-44c9-830e-439a9e89bf8b
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_manual_10.age=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e35acdcd-fbc4-4995-8fe6-959d75b7bda8
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PVS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea112989-4d6e-47ea-bf71-7981cf6a9060
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e454cb-aa5f-471b-8c93-b0e0af40a863
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROCESSED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e77c51e-9117-4819-83ff-d82a8a98c738
                stepCounter: b957f51f-6cf8-4994-9a1e-d60227137646
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47b200be-1d21-4cd7-b555-4b3fbf3d33a5
          stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_DATASTORE_CONTRACT_MANUAL: b957f51f-6cf8-4994-9a1e-d60227137646
          DIM_PATIENT: d52dd438-7899-4242-9e38-539d2a1447df
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_DATASTORE_CONTRACT_MANUAL
          - locationName: TGT
            nodeName: DIM_PATIENT
        join:
          joinCondition: |-
            FROM {{ ref('TGT','L_DATASTORE_CONTRACT_MANUAL') }}
              LEFT OUTER JOIN {{ ref('TGT','DIM_PATIENT') }}
                ON l_datastore_contract_manual.NHI = dim_patient.patient_NHI
               AND dim_patient.NHI_sequence = 1
        name: S_CONTRACT_MANUAL_10
        noLinkRefs: []
  name: S_CONTRACT_MANUAL_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
