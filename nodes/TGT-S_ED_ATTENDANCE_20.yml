fileVersion: 1
id: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
name: S_ED_ATTENDANCE_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Calculates fact table measures relating to the LOS."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 655cb7c5-ea4e-421b-b4d1-d1937aea43fe
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed9e5167-8032-4f20-8210-7c5200b8b023
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ad1f79-09e3-4c74-9110-32222aa7a6ce
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: first character of the attendance_encounter_type_code (A, H, etc...)
        name: ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE LEFT(s_ed_attendance_10.encounter,1)
                          WHEN 'C'                             THEN 'CDS'
                          WHEN 'V'                             THEN 'VIP'
                          WHEN 'N'                             THEN 'NA'
                          WHEN 'X'                             THEN 'XW'
                          ELSE LEFT(s_ed_attendance_10.encounter,1)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61953f30-ec4d-4d0d-83a4-2a1432a6acea
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a432d61-8f7a-4029-82bf-5565c3ede614
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: decef4af-31f8-4491-8813-d6282b13b362
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance ref no.
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52e67909-b5a0-4605-93a2-b1e2063144b2
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 631d8cfc-2a5a-4795-ae88-03ad13c98a1e
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Intended specialty ref no.
        name: INTENDED_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b6f402a-2320-4b2e-ab43-ca85381b8e39
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 105f4164-3d60-4d22-a120-e04a7164c740
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0367603a-90ef-436e-bcab-1457f2d0e5fe
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a18e675c-d343-4ae7-ad2d-346a13111dd0
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aac86195-78ca-4d4e-a55c-4038338fdeb9
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d740fcea-f049-4f1b-ba22-35bdc8e9d692
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Arrival date and time.
        name: ARRIVED_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31c6b3db-9ed3-4f13-835d-2832b6e1d9e2
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e237f4f-0610-4730-920f-3a4d9a1b8bef
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Arrival date and time.
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be3429ba-741b-47ca-85be-e22a5dd9830f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a39a59-233b-401b-8589-fd02f49e1ce3
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 532e3de2-62b0-4123-86ed-622f72c76a64
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7adcdd70-4aba-45f6-9e66-054c9df3a88f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Medical discharge date.
        name: MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f360b93-5e1d-4e43-b466-654f0a29c803
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0e8ad63-c919-4348-b9ec-9d3ed4c9c7b9
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: cld_date
        name: CLD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f360b93-5e1d-4e43-b466-654f0a29c803
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: |-
              CASE WHEN ds_centric_Patient_Status.status=7 THEN ds_centric_Patient_Status.statusDTTM
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ac8826d-76d7-4c6b-8a7a-cfe23ad29adf
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTED_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 231bcd55-c072-4edd-a680-e7bf1562eeae
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d160f4c-6281-4ade-8333-88e1ce855a88
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ref no of Clinician at ED discharge
        name: LAST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ad9e279-944a-4941-aa23-0ec265afa407
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 376f8395-78d7-442a-b7d6-29b839335e78
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: EMMED end date and time.
        name: EMMED_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db4b1f63-3d28-490f-8d95-e9a147e22fe8
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62bfeaba-5961-4dff-a0a5-d5ed4b29d23b
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: EM final clinician seen, clinician at EM referral time
        name: EM_REFERRAL_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a1a4121-e5a4-4d2e-83be-2e03fabfdd72
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02d0b0a0-303f-421e-8529-d55b47973ab1
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Dim Service Point Surrogate/Generated key
        name: DIM_PRESENTING_LOCATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 172bd6bb-45ce-4dd2-a0f7-489e4004c64c
                stepCounter: bcb81445-cdcd-4baa-a725-05e962830a1b
            transform: IFNULL(dim_presenting_location.dim_presenting_location_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43890033-2845-4a85-ab79-04892c683585
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NON_EMMED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4005009c-ff93-4730-9f0c-7422b63f7448
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edaf2fbc-26ae-4f75-b381-b5252617a519
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_national_health_index NHI
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b15d240d-297e-45a4-837e-3073979c549f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1af4b1bd-8904-49bb-bfb2-73a0a7e12ca0
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6af532ab-4b60-45d5-bcc6-676fd9be1f2f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b12f31d3-e32c-4a9d-a9c8-e04fae5359e8
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient date of birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8223d028-434c-49ac-b5b5-72b17afec9f9
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dc03e6d-a59b-4177-b67f-b66ff853a2a8
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_years
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fba7020e-2fec-481d-b4bf-87082c29bc6e
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 403ff6c1-9826-4d34-8bbd-e78dc88a9081
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Defaulted admin_category_code for Emergency Attendances
        name: ED_ADMIN_CATEGORY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'35'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd337922-cf94-455f-b02c-57ca3bdc8186
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_months
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe9fddf6-bbdf-4dcb-9a5b-e67d84b750b4
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f3d021c-941d-485a-bd9e-94954f46fd1e
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e147cd3-c4ed-46f0-877a-7a06a9b5f4ca
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05efab8a-65de-4ae1-a5ae-3df26dac537a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_count
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab2ae2b9-2b2f-41c5-8c15-a72c3501d182
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e3cd02-50ab-47e3-a90e-f1a9d3e305ae
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_PREV_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5f1d1c-05bb-4766-90b6-fbae341d6302
                stepCounter: e570bd5c-040d-438b-88e8-2dae7efb8e0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e487ca41-ee52-4bd0-b1e3-8e9ee2e3629b
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07720c99-6c20-4c62-9b78-ba232d3f4720
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a182e1c-9031-4dfe-b313-3c3cda6a1ed5
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether this is a return visit.
        name: PLANNED_RETURN_VISIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 358d1ef9-88cd-49e7-8e11-da9edf7f1670
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08267483-12ac-4b87-9650-9ddefa37dc20
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_PREV_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec6ce2a8-6532-4ed2-a9ba-0c56c255dd93
                stepCounter: e570bd5c-040d-438b-88e8-2dae7efb8e0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bc7831a-14a6-4f48-a433-caaed51d26da
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6187c6a-d39d-4361-9ee1-7c15968c7586
                stepCounter: e570bd5c-040d-438b-88e8-2dae7efb8e0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28c0d052-cdb0-4f21-ae25-c9303071e736
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Notes presented on patient's arrival.
        name: PRESENTATION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5426443a-da5c-4825-9b5a-99e10f17f32d
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55cbdcb0-66c1-48c8-8959-eee20a1da122
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Notes presented on patient's arrival.
        name: DISCHARGE_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25c43f13-9324-4747-964c-94742de3d4c3
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d4f4655-f0a3-448e-81d4-f0b4e5c761a7
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: previous_to current_attendance_duration
        name: PREVIOUS_TO_CURRENT_ATTENDANCE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi, s_ed_attendance_prev_next.prev_departed_date, s_ed_attendance_10.arrived_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d7c589c-4f28-4775-85de-d09e0fa8c953
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cd1353b-18bd-4fab-9c1b-cc5e4e94af9d
                stepCounter: e570bd5c-040d-438b-88e8-2dae7efb8e0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b06038b9-bdc4-4ba4-bb30-20542b5d6a8d
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Principal diagnosis code.
        name: PRINCIPAL_DIAGNOSIS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aeac6204-aba2-4ae2-9dea-aa331cbd5b47
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63a98d47-a64b-4443-8d23-735a7ff241ed
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52c4cc93-e3ad-4aae-be83-8efa3d85751b
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e877291a-a3ab-4292-a4f9-a8486e7158dd
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: current_to_next_attendance_duration
        name: CURRENT_TO_NEXT_ATTENDANCE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi, s_ed_attendance_10.departed_date, s_ed_attendance_prev_next.next_arrived_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f2b257d-16bd-4a3f-a396-9cc0ef950674
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 021b21e2-d605-47e5-8926-351aa7864291
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2efe374e-9495-476e-ae38-698e1575985f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b47349f-2774-4a17-b68b-3aa8512e311d
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77afccfa-6f14-4017-bf20-67a486670045
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Referral date and time.
        name: REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c4fe2ee-9eed-47f3-8319-6cbf908226e7
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8067adac-dba4-4557-b96a-d9c90653521a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Referral ref no.
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de699a05-f9cd-48ef-b885-1e7121e4559b
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6385eb19-afda-44f6-9863-c16712995a8e
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a66a63-b609-40d7-9c63-e4713b553ddd
                stepCounter: 795c21ea-1da9-4519-8c1b-1e9f6f1a9458
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58ebe4e6-7a88-42f2-ac39-6186180aa900
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether this is a return visit within 48 hrs
        name: RETURN_VISIT_48HR_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be3429ba-741b-47ca-85be-e22a5dd9830f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: |-
              CASE WHEN DATEDIFF(hh,s_ed_attendance_prev_next.prev_departed_date, s_ed_attendance_10.arrived_date) <= 48 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e45b30c-8bbc-4fb8-978a-bbb567a1fc40
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SECOND_SEEN_BY_DOCTOR_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 133cdef3-4e7e-423a-81eb-a86a4b6ee8e2
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether patient self-discharged.
        name: SELF_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b64fc73-31ed-4784-b989-60198e9f8140
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 379a2cc5-72b0-4052-8345-4dd0b805f0cb
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Discharge type ref no.
        name: DISCHARGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb1c990c-4c65-4d01-b53c-4bc941df4125
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1d5e4ee-e61b-43fc-89aa-fc880cbd8329
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0374d2c-1a5d-4ce3-82e5-e9a7eab9e8e8
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 742e9c14-868b-4d53-8684-9cd040fa0a45
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Reason for discharge code
        name: DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5eaa3bc2-793a-4281-846d-1bcaa198768f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a6f947c-e8e7-43c2-a455-ea32143fad73
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND arrived_date>'30-jun-2021 23:59:59') THEN 'OB'
                          ELSE discharge_reason_id
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6327516-671e-4c6e-aeb2-e5b5465a228f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_FINAL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_attendance_10.first_seenby_date IS NOT NULL AND arrived_date >= '1 Jul 2025' AND s_ed_attendance_10.discharge_reason_reference_no IN (1000013520,1500000620) THEN 'ER'
                          WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND arrived_date>'30-jun-2021 23:59:59')                                                            THEN 'OB'
                          ELSE discharge_reason_id
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2dd18a9-eaae-4e9c-9b60-feb4229917c8
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATETIME_OF_DISPOSITION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND arrived_date >'30-jun-2021 23:59:59') THEN departed_date
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a1d010c-59f9-4f0e-a086-88037bd3086a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINICAL_DISPOSITION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND IFNULL(CASE WHEN IFNULL(first_seen_date, first_seenby_date) IS NULL AND s_ed_attendance_10.self_discharge_flag = 'Y' AND s_ed_in_patient_stay.IP_spont_refno IS NULL -- Not in IP Ward
              THEN 'Y' ELSE 'N' END, 'N') = 'Y' AND arrived_date > '30-jun-2021 23:59:59') THEN 'ONW'
                          WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND discharge_reason_id='ES' AND arrived_date >'30-jun-2021 23:59:59')                                                                                                                                                                                                    THEN 'OSD'
                          WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND discharge_reason_id='EI' AND arrived_date >'30-jun-2021 23:59:59')                                                                                                                                                                                                    THEN 'OSW'
                          WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND discharge_reason_id='ED' AND arrived_date >'30-jun-2021 23:59:59')                                                                                                                                                                                                    THEN 'ODD'
                          WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND discharge_reason_id='ER' AND arrived_date >'30-jun-2021 23:59:59')                                                                                                                                                                                                    THEN 'ODI'
                          WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND discharge_reason_id='ET' AND arrived_date >'30-jun-2021 23:59:59') AND s_ed_attendance_10.discharge_reason_code='ADMIT'                                                                                                                                               THEN 'OAD'
                          WHEN (IFNULL(s_ed_attendance_10.observation_location_flag,'N')='Y' AND discharge_reason_id='ET' AND arrived_date >'30-jun-2021 23:59:59')                                                                                                                                                                                                    THEN 'OTR'
                          ELSE ''
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe1b2218-684d-4a4b-a434-efdfc3dcb164
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84b68756-ce19-4408-b83c-cf109a0720cf
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 671d75ae-911d-4ef9-8009-4a148fd1605c
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time used to check 6 hour limit
        name: STOP_CLOCK_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5897d212-be78-4d39-9564-6d8de0ad06de
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f22e88c0-64a1-4cf4-9311-521f744b74a2
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_destination_reference_no
        name: DISCHARGE_DESTINATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6830f97-0798-4c36-bd09-b604021cb9df
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c701eaa-ed86-4ba8-a125-3bf51c4f392a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: stop_clock_location_flag
        name: STOP_CLOCK_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a102f695-f0ae-427c-ba0e-cc31c6243395
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee981bb-b931-4909-8622-cae4bd0b6b5c
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: discharge_destination_code
        name: DISCHARGE_DESTINATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01770141-b7c7-41c0-8880-d7f4306562b9
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 769536ac-fd52-4066-8e44-e25dc3145173
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Symptom code.
        name: SYMPTOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5db3bea3-114d-40ff-b45d-bc01ba1ec38d
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 805104d6-2cfd-45d0-a025-06722d8f248a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Patient symptom list
        name: SYMPTOM_LIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be1af943-96b1-402d-ab2e-ab386e0900a0
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3b3cc53-895a-4e98-8cbf-1c3fc71ebd57
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ARRIVAL_TRANSPORT_MODE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4229b51a-b89e-41bc-a473-d1fa9fd357b4
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93f22d23-d3b0-47a6-8de5-fb56b331450a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance category reference no
        name: ATTENDANCE_CATEGORY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2798dbb-db95-4b49-9b2f-d310b7b271c6
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b8b6cae-f278-4dec-923b-720fc8c506b2
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: symptom_refno
        name: SYMPTOM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bce110c-2624-40ed-b018-0733a3950f55
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40839604-3017-48cc-9afe-9ea33d84f426
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: attendance_category code.
        name: ATTENDANCE_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad156f5f-3eac-4765-90ef-bc23d5029c96
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66164e55-eaad-4f24-bc13-4666d701b657
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_INITIATION_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b14998c5-6206-4905-a6ce-ca0fdaba74ee
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08146ff0-1ba5-45fe-9ae5-2b8c9bce1d5f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(MINUTE, s_ed_attendance_10.triage_start_date, s_ed_attendance_10.treatment_protocol_initiation_time)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd95aeb3-0c3c-49d5-8521-0542990e344a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: treatmentprotocolid
        name: TREATMENTPROTOCOLID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1b4633b-f21d-47be-9fcf-2e159a3d718e
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a5af8da-3618-4556-80c2-7d02522a5c3f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: triag_proca_refno
        name: TRIAG_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88e46572-5664-4edd-94b4-92b34907369f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d41e379d-3e5c-478b-b2a3-26e6a477106d
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OBSERVATION_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84faf327-3ed2-4f49-8faf-526b1bcec8fb
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 893063db-5819-4312-a6a2-7baf1fa160d7
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CLD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2759a469-0510-46b0-a848-08eb11ffbefe
                stepCounter: c838b679-0977-4897-bd4c-de21cc11818d
            transform: |-
              CASE WHEN ds_centric_Patient_Status.status=7 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43ff562a-0479-4179-9fcc-bf5a123833be
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: observation_admit_date
        name: OBSERVATION_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93692e6c-8c9f-4ff4-9a81-e3a3b902eecc
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5077801-f245-41b2-8285-0301928c9166
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ref no of the encounter stay with the ealiest start date.
        name: FIRST_STAY_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c29a8448-3c4d-4a50-8b6f-f64592ff2b93
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bcd3c2b-b972-4158-b4c1-b18c418121eb
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Triage Category Reference No
        name: TRIAGE_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6287d7f-ed5e-4fa0-9f65-fb34f398a6e6
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1c7b33f-1499-48d7-8bd1-004546e8c755
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b6517be-0a2c-4309-ab2a-d4d35ac9269d
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9173a35a-a6a2-4be6-80b2-ec79bb2fff09
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between triage start date and first seen date.
        name: TRIAGE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi, triage_start_date, first_seenby_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5c261fb-3fdd-43f2-b3a3-1eb236e6817c
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between triage start date and first seen date in an inpatient period
        name: WTBS_INPATIENT_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_attendance_10.first_stay_specialty <> 'EMMED' THEN DATEDIFF(mi, triage_start_date, first_seen_date)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72a15050-9901-49f7-a247-883906171732
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Triage end date and time.
        name: TRIAGE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 326ac4c1-2380-41d5-acda-2da411f7274f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 309cdcbf-9a9f-4ed4-9aa0-77ac57ccccb2
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Presenting specialty ref no
        name: FIRST_STAY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 022dfc41-6a8d-45e4-a13a-62b02c4eedd9
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa38847b-bd61-4daa-bb51-d3da449cd85c
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: triage_healthcare_professional_code
        name: TRIAGE_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0218601e-6280-4a59-aa33-02805bc4c764
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8346ec5-f15c-4284-b70b-1c2b6c316281
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae32bf43-a6fd-4d8e-9020-5f983654b050
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f820ad29-ba83-4f61-9d36-3d98988b2a63
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: triage_priority
        name: TRIAGE_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b55a171b-877c-43fa-bd11-7d39a57128de
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa5cbac3-5035-4e0d-8be1-6908c1946d1f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ed86f81-8a5d-4ddc-9708-e8b964ed486c
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27dd613b-7887-4a47-ab9d-67f7eaa45cd8
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Triage start date and time..
        name: TRIAGE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9de8323-fbc1-46af-bbcf-a17b36f3498b
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2555d3a-f22e-46e2-ad47-4b8d7b0eed18
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb6d4236-0da9-4065-aa67-8a36a1361ca8
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef4fcd2-61d4-40eb-8dbe-a5ac56f7b871
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 832bae86-66e1-459c-939a-3e159c54a98d
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17a35300-a126-401b-9a8f-3a785be8455d
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration between visit date and triage start date.
        name: TRIAGE_START_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi, s_ed_attendance_10.arrived_date, triage_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1da4e6e1-4f5c-4333-92df-f1e399dedfe5
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: 'First date time within ADU '
        name: ADU_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc4dad61-9bed-4729-b7ec-97b05783f7fb
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f3123b-ab9d-42f4-ae05-ef711fcf3cab
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether stay in ADU.
        name: FIRST_STAY_ADU_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d88d79be-3532-4860-b1ed-e9a32ca36a28
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e1dc62b-5da1-4da3-a969-d09492e535d6
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating whether first stay specialty was EMMED
        name: FIRST_STAY_EMMED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae32bf43-a6fd-4d8e-9020-5f983654b050
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: |-
              CASE WHEN s_ed_attendance_10.first_stay_specialty = 'EMMED' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42beb8a5-f2b7-47d5-8100-42ea996f6c59
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OBSERVATION_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18a79220-0699-422d-ad95-c2d2513aa602
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f83b467b-c921-491f-be9a-deb1d86568dd
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: inappropriate_location_flag
        name: INAPPROPRIATE_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27a0ee84-4e65-458f-8752-bfbef39811ef
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2444285-6075-4603-92d7-723040a25e71
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ref no of the encounter stay with the ealiest start date.
        name: EARLIEST_START_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30541089-b2d7-45cf-98de-6c13b765ae39
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ec6a324-7ee5-4e8e-ab5d-7d704d6fb213
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20f61975-7860-4eb3-9777-5d8b8dd6a0a5
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f937584e-1770-47ee-8bfe-f68f1cffd3f4
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ece050ea-4f31-4807-ac22-324732c417a3
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5deb59ce-3db7-4073-b79e-6abd1b7479df
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc1fe66-9b20-4978-be55-5bbc4c5aae68
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aca5e3d5-2d2c-416a-9ebb-e2bf76ac78b7
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0286843e-8376-42ef-a0d8-64e27ce41e1b
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b85490e5-dd9f-44dd-82f0-4c28fc8f0128
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bfc4b07-6b9e-478f-bd00-8146e7b993af
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75e29fb8-7138-4c82-9211-2b10dd58a7b7
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2af10e89-028c-4bbe-8ce5-f555c62d0ab4
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d0f08d3-ec0f-48d4-96f6-19cd602b8a21
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient first seen by a clinician.
        name: FIRST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 301d0034-b8d6-4cdc-b18e-71777d6ef281
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6f2016b-5ae2-4a2b-aa99-24e03f6be2cb
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e120af1-ff04-4672-8796-b7a6bf732ae6
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d9c9f5-d9e6-4c00-bc8a-63c788f61844
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: first_seen_proca_refno
        name: FIRST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c58d6d9c-176e-4781-9ba2-ddd28bb875a7
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c9ff703-4121-4fb0-a2fc-bc1783890a9f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a504a97b-6678-49ec-aa86-489a0b1ac203
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d320c6f-2fc5-4f1f-b39a-2038e13fab31
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59807125-f9f1-42c8-8f32-db3a22f28db9
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa3a3ade-18e7-4f7b-a41c-df7f80a69629
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da6d1d2d-75cc-412d-b638-b6cb22814678
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f87c145f-86bd-4d6d-8d6a-3ef5638682ed
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d63c4af-7050-440b-9a3c-5f76169eff14
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0555994-11d9-4a4e-80d0-54bea8153ca8
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdfe212b-1fb0-4425-816b-7ef13ae87789
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f0b9eed-7fc9-4608-8ab6-0a970c463805
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: First Stay reference for a location within ADU
        name: FIRST_ADU_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c71e0183-074b-47a9-b103-c8a6afe5d913
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a776f8-8ea2-4860-b102-aa7343ada3bb
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient last seen by a clinician.
        name: LAST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4067a1c4-1b5f-41e0-9d54-cb3d5a2755a8
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c7ee32e-6e39-4c9e-8e4d-b1d33937db1e
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: last_seen_spect_refno
        name: LAST_SEEN_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d02c3a76-9ea3-442d-95ee-b5fd32987100
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: IFNULL(s_ed_attendance_10.last_seen_spect_refno, s_ed_attendance_10.intended_spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 802acba3-bd00-40fd-a73e-31a9e92b0f5a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 756f11fe-af71-4a77-86b6-0ba7ab1fb8e4
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18c3f8b6-7c57-40b3-af55-89503ab484d2
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8b6aaec-b5dd-4fa3-9d98-3712c7815a56
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5b00527-0c74-4a43-81be-4a5efd67200e
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7473ca1-ea5e-4f0c-af88-3529dd16a6d0
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b23f89c7-e256-47fb-8363-6f1082abd4a6
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54832034-209e-42e8-896d-2ac567cb2278
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c693793f-fb5e-4659-a2f6-cf513d72780b
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77763eed-1335-456b-98df-7cf3f861df02
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4af1656-ca5e-4136-b083-cfaccf893a1f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36605894-3fd8-4a1a-b9d7-7b0abe0e8310
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 882432a5-c1d1-43ac-b292-1370b18899f5
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71cac84f-11d1-45b3-8260-6c7eb200360a
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcf649fb-96c9-4591-8f3c-0214d4f901b1
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14c88ba-eb46-4fc8-b45e-068aa783d0c0
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aa7ee3a-d82b-40c5-ae2c-23fac7c51a06
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c996a126-f5ab-472e-b8d9-26aa721ba972
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e38241a2-5c40-4e91-9aea-83f0b97c25e3
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82d69b96-29b2-4867-bb17-1a49e1805413
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5d5581d-c443-40cf-b2dd-e3d0b77127c3
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea1d52fd-418d-4b91-88a2-e9fe28d6cecb
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0d67359-c923-4733-993d-7ae487c93b5a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e272ef3e-1d5c-400e-8d81-df8b3e2de855
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75f83e96-0e3e-4b61-a68d-9e563cf417a4
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ref no for the first non ED stay of the encounter.
        name: FIRST_NON_ED_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747e74c4-6db0-473a-ad48-84a56301c764
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b69fc0b-81a8-4fc1-9078-54955fc02def
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: First seen_date for a non EMMERG location stay.
        name: FIRST_NON_ED_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b3a426-54a9-4f7b-b7a5-e9ba773c415d
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 180083e8-499d-4bfa-92bb-05a883f86cff
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating if patient currently not physically discharged and still in emergency care.
        name: ED_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db942281-9cb6-4830-a229-f16408cc8db2
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2f5960c-c9ff-4cb1-9dd9-c403317fc5ba
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating whether the encounter is eligible for 6hr reporting
        name: ED_6HR_REPORT_ELIGIBILITY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN first_stay_ADU_location_flag = 'Y' --Added 18.04.2024 ZA
              OR dim_presenting_location.stop_clock_location_flag = 'Y' --OR observation_location_flag = 'Y' -- ex ZA 03-Jun-14
               --OR self_discharge_flag = 'Y'       -- ex ZA 03-Jun-14
               OR (--first_seen_date IS NULL      -- changed 14-Feb-2024 ZA
               IFNULL(first_seen_date,first_seenby_date) IS NULL AND s_ed_attendance_10.self_discharge_flag = 'Y' AND s_ed_in_patient_stay.IP_spont_refno IS NULL)-- Patient-Not-Waited
              OR l_mappings_PurchaseUnit_ED.purchaseunit like 'WDHB%' --excl_vouchers
               THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b7e8296-9372-42ef-8fe6-fe1d2df16a16
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating that the Patient did Not wait for Treatment
        name: PATIENT_NOT_WAITED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              -- No Seen-By and Self-Discharged and Not in ED or in IP Ward
              CASE WHEN IFNULL(first_seen_date, first_seenby_date) IS NULL AND s_ed_attendance_10.self_discharge_flag = 'Y' --AND  ((last_seen_spont_code IS NOT NULL AND last_seen_spont_code NOT IN ('ECCW','ECCWR')) OR s_ed_in_patient_stay.spont_refno IS NULL)
               AND s_ed_in_patient_stay.IP_spont_refno IS NULL -- Not in IP Ward
              THEN 'Y'
                          WHEN dim_discharge_reason.discharge_reason_id IN ('EC')-- Primary Care Vouchers
                                                                                                                                                                                                                                                       THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e778060-0e5e-4507-ac0f-abb9becfc52d
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: First seen date by a clinician outside of EMMED.
        name: IP_RESPONSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3b5eced-120c-41cf-8548-9d9844370092
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72342ab3-f87d-413d-9de4-078140a18a8f
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: 'In Patient Ward Stay Start date '
        name: IP_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d46dc272-d88c-4e3d-87d7-c7d034283cc5
                stepCounter: bff97753-5f67-49f0-9934-67e7b63ac5a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e7b2a41-2a36-4ecd-9f9c-e5c0d8a503b9
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: encounter_id of IP admission
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1558c35f-a7c4-4fc3-835c-5a965669e375
                stepCounter: bff97753-5f67-49f0-9934-67e7b63ac5a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32fc29fd-74da-4dcc-bd1b-9747aed0a5de
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: IP_admission_ward_reference_no
        name: IP_ADMISSION_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eee90f05-c799-4c5c-abef-ee0fd7b4c126
                stepCounter: bff97753-5f67-49f0-9934-67e7b63ac5a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0ce36c4-b2d3-4b6e-b816-b1befdf0070b
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag  indicating whether the patient was admitted to IP ward.
        name: IP_ADMISSION_WARD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eee90f05-c799-4c5c-abef-ee0fd7b4c126
                stepCounter: bff97753-5f67-49f0-9934-67e7b63ac5a2
            transform: |-
              CASE WHEN s_ed_in_patient_stay.IP_spont_refno IS NULL                      THEN 'N'
                          WHEN s_ed_in_patient_stay.IP_emergency_location_flag = 'Y'            THEN 'N'
                          WHEN s_ed_in_patient_stay.IP_service_point_desc LIKE '%Trans%Lounge%' THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94473826-ba98-4b26-a010-13019e2651b8
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43e1a8e9-66fe-429e-a2c3-e3cdee026db5
                stepCounter: bff97753-5f67-49f0-9934-67e7b63ac5a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb1c798e-1e64-4c98-a7c8-47c69f892ae5
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: IP_health_specialty_code
        name: IP_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd44d369-a65b-4dd6-8b17-562bc6706ea3
                stepCounter: bff97753-5f67-49f0-9934-67e7b63ac5a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eac7674-1191-4b22-8598-2e76a6ccba4b
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: IP_healthcare_professional_reference_no
        name: IP_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98979ea8-21e6-433a-a838-5ce31c461ff5
                stepCounter: bff97753-5f67-49f0-9934-67e7b63ac5a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a74c9e4-dcd3-4fc8-a540-c4375bdc692c
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between first seen date and end of stay in EMMED.
        name: EMMED_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_attendance_10.first_stay_specialty = 'EMMED' THEN DATEDIFF(mi, first_seen_date, EMMED_end_date)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de42c103-1d51-41c5-ae15-c154388cfa18
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration between EMMED end and first seen by IP clinician.
        name: IP_RESPONSE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              /*  CASE WHEN stop_clock_date <= ip_seen_date
                     THEN 0
                     WHEN stop_clock_date <= ip_response_date
                     THEN DATEDIFF(mi, ip_seen_date, stop_clock_date)
                     ELSE DATEDIFF(mi, ip_seen_date, ip_response_date)
                     END */ CASE WHEN s_ed_attendance_10.EMMED_end_date IS NULL THEN DATEDIFF(mi, triage_start_date,s_ed_attendance_10.IP_response_date)
                          ELSE DATEDIFF(mi, EMMED_end_date,s_ed_attendance_10.IP_response_date)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3c8052f-ab6d-4c6b-bd42-c4f1d962cd05
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration between IP seen date and disposition decision.
        name: IP_SEEN_DECN_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE --when s_ed_in_patient_stay.IP_start_date is null then 0

                          WHEN stop_clock_date < medical_discharge_date              THEN CASE WHEN IFNULL(emmed_end_date, first_seen_date) < stop_clock_date THEN DATEDIFF(mi, IFNULL(emmed_end_date, first_seen_date), stop_clock_date) ELSE 0 END
                          ELSE CASE WHEN IFNULL(emmed_end_date, first_seen_date) < medical_discharge_date THEN DATEDIFF(mi, IFNULL(emmed_end_date, first_seen_date), medical_discharge_date) ELSE 0 END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce80a84c-b42a-4551-b1bd-abf3d50c0d4a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Hours between disposition decision and actual disposition.
        name: DECN_DISP_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN stop_clock_date < s_ed_attendance_10.medical_discharge_date THEN 0
                          WHEN stop_clock_date < s_ed_attendance_10.departed_date          THEN DATEDIFF(mi, s_ed_attendance_10.medical_discharge_date, s_ed_attendance_10.stop_clock_date)
                          ELSE DATEDIFF(mi, s_ed_attendance_10.medical_discharge_date, s_ed_attendance_10.departed_date)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aae09635-5377-44a7-8637-c508b711edff
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: attendance_duration
        name: ATTENDANCE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi, s_ed_attendance_10.arrived_date, s_ed_attendance_10.departed_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 353c32ef-9640-447f-b8f1-f4b332bbfb08
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ALCOHOL_ANSWER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(CASE WHEN alcohol_answer IN('NSP','Unknown') THEN 'U' WHEN alcohol_answer = 'Secondary' THEN 'S' WHEN alcohol_answer = 'Yes' THEN 'Y' WHEN alcohol_answer = 'No' THEN 'N' WHEN alcohol_answer = 'Not Known' THEN 'U' ELSE alcohol_answer END,'U')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151f8a46-3b9c-400d-a148-0d903ca39281
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FIRST_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c799ab65-076a-40df-9edc-e5766f5b1ebf
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10ce7d2f-d8c7-4f45-a7f5-8749c9b300f8
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FIRST_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d14a54b-33f3-4804-a0c3-4f2fcf15966c
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6355ae6a-23e4-4859-b6ac-0e08be58a4d0
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_SECOND_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30e08132-6d6f-44ae-8f3b-260d77f8e09f
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d449b061-438c-41ef-887e-96609395b3e4
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: SECOND_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 468419b2-4065-48ab-a3eb-c69f7143dfce
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abd7dfb9-4126-425c-be03-18bab6679993
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_THIRD_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551c2197-5faf-4c23-80c7-07f38874695c
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b90da679-adf6-47d9-9509-d9021ac8b334
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: THIRD_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 667f90e1-0fbc-45c0-b309-1849d5e8cd4c
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e1272ce-f4b2-4818-8412-cda2c02e2e5a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FORTH_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd5df15e-3232-450d-81c7-57555f199e8d
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58b6c4be-86e1-48a8-a9c4-5842ffbbb995
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FORTH_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 573e3218-a1aa-48a8-a516-d8bdf16485f2
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3ae459d-1a0d-4a24-8a21-6df36c518c56
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FIFTH_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d887e602-8fc9-4cd5-8688-5b2eaa725938
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3907335f-0c2c-4c63-8ba2-2e98b3c4eca7
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FIFTH_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbf7f290-740b-4d81-91e7-41b60501205e
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5da89d39-9efc-4760-b58b-58b52205436b
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the first specialty transfer was performed
        name: SPECIALTY_TRANSFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e7bfaca-a457-40a6-9fcc-a5555b1e7105
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f8f85a2-b259-46e2-8fba-d80d279dae8a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: LOS duration
        name: LOS_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi, s_ed_attendance_10.arrived_date, s_ed_attendance_10.stop_clock_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f75589b1-bb3c-4470-8838-7b856c7eef59
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: LOS in dd:hh:mm format
        name: LOS_DDHHMM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              --CONVERT(varchar, DATEDIFF(mi,s_ed_attendance_10.arrived_date,stop_clock_date) / 1440 )
              --  + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,stop_clock_date) % 1440) / 60 )))
              --  + CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,stop_clock_date)  % 1440) / 60 )
              --  + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,stop_clock_date)  % 60))))
              --  + CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,stop_clock_date)  % 60))
              CONVERT(varchar, DATEDIFF(mi,s_ed_attendance_10.arrived_date,departed_date) / 1440) + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,departed_date) % 1440) / 60))) + CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,departed_date) % 1440) / 60) + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,departed_date) % 60)))) + CONVERT(varchar(2), (DATEDIFF(mi,s_ed_attendance_10.arrived_date,departed_date) % 60))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95ff912e-a711-4115-8952-b8c177c52688
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b5d9e69-3f6c-4ad6-83ca-c0f0aa4fc316
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79e9f70c-111e-4a02-b7a1-7fb0dfd00720
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c435953f-0e4d-4d32-a811-9afccee9aef1
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03b4085f-4ce4-45c2-bfe7-f17da269bccb
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: 'Actual cost of the event  '
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(fact_cost_encounter.actual_cost,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d0b2ce0-20f4-4810-a77f-924f2e20f3eb
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Budget cost of the event
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(fact_cost_encounter.budget_cost,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c0303d5-0a49-4ca8-aad8-06005c896b5d
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9e31597-56e4-4769-8710-58dd2ce5a61c
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53ab2b10-bc58-4a88-9135-b3eac7ba2b7e
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9224d00-d246-46c1-9229-c8a4d6cdf6eb
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9fedc4a-cffa-45dc-a077-ba2f36bec2e2
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16e3cd40-c86c-481c-8c45-453579ec5db4
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebed1c43-9894-41bf-9622-ca7c4c5286bc
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 160c5096-99a7-46c6-8283-abc76e412a33
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 676d2819-7e70-4eb3-a19f-bcd5ea4fa589
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Contains Null fields where no diagnosis exists
        name: EDS_TEXT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9444ebd-95ff-47a2-82e4-2f32512eef78
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78f60561-fcbf-4927-ba5e-873130263528
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Yes if not part of the Diagnosis codes
        name: FREE_TEXT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22ffbbe1-3dac-4a9c-83a4-bb2ef806777c
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1ea130d-93e7-4da8-b809-8c27f50d602a
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRESENTING_COMPLAINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2986ba62-a60b-43bb-a66f-6f7a4ede24b7
                stepCounter: 3c359477-c3e7-4c05-b6c1-54ddbce7b924
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b4c67fb-ed50-462b-a4fc-e149611ea356
          stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_ED_LOCATION: 795c21ea-1da9-4519-8c1b-1e9f6f1a9458
          S_ED_ALCOHOL_ASSESSMENT_COMBINED: 0907bd91-bbc0-4fe1-b984-56590d95a4a1
          DS_CENTRIC_SNOMED_PATIENT_PC: 3c359477-c3e7-4c05-b6c1-54ddbce7b924
          DIM_PRESENTING_LOCATION: bcb81445-cdcd-4baa-a725-05e962830a1b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ED_ATTENDANCE_10
          - locationName: TGT
            nodeName: DIM_ED_LOCATION
          - locationName: UNKNOWN
            nodeName: FACT_COST_ENCOUNTER
          - locationName: TGT
            nodeName: S_ED_ALCOHOL_ASSESSMENT_COMBINED
          - locationName: TGT
            nodeName: DS_CENTRIC_SNOMED_PATIENT_PC
          - locationName: TGT
            nodeName: DIM_PRESENTING_LOCATION
        join:
          joinCondition: |-
            EXTENDED
              FROM s_ed_attendance_10
              LEFT OUTER JOIN s_ed_in_patient_stay
                ON s_ed_in_patient_stay.attendance_aeatt_refno = s_ed_attendance_10.aeatt_refno
               AND (s_ed_in_patient_stay.stay_seq_num_non_ed = 1 or(left(IP_health_specialty_code,1) IN('M','S','Y') AND IP_service_point_code IN ('ECC','ECCW') AND NOT EXISTS (SELECT 1 FROM s_ed_in_patient_stay dd WHERE dd.attendance_aeatt_refno = s_ed_in_patient_stay.attendance_aeatt_refno AND dd.stay_seq_num_non_ed = 1) AND stay_seq_num = (SELECT max(stay_seq_num) FROM s_ed_in_patient_stay dgd WHERE dgd.attendance_aeatt_refno = s_ed_in_patient_stay.attendance_aeatt_refno AND left(IP_health_specialty_code,1) IN('M','S','Y') AND IP_service_point_code IN ('ECC','ECCW'))))
              LEFT OUTER JOIN s_ed_attendance_prev_next
                ON s_ed_attendance_10.patnt_refno = s_ed_attendance_prev_next.patnt_refno
               AND s_ed_attendance_10.patient_visit_num = s_ed_attendance_prev_next.curr_patient_visit_num
              LEFT OUTER JOIN l_mappings_PurchaseUnit_ED
                ON s_ed_attendance_10.hospital_id = l_mappings_PurchaseUnit_ED.hospital
               AND IFNULL(s_ed_attendance_10.spont_refno,0) = IFNULL(l_mappings_PurchaseUnit_ED.service_point_reference_no,0)
               AND s_ed_attendance_10.first_stay_ADU_location_flag = l_mappings_PurchaseUnit_ED.ADU_direct_flag
               AND (CASE WHEN s_ed_in_patient_stay.IP_encounter IS NULL THEN 'N' ELSE 'Y' END) = IFNULL(l_mappings_PurchaseUnit_ED.inpatient_flag,'x')
               AND CASE WHEN s_ed_attendance_10.first_ADU_aesty_refno IS NULL THEN 'N'
                        ELSE 'Y'
                         END = IFNULL(l_mappings_PurchaseUnit_ED.adu,'x')
               AND IFNULL(s_ed_attendance_10.discharge_reason_reference_no,0) = IFNULL(l_mappings_PurchaseUnit_ED.discharge_reason_reference_no,0)
               AND coalesce(s_ed_attendance_10.medical_discharge_date,s_ed_attendance_10.departed_date, getdate()) BETWEEN l_mappings_PurchaseUnit_ED.start_date AND IFNULL(l_mappings_PurchaseUnit_ED.end_date,dateadd(MONTH,1,getdate()))
              LEFT OUTER JOIN {{ ref('TGT','DIM_ED_LOCATION') }}
                ON s_ed_attendance_10.spont_refno = dim_ED_location.ED_location_reference_no
               AND s_ed_attendance_10.arrived_date >= dim_ED_location.dss_start_date
               AND s_ed_attendance_10.arrived_date < = IFNULL(dim_ED_location.dss_end_date,dim_ED_location.dss_update_time)
              LEFT OUTER JOIN {{ ref('UNKNOWN','FACT_COST_ENCOUNTER') }}
                ON s_ed_attendance_10.encounter = fact_cost_encounter.encounter_id
              LEFT OUTER JOIN {{ ref('TGT','S_ED_ALCOHOL_ASSESSMENT_COMBINED') }}
                ON s_ed_attendance_10.encounter = s_ed_alcohol_assessment_combined.encounter --and encounter_sequence = 1    LEFT OUTER JOIN (Select distinct pcCode, nhi, encounter from {{ ref('TGT','DS_CENTRIC_SNOMED_PATIENT_PC') }}    where deletedBy IS NULL) ds_centric_Snomed_Patient_PC  --ON ds_centric_Snomed_Patient_PC.nhi       = s_ed_attendance_10.patient_nhi -- 01-Feb-2022 NHI often contains a temp value    ON ds_centric_Snomed_Patient_PC.encounter = s_ed_attendance_10.encounter    ---added on 13.04.2023--  left outer join  [dim].[dim_discharge_reason]      ON IFNULL(s_ed_attendance_10.discharge_reason_reference_no,0) = dim_discharge_reason.discharge_reason_reference_no      AND IFNULL(dim_discharge_reason.dss_start_date, GETDATE()-10000) <= s_ed_attendance_10.arrived_date      AND IFNULL(dim_discharge_reason.dss_end_date, GETDATE()+10000) >= s_ed_attendance_10.arrived_date  --added on 18.04.2024  LEFT OUTER JOIN {{ ref('TGT','DIM_PRESENTING_LOCATION') }}      ON IFNULL(s_ed_attendance_10.first_stay_spont_refno,0) = dim_presenting_location.presenting_location_reference_no      AND IFNULL(dim_presenting_location.dss_start_date, GETDATE()-10000) <= s_ed_attendance_10.arrived_date      AND IFNULL(dim_presenting_location.dss_end_date, GETDATE()+10000) >= s_ed_attendance_10.arrived_date  --added on 23.09.2024  left join (select encounter,status, statusDTTM from ds_centric_Patient_Status   where status = 7  and deletedBy is null)ds_centric_Patient_Status  on ds_centric_Patient_Status.encounter= s_ed_at
        name: S_ED_ATTENDANCE_20
        noLinkRefs: []
  name: S_ED_ATTENDANCE_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
