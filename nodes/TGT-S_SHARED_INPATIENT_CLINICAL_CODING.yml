fileVersion: 1
id: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
name: S_SHARED_INPATIENT_CLINICAL_CODING
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5c42aac-81b4-42bb-a001-6fef80049546
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd338d02-eac7-4d45-806a-1831b0f3775b
                stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a84dc0-b825-4e66-b636-a4c3060f9c30
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 379b5279-002f-46d6-a2b5-0a41fb41ec24
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33f1ec86-2d1d-4c73-9f00-931629f5df2b
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: ORIGINAL_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d2dceba-6f6f-4591-8ef1-969b12713f7b
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4a9579c-7f31-447f-89c4-208e60bb38e0
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebc723dc-706a-42dd-b32c-62e278d1ca07
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ada29e0-1ca8-46aa-8ca3-b3dfab66f5d3
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_NEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73832b7f-74d8-49f5-8535-30a123bf2fbc
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: row_number() over(PARTITION BY ds_plato_coding_details.pimsencounter,codetype ORDER BY sequencenumber)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15304cbd-d36b-4563-9c76-6fa29fb970ce
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: COUNT(1) OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 445dd59f-6585-4e5f-bbeb-c53e97752c98
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY ds_plato_coding_details.sequencenumber, ds_plato_coding_details.codetype)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0957b570-d0f5-4e90-b6fe-1b7d5cd2eb37
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CONDITION_ONSET_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea289ac0-8f9f-44c9-956b-41d38eec7e63
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6af0e9e6-47a0-40ef-821c-a6f6d38251dc
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b126124e-f57a-4ada-a1f7-b38b61b70a02
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9378c35-fe57-4934-b3cc-483f5d85a3c3
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e3c022e-e6ed-4c76-9c21-9f3014a9bc40
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d45ac64-060a-43f2-a151-ff4508ee703c
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d76ddaab-4850-4d65-b6f4-4174efabc36d
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8100ae4-e07c-4d13-8f7f-e9a3efd635af
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b212a94c-1ad3-498b-9f33-916ee4673918
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1720d893-a7a2-4c2a-95d0-7921865d556f
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a674762-e24f-40dd-9a67-ce4ffe570fbe
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfb0bf05-7d93-402e-a356-3a127906a512
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cb2d20e-c6fa-403a-b280-ed5f771aa911
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbfff9b7-6cdd-477d-aa95-451e49e98293
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d68a0ca-5c1f-4cb4-bcba-26e66ea5c13d
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93bba8bb-b885-4e4a-8e6b-47099a0b58f2
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e50bc58-b0f8-461d-9ebe-61d3ee818445
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7724627c-e5d3-4a96-9818-1840a26ca165
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1d4b43b-fc36-47ef-9a3b-7496cf0af1c4
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3995ed0-b4c2-4f6c-8da7-8dee8a0adaee
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfb257d9-7ee0-4127-8375-1f91b6684fb8
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 928f0c54-25ae-44b8-b89d-002a18fce7f8
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25bc58f1-27f6-4858-9ad5-cc37e2b91226
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbd63dae-d63a-4180-aeda-28a50df1d191
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d2ffa51-b4b5-4674-9b63-bff8f90962fb
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbd0c0df-350d-40ec-9506-fb0f852f6485
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05dfe6f4-0583-4aab-9956-63866439012f
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1680bbcb-e60e-472b-b849-4ccba897be60
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b662b6d-a73d-4e3d-a6ce-91ebd08a117e
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 360166f9-e4f3-4f78-9781-e99f72567955
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 919d611d-ef52-46af-b021-678653bad774
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7faa02eb-9704-41e3-8d68-c7aa1796e5cc
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a77e5848-0455-45b1-b373-8239738ba2bc
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 684fe35d-8f3c-4c35-95d6-df426595580c
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34ff016d-a186-46f0-a667-4916c515b911
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe7ef84-1dca-487e-affa-fe3c1e92e15a
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aed46042-a637-46f8-80e3-d3770ca32300
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e68d0dff-94be-482b-9ff4-01a16408db7b
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab155c01-3cdf-45d8-9640-092b70065c97
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f6e8c6a-b20c-4b30-9522-15c66332156b
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4eb5903c-478f-4572-af8f-5e79c60c6218
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa2b0449-a7b5-400e-a984-220697524e3a
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 153c73dc-f731-43e8-9540-7e2a583b3d4d
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22d3f98f-8104-4672-9280-b036361a1048
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: ACC_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a37c63bf-18da-4412-9ee6-1eb2b05e9263
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 060cdcd0-c838-4ed1-a846-5fa2f5b780d0
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: NZ_RESIDENCY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6e37f29-fec0-47a8-99a2-5ffc3295a70e
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6d76958-6d9b-4533-99f0-b3b4bdc718b4
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DOMICILE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747ff924-490d-42ec-b788-8ebab0bcc174
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 290a6647-163e-4cab-bf34-1a94a8d6b2ac
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45e174c-eb7a-42b6-99e1-0f5aab799629
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 959e1afa-21d0-46d7-ae9c-0f965ad4f451
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VENTILATOR_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8088abce-bf8f-41de-a734-1c7b754d1931
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 543c7aba-014f-4d8a-835d-cff439a6e51a
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de6a7f94-2e9f-4ef2-97eb-88a7041af0da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a1606df-e2d9-49cf-bc34-bce52d6a58a3
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 825a0fbe-d2ca-442e-8e51-3d2c9ff9b8da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34bc51c4-84b9-4d98-b96f-1efa4c7ee45c
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcb6f041-322d-4070-a547-ceb7ac76a16c
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abc41f97-0dc0-401b-bbb9-d2bdd6c97f65
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 160a9eb4-9ea2-4c5e-8907-5c5d2cb567bc
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f5c518f-2d69-44fc-a9d5-00c22f0be388
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: RECORD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faa838f8-d258-4b73-917a-d9c0bd6550bf
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6f4f004-9628-4e66-b429-1e8f8ce990cb
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NONE'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44ab709d-d1d8-413f-a2ab-67fd93ceb19a
          stepCounter: 4f87a5cf-b36a-4b5e-96d6-d0edb5c49697
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SHARED_INPATIENT_CHANGES
        join:
          joinCondition: |-
            FROM s_shared_inpatient_changes
              JOIN ds_pims_provider_spells
                ON ds_pims_provider_spells.prvsp_refno = s_shared_inpatient_changes.prvsp_refno
              JOIN ds_plato_event_details
                ON ds_plato_event_details.pimsencounter = s_shared_inpatient_changes.encounter_id
              JOIN ds_plato_coding_details
                ON ds_plato_coding_details.pimsencounter = s_shared_inpatient_changes.encounter_id
             WHERE IFNULL(s_shared_inpatient_changes.inmgt_refno, 0) <> 1410021940 -- exclude OP intended management
        name: S_SHARED_INPATIENT_CLINICAL_CODING
        noLinkRefs: []
  name: S_SHARED_INPATIENT_CLINICAL_CODING
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
