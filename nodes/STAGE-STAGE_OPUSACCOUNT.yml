fileVersion: 1
id: ec96f5ef-4eb0-412e-9e63-7b123e92c592
name: STAGE_OPUSACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d314a72b-1ea9-4fa8-a684-578bdfdcce16
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b169bea7-171e-4a7b-bd1f-5b3f867989f0
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0bc6253-40fc-43de-b158-8598ba298c6c
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCOUNT_RANK_BY_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY LOADOPUSACCOUNT.FORCEID ORDER BY LOADOPUSACCOUNT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cac12ae3-4c3d-4bf7-bcf3-51359c684c1f
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f1d3ec3-52ae-4ec9-aa15-0d01c1d04c9f
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e266092-9a75-41ed-9d8c-86b205563342
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 840ca5ce-0cbf-4986-9034-f32ad611ebc1
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fd8eeee-0dbd-4650-b363-2278c06aa0b1
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d392459-de36-42f1-a9ca-0e5e0cc60efe
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fa4539d-be6d-4307-b643-35185e98b610
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce435151-f863-4da6-a383-3fab48dabb0f
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e095606c-b60e-47e6-b7ba-dab1a45b3179
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac8b0deb-e7f8-491a-92f4-73720bdd8c71
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7808ece3-172c-4ef7-8fe0-5fc132c6f4d3
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: APPROVEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 058729ae-669b-4e12-a0eb-6978a3e49f85
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c82261f7-f9a4-4eb1-8308-552eced8f382
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd78a96-e43c-4bd5-a8b2-89f5aaadca74
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6425085-8191-49e6-8efa-1073643b8b24
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TAXEXEMPT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce7b3a52-bba4-4d6f-a64d-91899dc3eb20
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: CASE LOADOPUSACCOUNT.TAXEXEMPT \N WHEN 0 \N THEN 'FALSE' \N WHEN 1 \N THEN 'TRUE' \NELSE NULL \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8ef21a1-f6ec-41aa-9c87-fb080af2baae
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76329247-6251-49a7-8163-5062d1dc5a00
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a82780a3-6ad8-44e7-8cdb-cc17c36dc624
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95046495-a74c-4e28-9e1a-7cb287beeb46
          stepCounter: ec96f5ef-4eb0-412e-9e63-7b123e92c592
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPUSACCOUNT
          - locationName: UNKNOWN
            nodeName: LOADOPUSACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADOPUSACCOUNT') }} LOADOPUSACCOUNT
             WHERE TRY_TO_NUMBER(LOADOPUSACCOUNT.FORCEID) IS NOT NULL
        name: STAGEOPUSACCOUNT
        noLinkRefs: []
  name: STAGE_OPUSACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
