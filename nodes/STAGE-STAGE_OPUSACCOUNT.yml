fileVersion: 1
id: b24d3565-52a9-4432-8ec2-d818d067b697
name: STAGE_OPUSACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e54a0023-eae5-4eb3-8711-49bdc0927035
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1ea137e-030b-41ba-b7c3-afbd958f89d6
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6227e0e5-c09a-4c71-b0d4-4e1fbeb02b3b
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCOUNT_RANK_BY_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY LOADOPUSACCOUNT.FORCEID ORDER BY LOADOPUSACCOUNT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d9764ce-2038-4e02-b49c-975dc955c4dc
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6e5c9ae-dcb2-4e2d-a1d9-7cb789c2c1ee
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abbe2c28-2947-4a58-9817-3aa8da9e5be3
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56143c68-7df4-4914-8038-7ae4a856202e
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5d67473-1a1e-4faa-949f-7a538b154cb5
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c75f3ee-9b76-4a20-aafb-b33f554f0d2b
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7533577-d941-49fe-9751-a9610bd58ee8
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 718fa0d1-c9b0-4041-b86d-525d382da554
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7157c45-2ff3-4c66-aea3-4b91a41589b8
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c3f8390-26f3-470e-b777-4ae116c21765
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a4daa5e-ca4e-49e1-a081-066308de9f07
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: APPROVEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a02ca78d-86db-4704-a994-112098fe2662
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aa863bf-ad18-4e42-81f7-b3287ab6ae13
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5242f1ad-1bbb-4c0d-849f-720010183d70
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1210414c-99ee-4042-96ca-4764d9da5554
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TAXEXEMPT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bfa375a-311a-4402-aea6-dc7c2b6fd734
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: CASE LOADOPUSACCOUNT.TAXEXEMPT \N WHEN 0 \N THEN 'FALSE' \N WHEN 1 \N THEN 'TRUE' \NELSE NULL \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 169148c2-9761-419c-9636-a38fc31c9421
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be63eb4b-eeff-4d9f-8f9e-00dc158dff17
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16131d89-8fad-43a2-8680-446e483f3bf2
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b8543e7-60bb-426a-b24d-ce8a541f321f
          stepCounter: b24d3565-52a9-4432-8ec2-d818d067b697
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_OPUSACCOUNT: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPUSACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_OPUSACCOUNT') }} LOAD_OPUSACCOUNT
             WHERE TRY_TO_NUMBER(LOAD_OPUSACCOUNT.FORCEID) IS NOT NULL
        name: STAGEOPUSACCOUNT
        noLinkRefs: []
  name: STAGE_OPUSACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
