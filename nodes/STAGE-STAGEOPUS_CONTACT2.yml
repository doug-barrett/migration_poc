fileVersion: 1
id: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
name: STAGEOPUS_CONTACT2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a5b5263-a484-48ba-9888-ec1486e64cfb
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e7c1376-67f3-4783-a14c-46464123556f
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ifnull(StageOPUS_CONTACT.ContactSalesforceId,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3699331f-d576-4ea6-8589-a32cea3e7535
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_DUPLICATE_RANK
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY StageOPUS_CONTACT.ForceId,StageOPUS_Contact.Level1ForceId,StageOPUS_CONTACT.EMAIL ORDER BY IFNULL(StageOPUS_CONTACT.LastActivityDate,'1899-01-01') DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6ccb2ff-3119-4357-a1c2-6c5ef55db26f
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffec1c33-7724-4010-b266-f07690a87e67
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c468818-8b0c-4486-8ac0-559f177dc9b3
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4bd15a9-2664-4cc5-964e-3e911a0243e5
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1643afbc-8e80-44a4-924d-9c5bfdce17e6
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d76a8740-cc19-4d10-ba51-3b58869d5a8b
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27b20ee7-a1b0-4e31-9590-e82bc3ef90a7
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 447c554b-f76d-44a2-a181-435cfb9ad5b5
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a63ea8c-8262-4ec3-a3a1-0e26778a55f1
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69bba188-9824-47ec-bc06-a8590ba2daf4
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 061487ed-7395-4f4a-a3e6-2aa8f7d207c1
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56aa19c5-e6ac-43d5-ade1-23cf2fb2daeb
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81ccea24-6f65-4761-947a-17ffddc16f40
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22cb7e18-e2d7-4fae-9737-0c3a35420954
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40df2729-4fc6-48ea-b1f1-4aa292be26f1
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad176ac6-a38a-41d6-b5d1-a436a0771cb4
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57600287-6c01-4b88-8b70-9be0d67600f6
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d46e66e-d302-4385-8800-d1f9ef2769be
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96f7c3cd-689a-4c30-847b-45457a2c926d
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82703710-8de7-473a-bd32-d17bd1234aad
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a95dad8-9eea-4879-8eb9-d4396e979364
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3158301a-30d7-4af6-a22b-8ed4f5eda79d
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5b2a17e-4786-4e48-baeb-c6d262e9438d
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCEPTEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40c568b6-2651-4d51-a40c-a7917f6ed7bb
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d06a1a9f-63ba-4dc2-8d43-e979eb030d5a
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe7dd68-b7da-48db-8d6d-9ba11fc69794
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d1c347a-331b-4106-a240-2ca8f46f1020
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 008b3a75-bfd7-4b89-9eb2-c28802b7924c
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 731310f8-a022-40f9-8974-346373a15bf6
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a51d5a1-2950-4fa0-bce1-76f870c7a9b1
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c4a920e-6089-491b-94e3-723cbf212530
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b052d1c-00a7-4ccc-89ef-a053278d83f8
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4dbc0a2-b76a-413c-b663-68280a95cf56
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5084905-30d5-42ab-b83c-312358f3cbd7
                stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2e841bb-79c3-4279-8216-f3306e9a7573
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebc0e2ce-6c45-4300-adb0-83666d7dfcf4
          stepCounter: 1028ff05-5d8d-4ab6-9235-aeaafb5b1cc6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEOPUS_CONTACT: 09854eaa-31e2-42f4-a469-e944e0db0002
          CONTACT: 5fa12080-8040-4cbf-96f4-8e9c84eee853
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGEOPUS_CONTACT
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEOPUS_CONTACT') }} StageOPUS_CONTACT
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageOPUS_CONTACT.ContactSalesforceId = Contact.ContactSalesforceId
               AND StageOPUS_CONTACT.fORCEiD = Contact.ForceId
        name: STAGEOPUS_CONTACT2
        noLinkRefs: []
  name: STAGEOPUS_CONTACT2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
