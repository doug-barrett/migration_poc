fileVersion: 1
id: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
name: STAGEOPUS_CONTACT2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e08d8af-50b9-4b4f-aab4-b9b7c35012a8
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ad70ed0-c658-4ec8-ab25-b711e41c807d
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ifnull(StageOPUS_CONTACT.ContactSalesforceId,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e937e844-d583-47c4-ae69-f7007313d8b0
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_DUPLICATE_RANK
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY StageOPUS_CONTACT.ForceId,StageOPUS_Contact.Level1ForceId,StageOPUS_CONTACT.EMAIL ORDER BY IFNULL(StageOPUS_CONTACT.LastActivityDate,'1899-01-01') DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 955488bc-96c7-43dc-aa19-94b39ea20d0a
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef44d9b5-4f14-4387-9fbf-2aaba3b8caab
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4313eac-b8e5-4ed7-adea-18b1a3bf3718
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3caf3c35-0c81-40d6-944f-a8a3bd4cdba8
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bb1e26f-26ce-44f1-9353-b692d3bf0603
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bca7a257-6b22-4832-8e4c-13810b999efa
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a389be2e-883f-4005-b451-12ab84888af0
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48019ab9-e9c7-4a48-8ecd-89a1a825cba4
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5233ad01-8c72-4838-a5da-b9a6b6eb30ad
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ef326a3-84a3-4227-b02a-f9cfc2790dba
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85fa061b-bb1a-44b7-b3a6-1bebc6172b57
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a99427e7-d857-4ad0-affb-52f2a83738aa
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7612ebef-aef0-4233-b25c-3c37b9d20ba7
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48adf87a-9597-4925-9751-024829765e7d
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c5ea4e0-4c49-4ddc-bd41-22c2443c9bac
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cafb0a59-6ab4-4f8f-a88f-798baf68ef31
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d540a3fe-b5bd-494b-b7cf-47e66cb1dd65
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e119f58-363b-4930-8b84-155b721b57e1
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90aadffc-4fa2-487c-85e1-eec82cb8367f
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab772e7f-819e-46e4-9b85-b6ff687ad2cc
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0e667a8-ee24-4eac-bab2-36a68085a5c8
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39faee5f-b337-4715-ae0d-1bfb35c64bee
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c13f4531-c83d-451d-bc32-580bc1ec5317
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCEPTEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be41d4c8-74b9-448f-9c1c-681d95545670
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea03f2f6-b244-4197-bf5d-b27ffbf1cc30
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c82ca1e-a239-45af-a94f-851d145b0fb7
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8734e9fc-fbfe-4f5c-91e4-60099b1a2597
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d1481d6-b0d8-4656-896f-7509fce5a631
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6943599-c5d6-4b78-933e-c1c6af2fcaae
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59711f9f-b7b6-4d4f-9b1a-d11eec2d15b3
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55e94829-f24b-4ff0-841f-a9d0c81ab8ea
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bec6c61-a49c-4eb0-85d0-e8871aeaf56d
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7563c56d-b1be-4826-9fef-aa2e434961d2
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c82b507-d1b7-41e4-8cd4-163e5a0d6373
                stepCounter: 5e23afad-afff-4545-bc14-109653809e02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe43b64a-aa67-4879-b390-4151f3228ce5
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 638e49c4-0b31-4bd9-a8f2-67343b9ce81d
          stepCounter: e4f952d1-b800-48b5-a24a-ce6dd2f24f56
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEOPUS_CONTACT: 5e23afad-afff-4545-bc14-109653809e02
          CONTACT: e165c76e-6a45-4567-817a-c8ecf377ecd2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGEOPUS_CONTACT
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEOPUS_CONTACT') }} StageOPUS_CONTACT
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageOPUS_CONTACT.ContactSalesforceId = Contact.ContactSalesforceId
               AND StageOPUS_CONTACT.fORCEiD = Contact.ForceId
        name: STAGEOPUS_CONTACT2
        noLinkRefs: []
  name: STAGEOPUS_CONTACT2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
