fileVersion: 1
id: a0da83d5-fea1-4263-b647-253f37d8dcd7
name: STAGEOPUS_CONTACT2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 324fe374-efe8-46a8-b8d5-4a30768d4777
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fcc1676-5bc9-431f-be17-229999f49a32
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: IFNULL(STAGEOPUS_CONTACT.CONTACTSALESFORCEID,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee2ed4ad-93bf-40c0-8fea-67f5042eb269
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_DUPLICATE_RANK
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY STAGEOPUS_CONTACT.FORCEID,STAGEOPUS_CONTACT.LEVEL1FORCEID,STAGEOPUS_CONTACT.EMAIL ORDER BY IFNULL(STAGEOPUS_CONTACT.LASTACTIVITYDATE,'1899-01-01') DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ea18b22-cd44-4e14-8ce0-db46ed07d720
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541bc7a1-4e80-43a3-a62b-29a0d12a4cab
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c529e158-fd12-4009-b605-799144c8a5ea
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0790dcee-674a-47a3-8288-07b8b0d28720
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdbd9d0b-e513-4ffd-863e-cb1af835d7d5
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c617be7-69f4-4997-9bd1-5ea06ed30189
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1caaadc9-2798-401c-8f75-7f15c91efa53
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f16bbb3-7273-4d41-9768-53d370491c0c
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c23176ba-6f1e-4ae3-8f59-a31fd22de863
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d67c2853-5230-4368-a570-d1158fd03424
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95a94f3f-fa0b-473b-b68c-3da52a0565e7
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 386fdfc4-1ed0-4ccb-a381-11697b08f554
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7450dd1f-d647-41f0-934b-9dd1e9819230
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f769681-be20-4542-8b65-7bed42fcc39c
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8cba548-dd8b-436d-9077-77d0b9274397
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b8c02ed-a65b-47c8-9ee6-858115514a72
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 029e84ed-c595-486b-ae45-757958c8b4af
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e81e608d-97e8-44aa-a58c-ac96335a1fc8
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b0c5fd9-30e4-4cf9-871d-ab7378bd201d
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8bfb8fc-eb53-40a3-941f-c282a5401a4f
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55bbc2e3-9c07-4663-8e74-96b8276b8854
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6581dd39-afac-4bae-a9cb-f4504f0a347f
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fad978b2-f2bb-4958-8135-e005e226904e
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPTEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b8e55f6-651d-4e92-b4dd-c991390aacd4
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec5ad82d-2987-4ab1-ad41-1b2fb343f762
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04189fdc-2e8b-400e-92d5-c7ce53cd8dff
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 480e0756-d50c-4058-a14a-01a9b4a08a48
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9acc90fb-9c29-4868-aa49-66a95a0721b8
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c7d2aee-274c-4232-87bf-eabfdb3ee355
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2ee6b21-c306-45b2-be35-6936637db494
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20057c16-f13a-43d7-ae4d-d1ecd94bb9be
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1073cf66-c592-4f52-84f0-c210f02c77dc
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b22be56-8fc2-4d01-a051-1180c8bc284d
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea8830e9-b770-45bd-87a6-8641e19e6638
                stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08818efc-1c18-4018-873e-0cb4e5468997
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27260a3e-5943-4caa-a6c7-fe83749b61a8
          stepCounter: a0da83d5-fea1-4263-b647-253f37d8dcd7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEOPUS_CONTACT: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
          CONTACT: 69bed407-4a56-4539-a027-399a1d5dc1bb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGEOPUS_CONTACT
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEOPUS_CONTACT') }} STAGEOPUS_CONTACT
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEOPUS_CONTACT.CONTACTSALESFORCEID = CONTACT.CONTACTSALESFORCEID
               AND STAGEOPUS_CONTACT.FORCEID = CONTACT.FORCEID
        name: STAGEOPUS_CONTACT2
        noLinkRefs: []
  name: STAGEOPUS_CONTACT2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
