fileVersion: 1
id: 8e521aed-4691-4c7e-b363-42e8c33aee83
name: STAGEOPUS_CONTACT2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03fc5232-ce19-4996-9acb-5d70d0dccd5e
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c44abce5-ad12-4f82-b17d-70f1d8d363d0
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: IFNULL(STAGEOPUS_CONTACT.CONTACTSALESFORCEID,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dc83699-187c-42ec-b62c-2d9ef2045ce0
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_DUPLICATE_RANK
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY STAGEOPUS_CONTACT.FORCEID,STAGEOPUS_CONTACT.LEVEL1FORCEID,STAGEOPUS_CONTACT.EMAIL ORDER BY IFNULL(STAGEOPUS_CONTACT.LASTACTIVITYDATE,'1899-01-01') DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e92994f1-cf54-4ce4-9027-c5e23029145a
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb5f4499-90b9-49c9-965c-ba32b5fbbe23
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e14d8cff-3fa7-42d5-a9e9-91afa18b90e0
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c45fed99-7e6e-48ca-b48d-4c4b961652f7
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61aaad2b-a0f9-448a-b66e-872f57e7adde
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02437389-014f-404a-b980-4aea07d78ab5
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dcb112b-5e9e-4115-9b52-df6faa422ff2
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ab30c2-f371-402c-9c0d-1f913e452d14
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b61a85f-2944-4cc7-a237-ad7cf4d5966e
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecd7fcee-2d45-4b6e-a938-0442222dfdd6
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fdd019b-3c3d-4b8f-852b-97283764a7c6
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89d38485-75fc-416f-8876-6d1016cb8585
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11ef4781-85f2-49d6-a15b-2130b9d2cc35
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 554c37a9-6e8a-4dd5-9483-c5d875489415
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 530af641-5e20-4802-a14b-d6713fdfef92
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a6d978c-d32a-46d2-8022-26f39cf0effd
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cb07530-d3e0-46dc-8c28-abccc8296edc
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae7462c-af5f-4c06-a35f-b9bb67c1a270
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eb4418a-d25f-4423-bc96-b072ac995da4
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87065d92-536e-4c53-b837-c267f54b4261
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c575aa96-2965-43a6-bf1e-5df584a8f37b
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8569656-03f4-4150-a225-e379202fab0a
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82b4aa86-7cf1-48a0-a084-196be21813bb
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPTEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d2812b4-4221-4a25-b569-882c2072bc26
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bfe0778-0d25-468a-bbdc-5d499ad977a3
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dc2d563-258b-41aa-a032-cd246b1ff873
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c314a89-2823-4630-880f-27cbbecf1ce9
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca055bc5-c7a6-4bb3-97ea-450e1a1e08c9
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28b978cf-3c6f-4ea2-87b1-696161c9800b
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb30232d-60e1-4ace-abe1-9ffe1a50e692
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06597c7f-417a-4217-a779-7f1476e7f5af
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18d20dca-34c7-4996-b638-c09dc6f86422
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7391c70-aec2-43c7-94f4-198029239677
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b61195f-695f-47cb-ac82-098236cb08fe
                stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ddebdbc-736e-4549-acfe-7619610d9c9a
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66b2e977-cc9c-460d-8a5b-3a0fa0d2fa1f
          stepCounter: 8e521aed-4691-4c7e-b363-42e8c33aee83
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEOPUS_CONTACT: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
          CONTACT: 4015cdd7-ddd6-45b0-996c-53903de48f6b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGEOPUS_CONTACT
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEOPUS_CONTACT') }} STAGEOPUS_CONTACT
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEOPUS_CONTACT.CONTACTSALESFORCEID = CONTACT.CONTACTSALESFORCEID
               AND STAGEOPUS_CONTACT.FORCEID = CONTACT.FORCEID
        name: STAGEOPUS_CONTACT2
        noLinkRefs: []
  name: STAGEOPUS_CONTACT2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
