fileVersion: 1
id: 89515376-0122-4bc8-b96d-e80fec0cbdbe
name: STAGEOPUS_CONTACT2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a28b03ff-2fa8-4eb7-b9ad-6d0186fe463f
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c82f4caf-ffc6-4627-8540-c8eb835534a0
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: IFNULL(STAGEOPUS_CONTACT.CONTACTSALESFORCEID,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e279dc1-dc6d-4bd3-81f6-316b04c08ffa
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_DUPLICATE_RANK
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY STAGEOPUS_CONTACT.FORCEID,STAGEOPUS_CONTACT.LEVEL1FORCEID,STAGEOPUS_CONTACT.EMAIL ORDER BY IFNULL(STAGEOPUS_CONTACT.LASTACTIVITYDATE,'1899-01-01') DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dbda376-aa75-4fab-9825-7904b11099a4
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e567089f-c745-48a5-8b40-9bd737e0ad79
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a17c431c-fb7b-4a4a-a217-8b379f6f56ae
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68641cf7-a7a7-49b1-83df-980dba8844b5
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65180343-ecb4-41a7-a14a-dc4afcea9b83
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8aad6164-9ec5-46cf-8948-9c93b431e3ea
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad56342b-c7d7-4ee7-acaf-5783f5d7f87f
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48e735fd-8ece-401d-9695-9e8153bfb26f
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5534295-52c5-45c2-9aa7-19792fba1c71
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fd65f3c-e8d3-4f4e-b003-bf2c71934816
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c62feceb-e9d0-4319-b131-cf564c8eaa88
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df6c2b65-7728-4893-aad6-038e1d6b6d0a
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 749f2393-3ebd-4903-bd3a-56ef51e24998
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a61d564-4340-4477-b832-8ffea2058f9c
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e3e645b-4fda-481a-88dc-66d73e426178
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c87ad5b9-2dad-47a2-8bf9-ffb232ff6879
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b376210b-badf-4e1a-aba7-cd201fd102e0
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0652ca78-31e4-474e-9b3e-5e44a87ce7a3
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65f122b2-d07a-4c86-8d75-6812179e0358
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d07b79d7-11af-49c9-8cf0-dcbd81cb043a
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7b88a4b-58a6-4736-9796-b46fc49cd3cc
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f04a428-bef7-4c17-bd05-2c4b91eaaf22
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4a98fdd-2a2c-48fc-9e48-82336b1f6152
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPTEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94df576a-a00b-44b5-aa34-cfb6390bcc19
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c90ead0-9bc8-4284-925f-f582ab826ce2
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74884097-cb52-407b-a7cc-c4460b04688e
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dcc4428-c117-4067-ad89-09bce7a3a20c
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27caf982-ae54-4123-9e1b-6a0883079c8b
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: beaf0a6b-4559-439f-b10c-c2a097459185
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14952c54-e784-44ea-a220-2fa1a15bc771
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8853f242-1667-494f-9aa8-ffa533e48aa3
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da98bc79-d481-4c9e-b5f6-5333d553409d
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 073c1acb-30c4-49f7-946e-645f71dc5e4e
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bee1286-7e22-44c4-9366-2387f4c06c0e
                stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22b93d32-965d-42ae-ae79-f4668173efb1
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aa39a24-06f0-4292-a7cf-af09c8ab70fa
          stepCounter: 89515376-0122-4bc8-b96d-e80fec0cbdbe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEOPUS_CONTACT: 2b193351-c43d-4efb-936d-880bb9e4be7d
          CONTACT: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGEOPUS_CONTACT
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEOPUS_CONTACT') }} STAGEOPUS_CONTACT
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEOPUS_CONTACT.CONTACTSALESFORCEID = CONTACT.CONTACTSALESFORCEID
               AND STAGEOPUS_CONTACT.FORCEID = CONTACT.FORCEID
        name: STAGEOPUS_CONTACT2
        noLinkRefs: []
  name: STAGEOPUS_CONTACT2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
