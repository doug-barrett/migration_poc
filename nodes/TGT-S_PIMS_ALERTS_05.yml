fileVersion: 1
id: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
name: S_PIMS_ALERTS_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b52a344b-1634-42cc-8fa2-95bc14f5ecc7
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: DGPRO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f49ba7ec-9b7c-499d-ae59-ed3ecd3a63a5
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c1f8d8b-b18f-40cb-b1e3-15d1d21eaa59
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd8e25c9-7a3c-446d-b6ba-d91333ebfb6e
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ecc42f3-73d4-4e2a-9736-9f35a0cc12b8
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ALERT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecc036db-91d2-4737-b93c-f3e449aa298e
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5950a6a-ed34-4aae-8458-adb92e1c6370
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: ALERT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f483d-a948-4558-87f8-d3e65fffac3c
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c716423-39ec-4656-b82b-c02613ed461c
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5685ddda-d355-4026-9515-8efeceb61f7e
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e99ca382-2643-4e24-ac6d-d92205a9a56e
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ALERT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae1a398a-9c7b-4fad-b7e2-8e105705ec6f
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24b12a84-84ba-41c5-8170-81c757a4825f
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ALERT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b78537e-2603-4547-936d-1413eb60d381
                stepCounter: 314df606-ff6a-4436-bfb4-272353ca2b9e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1238b834-1186-4ef8-8baf-86609faf1452
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850cf67a-00df-40b0-866c-be23c1e55f5c
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21bae849-77e0-4169-9b43-4111191eadf6
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ALERT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 474d7c94-2844-4fd3-a545-689f9362af17
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf888e27-6780-49bc-8668-646f6e63a9d3
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ALERT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fd03a6c-d363-425a-bc84-bbd30146d940
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a39b973-813b-4131-972f-4552a88c8a86
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6decebff-eb31-4277-aa08-3a795ec793df
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 217937d0-e1b5-401e-9029-aa2454922415
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0018f473-59d0-4576-9d88-96374fcf8639
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77ed504e-d689-4779-8849-9e71f378d8ad
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REVIEW_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c842905a-f6fd-49a4-9c5f-35a0807c2df1
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e226fbe0-dc78-4380-b6ab-8e9ed5d19c20
          stepCounter: c2a11a1c-ea5a-4659-8156-37d1c6a81da7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_DIAGNOSIS_PROCEDURES: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
          DS_PIMS_PATIENTS: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
          DS_PIMS_REFERENCE_VALUES: 06fa4241-360c-43d0-8e4a-8b860f92fc09
          DS_PIMS_ODPCD_CODES: 314df606-ff6a-4436-bfb4-272353ca2b9e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_DIAGNOSIS_PROCEDURES
          - locationName: TGT
            nodeName: DS_PIMS_PATIENTS
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
          - locationName: TGT
            nodeName: DS_PIMS_ODPCD_CODES
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_PIMS_DIAGNOSIS_PROCEDURES') }}
              JOIN {{ ref('TGT','DS_PIMS_PATIENTS') }}
                ON ds_pims_diagnosis_procedures.sorce_refno = ds_pims_patients.patnt_refno
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }}
                ON ds_pims_diagnosis_procedures.ccsxt_code = ds_pims_reference_values.main_code
               AND ds_pims_reference_values.rfvdm_code = 'CCSXT'
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_ODPCD_CODES') }}
                ON ds_pims_diagnosis_procedures.odpcd_refno = ds_pims_odpcd_codes.odpcd_refno
             WHERE ds_pims_diagnosis_procedures.sorce_code = 'PATNT'
               AND ds_pims_diagnosis_procedures.dptyp_code = 'ALERT'
        name: S_PIMS_ALERTS_05
        noLinkRefs: []
  name: S_PIMS_ALERTS_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
