fileVersion: 1
id: 203f282d-dadf-437d-9bc2-a455966f36f9
name: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "------------------------------------------------------------------ -- This view was built for the lost production Engineering downtime extract. This view was prompted by a request from Prabhu Srinivasan -- units : liquids assume m3 in database --       "
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 064fffc5-e4a1-465f-8ab5-2331c6ef3de0
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 064fffc5-e4a1-465f-8ab5-2331c6ef3de0
                stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7672b3c2-779d-41cc-bf03-4a94d0903d65
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NETWORKNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7dedb16-a152-405f-ab2b-cf2af7f7ee2c
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEMPBASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58066566-142a-47c4-b649-a8300dbbddca
                stepCounter: dd3550ac-fec2-457c-9c86-92e386a013c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08af03ea-e80d-4d80-93f7-3453213eec90
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: UNITNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f92eccd-3180-4608-b23a-2dcbb5ee5f6a
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9cf7ea6-340c-4b7d-9dd9-6f55a9da5f4a
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04cf2dd8-e55f-4d86-8dad-913803058849
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53ad43dd-81d2-4c31-a670-7d5d963e398a
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7fe1a76-e16c-4253-9cef-5607e7315e56
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 696a588a-e50d-4cbb-9fa7-a2411dd7a612
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b96ba6-fa62-4c0f-b013-fdbeffce9ce2
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74571add-e733-48ea-9444-dd8a4ff1d04a
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ROUTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0b84e37-3366-4623-989f-e9bcea2cc41b
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b89ca79c-fd52-4dde-9a17-ca1eaba1dbdd
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DWNTM_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 660da368-a91b-41f5-a602-2fe19c74e260
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72c103a1-feae-400e-b93a-854da4bcea04
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44df4510-45b6-424c-997b-c6561997ba07
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a70ac95-14ce-4887-800c-362b2ed2cca7
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04e8ab5d-9b45-4b72-9cbc-ef91c90d10f5
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295d169a-8764-40e9-9347-7e6746bb1d69
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05fe8616-8f15-4d6d-aaba-4d9db0d606d5
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECCOMPORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f76be576-f021-42f1-a5bc-c6dfa35d25fb
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7a62e89-eb1a-41dc-a907-6a768aa1d993
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNITORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b6e1d74-6828-42ae-b9d7-69ba4615f389
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02cf94b4-2d0f-4637-aa30-6638b5249a56
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cfb8a9e-36dc-4f7f-ba0d-ae6d13ca40e1
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OPHOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6704ce92-d4a7-414f-8fd4-d893c520bbf0
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbcc8083-1918-410b-bd23-373679b619fa
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ecae991-8474-4191-8547-9abb6ac55657
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87bf2b8d-b479-4bb3-abb2-ed4655256a0b
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54ff361c-660b-4aa9-bc61-6d1550f57307
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d539df60-0e9b-4249-977b-41c8b8ad5036
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 467811d5-aefd-480f-bf1e-56aa976adbea
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd220625-155d-4c49-9071-15ff4c15b671
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4636b360-e074-4363-bb69-2b6f044b5821
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab272ea9-89a6-4a9a-9dd7-39bad3e6c84a
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ddab98-54bd-4ee4-ae66-3958f4212e23
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5a3cdea-3b7a-4008-8e08-4d482e61ab01
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7d09092-83ee-4842-adf9-c5a5eac9d530
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c30c19-cfad-4628-833c-b1db05a6c4bf
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e36b844a-59b1-4bd1-a1ab-6fa772812b63
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a36e3904-0680-4b68-82e5-d4f34b1c745f
          stepCounter: 203f282d-dadf-437d-9bc2-a455966f36f9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW: 203f282d-dadf-437d-9bc2-a455966f36f9
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW') }} AS SELECT d.idflownet,
                   h.name AS networkName,
                   s.tempbase,
                   u.name AS unitName,
                   u.district AS district,
                   u.area AS core_area,
                   u.field AS area,
                   c.completionname AS wellName,
                   r.name AS route,
                   r.usertxt1 AS foreman,
                   round(d.durdown * 24, 1) AS dwntm_hours,
                   dt.codedowntm1 AS code1,
                   dt.codedowntm2 AS code2,
                   dt.codedowntm3 AS code3,
                   dt.com AS note,
                   c.wellidregulatory AS uwi,
                   c.idrec AS idreccomporigin,
                   u.idrec AS idrecunitorigin,
                   d.dttm AS prod_date,
                   d.durop * 24 AS ophours,
                   d.wigas AS wi_gas,
                   d.wihcliq AS wi_oil,
                   CASE WHEN IFNULL(d.wigas, 0) = 0 THEN IFNULL(d.wihcliq, 0)
                        ELSE IFNULL(d.wigas, 0)
                         END AS working_interest,
                   d.volprodgathgas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_raw_gross,
                   d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_gross,
                   d.volprodgathhcliq AS oil_raw_gross,
                   d.volnewprodallocoil AS oil_alloc_gross,
                   d.voldispsaleoil - ifnull(d.volrecovhcliq, 0) AS oil_sales_gross,
                   d.volnewprodallocngl AS ngl_alloc_gross,
                   d.volnewprodalloccond AS cond_alloc_gross,
                   d.voldispsalengl + d.voldispsalecond AS ngl_sales_gross,
                   d.volnewprodallocwater AS water_alloc_gross,
                   d.volprodgathwater AS water_raw_gross,
                   ifnull(d.volnewprodallochcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_alloc_gross,
                   ifnull(d.voldispsalehcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_sales_gross,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
              LEFT JOIN DS_PRODVIEW.PVT_pvcalcset s
                ON s.idrec = d.idreccalcset
               AND s.tempbase != 15
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON d.idrecunit = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON d.idreccomp = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvroutesetroute r
                ON u.idrecroutesetroutecalc = r.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = d.idflownet
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompdowntm dt
                ON dt.idrec = d.idrecdowntime
             WHERE h.usertxt1 = 'CANADA'
               AND d.dttm >= '01-NOV-2020'
        dependencies: []
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW') }}
        name: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
        noLinkRefs:
          - locationName: TARGET
            nodeName: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
  name: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
