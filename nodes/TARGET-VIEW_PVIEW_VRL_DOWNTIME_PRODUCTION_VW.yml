fileVersion: 1
id: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
name: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "------------------------------------------------------------------ -- This view was built for the lost production Engineering downtime extract. This view was prompted by a request from Prabhu Srinivasan -- units : liquids assume m3 in database --       "
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97beb3f7-b65e-4401-916c-e2a203423413
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97beb3f7-b65e-4401-916c-e2a203423413
                stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98fc326e-e160-4e9c-96e0-4f8c20d4ebdd
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NETWORKNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a851e9a8-b289-4e76-95c3-8bfa35b4c067
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEMPBASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8641371-a68d-4bd2-bd72-5d32bcc9be46
                stepCounter: ff7957af-8a84-42a3-9e98-3c09478b07b7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3fa1fc1-ae74-417e-b676-e218290cc9f4
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: UNITNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7717e180-e309-4b1c-8748-29061a001a45
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d96f944-44ce-49f9-ba99-ef4510b5d01c
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05f2e80b-1320-4394-b920-e5b5972e266d
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b4eea6c-657b-4de0-bcb3-21acca1bc8ab
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66c5b120-bd07-45ad-b22a-e20b747ac5d7
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e9d6467-2e08-4e2e-96b7-ed2fb1948b69
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47f8a18b-1555-41b2-9a09-2de136944f7f
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 737f4ed1-2be8-47a3-825f-8aa4d6dcd30b
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ROUTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5a371e2-d239-4690-a40b-8b92f4ecf361
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0a226bd-0f65-4cc0-92d8-cd21d20dd818
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DWNTM_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8731da11-7385-4b1d-b3f7-8a90de505c7c
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7641d464-b604-4cce-bc56-f8cc381e57c6
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf37a82a-dd4a-4d92-8289-33f7be49632e
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b0b03af-4bb8-4453-b04e-7fee44810ed7
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 853f3dba-4142-457b-89f6-79c7b4d98110
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7014a46b-a09f-4d32-ae9a-66b516c1d8d6
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc8e2cec-8d88-4fbd-b77a-7efa045677ac
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECCOMPORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cf6aa8f-2e96-43a3-8472-6ee102299445
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc0ce3e1-d81b-4a5e-bb88-aace8643b2e9
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNITORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe22de8-f6e2-429b-90aa-91f793353b62
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a7a52b9-217e-4e84-a972-c4706f576b29
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 521d6b82-87bc-4737-9e48-b9f2f8bf8a30
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OPHOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e796c44c-c192-4b76-a7e6-2ded90f4c268
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 011e74df-ed2b-43d7-8438-8857932f1f37
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f69763d6-aa56-4533-b586-1389841c8100
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4046ee09-e2d6-42da-b4c6-83ab05e4e763
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d79843f-60cd-4dac-a6c5-c024fe3e3dbd
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65051944-278d-47ca-ba4b-fb153f0121b7
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d289fd4-5530-4686-8bc1-f06f2bd83426
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55b7c812-fcca-4562-9522-8d3f5955f9d6
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b2c28ae-257b-4ab4-86cf-69f9a40c3190
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dc4bd68-c26e-4972-a99f-dde42f997c35
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e2a9f94-3527-4d98-886e-e7afa2525962
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ce47647-a60d-4502-8fed-3dd1883b29ed
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b037fdb6-4593-4a4b-8411-c210553c1f83
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b74dbd15-7a40-464f-9338-a8a17b07b875
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5f613f3-b8ba-4130-9ee9-bfb6e2cd4e00
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aef93ff-ec9e-495b-9ed7-f4df48147821
          stepCounter: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW: 0cbb19c9-d9b7-4652-b2d2-ce59a6ddba4b
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW') }} AS SELECT d.idflownet,
                   h.name AS networkName,
                   s.tempbase,
                   u.name AS unitName,
                   u.district AS district,
                   u.area AS core_area,
                   u.field AS area,
                   c.completionname AS wellName,
                   r.name AS route,
                   r.usertxt1 AS foreman,
                   round(d.durdown * 24, 1) AS dwntm_hours,
                   dt.codedowntm1 AS code1,
                   dt.codedowntm2 AS code2,
                   dt.codedowntm3 AS code3,
                   dt.com AS note,
                   c.wellidregulatory AS uwi,
                   c.idrec AS idreccomporigin,
                   u.idrec AS idrecunitorigin,
                   d.dttm AS prod_date,
                   d.durop * 24 AS ophours,
                   d.wigas AS wi_gas,
                   d.wihcliq AS wi_oil,
                   CASE WHEN IFNULL(d.wigas, 0) = 0 THEN IFNULL(d.wihcliq, 0)
                        ELSE IFNULL(d.wigas, 0)
                         END AS working_interest,
                   d.volprodgathgas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_raw_gross,
                   d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_gross,
                   d.volprodgathhcliq AS oil_raw_gross,
                   d.volnewprodallocoil AS oil_alloc_gross,
                   d.voldispsaleoil - ifnull(d.volrecovhcliq, 0) AS oil_sales_gross,
                   d.volnewprodallocngl AS ngl_alloc_gross,
                   d.volnewprodalloccond AS cond_alloc_gross,
                   d.voldispsalengl + d.voldispsalecond AS ngl_sales_gross,
                   d.volnewprodallocwater AS water_alloc_gross,
                   d.volprodgathwater AS water_raw_gross,
                   ifnull(d.volnewprodallochcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_alloc_gross,
                   ifnull(d.voldispsalehcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_sales_gross,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
              LEFT JOIN DS_PRODVIEW.PVT_pvcalcset s
                ON s.idrec = d.idreccalcset
               AND s.tempbase != 15
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON d.idrecunit = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON d.idreccomp = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvroutesetroute r
                ON u.idrecroutesetroutecalc = r.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = d.idflownet
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompdowntm dt
                ON dt.idrec = d.idrecdowntime
             WHERE h.usertxt1 = 'CANADA'
               AND d.dttm >= '01-NOV-2020'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW') }}
        name: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_DOWNTIME_PRODUCTION_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
