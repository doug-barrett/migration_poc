fileVersion: 1
id: 3883d918-f383-406f-9913-4c303407e8ec
name: STAGE_RES_RESULT
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a502e76d-af66-4dde-bccf-9f0fc38b1bd7
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.CASE_ID=DIM_RES_CASE.CASE_ID
        name: DIM_CASE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8416567d-3dbb-4e8a-96f7-b0efe974b7d5
                stepCounter: 884d4c26-70d1-4443-af19-dcbf0c9a4436
            transform: NVL(DIM_RES_CASE.DIM_CASE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bdbf5e8-36de-406b-a946-2913da08753a
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.VINTAGE_ID=DIM_RES_VINTAGE.VINTAGE_ID
        name: DIM_VINTAGE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bff5b2bc-9768-4121-aae5-6103b8a21d64
                stepCounter: bdc949e5-ecdd-42be-9212-67c2b1e7be78
            transform: NVL(DIM_RES_VINTAGE.DIM_VINTAGE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e37d5ed-257c-4a61-90cc-51c76e6e325f
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.ENTITY_ID=DIM_RES_ENTITY.ENTITY_ID
        name: DIM_ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e94fe256-d02b-44cf-8555-d7a4e74158e5
                stepCounter: fa3c7843-1d75-4bc2-8592-49fb44ad3c53
            transform: NVL(DIM_RES_ENTITY.DIM_ENTITY_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcd3343b-ec94-4cc5-97c8-efea8746d3c9
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.RESERVE_CATEGORY_ID=DIM_RES_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
        name: DIM_RESERVE_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d4d038e-cdd9-464c-ae8a-2266a4c54bfe
                stepCounter: 0487c763-a764-486a-928a-d508bc0cd386
            transform: NVL(DIM_RES_RESERVE_CATEGORY.DIM_RESERVE_CATEGORY_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f9bf84c-aa4a-457f-a7b8-bcbb53541e59
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5b026ca-4e1c-4d2f-beeb-8fa0d20065ff
                stepCounter: 3f632304-1c5b-49b7-a564-7418a74380be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 529a510f-4ca2-4600-ad30-71d8c10132f0
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 640a1e8c-13eb-489c-921e-2349a93f559e
                stepCounter: 3f632304-1c5b-49b7-a564-7418a74380be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c333ee1-b6da-4a0e-b096-476966062f6e
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed99c9c-ba55-47a0-a6d4-212b52a64f0f
                stepCounter: 89bed33e-deff-4929-8394-3276d3c48fba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c357a100-dd69-400e-9e2e-eeb16794dd9f
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: VINTAGE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6163eee-16c6-4afe-a950-feb6a20eaa24
                stepCounter: 89bed33e-deff-4929-8394-3276d3c48fba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13e8507d-b79d-4875-8a11-d53173033be9
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: PRICE_DECK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f8ab67-8aa7-4ccc-996b-67b8dc5e4b7d
                stepCounter: d59597eb-9e62-4fb0-b56a-32e47f5a96d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b68418c-a752-44d4-9395-c5468e4b427e
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d54bbecf-7c37-4441-8656-eebce611e2a8
                stepCounter: 3f632304-1c5b-49b7-a564-7418a74380be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db1fcd9b-6c03-4b84-81f1-77d12a1a7057
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: ECONOMIC_CASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4c95a68-9386-43aa-87ec-8a8ab5989608
                stepCounter: 89bed33e-deff-4929-8394-3276d3c48fba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8ebc94d-5e91-4da2-9440-ee335da4711f
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: PRICE_DECK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40cd77a2-759d-4fce-a62d-63b64379d518
                stepCounter: d59597eb-9e62-4fb0-b56a-32e47f5a96d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc71729b-f30a-4b88-8636-ae61b818a7fa
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8c09d77-98b7-48dd-b69c-f0c9183f9298
                stepCounter: 89bed33e-deff-4929-8394-3276d3c48fba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af2059c4-89bc-4b3b-9de5-9ecc2a4f20e7
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 346feec7-ef58-4357-8a4c-b1f70fcfc966
                stepCounter: b71bf829-8093-4e35-b61a-e994bd173b32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ae48151-b9ad-4082-b15b-4e29224b7ca2
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: CALCULATED_BY_RINGFENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21c776ef-7401-41c3-bd15-c4af92e01116
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 876c6fba-e59d-4934-b3f8-12db8b50e0ef
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: FIRST_CAPITAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a08e3eb-ce27-402d-88c2-f25570fcfd40
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e8b0ff-2258-410d-81d1-b126117e427f
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EARLIEST_PROD_DATE_FROM_ED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9a585e7-dbcb-40f8-8a26-9bc3c40c19c6
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a3d439d-36c5-41c1-bed4-1915d133a0fa
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: END_OF_LIFE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7f91901-8c52-4ed2-ae33-c0d3028690f0
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3d88d57-e5fd-4f3f-8ed6-679f11f5c11e
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: END_OF_LIFE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91bce045-97a7-4a72-98b7-de44d08c35f6
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a368d09-e511-4657-94c4-c6e7e9ac4376
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: FIRST_YEAR_COSH_PROD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d55e5a1-ec14-473b-be33-d4066d6a59ac
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1156d08-76de-43e0-9a65-fe70ae8b765f
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: FIRST_YEAR_COSH_PROD_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6a0bdf9-c9c6-42c9-8653-f06ebf6ea5d9
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5148787e-ceba-4adb-9d2b-678846794471
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LATEST_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3655df55-6355-4caf-85b8-2159f4e7f936
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a183af1e-fae0-48e1-b6ce-62020ffc8ff1
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 247e19e3-b467-402d-abe3-63ed5d690052
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a59857-2ee0-4814-beac-af60e11f5e12
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PAYOUT_DATE_BTAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0087e33-ffc3-471a-acd2-facaebe4760c
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43849f55-31f9-4e4a-aebc-218541f175c9
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_HALF_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ffa571-74d6-4908-ace5-d9aac6c5b0d0
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e08265ed-bf7f-4e77-ae37-7a198a669e0b
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74089c85-b8a5-4e66-a61a-df6717b8056a
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f54159a8-9f8a-4324-b53b-de0fac2f9559
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_LIFE_INDEX_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef8b7eef-17d6-479b-9445-ad444ff84f2f
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2bd1035-9728-4cc3-aec0-8d49c790fe31
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_LIFE_INDEX_PRODUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8467bc8e-f137-4024-901b-4635072c365b
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a4745e-e0c4-4a58-aff0-56175b345ffc
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: RING_FENCE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a5cea97-3c40-40c9-83e3-2f865e2f8ca5
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 605ecf8a-3026-4af6-a104-0b9659831ee8
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: RING_FENCE_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 305343a2-9251-4b77-b980-b5e8b2dc6e62
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b3f6a18-d247-4043-8dae-5ccacdccd495
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: FORECAST_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03ba8e0e-658e-482d-b01b-de0a23f448bf
                stepCounter: ef7c0219-5c46-4d11-9a05-d34b210c098a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b90cb83f-a0b1-4c77-a1e2-408119c3eb60
          stepCounter: 3883d918-f383-406f-9913-4c303407e8ec
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Row Level Security Role
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 114a7a93-6040-435f-a072-83f3bc0e1ed1
                stepCounter: 9a0932dd-1fc8-4661-8c3c-1eef4351a88f
            transform: NVL(COALESCE(STAGE_RES_SAP_RPT_HIERARCHY.BU_SF_ROLE,STAGE_RES_QB_RPT_HIERARCHY.BU_SF_ROLE), 'CORP' || DECODE(CURRENT_DATABASE(), 'EDW_TST', '_TEST', 'EDW_DEV', '_DEV', 'EDW',''))
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_MOSAIC_RES_ECONOMIC_RESULT: 3f632304-1c5b-49b7-a564-7418a74380be
          ODS_MOSAIC_RES_RESERVE_CATEGORY: b71bf829-8093-4e35-b61a-e994bd173b32
          ODS_MOSAIC_RES_ECONOMIC_CASE: 89bed33e-deff-4929-8394-3276d3c48fba
          ODS_MOSAIC_RES_PRICE_DECK: d59597eb-9e62-4fb0-b56a-32e47f5a96d0
          ODS_MOSAIC_RES_ECONOMIC_INDICATOR: ef7c0219-5c46-4d11-9a05-d34b210c098a
          DIM_RES_RESERVE_CATEGORY: 0487c763-a764-486a-928a-d508bc0cd386
          DIM_RES_CASE: 884d4c26-70d1-4443-af19-dcbf0c9a4436
          DIM_RES_VINTAGE: bdc949e5-ecdd-42be-9212-67c2b1e7be78
          DIM_RES_ENTITY: fa3c7843-1d75-4bc2-8592-49fb44ad3c53
          STAGE_RES_SAP_RPT_HIERARCHY: 9a0932dd-1fc8-4661-8c3c-1eef4351a88f
          STAGE_RES_QB_RPT_HIERARCHY: 9c1e06ee-d56f-4c24-90b1-29db778119c4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_RES_CASE
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_RESULT
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_RESERVE_CATEGORY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_CASE
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_PRICE_DECK
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_INDICATOR
          - locationName: TARGET
            nodeName: DIM_RES_RESERVE_CATEGORY
          - locationName: TARGET
            nodeName: DIM_RES_VINTAGE
          - locationName: TARGET
            nodeName: DIM_RES_ENTITY
          - locationName: TARGET
            nodeName: STAGE_RES_SAP_RPT_HIERARCHY
          - locationName: TARGET
            nodeName: STAGE_RES_QB_RPT_HIERARCHY
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_RESULT') }} ODS_MOSAIC_RES_ECONOMIC_RESULT
              JOIN {{ ref('TARGET','ODS_MOSAIC_RES_RESERVE_CATEGORY') }} ODS_MOSAIC_RES_RESERVE_CATEGORY
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.RESERVE_CATEGORY_ID = ODS_MOSAIC_RES_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
               AND ODS_MOSAIC_RES_RESERVE_CATEGORY.DSS_CURRENT_FLAG = 'Y'
              JOIN {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_CASE') }} ODS_MOSAIC_RES_ECONOMIC_CASE
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.CASE_ID = ODS_MOSAIC_RES_ECONOMIC_CASE.CASE_ID
               AND ODS_MOSAIC_RES_ECONOMIC_CASE.DSS_CURRENT_FLAG = 'Y'
              JOIN {{ ref('TARGET','ODS_MOSAIC_RES_PRICE_DECK') }} ODS_MOSAIC_RES_PRICE_DECK
                ON ODS_MOSAIC_RES_ECONOMIC_CASE.PRICE_DECK_ID = ODS_MOSAIC_RES_PRICE_DECK.PRICE_DECK_ID
               AND ODS_MOSAIC_RES_PRICE_DECK.DSS_CURRENT_FLAG = 'Y'
              LEFT JOIN {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_INDICATOR') }} ODS_MOSAIC_RES_ECONOMIC_INDICATOR
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.RESULT_ID = ODS_MOSAIC_RES_ECONOMIC_INDICATOR.RESULT_ID
               AND ODS_MOSAIC_RES_ECONOMIC_INDICATOR.DSS_CURRENT_FLAG = 'Y'
              LEFT JOIN {{ ref('TARGET','DIM_RES_RESERVE_CATEGORY') }} DIM_RES_RESERVE_CATEGORY
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.RESERVE_CATEGORY_ID = DIM_RES_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
              LEFT JOIN {{ ref('TARGET','DIM_RES_CASE') }} DIM_RES_CASE
                ON ODS_MOSAIC_RES_ECONOMIC_CASE.CASE_ID = DIM_RES_CASE.CASE_ID
              LEFT JOIN {{ ref('TARGET','DIM_RES_VINTAGE') }} DIM_RES_VINTAGE
                ON ODS_MOSAIC_RES_ECONOMIC_CASE.VINTAGE_ID = DIM_RES_VINTAGE.VINTAGE_ID
              LEFT JOIN {{ ref('TARGET','DIM_RES_ENTITY') }} DIM_RES_ENTITY
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.ENTITY_ID = DIM_RES_ENTITY.ENTITY_ID
              LEFT JOIN (
                    SELECT COUNTRY,
                           PROVINCE_STATE,
                           CURRENT_CORE_AREA,
                           CURRENT_CORE_PROPERTY,
                           MIN(BU_SF_ROLE) BU_SF_ROLE
                      FROM {{ ref('TARGET','STAGE_RES_SAP_RPT_HIERARCHY') }}
                     GROUP BY COUNTRY,
                              PROVINCE_STATE,
                              CURRENT_CORE_AREA,
                              CURRENT_CORE_PROPERTY
                   ) STAGE_RES_SAP_RPT_HIERARCHY
                ON DIM_RES_ENTITY.COUNTRY = STAGE_RES_SAP_RPT_HIERARCHY.COUNTRY
               AND DIM_RES_ENTITY.PROVINCE_STATE = STAGE_RES_SAP_RPT_HIERARCHY.PROVINCE_STATE
               AND DIM_RES_ENTITY.CURRENT_CORE_AREA = STAGE_RES_SAP_RPT_HIERARCHY.CURRENT_CORE_AREA
               AND DIM_RES_ENTITY.CURRENT_CORE_PROPERTY = STAGE_RES_SAP_RPT_HIERARCHY.CURRENT_CORE_PROPERTY
              LEFT JOIN (
                    SELECT COUNTRY,
                           PROVINCE_STATE,
                           CURRENT_CORE_AREA,
                           CURRENT_CORE_PROPERTY,
                           MIN(BU_SF_ROLE) BU_SF_ROLE
                      FROM {{ ref('TARGET','STAGE_RES_QB_RPT_HIERARCHY') }}
                     GROUP BY COUNTRY,
                              PROVINCE_STATE,
                              CURRENT_CORE_AREA,
                              CURRENT_CORE_PROPERTY
                   ) STAGE_RES_QB_RPT_HIERARCHY
                ON DIM_RES_ENTITY.COUNTRY = STAGE_RES_QB_RPT_HIERARCHY.COUNTRY
               AND DIM_RES_ENTITY.PROVINCE_STATE = STAGE_RES_QB_RPT_HIERARCHY.PROVINCE_STATE
               AND DIM_RES_ENTITY.CURRENT_CORE_AREA = STAGE_RES_QB_RPT_HIERARCHY.CURRENT_CORE_AREA
               AND DIM_RES_ENTITY.CURRENT_CORE_PROPERTY = STAGE_RES_QB_RPT_HIERARCHY.CURRENT_CORE_PROPERTY
             WHERE ODS_MOSAIC_RES_ECONOMIC_RESULT.RISK IN ('B', 'Y')
               AND ODS_MOSAIC_RES_ECONOMIC_RESULT.COMPANY_ID = 801
               AND ODS_MOSAIC_RES_ECONOMIC_RESULT.DSS_CURRENT_FLAG = 'Y'
        name: STAGE_RES_RESULT
        noLinkRefs: []
  name: STAGE_RES_RESULT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
