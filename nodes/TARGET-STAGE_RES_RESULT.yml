fileVersion: 1
id: ab77b681-ae73-4b1c-9e9b-bc118e51b304
name: STAGE_RES_RESULT
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c1a8ce-5389-4416-b34b-0dc50a984db7
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.CASE_ID=DIM_RES_CASE.CASE_ID
        name: DIM_CASE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e2c96ae-b08c-47c0-accc-95deaeccef44
                stepCounter: 7272eaa2-fafb-4bca-8e4e-c19b3bc293a8
            transform: NVL(DIM_RES_CASE.DIM_CASE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 644d0e0b-49f9-474a-a02e-13a475e3e137
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.VINTAGE_ID=DIM_RES_VINTAGE.VINTAGE_ID
        name: DIM_VINTAGE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6469ae00-24ac-48dd-9669-b379ca841575
                stepCounter: 4c58af2a-4db8-4c37-81a6-624b353707dd
            transform: NVL(DIM_RES_VINTAGE.DIM_VINTAGE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aad4e9e6-43e5-4a0d-9fb0-db31ef72cd4b
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.ENTITY_ID=DIM_RES_ENTITY.ENTITY_ID
        name: DIM_ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74ffd597-20f7-4309-a3b9-20d578cb765a
                stepCounter: adbc6f18-f674-470a-81eb-8a903fd63361
            transform: NVL(DIM_RES_ENTITY.DIM_ENTITY_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09bbb6fd-1b9e-4d53-84b8-2ccfe66c345f
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_RESULT.RESERVE_CATEGORY_ID=DIM_RES_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
        name: DIM_RESERVE_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5774a43-c540-4816-8b74-9264e66fcb5b
                stepCounter: 34b3ca37-5d9b-425a-bb44-4379c6e4b8b5
            transform: NVL(DIM_RES_RESERVE_CATEGORY.DIM_RESERVE_CATEGORY_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33a7bcb4-a5ee-4a42-a618-bfc8c44f1161
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6904d9c-2099-4c92-b542-cf5daf911116
                stepCounter: 75edf470-b81c-4956-8491-819049b26abf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66ec9ba6-a58b-42be-b1e6-7f5824e87069
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d26ae27-3cfc-4ef6-adf1-819c5485616d
                stepCounter: 75edf470-b81c-4956-8491-819049b26abf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3ff75ae-2d97-4b1e-b6dd-0750cfa40f61
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7af85a0-9c3d-4349-9947-be2d91d53dcb
                stepCounter: 7934fa86-46e6-47c5-af25-69bb7bda6b93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30240c31-8cc7-4447-9747-1ce2519c2f6d
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: VINTAGE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b4d3d23-fc6b-47ea-b5b0-077f4b120a1c
                stepCounter: 7934fa86-46e6-47c5-af25-69bb7bda6b93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9663c515-0afc-4062-a0c0-4598675f1e69
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: PRICE_DECK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9f7a816-5a47-4191-a68c-cb9c9d5f8795
                stepCounter: e4961720-d5d7-4e0d-9e43-4bf19788790c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e8bc6c-a295-4bd5-bd2d-9a4293b8eb93
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4548a8b-9e27-4143-a351-fde482b170ae
                stepCounter: 75edf470-b81c-4956-8491-819049b26abf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 584e76e8-e334-418d-839d-b96f051c29a9
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: ECONOMIC_CASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a01fe88-1cfd-4cc5-a183-b8bf22636313
                stepCounter: 7934fa86-46e6-47c5-af25-69bb7bda6b93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09297e96-397a-4212-8792-0fe7c68324fe
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: PRICE_DECK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af88e5cd-1df5-463f-a431-1678acb3f1c9
                stepCounter: e4961720-d5d7-4e0d-9e43-4bf19788790c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05f450ad-4ca4-4a88-b29a-a382df81ec69
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aba894fe-3df7-4920-be55-114f4df05dad
                stepCounter: 7934fa86-46e6-47c5-af25-69bb7bda6b93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33ea0ae4-43d9-4da6-92e8-cdf581db23eb
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0aebd4c4-3082-4d90-86ae-d48b59b2dad6
                stepCounter: 72f8ddb6-5eb0-4610-8cee-2fde47af21a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c87b2497-f118-4c10-a6b8-b68f598ea43c
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: CALCULATED_BY_RINGFENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2cf93d0-4359-45a2-b0e0-89e6b9fc4a61
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d87ddcb1-f97d-426d-856c-2345dae97910
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: FIRST_CAPITAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de8ad36a-2d3b-488f-b9ba-fbae697490e8
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 410b172b-b772-4018-ac8a-24444a4c8072
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EARLIEST_PROD_DATE_FROM_ED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ce4e63d-eee5-4bc2-99f0-51b2372e70a6
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b71854d6-b72f-4b91-bb3c-2bd450f4cb4d
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: END_OF_LIFE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74950c36-70a9-49a0-98b3-805546609d08
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 208d107a-321a-48e2-be16-c779a951668e
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: END_OF_LIFE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f5b840-c541-468b-84ea-f730395a9486
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e364e7db-d629-49d5-a942-c28fde0ad101
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: FIRST_YEAR_COSH_PROD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e8ae93c-fd0b-428d-9896-a8fb4d70d29d
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e599cb5b-82c3-4c37-a4e9-deaca9e5efa4
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: FIRST_YEAR_COSH_PROD_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9c2fde9-730a-4911-bd12-cf54b06d9db2
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3143f507-ad57-4512-b093-25ba70e3236a
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LATEST_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce20c443-3a49-4976-8d64-a77cd84f5bf7
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29d9e561-8355-4bda-a5c0-ac239c270eb7
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b944f0c-f105-448f-b983-31763256f9c0
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcac3d8b-9fe7-416a-9a2c-402c76f934db
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PAYOUT_DATE_BTAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba38326-e270-4dd5-94a0-f31001af6087
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 709bd36c-4fd4-472b-8395-dcfe78b9af7d
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_HALF_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efb00e3d-c0af-4b1a-82b5-11d3f63cc0b7
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 075de110-3f42-4658-afa1-3a8a23f93526
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 648cf596-80e4-415e-870a-f2210c7b0201
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9913d521-a877-4fa1-a210-38586b224668
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_LIFE_INDEX_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71362736-a428-4741-ad45-6628fd32697c
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d0b475e-96ba-475d-90e0-c8e7cf5a29de
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: NUMBER(24,8)
        defaultValue: ""
        description: ""
        name: RESERVES_LIFE_INDEX_PRODUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 122b359e-28f7-4ebe-848c-79c81bf579a5
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fb4a023-bc74-464b-8ea9-efbba39e25e8
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: RING_FENCE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee0a2c4b-fc7e-4e60-bd87-68beb2d526e3
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16b8d50a-810e-46f9-b255-e5a26bd88e68
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: RING_FENCE_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 162ac0b4-c290-4f4c-8eee-1495394d6cee
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4df4fc61-35f6-4ace-a257-aa6e9f93b8f8
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: FORECAST_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb22dd36-5fc5-4cec-a801-72dbd88f2048
                stepCounter: 0421b95d-f6de-470a-bbba-510d3f56a6af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4317c1de-f718-4c0f-abeb-53f2ab0bb9f4
          stepCounter: ab77b681-ae73-4b1c-9e9b-bc118e51b304
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Row Level Security Role
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68cc19df-5ecb-4243-8137-9377d38706e5
                stepCounter: e94844c8-e7b8-4df0-b7b7-f5359a9f2b53
            transform: NVL(COALESCE(STAGE_RES_SAP_RPT_HIERARCHY.BU_SF_ROLE,STAGE_RES_QB_RPT_HIERARCHY.BU_SF_ROLE), 'CORP' || DECODE(CURRENT_DATABASE(), 'EDW_TST', '_TEST', 'EDW_DEV', '_DEV', 'EDW',''))
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_MOSAIC_RES_ECONOMIC_RESULT: 75edf470-b81c-4956-8491-819049b26abf
          ODS_MOSAIC_RES_RESERVE_CATEGORY: 72f8ddb6-5eb0-4610-8cee-2fde47af21a1
          ODS_MOSAIC_RES_ECONOMIC_CASE: 7934fa86-46e6-47c5-af25-69bb7bda6b93
          ODS_MOSAIC_RES_PRICE_DECK: e4961720-d5d7-4e0d-9e43-4bf19788790c
          ODS_MOSAIC_RES_ECONOMIC_INDICATOR: 0421b95d-f6de-470a-bbba-510d3f56a6af
          DIM_RES_RESERVE_CATEGORY: 34b3ca37-5d9b-425a-bb44-4379c6e4b8b5
          DIM_RES_CASE: 7272eaa2-fafb-4bca-8e4e-c19b3bc293a8
          DIM_RES_VINTAGE: 4c58af2a-4db8-4c37-81a6-624b353707dd
          DIM_RES_ENTITY: adbc6f18-f674-470a-81eb-8a903fd63361
          STAGE_RES_SAP_RPT_HIERARCHY: e94844c8-e7b8-4df0-b7b7-f5359a9f2b53
          STAGE_RES_QB_RPT_HIERARCHY: 908e51f3-3e4b-4c11-b57b-4fe2fe2c4e0b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_RES_CASE
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_RESULT
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_RESERVE_CATEGORY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_CASE
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_PRICE_DECK
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_INDICATOR
          - locationName: TARGET
            nodeName: DIM_RES_RESERVE_CATEGORY
          - locationName: TARGET
            nodeName: DIM_RES_VINTAGE
          - locationName: TARGET
            nodeName: DIM_RES_ENTITY
          - locationName: TARGET
            nodeName: STAGE_RES_SAP_RPT_HIERARCHY
          - locationName: TARGET
            nodeName: STAGE_RES_QB_RPT_HIERARCHY
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_RESULT') }} ODS_MOSAIC_RES_ECONOMIC_RESULT
              JOIN {{ ref('TARGET','ODS_MOSAIC_RES_RESERVE_CATEGORY') }} ODS_MOSAIC_RES_RESERVE_CATEGORY
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.RESERVE_CATEGORY_ID = ODS_MOSAIC_RES_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
               AND ODS_MOSAIC_RES_RESERVE_CATEGORY.DSS_CURRENT_FLAG = 'Y'
              JOIN {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_CASE') }} ODS_MOSAIC_RES_ECONOMIC_CASE
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.CASE_ID = ODS_MOSAIC_RES_ECONOMIC_CASE.CASE_ID
               AND ODS_MOSAIC_RES_ECONOMIC_CASE.DSS_CURRENT_FLAG = 'Y'
              JOIN {{ ref('TARGET','ODS_MOSAIC_RES_PRICE_DECK') }} ODS_MOSAIC_RES_PRICE_DECK
                ON ODS_MOSAIC_RES_ECONOMIC_CASE.PRICE_DECK_ID = ODS_MOSAIC_RES_PRICE_DECK.PRICE_DECK_ID
               AND ODS_MOSAIC_RES_PRICE_DECK.DSS_CURRENT_FLAG = 'Y'
              LEFT JOIN {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_INDICATOR') }} ODS_MOSAIC_RES_ECONOMIC_INDICATOR
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.RESULT_ID = ODS_MOSAIC_RES_ECONOMIC_INDICATOR.RESULT_ID
               AND ODS_MOSAIC_RES_ECONOMIC_INDICATOR.DSS_CURRENT_FLAG = 'Y'
              LEFT JOIN {{ ref('TARGET','DIM_RES_RESERVE_CATEGORY') }} DIM_RES_RESERVE_CATEGORY
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.RESERVE_CATEGORY_ID = DIM_RES_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
              LEFT JOIN {{ ref('TARGET','DIM_RES_CASE') }} DIM_RES_CASE
                ON ODS_MOSAIC_RES_ECONOMIC_CASE.CASE_ID = DIM_RES_CASE.CASE_ID
              LEFT JOIN {{ ref('TARGET','DIM_RES_VINTAGE') }} DIM_RES_VINTAGE
                ON ODS_MOSAIC_RES_ECONOMIC_CASE.VINTAGE_ID = DIM_RES_VINTAGE.VINTAGE_ID
              LEFT JOIN {{ ref('TARGET','DIM_RES_ENTITY') }} DIM_RES_ENTITY
                ON ODS_MOSAIC_RES_ECONOMIC_RESULT.ENTITY_ID = DIM_RES_ENTITY.ENTITY_ID
              LEFT JOIN (
                    SELECT COUNTRY,
                           PROVINCE_STATE,
                           CURRENT_CORE_AREA,
                           CURRENT_CORE_PROPERTY,
                           MIN(BU_SF_ROLE) BU_SF_ROLE
                      FROM {{ ref('TARGET','STAGE_RES_SAP_RPT_HIERARCHY') }}
                     GROUP BY COUNTRY,
                              PROVINCE_STATE,
                              CURRENT_CORE_AREA,
                              CURRENT_CORE_PROPERTY
                   ) STAGE_RES_SAP_RPT_HIERARCHY
                ON DIM_RES_ENTITY.COUNTRY = STAGE_RES_SAP_RPT_HIERARCHY.COUNTRY
               AND DIM_RES_ENTITY.PROVINCE_STATE = STAGE_RES_SAP_RPT_HIERARCHY.PROVINCE_STATE
               AND DIM_RES_ENTITY.CURRENT_CORE_AREA = STAGE_RES_SAP_RPT_HIERARCHY.CURRENT_CORE_AREA
               AND DIM_RES_ENTITY.CURRENT_CORE_PROPERTY = STAGE_RES_SAP_RPT_HIERARCHY.CURRENT_CORE_PROPERTY
              LEFT JOIN (
                    SELECT COUNTRY,
                           PROVINCE_STATE,
                           CURRENT_CORE_AREA,
                           CURRENT_CORE_PROPERTY,
                           MIN(BU_SF_ROLE) BU_SF_ROLE
                      FROM {{ ref('TARGET','STAGE_RES_QB_RPT_HIERARCHY') }}
                     GROUP BY COUNTRY,
                              PROVINCE_STATE,
                              CURRENT_CORE_AREA,
                              CURRENT_CORE_PROPERTY
                   ) STAGE_RES_QB_RPT_HIERARCHY
                ON DIM_RES_ENTITY.COUNTRY = STAGE_RES_QB_RPT_HIERARCHY.COUNTRY
               AND DIM_RES_ENTITY.PROVINCE_STATE = STAGE_RES_QB_RPT_HIERARCHY.PROVINCE_STATE
               AND DIM_RES_ENTITY.CURRENT_CORE_AREA = STAGE_RES_QB_RPT_HIERARCHY.CURRENT_CORE_AREA
               AND DIM_RES_ENTITY.CURRENT_CORE_PROPERTY = STAGE_RES_QB_RPT_HIERARCHY.CURRENT_CORE_PROPERTY
             WHERE ODS_MOSAIC_RES_ECONOMIC_RESULT.RISK IN ('B', 'Y')
               AND ODS_MOSAIC_RES_ECONOMIC_RESULT.COMPANY_ID = 801
               AND ODS_MOSAIC_RES_ECONOMIC_RESULT.DSS_CURRENT_FLAG = 'Y'
        name: STAGE_RES_RESULT
        noLinkRefs: []
  name: STAGE_RES_RESULT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
