fileVersion: 1
id: 8a363714-a684-4751-b5e6-657186391f80
name: STAGE_LO_SAP_72A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df94831d-0056-4eb0-8bf4-b470f75eb4dd
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d15d52d-aa78-4a52-95d1-a4ad5c668dee
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11bbd1c0-a80b-4764-9e44-9c833784fee6
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54526b1e-45d8-48aa-bb3b-bfef2e8ff111
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10bdb954-a6b5-46e4-aa9f-64fbc4a53063
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3c0b815-a583-47e8-b3be-6185d6b8cdb9
                stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b7926f9-5531-4336-8ccc-ae45b85535f8
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 124036cf-4525-4288-ae32-53c4b83c69f6
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af189e4e-ae63-4ead-a3dd-1ff32b80f219
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09dbd4ef-05cb-430d-90fe-c0a18e5f48ea
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62f1e7a5-2cf8-4b1e-a279-743f79de109b
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04d2bc3c-fa0e-451c-bc7f-f77d215f254a
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18126d05-e910-4f92-8ae9-bb3cc74271c4
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 154068f9-4120-427b-9543-030412be64f4
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a716d722-593d-4a7f-85b8-855d3ccd21a7
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04a43ee5-8d88-4bcf-908b-f583ac4a8bb7
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bac2b5d-65d6-45f4-b87f-59ea54635d37
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0e8c320-9e03-4f88-9e4e-d8f8995c4ff6
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df11ef55-7984-4c19-801d-fc9dd41012b7
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19c943be-ea14-4d51-b69e-631f0aaf6734
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa446fd2-6dd4-452f-80bb-227523affa43
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c8b6a7e-0300-436e-9b8d-da3b9f170619
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89b840ef-0818-40b0-9a34-f2cd3f33754b
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 963eea5c-4226-43e9-abca-2aba89566743
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6316db0f-0ffe-4164-b4f0-ee82cf5a4f2e
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86a690a4-2539-45c8-bc94-990a2ff4fc34
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8193d3fc-ef33-46f0-8de4-59ce89ac19a1
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0c49e09-e00c-4b25-b6ab-469f608d515f
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33f00836-a784-43e0-8c43-37f890b196b6
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38a7ef49-3e13-4c23-87bd-6851114f2aee
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24e990a3-fd59-4608-9c40-4f07d5c0acfa
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 565a1009-7b09-465f-b3ec-6864b745444a
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91df505d-670d-4080-82b4-c2135a4c8e29
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c557f58-36e9-4efc-90e9-1473242588b5
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e9be255-7a00-4d64-9245-87e8580d76df
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f9ce928-446a-44d0-a28b-7fc2398658cf
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 455f1e13-fd1c-4b60-8d28-b1e065f6dc16
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1ce3ce2-eeec-4667-a5fd-1c4bc49619dc
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3902e89-72c5-46f5-b553-e54f82534123
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0236be80-4a12-4363-b7ef-5ecc132b2ab0
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 066b21ad-5d5f-4b6a-9764-68487cc90eb2
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fc5de03-8ef9-472d-a3c7-0ea5ce482122
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f51c159-b610-41c4-999c-06d6d16fe1a7
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fe52f0c-b6b2-4986-be7a-f1ccb712696c
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 201dfbac-08f1-41ae-8696-1029994419d9
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb45154b-cb7d-4f25-a05c-115457b2e52f
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54f622f9-aaaa-42bf-aaab-39faa84600bc
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a2fd8fa-b76c-431e-8314-a93c76526811
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b25e6713-b299-4b66-8736-507f3db75f54
          stepCounter: 8a363714-a684-4751-b5e6-657186391f80
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_70A: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
          STAGE_LO_SAP_FIRST_PASS: 7f87de3d-bdfa-4c2a-af50-4179beced526
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_FIRST_PASS
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_70A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_70A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_70A') }} STAGE_LO_SAP_70A
                 UNION ALL SELECT STAGE_LO_SAP_FIRST_PASS.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_FIRST_PASS') }} STAGE_LO_SAP_FIRST_PASS
                     WHERE STAGE_LO_SAP_FIRST_PASS.LINE_NO_GROUP = '71'
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '72A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_72A
        noLinkRefs: []
  name: STAGE_LO_SAP_72A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
