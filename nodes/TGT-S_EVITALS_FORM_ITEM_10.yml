fileVersion: 1
id: f0f20bed-b828-4b6d-af52-eb73eac70536
name: S_EVITALS_FORM_ITEM_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Generate a row for each item found in forms loaded in fact_eVitals_form."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74928f78-f62c-44ad-8bf7-04006bb1da64
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_INSTANCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8621eb11-e841-47a2-abd2-da6dab8ee56f
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fa84ad1-af74-408c-9cc6-658d4a086cd0
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_DEFINITION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a74bd33-fca6-47db-bbaa-dbd84523e731
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f95e869-17a1-4b3c-8a72-8ec8ad9c9ee6
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f388141-4c32-47b5-9b90-b9b893071894
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 263952f1-0d4a-4d9b-9398-5a8a283abbbb
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MATCHED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 456284ec-a6a2-4dbb-95b2-ad6a904f4489
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e165ed5e-9222-4552-b568-90d284cfeed0
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 711cc89a-0ffd-4735-a537-a3bc318dea8a
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dde03e19-5324-4291-80fa-9b7f74e1df30
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd00e1a1-9102-491b-ada2-47ec6a63ef96
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0d3a2d8-e73c-40e3-b7d8-3a3e6de35fa9
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECORDED_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eba4b5a-a9c7-40f9-bd9d-243887392dea
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0c5d90e-24ef-4a8f-bbce-f61c853208f1
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATED_BY_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2563d735-38f2-4337-94c5-2263974e1a30
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60f93b82-ab76-475f-8f2d-e4c3fe232b35
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFIED_BY_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f78cd03-8e61-4e9d-bd33-86746925108e
                stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecaade8d-6d50-41d2-b2f9-5a7b79829b11
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: ITEM_DEFINITION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e0366f7-3556-4d76-9b5f-dd57f3921d05
                stepCounter: 082416f9-6241-4615-b479-5734a0649660
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a6ea0a2-ba16-4643-bf1a-8a1d0b7b5019
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ITEM_LABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 069f6ddb-3623-4699-ae17-fa91535834da
                stepCounter: 082416f9-6241-4615-b479-5734a0649660
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70327e6f-9f7e-4b0a-95a5-d0646e57bcf4
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ENTRY_DISPLAY_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47cd2912-b2ae-40c3-bbb8-d8ae9610e40d
                stepCounter: b0969f05-88c2-4639-8e4d-8e2e760916da
            transform: COALESCE (ds_Patientrack_ITEM_INSTANCE_TEXTBOX.entry_text, CAST(ds_Patientrack_ITEM_INSTANCE_NUMBER.entry_number AS varchar), CAST(ds_Patientrack_ITEM_INSTANCE_BOOLEAN.entry_boolean AS varchar), CAST(l_Patientrack_ITEM_INSTANCE_DATETIME.entry_datetime AS varchar), s_Patientrack_Multiple_List_Values.display_value, SI_COMBOBOX.display_value, SI_RADIO.display_value, 'missing')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5581c31e-7e80-49b1-a6c0-15dc6c605b45
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: ENTRY_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47cd2912-b2ae-40c3-bbb8-d8ae9610e40d
                stepCounter: b0969f05-88c2-4639-8e4d-8e2e760916da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86bb3c9a-74f8-4189-9176-062b0c21c449
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: ENTRY_BOOLEAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e68fc90-56a9-47c0-bdf0-87c0ef2b8152
                stepCounter: d55c32c9-dba0-4bfc-a26b-162f8ba6efa0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e55d56c1-31a8-41e0-b15b-765c8ec22e2e
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: ENTRY_COMBO_SIID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67dff107-d4c7-4b22-b0d3-bc1a4a0a4f38
                stepCounter: c4b21690-a669-4278-8ab3-0eaeb5f72074
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df98dc67-aca0-446b-9690-cc495d19cf32
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ENTRY_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c63226a-a9d4-4c33-bb72-8aa1a18b472c
                stepCounter: 2d6b4eeb-6158-4d2e-b214-30250fb86ae9
            transform: IFNULL(ENTRY_DATETIME, CASE WHEN PATINDEX('%-%T%', entry_text) > 0 THEN TRY_CONVERT(DATETIME, REPLACE(entry_text, 'T', ' '), 121) WHEN PATINDEX('%/%/%', entry_text) > 0 THEN TRY_CONVERT(DATETIME, entry_text, 103) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f9a484c-a629-4639-9df5-20aaa8da2f6c
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ENTRY_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95ede8f9-368b-45f4-832c-fa2fb0405c77
                stepCounter: a4a74344-1bc8-49aa-86e6-2014f47f0c91
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1daa02d-db5c-41e7-93bc-2e3f4f77c60d
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: ENTRY_RADIO_SIID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: feb5e649-3d17-49a2-87e7-b16603f31731
                stepCounter: e4911381-7d84-488c-a733-0043d3e17e66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec64a144-e0ab-494e-ba47-ef8448d4c0a6
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: ITYPE_SIID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdde6d18-4fd7-42d0-8872-683b986214c8
                stepCounter: 082416f9-6241-4615-b479-5734a0649660
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 932c40df-0e28-41cc-872a-acc4facdb537
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ITEM_DISPLAY_ORDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15445444-b3a1-4730-82a8-356cfc17884c
                stepCounter: 082416f9-6241-4615-b479-5734a0649660
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6528f1ab-20a4-47de-86c4-e9c0de2ce0f5
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: LIST_DISPLAY_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7880bc52-e4b5-4183-b9de-8325aa5fbd0b
                stepCounter: ecdf78d6-77ef-4fe0-81e3-39b0c60e9c77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4420ee1-c1bf-4adb-a0c0-f946ab4fe461
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: COMBO_DISPLAY_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47bc506f-91ee-42e4-83f3-212f789e4bce
                stepCounter: b3cc9170-c5b9-4cde-a8e0-c4118092ea4f
            transform: SI_COMBOBOX.DISPLAY_VALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5f3e474-9a09-4a74-9991-d713c1127f2e
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: RADIO_DISPLAY_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47bc506f-91ee-42e4-83f3-212f789e4bce
                stepCounter: b3cc9170-c5b9-4cde-a8e0-c4118092ea4f
            transform: SI_RADIO.DISPLAY_VALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ebfdf8-8370-4449-bef5-5fd79ccc5da9
          stepCounter: f0f20bed-b828-4b6d-af52-eb73eac70536
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_PATIENTRACK_ITEM_DEFINITION: 082416f9-6241-4615-b479-5734a0649660
          DS_PATIENTRACK_ITEM_INSTANCE_TEXTBOX: b0969f05-88c2-4639-8e4d-8e2e760916da
          DS_PATIENTRACK_ITEM_INSTANCE_BOOLEAN: d55c32c9-dba0-4bfc-a26b-162f8ba6efa0
          DS_PATIENTRACK_ITEM_INSTANCE_COMBOBOX: c4b21690-a669-4278-8ab3-0eaeb5f72074
          L_PATIENTRACK_ITEM_INSTANCE_DATETIME: 2d6b4eeb-6158-4d2e-b214-30250fb86ae9
          DS_PATIENTRACK_ITEM_INSTANCE_NUMBER: a4a74344-1bc8-49aa-86e6-2014f47f0c91
          S_PATIENTRACK_MULTIPLE_LIST_VALUES: ecdf78d6-77ef-4fe0-81e3-39b0c60e9c77
          DS_PATIENTRACK_ITEM_INSTANCE_RADIO: e4911381-7d84-488c-a733-0043d3e17e66
          L_PATIENTRACK_SELECTION_ITEM: b3cc9170-c5b9-4cde-a8e0-c4118092ea4f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_FORM
          - locationName: TGT
            nodeName: L_PATIENTRACK_ITEM_DEFINITION
          - locationName: TGT
            nodeName: DS_PATIENTRACK_ITEM_INSTANCE_TEXTBOX
          - locationName: TGT
            nodeName: DS_PATIENTRACK_ITEM_INSTANCE_BOOLEAN
          - locationName: TGT
            nodeName: DS_PATIENTRACK_ITEM_INSTANCE_COMBOBOX
          - locationName: TGT
            nodeName: L_PATIENTRACK_ITEM_INSTANCE_DATETIME
          - locationName: TGT
            nodeName: DS_PATIENTRACK_ITEM_INSTANCE_NUMBER
          - locationName: TGT
            nodeName: S_PATIENTRACK_MULTIPLE_LIST_VALUES
          - locationName: TGT
            nodeName: DS_PATIENTRACK_ITEM_INSTANCE_RADIO
          - locationName: TGT
            nodeName: L_PATIENTRACK_SELECTION_ITEM
        join:
          joinCondition: |-
            FROM s_eVitals_form
              JOIN {{ ref('TGT','L_PATIENTRACK_ITEM_DEFINITION') }}
                ON s_eVitals_form.form_definition_id = l_Patientrack_ITEM_DEFINITION.form_definition_id
              LEFT OUTER JOIN {{ ref('TGT','DS_PATIENTRACK_ITEM_INSTANCE_TEXTBOX') }}
                ON l_Patientrack_ITEM_DEFINITION.item_definition_id = ds_Patientrack_ITEM_INSTANCE_TEXTBOX.item_definition_id
               AND s_eVitals_form.form_instance_id = ds_Patientrack_ITEM_INSTANCE_TEXTBOX.form_instance_id
              LEFT OUTER JOIN {{ ref('TGT','DS_PATIENTRACK_ITEM_INSTANCE_BOOLEAN') }}
                ON l_Patientrack_ITEM_DEFINITION.item_definition_id = ds_Patientrack_ITEM_INSTANCE_BOOLEAN.item_definition_id
               AND s_eVitals_form.form_instance_id = ds_Patientrack_ITEM_INSTANCE_BOOLEAN.form_instance_id
              LEFT OUTER JOIN {{ ref('TGT','DS_PATIENTRACK_ITEM_INSTANCE_COMBOBOX') }}
                ON l_Patientrack_ITEM_DEFINITION.item_definition_id = ds_Patientrack_ITEM_INSTANCE_COMBOBOX.item_definition_id
               AND s_eVitals_form.form_instance_id = ds_Patientrack_ITEM_INSTANCE_COMBOBOX.form_instance_id
              LEFT OUTER JOIN {{ ref('TGT','L_PATIENTRACK_ITEM_INSTANCE_DATETIME') }}
                ON l_Patientrack_ITEM_DEFINITION.item_definition_id = l_Patientrack_ITEM_INSTANCE_DATETIME.item_definition_id
               AND s_eVitals_form.form_instance_id = l_Patientrack_ITEM_INSTANCE_DATETIME.form_instance_id
              LEFT OUTER JOIN {{ ref('TGT','DS_PATIENTRACK_ITEM_INSTANCE_NUMBER') }}
                ON l_Patientrack_ITEM_DEFINITION.item_definition_id = ds_Patientrack_ITEM_INSTANCE_NUMBER.item_definition_id
               AND s_eVitals_form.form_instance_id = ds_Patientrack_ITEM_INSTANCE_NUMBER.form_instance_id
              LEFT OUTER JOIN {{ ref('TGT','S_PATIENTRACK_MULTIPLE_LIST_VALUES') }}
                ON l_Patientrack_ITEM_DEFINITION.item_definition_id = s_Patientrack_Multiple_List_Values.item_definition_id
               AND s_eVitals_form.form_instance_id = s_Patientrack_Multiple_List_Values.form_instance_id
              LEFT OUTER JOIN {{ ref('TGT','DS_PATIENTRACK_ITEM_INSTANCE_RADIO') }}
                ON l_Patientrack_ITEM_DEFINITION.item_definition_id = ds_Patientrack_ITEM_INSTANCE_RADIO.item_definition_id
               AND s_eVitals_form.form_instance_id = ds_Patientrack_ITEM_INSTANCE_RADIO.form_instance_id
              LEFT OUTER JOIN {{ ref('TGT','L_PATIENTRACK_SELECTION_ITEM') }} SI_RADIO
                ON ds_Patientrack_ITEM_INSTANCE_RADIO.ENTRY_SIID = SI_RADIO.selection_item_id
              LEFT OUTER JOIN {{ ref('TGT','L_PATIENTRACK_SELECTION_ITEM') }} SI_COMBOBOX
                ON ds_Patientrack_ITEM_INSTANCE_COMBOBOX.ENTRY_SIID = SI_COMBOBOX.selection_item_id
             WHERE l_Patientrack_ITEM_DEFINITION.deleted_flag = '0'
               AND COALESCE(ds_Patientrack_ITEM_INSTANCE_TEXTBOX.entry_text, CAST(ds_Patientrack_ITEM_INSTANCE_NUMBER.entry_number AS varchar), CAST(ds_Patientrack_ITEM_INSTANCE_BOOLEAN.entry_boolean AS varchar), CAST(l_Patientrack_ITEM_INSTANCE_DATETIME.entry_datetime AS varchar), s_Patientrack_Multiple_List_Values.display_value, SI_COMBOBOX.display_value, SI_RADIO.display_value) IS NOT NULL
        name: S_EVITALS_FORM_ITEM_10
        noLinkRefs: []
  name: S_EVITALS_FORM_ITEM_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
