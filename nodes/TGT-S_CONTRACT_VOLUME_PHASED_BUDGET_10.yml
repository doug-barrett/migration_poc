fileVersion: 1
id: 6972231e-40d6-4be7-bbb4-55c5ea1debae
name: S_CONTRACT_VOLUME_PHASED_BUDGET_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa91b0e6-2a01-489b-a2fe-98e37274a1c6
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_volume_phased_budget_10.purchase_unit_code=dim_contract_line.purchase_unit_code  s_contract_volume_phased_budget_10.funder_provider_split=dim_contract_line.funder_provider_split  s_contract_volume_phased_budget_10.IDF_class=dim_contract_line.IDF_class  s_contract_volume_phased_budget_10.acute_elective_other=dim_contract_line.acute_elective_other  s_contract_volume_phased_budget_10.RC_code=dim_contract_line.RC_code
        name: DIM_CONTRACT_LINE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a089622c-29df-43d2-a167-1f603c12c592
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: IFNULL(dim_contract_line.dim_contract_line_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 019775c0-8ea7-4381-8323-9e12f2abc4c5
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 549c362c-d470-4b0c-b76c-dbe78f928c97
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82fe65a8-1715-4227-bde5-df3878dc6219
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6186d723-2082-4103-a40f-535352937d90
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: UPPER(l_reference_vPhased_Price_Volume_Schedule.purchase_unit_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd2a9c1b-b1e6-455d-9962-339f400ffc37
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66bcc1d1-7083-4eac-8477-68b572452d86
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bab13c7a-982c-4e07-ac77-f6eb375be673
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: ""
        name: UNIT_OF_MEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e20f8bf0-8dc4-4b5b-98bf-4c1858df56cf
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91b48aa1-6bb0-47ff-ad70-4b3a03a51d34
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NUMERIC(38,6)
        defaultValue: ""
        description: ""
        name: PLANNED_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23d75e1a-bd0d-48c7-af50-3072d6136fb3
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdda89ec-1c5b-4866-8edd-7cbce1909eb0
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: APPLIED_PHASING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de1b02e4-9c85-4291-bc34-8ba7d7c2d5d3
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34ba59c9-aee6-4b0f-8045-bf0834da7c82
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(25)
        defaultValue: ""
        description: ""
        name: FUNDER_PROVIDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d595d78-08d3-41a1-97f7-3f1d3ee75c8b
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d619480-3b54-4306-a479-b4e65545ed79
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(25)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 335a7499-18f7-4d77-881a-9f0955544244
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae3afaeb-bbc1-4320-a921-de3136e030ba
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(10)
        defaultValue: ""
        description: ""
        name: ACUTE_ELECTIVE_OTHER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a55d469b-0cc0-4b72-9844-e79867395aee
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eca6eeb-cf5d-44d6-9a4d-4a535922bf26
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: NATIONAL_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ab1f1a2-0e35-4188-9bb3-4672212476e4
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dba410cb-0b25-40c2-8466-bf91653630e0
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PLANNED_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37f78266-ed8e-4c12-998c-dbaf61e3dbc5
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7967b3ff-33ce-4538-94e1-1c570e7f558c
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: REVENUE_EXPENDITURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b66efa3-2a0f-40df-be4b-bc4b69558770
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a2c6ce-26c8-43b8-9a27-527ce976a5d5
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(10)
        defaultValue: ""
        description: ""
        name: RC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5388f12-1f38-4493-8726-83c6d7ef07ef
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 610bd122-c3ef-462c-900d-7bddeed07e56
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(4)
        defaultValue: ""
        description: ""
        name: ACCOUNT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 336e337d-0792-48d8-b1c1-42ae46e12418
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b7bb710-cb02-42a4-949d-c75e5b544712
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(5)
        defaultValue: ""
        description: ""
        name: SUB_ACCOUNT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dab93c0-dd55-4ce2-8117-688a95d04331
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5d1f852-1dd9-466c-a682-dba0cec45c54
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: CONTRACT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65f8e623-07b9-4150-8876-b40b50e4d542
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec3f7a7d-669b-476d-a4db-2c02cd26b099
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: SUB_PURCHASE_UNIT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c6951bc-5417-49c4-ab7c-0bfefdd78a32
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c241f5c6-71cd-4310-aae5-6da9a384b3c9
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NUMERIC(38,6)
        defaultValue: ""
        description: Budget volume from the Price Volume Schedule at the phasing time period grain.
        name: BUDGET_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74576a61-a658-459d-bcaf-7a5c8eaf3613
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 337462fb-e0d6-439c-9b70-d7fc02cce19d
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SHOW_IN_AVR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6eebccfe-e3ee-400a-add1-73e7fdb2bafd
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23b81f97-d08b-4dd3-84f8-ed3a47df3ccc
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: LOOKUP_FIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6a37d55-84c0-4826-be49-1d69a89eafb5
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23741342-89d2-42c3-92de-f9be3eca3c3c
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_CONTRACT_REPORTING_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e1d81c8-400e-4a18-9877-4bc569719cea
                stepCounter: 4f22f895-47c0-4e2a-9a51-f3051174cf24
            transform: IFNULL(dim_contract_reporting_date_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdd44895-5112-47b2-91b2-a76de2e317f4
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(10)
        defaultValue: ""
        description: ""
        name: GRP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 992587eb-1d65-4251-94a0-526c87fe4915
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c28567a-5a71-431e-b5cd-e0a556d73d6b
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: ""
        name: GROUP_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4efe209b-c4e1-4fe6-8119-4c43ae45caa5
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65850c8a-fd6b-4145-b6c3-20cb3e3b7bfb
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RC_DESCRIPTION_ORACLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3931e39-e077-4ace-bee5-de7e9e6dbe7f
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 773f8dd5-5fd2-4547-a942-77fc5e23bcd5
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AVR_SECTION_HEADING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9d48aac-ed14-4241-bf76-520af87e05db
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96080223-34cd-4302-8dc6-45a98b10e467
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a146aefb-7cd8-46c6-add6-558eea0e916b
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83efa8a3-82c0-44b7-bb7d-bdad6c571322
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: UOM_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b442825-2d8b-4817-b728-0ca3cad59ff2
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee6bb7b7-e4be-4c1d-8eb8-57d9f394d764
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_contract_volume_phased_budget_10.account_code=dim_revenue_account_codes.accountcode
        name: DIM_ACCOUNT_CODES_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2271450-25fa-4f68-b397-a065ef9c7729
                stepCounter: d8a2759c-3bb4-4cde-9420-f7fc06bfc38c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f23c0c60-4a60-49d1-a03f-b6e104937b16
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_volume_phased_budget_10.RC_code=dim_revenue_responsibility_centre.responsibility_centre_code
        name: DIM_REVENUE_RESPONSIBILITY_CENTRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96ebe037-b0bd-48b1-afba-59eeb8266787
                stepCounter: e9ae78d6-3f1b-4ea7-907f-4db2af72b742
            transform: IFNULL(dim_revenue_responsibility_centre_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7239bb1d-5f38-4be5-89a2-5cea00de83b0
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ROWID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35a61e60-05e5-484d-8ca8-ce10a35c2b41
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e02ce632-5e4b-4a16-b3e1-dfa1dc1ead33
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PVS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8946cd9-eb54-4a07-9820-e57f281864a6
                stepCounter: 2f672dae-ac28-4029-a357-72dcdb144ea5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9828081-b337-4553-b67b-d9f0b673e3e2
          stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_REFERENCE_VPHASED_PRICE_VOLUME_SCHEDULE: 2f672dae-ac28-4029-a357-72dcdb144ea5
          DIM_CONTRACT_LINE: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
          DIM_CONTRACT_REPORTING_DATE: 4f22f895-47c0-4e2a-9a51-f3051174cf24
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DIM_CONTRACT_LINE
          - locationName: TGT
            nodeName: L_REFERENCE_VPHASED_PRICE_VOLUME_SCHEDULE
          - locationName: TGT
            nodeName: DIM_CONTRACT_REPORTING_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','L_REFERENCE_VPHASED_PRICE_VOLUME_SCHEDULE') }}
              LEFT OUTER JOIN {{ ref('TGT','DIM_CONTRACT_LINE') }}
                ON l_reference_vPhased_Price_Volume_Schedule.purchase_unit_code = dim_contract_line.purchase_unit_code
               AND l_reference_vPhased_Price_Volume_Schedule.funder_provider_split = dim_contract_line.funder_provider_split
               AND l_reference_vPhased_Price_Volume_Schedule.IDF_class = dim_contract_line.IDF_class
               AND l_reference_vPhased_Price_Volume_Schedule.acute_elective_other=dim_contract_line.acute_elective_other
               AND l_reference_vPhased_Price_Volume_Schedule.RC_code=dim_contract_line.planned_RC_code
               AND l_reference_vPhased_Price_Volume_Schedule.Fiscalyear = dim_contract_line.FiscalYear
               AND l_reference_vPhased_Price_Volume_Schedule.FiscalPeriod = dim_contract_line.FiscalPeriod
               AND l_reference_vPhased_Price_Volume_Schedule.show_in_AVR = dim_contract_line.show_in_AVR
               AND l_reference_vPhased_Price_Volume_Schedule.purchaser_code = dim_contract_line.purchaser
              LEFT OUTER JOIN {{ ref('TGT','DIM_CONTRACT_REPORTING_DATE') }}
                ON dim_contract_line.calendar_date = dim_contract_reporting_date.calendar_date
             WHERE [l_reference_vPhased_Price_Volume_Schedule].[funder_provider_split] ='Provider'
        name: S_CONTRACT_VOLUME_PHASED_BUDGET_10
        noLinkRefs: []
  name: S_CONTRACT_VOLUME_PHASED_BUDGET_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
