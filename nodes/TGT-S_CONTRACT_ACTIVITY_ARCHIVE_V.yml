fileVersion: 1
id: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
name: S_CONTRACT_ACTIVITY_ARCHIVE_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Used to create monthy snapshots of the current fiscal year and last month of the previous fiscal years data for comparisons of coded versus uncoded data."
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a053a11-598b-426a-88b5-1a6d24c850af
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Generated column used to join to correct Price Volume Schdule Line
        name: PROVIDER_FUNDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9862be27-8b73-452f-af9a-79ce2b427d91
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d4bca52-fe87-4bf6-ae45-6925ca28557e
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c010ef7e-c6b6-49eb-89cd-6831d3f57b23
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39bd2de3-2486-4b37-993e-4af7fb853c8c
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: health_specialty_code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c383dd-7682-44b4-a9df-88932212427a
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06e58d32-5ee2-486c-8ec4-a027a3656d5d
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.health_specialty_code=dim_MOH_health_specialty.health_specialty_code
        name: DIM_MOH_HEALTH_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 375aa674-b449-4e37-9b05-5f9c4dbd3acc
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3ce5799-62ba-4ce2-b58b-5cf4abf55eba
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.facility_code=dim_health_facility.health_facility_code
        name: DIM_HEALTH_FACILITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82d56ae0-1eeb-457b-9922-e695c6996fdb
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec39bc8e-3177-4ef2-a5d7-d59d39991d4c
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: facility_code
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a15fb04-d30c-48c0-ba61-ac2c3daf76c9
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae94b50c-9087-4b6a-85ca-341ce687c63f
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe35e53-1d30-46fe-8e66-09094457ebc8
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0acdd51-f07c-49e2-ae91-884c5fa9ae94
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REPORTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8344ac46-d066-412c-897b-d907c29cc22d
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06c941eb-b7e3-40d2-911e-561191e93c77
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f471265e-e464-430d-8c2d-abcaee386963
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71866d29-28c8-4bad-a6b2-61e8cd56d467
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c18eaa37-27c9-4ad8-8182-db91b546cde9
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17366b5e-e258-4ecd-87fd-addac7ce0eca
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89b44581-cd1f-4515-bc37-aaf9053a0bb0
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50db0851-829a-4709-9224-be4571604991
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9772b5d-8c69-47ea-933b-14e3152b88fd
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f4334b4-7e57-495d-89ba-9c86ece9f047
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e184949-ecd7-4851-8432-26acf94061b6
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bda18de2-d838-4184-b827-1c67e94da848
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ad1b870-86c6-4970-ba8d-432f8315d842
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 989ea646-e912-4494-a8d5-720a4b206bc7
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.admin_category_reference_no=dim_admin_category.admin_category_reference_no
        name: DIM_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b06529c7-c2e2-47bd-ad76-68151b7003e5
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 020296df-899a-44f4-9217-b5429715570f
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdcfb70a-0b63-47e1-931a-b682902bed18
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0658f78e-16fb-4b68-a5a9-7e3acda83309
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PURCHASER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a23a57a0-f164-4fe7-a335-91b1de51dadc
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 958def13-162c-4500-bfdf-9936087b1f2f
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CONTRACT_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 362f0472-6a0f-4bbb-b7b8-3ffa9de0cc67
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da61ee8f-e385-4f00-8383-b2f7a1576895
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc737284-14f4-452a-ac12-6adc5ba5718e
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b84e3150-8c93-47c2-9d91-ca3cef9c7cb8
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3591b4-b91d-4354-b7f8-81c52900ada6
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2e03770-baa5-4203-bf33-eaf21f0db154
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: This is the volume of units for the method by which the event is funded. i.e. WIES or 1 for procedure funded purchase units.
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e24cc067-ba09-47d8-88d7-cc6feb931272
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc6ffc6-d9b2-4872-a566-c633c2833934
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c63997d2-2356-4927-8629-4c0081bb6752
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fd4fa15-9d1d-4a49-8d2e-8673bc722bc3
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1def154-f34e-4d4d-b167-dd4cf2aa42d8
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 914932ef-759f-455f-9896-b62b5a2968a5
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7d8166e-1470-49e1-ba9a-0632e37a7e9c
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7450655-2d8b-47ae-beea-3e77b4f62a22
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: MHOP_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19df8653-fa46-42f0-a21c-5f8ff8999a85
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aecce865-8462-4322-ba7a-1b99e5785941
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: AMED_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b6de778-aea9-48ec-82b2-652ad92158d5
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d0cf884-c531-4763-9401-509a154947da
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: SURG_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb39b38d-3f4c-4f3c-a6a5-7f7e2261fc18
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59df4296-9193-42d8-80b7-386f67a27ede
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: CWF_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f336a0a2-a5fc-4db5-a48a-d8856a5fb4b8
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd1b984a-d909-4abb-8102-cd36db049d81
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f953af-f72e-4c87-bf43-4126ae07480a
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbbe3466-c64a-4497-a700-e746276da139
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: OTH_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92945760-b9e2-44a5-817c-cfbf54234aca
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 908dae5b-d6ae-4a21-82a5-cb11eb689af0
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Activity that matches a price volume schedule contract line. Y means that it is matched to funded contract line. N means that there is no match
        name: FUNDED_ACTIVITY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9d213fa-1e10-4cb4-b71f-0d2aa6b88dbb
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7b1d661-a3ff-4186-aed1-28081a510cd9
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COSTED_ACTIVITY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0805c49-679a-4c5f-ac9f-fea9337956fb
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa278b5a-28cb-44e6-85d8-a403339adc59
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ESTIMATED_ACTIVITY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51e79422-8edb-4ac2-b3e9-938ccb2ce046
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c29a4646-3749-4100-84fb-7766e25ceca3
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flags encounters that have purchase unit volume as Y and where there is no volume as N. Events can legitimately have no volume if they are not outcomed, patient DNAs or they occur in the future.
        name: EVENTS_WITH_PURCHASE_UNIT_VOLUME_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b81264e-7c7b-495f-a567-e39384ec3d90
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da3a520e-87b7-4ea8-af11-fdf47cb2a946
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: the price the DHB funding arm is paying the provider
        name: PLANNED_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a77d6e3-3270-4f70-b6bc-4b916f64f1e4
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b305131c-1206-4b0b-92cf-a1c596661efd
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Planned price x purchase unit volume
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f757e3a-d865-4370-a267-b97361937bc0
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbc16e13-6cea-413f-8f33-3259a4d9741f
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f97e051-1cca-4503-9604-4f412f254262
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 668123c6-ea30-415d-a8da-19930d2e41b8
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1ee3ff-d382-4e14-91a7-62e8a2ecef28
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7be4808-b3bc-4a77-b1d0-f1daf52b7a5b
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_PLANNED_CARE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a88fb9e7-5dda-464f-a429-0daaffeaa615
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39e6ebef-03a9-41c1-8f09-817e08d1227c
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_CONTRACT_LINE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51aef14f-3401-4f2e-92e9-67283d8009f3
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 664fdf9d-00e8-4db1-bf69-e243cc744528
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: business key for dim_contract_line, reqd for rekeying
        name: PVS_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f60ef0c-7b19-4bd6-9c80-6ac447725e84
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71603894-9450-4d46-b022-88e21c1fa94c
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_ADMISSION_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4b6506f-3e05-4189-bd70-830077ee4a17
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92773298-a5ec-4308-9f17-760067a7c966
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_CONTRACT_REPORTING_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac5b05fa-c9ad-4c02-9838-642115bca3bf
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c68d8686-8f53-4b6a-be18-d6ad3a5d70b5
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a45137a4-2854-4aeb-86f1-b4d8fa3d813e
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc8c966f-bd36-4a83-8ff2-40c07edfd1d4
          stepCounter: cbea97f8-8cd0-4acb-929c-a12ff5e87c8c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acced659-bc17-4503-8585-123cb1b88609
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ this }}(provider_funder_split, responsibility_centre_code, health_specialty_code, dim_MOH_health_specialty_key, dim_health_facility_key, facility_code, service_date, reporting_date, source_encounter, funded_event_encounter, event_encounter_type_code, dim_encounter_type_key, NHI, dim_patient_key, dim_admin_category_key, admin_category_reference_no, purchaser, contract_admit_type, IDF_class, purchase_unit_code, purchase_unit_volume, estimated_purchase_unit_volume, actual_cost, budget_cost, MHOP_cost, AMED_cost, SURG_cost, CWF_cost, ESC_cost, OTH_cost, funded_activity_flag, costed_activity_flag, estimated_activity_flag, events_with_purchase_unit_volume_flag, planned_price, revenue, clinician_reference_no, dim_age_group_key, dim_planned_care_key, dim_contract_line_key, pvs_id, dim_admission_type_key, dim_contract_reporting_date_key, dim_clinician_key, dss_update_time) AS SELECT s_contract_activity_20.provider_funder_split,
                   s_contract_activity_20.responsibility_centre_code,
                   s_contract_activity_20.health_specialty_code,
                   s_contract_activity_20.dim_MOH_health_specialty_key,
                   s_contract_activity_20.dim_health_facility_key,
                   s_contract_activity_20.facility_code,
                   s_contract_activity_20.service_date,
                   s_contract_activity_20.reporting_date,
                   s_contract_activity_20.source_encounter,
                   s_contract_activity_20.funded_event_encounter,
                   s_contract_activity_20.event_encounter_type_code,
                   s_contract_activity_20.dim_encounter_type_key,
                   s_contract_activity_20.NHI,
                   s_contract_activity_20.dim_patient_key,
                   s_contract_activity_20.dim_admin_category_key,
                   s_contract_activity_20.admin_category_reference_no,
                   s_contract_activity_20.purchaser,
                   s_contract_activity_20.contract_admit_type,
                   s_contract_activity_20.IDF_class,
                   s_contract_activity_20.purchase_unit_code,
                   s_contract_activity_20.purchase_unit_volume,
                   s_contract_activity_20.estimated_purchase_unit_volume,
                   s_contract_activity_20.actual_cost,
                   s_contract_activity_20.budget_cost,
                   s_contract_activity_20.MHOP_cost,
                   s_contract_activity_20.AMED_cost,
                   s_contract_activity_20.SURG_cost,
                   s_contract_activity_20.CWF_cost,
                   s_contract_activity_20.ESC_cost,
                   s_contract_activity_20.OTH_cost,
                   s_contract_activity_20.funded_activity_flag,
                   s_contract_activity_20.costed_activity_flag,
                   s_contract_activity_20.estimated_activity_flag,
                   s_contract_activity_20.events_with_purchase_unit_volume_flag,
                   s_contract_activity_20.planned_price,
                   s_contract_activity_20.revenue,
                   s_contract_activity_20.clinician_reference_no,
                   s_contract_activity_20.dim_age_group_key,
                   IFNULL(s_contract_activity_20.dim_planned_care_key,0),
                   s_contract_activity_20.dim_contract_line_key,
                   s_contract_activity_20.pvs_id,
                   s_contract_activity_20.dim_admission_type_key,
                   s_contract_activity_20.dim_contract_reporting_date_key,
                   s_contract_activity_20.dim_clinician_key,
                   s_contract_activity_20.dss_update_time
              FROM dbo.s_contract_activity_20 s_contract_activity_20
             INNER JOIN dim.dim_contract_reporting_date
                ON s_contract_activity_20.dim_contract_reporting_date_key = dim_contract_reporting_date.dim_contract_reporting_date_key
             WHERE contract_reporting_fin_year_offset IN (0, 1,2,3,4)
        dependencies:
          - locationName: TGT
            nodeName: S_CONTRACT_ACTIVITY_20
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_CONTRACT_ACTIVITY_20') }}
        name: S_CONTRACT_ACTIVITY_ARCHIVE_V
        noLinkRefs: []
  name: S_CONTRACT_ACTIVITY_ARCHIVE_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
