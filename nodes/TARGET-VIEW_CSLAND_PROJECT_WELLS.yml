fileVersion: 1
id: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
name: VIEW_CSLAND_PROJECT_WELLS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1640f551-6083-4613-9eb0-e746aff7e247
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Project Code
        name: PROJECT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3825e0f-a149-43d5-ac8c-a70790a28cbe
                stepCounter: 718936f3-32d5-47ca-a017-b1de5d82f663
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ed782e5-9a2a-4226-8e5a-54a6577f59af
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Project Description
        name: PROJECT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fea0e180-aa43-4886-a6aa-0cb063b14581
                stepCounter: 718936f3-32d5-47ca-a017-b1de5d82f663
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e44d1f0-8880-4122-b3e8-aa75dcc0fe3f
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Owner
        name: OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a0aa566-91c0-499a-89a8-ee7873c2ad08
                stepCounter: 718936f3-32d5-47ca-a017-b1de5d82f663
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21d0a625-0f9c-41c9-a755-2d85644ae20a
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Closed Flag
        name: CLOSED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da09b02d-9010-4836-8b65-74aca6fd84e1
                stepCounter: 718936f3-32d5-47ca-a017-b1de5d82f663
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c42f454e-355e-487a-a2b6-0d2f36a17bfb
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Shared Flag
        name: SHARED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bead0bd-998a-42c3-ab65-a29246303e30
                stepCounter: 718936f3-32d5-47ca-a017-b1de5d82f663
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0108309c-0793-4b56-afbc-74cc956634a3
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Create Date
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef49c7cd-8ecc-46df-9374-7850a67c8b88
                stepCounter: 718936f3-32d5-47ca-a017-b1de5d82f663
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04f9064c-18b9-4a60-9feb-06e6f74e8ebc
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Update Date
        name: UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b95d32d3-0eab-49f7-ac80-e830aef069fd
                stepCounter: 718936f3-32d5-47ca-a017-b1de5d82f663
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 359d4538-21d9-4c60-8f8a-7d358fe28a1f
          stepCounter: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        config: {}
        dataType: CHAR(10)
        defaultValue: ""
        description: WELL_FILE_KEY
        name: WELL_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d09944b3-47c0-4d7d-ba88-3e986f377b88
                stepCounter: 5d4d9cc5-17ca-47c4-81da-8f256500ce91
            transform: TRIM(ODS_CSLAND_QB_PROJ_DOC.FILE_NUMBER)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_PROJECT_WELLS: c8b33adf-3d4e-44f0-a0d7-4843f56b8150
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_PROJECT_WELLS') }} AS SELECT QP.CODE "PROJECT_CODE",
                   QP.DESCRIPTION "PROJECT_DESC",
                   QP.OWNER,
                   QP.CREATE_DATE,
                   QP.UPDATE_DATE,
                   TRIM(QPD.FILE_NUMBER) "WELL_FILE_KEY"
              FROM DS_CSLAND.QB_PROJECT QP,
                   DS_CSLAND.QB_PROJ_DOC QPD
             WHERE QP.CODE = QPD.CODE
               AND QPD.SUBSYSTEM = 'W'
               AND QP.TYPE = 'Exchange'
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_QB_PROJECT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_QB_PROJECT') }}
        name: VIEW_CSLAND_PROJECT_WELLS
        noLinkRefs: []
  name: VIEW_CSLAND_PROJECT_WELLS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
