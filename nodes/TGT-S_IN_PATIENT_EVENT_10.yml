fileVersion: 1
id: 3785c411-0818-4b5e-9d42-9d553d84ebd6
name: S_IN_PATIENT_EVENT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9936460e-5402-4227-b126-c13a0fc4a57b
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1c7a3a3-1474-4270-ae9b-54e5b66ee6e1
                stepCounter: a7d7c8ec-88ee-49a8-b500-e3f4bce83e59
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61fcaf1e-5758-41ab-8a69-803d32d7a5e0
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98c9bdfa-1455-4c81-8336-1fc71694c387
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 099445b6-89ce-45e8-a2f6-d67791230080
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fcf5f43-b303-4c9d-a7b1-7e649a7116f2
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83b5e08b-0065-4efd-8945-e1e294fc8441
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74694608-ed5b-438b-9b08-e0e972211172
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69cf65ef-5c41-40ba-8d2a-0e916d30b0d0
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf7c8b3-5813-4be7-a8ca-91b0073451b4
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8e06324-f9df-4568-8432-51db24b9ddf1
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab525339-3f36-4625-ba0c-d207897f094b
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0320580-fa5f-45c0-aef2-24aec85780aa
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b28c51b0-cd37-4465-8144-44f2398d8224
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8882df74-5465-4917-9970-62e8e4d93f44
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: event_Service_Point_Code
        name: EVENT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee6c2a6a-8eea-41b0-a225-a6e82680d696
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 115c14ce-e2f2-482a-a9b2-df1d2f15f74b
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Hospital Code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16b53f41-91de-4daa-b4b3-25b663ca0e3f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b1db80c-6611-4f5b-bbef-0cd334ed414a
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c58a79f9-b36f-4d77-96b1-8522082fb8f7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8e599f4-8309-4d1b-b4d0-1ed0bb6904e1
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7c8a94c-af9d-470f-966d-88ae1a833501
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf1991b0-3487-42a1-beb5-5ecc4b5d7114
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: event_Healthcare_Professional_Code
        name: EVENT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393c87d-2bfd-47b3-a557-82745248467a
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 041d803a-d267-4a13-84c1-428a9fcee1f6
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39a62472-7f46-4c36-80b0-fe2f95d9a133
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9437b947-083f-4a8a-8ae3-57a302c17d39
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1c9edf2-e55b-46f3-9464-4cbe977b3f01
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00df2ab2-272a-419c-b20f-ebb4bbd5039e
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1bccc70-afad-441c-a6f9-e721817241ab
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bbe98a6-18e1-4bf4-b0ef-6b88d3a01552
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_NZNHI_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a3ffb22-f7a3-4df8-9fe4-7285c5ae4896
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5425c16a-9b29-48b1-91b4-8324c8230d1f
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5497274-7fd4-4878-a066-a23766ee8d9f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 138fbc99-5677-4afd-99d1-c80c82ba942a
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecf9779b-ad0b-470f-8881-b794a1903167
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91f6381a-f792-4478-8004-dab41231e6ca
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: READMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9686351d-558c-45b5-878b-35d28c320882
                stepCounter: 9b060604-ca06-4eef-aaf1-8957f2377d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25bb084e-5087-4487-a5cb-a54a40aa63aa
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69b40d53-2c6b-48dc-becd-806736ee9ce1
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cf27f55-7d8f-4314-b12e-a2eeec361628
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fbcaac3-c9ea-4689-b237-daf4ed8d434c
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc86e373-13b5-4ff8-99a5-ee6fd4e41304
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_10.dismt_refno=dim_discharge_method.discharge_method_reference_no
        name: DIM_DISCHARGE_METHOD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cfc7a5d-1a68-40a3-8031-dd6da6eb8ba9
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 692dc925-9dce-47ef-918b-4d443b029c59
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63829b4b-cb50-47c5-b8fc-df3a7548d9af
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2253459-f0c6-4838-8d1c-2de66d9ff53a
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DISCHARGE_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa9aae31-f7f7-49d4-9617-78164feef740
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2952ab3f-3060-46ee-b8f8-b8c6384ba496
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8b97822-0c69-4a6b-9e0a-2bee42184d54
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cbefc88-ce92-4128-aec6-c2f68addf57f
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e81e90d-61f7-407c-8b2d-ae8078e437d1
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d1d99aa-8217-456c-9564-74a618e07d11
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: feea49b4-8128-41d0-9de3-1592657afa2a
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fc6e4eb-3c46-429d-aabf-7fcc7d51e1d9
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Carer Episode Outcome
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcadbf95-d811-4af8-b135-1ca85299ab2e
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbd31b40-cdfb-4c9a-8157-92df073839a8
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7768d9b8-aa45-40e4-9779-cfd739613c8f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bfe8bd5-32f3-4e3a-8317-2dbb37c30830
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27f00db8-2d2e-4b8b-ad38-ef06e950274e
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c82de99-954c-4ae0-98c4-55fadabac357
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bee74354-ee9d-46b5-89f4-ac3f13933701
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b820416-07dd-40f6-bf40-b709178c9b29
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 462a8519-8ed8-4978-9df5-d758e6e21e22
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 933b2282-b9b8-4117-9bd3-56dce1d4eee0
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cc8d360-c57c-41f4-9119-af0a40c41d34
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bcb0406-0ba5-4ac7-ad55-12b5d3cabe8b
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295ae3d6-ddda-4729-ac1b-c39a15307255
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 371d4146-583e-4a29-a299-516b8e56c05b
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59e0947f-cea2-4eab-949c-3d4307c3c7c7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              'W' +
              CONVERT (varchar (15),s_in_patient_event_05.Wlist_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ca119d9-7f7b-4050-9f38-768df9f7f176
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbe6ecb9-7401-426c-b229-b5818a137e3f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbda8ddb-0785-4665-9469-a053d7e2b4fd
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78ab5f53-3e3d-4afa-83d7-37d1362fe2ea
                stepCounter: 27157083-4019-40ef-b39f-a70b955092ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db7a4df8-9c0e-4b54-bc50-125f60436933
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: waitlist removal reason
        name: REMVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f7d63ce-59d0-4395-b749-aa36a45bd93e
                stepCounter: 27157083-4019-40ef-b39f-a70b955092ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b34bf60e-043e-4948-8228-29671d5ea15b
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 263f8471-1673-4278-ba19-c9bce9bf9e20
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3bb1f13-021d-4e0d-90a5-5ba1740b3440
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11b6a651-b890-41c5-b4f9-b2df96a3f55b
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52a89df9-703f-4162-9116-370761847c8f
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DSINF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e29faa1-00cf-4ac6-9df8-991e3a42870f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a2651d1-60a9-4f13-8a78-8f5e01ca667d
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHAB_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7c534c2-46c2-4217-ac41-74d013fe8a1b
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c81ac44-945a-47a3-ac6d-09fb55092df1
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8755b653-4af7-45ac-95ed-1e2e7134f7a8
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21abc728-6580-4219-828e-4a03174e69d1
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01c61f5c-21f8-498c-8a9a-3bf9fc714db7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c07d8de-483b-446b-a36c-c34f42dcffa7
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3978b2dc-2299-422d-a614-f8a65504fa1f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e09b7878-ecb8-481f-8356-90d6270fc289
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 090bca98-923c-4b92-8dbd-f7c0d7ba726c
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 310b4518-459e-4054-b765-ae1916cf5e8f
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ef1f2d-92a2-4333-bbcb-124b1cf92449
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7531fc0-ed03-4b72-8581-b910afb1e7be
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80dd2f2e-5f47-4289-9059-69f1b24f8808
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cc03a5a-0fc7-48d7-bb66-ed5a45f3508e
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a0d5a12-1979-4f2c-8064-624c175d8d47
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cabc3ed4-5a8b-4184-9901-f84715f9b5b8
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27dcf166-804f-4bd5-a220-964a1de5fe5a
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00803c1f-550d-4585-a405-68dc2cd2130c
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f38350be-9dd7-4f8e-9d9f-d36cdc7a2324
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f540708-08dd-451e-a08d-4e61b1a3086b
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7af34b7-c83a-4e87-8944-073f7db2aa5e
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f97bcdcb-980b-4c07-b91c-ac0aa9efdcbe
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7e94618-3be4-4955-b0fa-012712934b20
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78a3370d-9177-402f-a69b-ed71937634d2
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2dc4499-9f03-4e46-b53f-3a5f136c2620
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e837345-cdca-446f-9818-f0231733b4bb
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d93b2937-11d9-4c62-830e-93d1bd615268
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ad4c740-1a4d-4d09-86cd-7155c763d553
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed69dd6-9b73-4dcb-aaa0-111d9c0d185e
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ff6b011-960f-46d8-8948-4656b615e2fa
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 932359c7-5f56-487c-b0c4-d9a490011eac
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280d02de-f94f-49ab-9ceb-dbee9d3855a0
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac5c57f1-f417-470d-ae1d-593e3e85a2b2
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7510e2a9-4ca4-4b65-858e-f5ae55a5fe99
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79b60fee-3208-4e0e-821a-595c5aa7af77
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b113a0ee-c39c-4645-b322-d6fc9e8e91db
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97dd07fb-88fd-40df-9532-b221c9d1b9ac
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ED_FIRST_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 253700b2-3414-4471-a249-4f5f369c63d7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              CASE WHEN s_in_patient_event_05.aeatt_refno IS NOT NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57e5270d-240c-4885-a53b-7f3b3cc4acde
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 253700b2-3414-4471-a249-4f5f369c63d7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd0950f2-999b-483e-a928-ad51430e4ff0
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3490906-6f48-4084-913d-5535ca85a478
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea8ed4d5-b8d6-454f-8fb8-fc564798b41c
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5575a982-f3a4-441e-be84-490232d53b24
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e513d868-ff48-42f9-96c1-7476cab15a09
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1d761e5-2a79-4e24-8644-333c311598eb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f49d4e6a-9579-4c84-b025-fe6c38cb5ca9
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16a63032-3f00-40bb-ad05-c545bbb88f61
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d54e3b82-b480-4864-b087-999153073f8e
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cfdbc61-95a7-4bf6-b56e-cb882fd0daee
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ff7f811-5ca8-48f5-bdf5-555f2e3a9689
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GASTROSCOPY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b6feb9a-0f70-4648-a649-014c17b01118
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: IFNULL(s_in_patient_event_05.gastroscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5392d9d0-ad9d-4c82-9c8a-42e00726b5df
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COLONOSCOPY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6553d50c-62b9-490f-8a53-1e244d475a13
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: IFNULL(s_in_patient_event_05.colonoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 856f22a0-36a1-469f-a5bc-8a80dc27bd12
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CYSTOSCOPY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c392d333-d93d-4b8f-b594-4d965d3cbe40
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: IFNULL(s_in_patient_event_05.cystoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c846f287-34fa-4d32-b828-369dd845ac0a
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: sets up the SCBU flag based on DRG. Flag is adjusted depending on whether a patient passes through SCBU too.
        name: SCBU_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f19d25b3-0684-4840-8edd-13d4798e5443
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              -- SCBU_flag now calculated in event_05
              --CASE WHEN
              --REPLACE(IFNULL(NULLIF(s_in_patient_event_05.purchase_unit_code,'EXCLU'),s_in_patient_event_05.excluded_purchase_unit_code),'.','0')  ='W06003' then 'Y'
              --ELSE 'N'
              --END
              s_in_patient_event_05.scbu_flag
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f412d7b-43df-4a19-a152-61898d05e2f1
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SKIN_LESION_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04e8cd97-c576-4a78-adc7-d269011b177f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: IFNULL(s_in_patient_event_05.skin_lesion_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8160b21-9f5c-4a06-8de9-470732f64d8a
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COLPOSCOPY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e52f256-0b8c-4456-8c30-426d235fa4c9
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: IFNULL(s_in_patient_event_05.colposcopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11427224-1af5-4e3d-8d22-35d2baa6d289
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a bronchoscopy
        name: BRONCHOSCOPY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb24a382-a162-487c-9f87-7bb71e12553c
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 370dc19e-ee7b-4c12-80f4-9232b344e755
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a hysteroscopy
        name: HYSTEROSCOPY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8873d7ed-293c-4547-8707-9dfa97dac8ec
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e853462-9cfc-461a-81d1-9fe211fee293
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: package_of_care_flag
        name: PACKAGE_OF_CARE_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f7a7183-9900-497e-81c7-293d419c3c5f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c1518fe-067d-4dc1-84d2-0e834d5ff53a
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc9e1107-8027-4dfe-8126-a1d1dca9f943
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 432a737d-bf28-4c90-83ca-ac9fc07ee482
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8126f6-148a-432e-86c9-ca55b195c0c5
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1038d837-54ef-4fbb-95f2-b969113efd2c
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62f38507-7f66-45f7-b6b7-4d3d5044b347
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6815dd9-cc2f-43dd-8c42-1c016fff88b2
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1357976-ac3f-4530-bd51-f80572a57e09
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa0b6f4-7aac-4da4-aa7d-9ed3b5adb12e
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469304df-ebef-4b86-b936-ae5707c5b101
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a302556-c72a-4718-b06a-001d7196a0af
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d649d141-3afb-4fee-b79e-69e0548a3f71
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 280f8782-a481-4aa2-80f0-1999e1c94fe9
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d01d3af5-2186-4bd6-9d6f-349f6a2e7161
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: IFNULL(s_in_patient_leave_05.event_leave_total_duration_minutes,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfdff60a-94eb-48ee-a17e-17a5d29b33e6
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47d9a746-30c8-41f8-af7d-7ccfec8f3536
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2771ce3-37e0-4952-ba2b-93d73fbc4997
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d270edf8-50ad-41d8-a51b-d674079f00de
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cc20d18-3b29-48af-8b78-41efeaab5ecd
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1b024af-bf82-4ca1-b120-7c2776119aca
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cf9e3b6-25cc-4f29-8679-71a46fd91d36
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e524c59d-aac6-463e-9765-085b9e9c19cf
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 534297c7-a3e0-41b2-b508-a2c7d8fb60c1
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30df8e89-da37-4186-b8b2-135210fdc882
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4af7dd1b-2f38-4aae-bd3d-09fba680a7a1
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f461eae-fb4c-4efc-87f9-8db35785d92d
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4448224-8c69-421b-b5af-146b25cf9f48
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd4b33d2-c40e-4fc4-b4a5-22effab07235
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 516095fa-749b-4b79-ba84-ec75102bb393
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cd92ce5-5c43-46c7-9761-1dc8b74d5a5f
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Updated by custom procedure.
        name: DEFAULT_PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f352b39b-a659-4d79-98b9-7e4dd0a60af2
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b217983d-440d-4de8-a4e6-c8904077144e
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Updated by custom procedure.
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28a2ff3b-5729-4ac7-adac-fa3742fadb5f
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7924ec2e-2f80-4935-97d5-f6a83e8b1a68
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Updated by custom procedure.
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ce43525-4831-462c-990c-000ae6ec9f76
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 344c94fe-2fde-4e46-ba61-1e2ab92275b0
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event identifier for the MoH OS3 ALOS measure that connects across events.  The event use is the last event in the sequence.
        name: OS3_MASTER_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1b50552-6f30-42e8-94a4-1a0adb006400
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5a2005e-f2de-4275-a54c-f659cb5ec8f3
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: INT
        defaultValue: ""
        description: OS3 Event sequence 1= the first event in the series
        name: OS3_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ecbac42-ce5e-4563-9748-82373390e5f2
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65dcb38f-043b-4130-a627-60daa497782f
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Event LOS in 30 minute units for the MoH OS3 ALOS measure that connects across events.  '
        name: OS3_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96d4b1f6-9f51-4992-86c7-0607350f5c9a
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0a2a4c9-ef87-4310-9e4c-97a82a988f1d
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffa78124-c4ea-40c1-8ca9-abe02ae0b99a
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2be9d50f-e87c-42f5-9e1f-a24fe2b5b85a
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 528bf8de-ce38-42c2-9d2f-d6d229bec1b8
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70439a3f-bb0c-4ebc-9874-f4e3ef7b0bb7
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Clinician notes for the encounter.
        name: ADMISSION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2757ebcf-cd06-4adb-b522-f524f9ca5a9d
                stepCounter: a16650f8-dc64-4756-986a-73c08dc6cc2e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edc6c7d7-d854-45bc-8aea-b0d3f2055c68
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47d7a5b3-9101-4393-b903-fc04a5d34915
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              CASE WHEN s_in_patient_event_05.prvsp_refno IN -- junk encounters
               (1000667703, 1000562057, 1000499947,1000479157,1000361328,1000347881,1000312169,1000269004)  THEN 'JUNK'
                          WHEN s_in_patient_event_05.admit_date <> s_in_patient_event_05.admit_date_orig OR s_in_patient_event_05.disch_date <> s_in_patient_event_05.disch_date_orig THEN 'DT'
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7101138-db7a-4264-9614-9c79a4982b1d
          stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_SHARED_WAITLIST: 27157083-4019-40ef-b39f-a70b955092ef
          DS_SHARED_REFERRAL: 32661289-2246-4a7c-a2ad-9907fdccd6ac
          S_IP_NOTE: a16650f8-dc64-4756-986a-73c08dc6cc2e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_INPATIENT_CHANGES
          - locationName: TGT
            nodeName: DS_SHARED_WAITLIST
          - locationName: TGT
            nodeName: DS_SHARED_REFERRAL
          - locationName: TGT
            nodeName: S_IP_NOTE
        join:
          joinCondition: |-
            FROM s_inpatient_changes
              JOIN s_in_patient_event_05
                ON s_in_patient_event_05.prvsp_refno = s_inpatient_changes.prvsp_refno
              LEFT OUTER JOIN dim.dim_specialty
                ON s_in_patient_event_05.spect_refno = dim_specialty.specialty_reference_no
               AND dim_specialty.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_readmission_type
                ON s_in_patient_event_05.readm_refno = dim_readmission_type.readmission_type_reference_no
               AND dim_readmission_type.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_healthcare_professional
                ON s_in_patient_event_05.proca_refno = dim_healthcare_professional.healthcare_professional_reference_no
               AND dim_healthcare_professional.dss_current_flag = 'Y'
              LEFT OUTER JOIN ds_pims_ae_attendances
                ON s_in_patient_event_05.aeatt_refno = ds_pims_ae_attendances.aeatt_refno
              LEFT OUTER JOIN s_in_patient_leave_05
                ON s_in_patient_event_05.event_encounter_id = s_in_patient_leave_05.event_encounter_id
               AND s_in_patient_leave_05.event_leave_seq_num = 1
              LEFT OUTER JOIN {{ ref('TGT','DS_SHARED_WAITLIST') }}
                ON s_in_patient_event_05.wlist_refno = ds_shared_waitlist.wlist_refno
              LEFT OUTER JOIN {{ ref('TGT','DS_SHARED_REFERRAL') }}
                ON s_in_patient_event_05.refrl_refno = ds_shared_referral.refrl_refno
              LEFT OUTER JOIN {{ ref('TGT','S_IP_NOTE') }}
                ON s_ip_note.sorce_refno = s_in_patient_event_05.prvsp_refno
               AND s_ip_note.row_num = 1
        name: S_IN_PATIENT_EVENT_10
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
