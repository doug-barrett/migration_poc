fileVersion: 1
id: 84473ec9-a596-430a-8f11-0ac20d944096
name: STAGE_BUDGET
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2e5a8b6-8a5f-44cb-8426-5bb7bd2d4e06
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_COST_CENTER_KEY
        name: DIM_COST_CENTER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(dim_LO_cost_center.dim_cost_center_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5ab0ea0-d5ad-487f-86cc-60af4a8b1969
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_DEST_ORGANIZATION_KEY
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(dim_lo_dest_organization.dim_dest_organization_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaa49cb9-0175-40de-ab62-b1c9ccbee9f4
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_GL_ACCOUNT_KEY
        name: DIM_GL_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b1137a0-e68b-4ed8-bb3d-6c58b03049ba
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_BUDGET.GROSS_OR_NET_CODE=DIM_LO_GROSS_NET.GROSS_OR_NET_CODE
        name: DIM_GROSS_NET_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_GROSS_NET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d8f843a-5b1c-48f1-b2f4-48bdd375d949
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_AFE_TYPE_KEY
        name: DIM_AFE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_AFE_TYPE.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a9f8139-fec3-4dff-8245-ab72eb1b048b
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_ACTVY_PER_DATE_KEY
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e373b-de8b-4551-8b62-2ed775a78443
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACTVY_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38cbb02f-5ac4-4bbe-9e8b-1d3593f79c5f
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_ACCT_PER_DATE_KEY
        name: DIM_ACCT_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eda27173-894d-4c50-9ef8-0120664b0c67
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACCT_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd9fb3da-0eaa-451f-ad9e-db94140c15a1
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_BUDGET_VERSION_KEY
        name: DIM_BUDGET_VERSION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_BUDGET_VERSION.DIM_BUDGET_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca813a43-339a-421c-b1c3-44d6a20a540f
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: DATE
        defaultValue: ""
        description: DIM_ACTVY_PER_DATE
        name: DIM_ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e373b-de8b-4551-8b62-2ed775a78443
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78de98bd-c80c-47e8-aadf-ac8e9a1d4581
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: DATE
        defaultValue: ""
        description: DIM_ACCT_PER_DATE
        name: DIM_ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eda27173-894d-4c50-9ef8-0120664b0c67
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 049604c3-ee21-4526-aebe-fd0450591570
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: System Generated IDX
        isBusinessKey: true
        name: IDX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e3ec215-e087-4836-8b38-2cd309e3cb84
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d05cda27-d278-45f0-885f-cc4d2e56d2a9
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: LINE_NO
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(UPPER(DIM_LO_GL_ACCOUNT.MINOR_ACCT),'CLR',NULL, DIM_LO_LEASE_OPS_HIER.LINE_NO)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c861ea07-1fde-4ead-8192-39e46be787c8
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: VERSION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1c46861-a848-4d48-9c2f-3d3ca78ea743
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: DIM_GL_ACCOUNT.ACCT_GROUP_CODE
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f90925c7-6f6f-4595-a3af-e83ae891c629
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3c1d790-29e0-43b5-a831-9db10d402ff8
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: DIM_COST_CENTER.CC_NUM
        name: COST_CENTRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ad71d33-707b-441d-a2e9-c4edb062b6dc
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c780e34-d8cb-4324-9688-0aacbd7ab294
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: DIM_GL_ACCOUNT.GROSS_OR_NET_CODE
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_GL_ACCOUNT.GROSS_OR_NET_CODE,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79771c4e-dd77-4137-ac6a-fcb9b6bb3ad4
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Flipsign applied for GL/AFE items that are supplied as positives in the Budget process but negative in the Financial context
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b10cb356-2d6c-4fcb-87aa-03f0b23f06b7
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fbf55a9-3890-4649-a4ae-dad3cd25da60
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: LINE_ITEMS.ORG_REP_CURR_AMT
        name: GLOP_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b10cb356-2d6c-4fcb-87aa-03f0b23f06b7
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20b51d47-7e08-46a7-9e3f-6c311a699bfe
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: LINE_ITEMS.ORG_REP_CURR_AMT
        name: GLOP_EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0849049c-c7c7-4849-b910-d873d05f9c2b
                stepCounter: 9bb59105-be11-44bf-8ca3-0f995e0fc39a
            transform: 1/LOAD_BUDGET_R_VERSION_FX.FX_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 820e9564-39f2-43fc-824d-b689bae2c842
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_AMT
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fee04c4-25ec-4158-8746-fcbb5685930e
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.OP_AMT * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eb9d32f-4f86-43b3-91c5-22998e88b931
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: DEST_ORGANIZATION.OP_CURR_CODEâ€,
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61b138df-1cfe-44c9-b1f9-a24d72e1e964
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b2fd429-7a5f-4e7f-ab30-22aba5fa4b34
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.VOL * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d54a572-1650-4e92-a284-2ad98b307762
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3',LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,'BOE',LOAD_BUDGET_T_BUDGET.VOL ,'NM3',LOAD_BUDGET_T_BUDGET.VOL/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END)*nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,'IMP',(LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0))*nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93f5637a-8ef4-4dbd-b67c-ffee95120026
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3',DECODE (DIM_LO_PRODUCT_TYPE.PROD_CODE,'NGAS',LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.M3_THERMAL,0)/1000, LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.M3_THERMAL,0)) ,'NM3',LOAD_BUDGET_T_BUDGET.VOL/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END) ,'IMP',LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,'BOE',LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c327bbaa-a939-4069-9ed9-82993cfa7704
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3', CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN LI_VOL_m3/cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN LI_VOL_m3/cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE LI_VOL_m3 END ,'NM3',LOAD_BUDGET_T_BUDGET.VOL ,'IMP',(LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0))/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END) ,'BOE',(LOAD_BUDGET_T_BUDGET.VOL/NVL(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0))/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31a60ea3-3d85-4715-af61-a7da090eb06e
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3',LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,'IMP',LOAD_BUDGET_T_BUDGET.VOL ,'BOE',(LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0))*nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,'NM3', (LOAD_BUDGET_T_BUDGET.VOL*(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END))*nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 334faea4-a48a-4248-997e-c4c1242168ae
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: M3, NM3, BOE, IMPERIAL
        name: LI_VOL_UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03c8b92e-0248-4234-b77d-100776e7ebae
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 628ada2b-3d8d-41fd-8d76-6f5151f2b452
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c6196c7-8f17-4bad-98f9-f37f134760c0
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd4c8087-255b-42b8-8ec4-fabc855238d8
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: UPDATE_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7566e124-56df-4d54-be42-7907bdcf4a66
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e43c539-212e-4866-a022-d58597e4988f
          stepCounter: 84473ec9-a596-430a-8f11-0ac20d944096
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_BUDGET_T_BUDGET: 2e5d2f4e-0c64-4364-9b6d-df174925af08
          LOAD_BUDGET_R_VERSION_FX: 9bb59105-be11-44bf-8ca3-0f995e0fc39a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_COST_CENTER
          - locationName: TARGET
            nodeName: LOAD_BUDGET_T_BUDGET
          - locationName: UNKNOWN
            nodeName: DIM_LO_BUDGET_VERSION
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_VERSION_FX
          - locationName: UNKNOWN
            nodeName: DIM_LO_COST_CENTER
          - locationName: UNKNOWN
            nodeName: DIM_LO_DEST_ORGANIZATION
          - locationName: UNKNOWN
            nodeName: DIM_LO_GL_ACCOUNT
          - locationName: UNKNOWN
            nodeName: DIM_LO_GROSS_NET
          - locationName: UNKNOWN
            nodeName: DIM_LO_AFE_TYPE
          - locationName: UNKNOWN
            nodeName: DIM_LO_LEASE_OPS_HIER
          - locationName: UNKNOWN
            nodeName: DIM_LO_PRODUCT_TYPE
          - locationName: UNKNOWN
            nodeName: DIM_LO_CC_CORP_HIER_CURRENT
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','LOAD_BUDGET_T_BUDGET') }} LOAD_BUDGET_T_BUDGET
              JOIN {{ ref('UNKNOWN','DIM_LO_BUDGET_VERSION') }} DIM_LO_BUDGET_VERSION
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = DIM_LO_BUDGET_VERSION.IDX
               AND DIM_LO_BUDGET_VERSION.VERSION_TYPE='BUDGET'
              JOIN {{ ref('TARGET','LOAD_BUDGET_R_VERSION_FX') }} LOAD_BUDGET_R_VERSION_FX
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = LOAD_BUDGET_R_VERSION_FX.FK_R_VERSION_IDX
               AND LOAD_BUDGET_T_BUDGET.OP_CURR_CODE = LOAD_BUDGET_R_VERSION_FX.OP_CURR_CODE
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_COST_CENTER') }} DIM_LO_COST_CENTER
                ON LOAD_BUDGET_T_BUDGET.COST_CENTRE = DIM_LO_COST_CENTER.cc_num
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_DEST_ORGANIZATION') }} DIM_LO_DEST_ORGANIZATION
                ON LOAD_BUDGET_T_BUDGET.DEST_ORG_ID = DIM_LO_DEST_ORGANIZATION.org_id
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_GL_ACCOUNT') }} DIM_LO_GL_ACCOUNT
                ON LOAD_BUDGET_T_BUDGET.major_acct = DIM_LO_GL_ACCOUNT.major_acct
               AND LOAD_BUDGET_T_BUDGET.minor_acct = DIM_LO_GL_ACCOUNT.minor_acct
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_GROSS_NET') }} DIM_LO_GROSS_NET
                ON NVL(DIM_LO_GL_ACCOUNT.GROSS_OR_NET_CODE,'N') = DIM_LO_GROSS_NET.GROSS_OR_NET_CODE -- AFE based line item defaults to NET LEFT JOIN {{ ref('UNKNOWN','DIM_LO_AFE_TYPE') }} DIM_LO_AFE_TYPE      ON LOAD_BUDGET_T_BUDGET.AFE_TYPE = DIM_LO_AFE_TYPE.AFE_TYPE  LEFT JOIN {{ ref('UNKNOWN','DIM_LO_LEASE_OPS_HIER') }} DIM_LO_LEASE_OPS_HIER     ON NVL(DIM_LO_AFE_TYPE.LINE_NO ,DIM_LO_GL_ACCOUNT.LINE_NO) = DIM_LO_LEASE_OPS_HIER.LINE_NO LEFT JOIN {{ ref('UNKNOWN','DIM_LO_PRODUCT_TYPE') }} DIM_LO_PRODUCT_TYPE     ON DIM_LO_GL_ACCOUNT.prod_code = DIM_LO_PRODUCT_TYPE.prod_code LEFT JOIN {{ ref('UNKNOWN','DIM_LO_CC_CORP_HIER_CURRENT') }} DIM_LO_CC_CORP_HIER_CURRENT     ON DIM_LO_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY=DIM_LO_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
        name: STAGE_BUDGET
        noLinkRefs: []
  name: STAGE_BUDGET
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
