fileVersion: 1
id: c74012cc-622b-41c3-9cdd-66e224bdbfcc
name: STAGE_BUDGET
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d069a2e3-95fe-4b47-8c9d-f48be8061d18
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_COST_CENTER_KEY
        name: DIM_COST_CENTER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(dim_LO_cost_center.dim_cost_center_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c440a23d-553b-47ef-85d8-346142c4316c
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_DEST_ORGANIZATION_KEY
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(dim_lo_dest_organization.dim_dest_organization_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50be5ea4-19e8-47c0-aaef-67acf4769418
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_GL_ACCOUNT_KEY
        name: DIM_GL_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9979ec88-c251-405f-9545-19779dcea74b
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_BUDGET.GROSS_OR_NET_CODE=DIM_LO_GROSS_NET.GROSS_OR_NET_CODE
        name: DIM_GROSS_NET_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_GROSS_NET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b15d271b-a334-470b-be68-d2b91fa7ae44
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_AFE_TYPE_KEY
        name: DIM_AFE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_AFE_TYPE.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3bd0362-2c6d-4827-a32e-423b5191cb00
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_ACTVY_PER_DATE_KEY
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18508ec0-f5a9-459b-8ad8-f0c28c526bfa
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACTVY_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7852f6a0-a9e4-4590-abab-14413d46ddc9
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_ACCT_PER_DATE_KEY
        name: DIM_ACCT_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baed450f-b9d5-4c24-b58b-70311d96cd52
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACCT_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a8f9a1c-fe55-46fd-833f-3d186d6a1aa0
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: DIM_BUDGET_VERSION_KEY
        name: DIM_BUDGET_VERSION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_BUDGET_VERSION.DIM_BUDGET_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 975bd56b-4c22-4ed7-b45f-2b4ebafdac43
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: DIM_ACTVY_PER_DATE
        name: DIM_ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18508ec0-f5a9-459b-8ad8-f0c28c526bfa
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff01bed5-6fd2-4ada-ae09-d11367511a2a
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: DIM_ACCT_PER_DATE
        name: DIM_ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baed450f-b9d5-4c24-b58b-70311d96cd52
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aa16761-88a4-4d40-94f6-a96501b83278
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: System Generated IDX
        isBusinessKey: true
        name: IDX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bef85a22-8561-4d62-8309-c0e6f9a52301
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aefa7bbf-a292-49b7-931f-c0d87b076a02
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: LINE_NO
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(UPPER(DIM_LO_GL_ACCOUNT.MINOR_ACCT),'CLR',NULL, DIM_LO_LEASE_OPS_HIER.LINE_NO)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7edf4094-075c-44a7-b327-6e2c86ea3f44
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: VERSION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a9615eb-81f6-49f1-92b6-34d476c671e8
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: DIM_GL_ACCOUNT.ACCT_GROUP_CODE
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db03b84d-4c65-45f7-a6b7-5d046208412a
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91a5eab3-d20a-42b1-9795-d08e02a46cb0
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: DIM_COST_CENTER.CC_NUM
        name: COST_CENTRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d65bd398-b5ae-4691-a95e-8a20888ffd5d
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c2cf1c8-7939-49da-baf5-0d43e1b25a8c
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: DIM_GL_ACCOUNT.GROSS_OR_NET_CODE
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DIM_LO_GL_ACCOUNT.GROSS_OR_NET_CODE,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6b08d32-d401-4c91-b643-26dd05b275f1
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Flipsign applied for GL/AFE items that are supplied as positives in the Budget process but negative in the Financial context
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b1caede-1a51-4a8e-bf79-9b0f66123763
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e0624a6-9b15-4fff-8818-8873f9325c45
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: LINE_ITEMS.ORG_REP_CURR_AMT
        name: GLOP_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b1caede-1a51-4a8e-bf79-9b0f66123763
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f034bba-b69d-4b27-b54a-a0ccb419e88f
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: LINE_ITEMS.ORG_REP_CURR_AMT
        name: GLOP_EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fa1e507-b5d7-4f1e-a169-f42c94664858
                stepCounter: be7a3a5f-199b-4588-a06a-4701f7a8b755
            transform: 1/LOAD_BUDGET_R_VERSION_FX.FX_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39ec02f3-e98f-40c0-8e67-6ddec9afc655
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_AMT
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a944a6c1-d453-43e3-a4ca-d0910c229d9e
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.OP_AMT * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8825c7bb-f5b9-474e-b88d-225fca705aee
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: DEST_ORGANIZATION.OP_CURR_CODEâ€,
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfb1095d-a4f5-45f3-8d82-f10b3f33f727
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f2dcac7-3045-482f-98d9-a6f684b67c42
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.VOL * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a19ea77f-e051-4a97-a055-3cec3645924b
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3',LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,'BOE',LOAD_BUDGET_T_BUDGET.VOL ,'NM3',LOAD_BUDGET_T_BUDGET.VOL/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END)*nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,'IMP',(LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0))*nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c929a69-baf1-4a18-95c8-744d0d4003a5
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3',DECODE (DIM_LO_PRODUCT_TYPE.PROD_CODE,'NGAS',LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.M3_THERMAL,0)/1000, LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.M3_THERMAL,0)) ,'NM3',LOAD_BUDGET_T_BUDGET.VOL/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END) ,'IMP',LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,'BOE',LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4aed3c0-9431-46af-9e53-50112f56459f
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3', CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN LI_VOL_m3/cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN LI_VOL_m3/cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE LI_VOL_m3 END ,'NM3',LOAD_BUDGET_T_BUDGET.VOL ,'IMP',(LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0))/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END) ,'BOE',(LOAD_BUDGET_T_BUDGET.VOL/NVL(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0))/(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d025767b-d036-4fa8-a716-25f8cf60759a
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: DECODE (LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE, 'M3',LOAD_BUDGET_T_BUDGET.VOL*nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,'IMP',LOAD_BUDGET_T_BUDGET.VOL ,'BOE',(LOAD_BUDGET_T_BUDGET.VOL/nvl(DIM_LO_PRODUCT_TYPE.BOE_THERMAL,0))*nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,'NM3', (LOAD_BUDGET_T_BUDGET.VOL*(CASE WHEN length(DIM_LO_PRODUCT_TYPE.PROD_CODE)>3 AND SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,2,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) WHEN SUBSTR(DIM_LO_PRODUCT_TYPE.PROD_CODE,1,3) LIKE '%GAS' THEN cast('{{ parameters.gas_nm3_factor }}' AS decimal(8,5)) ELSE 1 END))*nvl(DIM_LO_PRODUCT_TYPE.SI_TO_IMP_CONV_FACTOR,0) ,NULL) * DIM_LO_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d0eec00-e066-44b3-9fae-f6f5d8e0ed78
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: M3, NM3, BOE, IMPERIAL
        name: LI_VOL_UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be6f579-4cc7-4ef7-8f68-efa800388b92
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7256b4d4-7dfa-44f5-8e5e-bda5d7858361
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55474ed6-44cb-4d6a-a3dd-60158097c45d
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d5d18cf-385a-472b-b0db-a83cb805c0ce
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: UPDATE_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4d31257-3f92-4b0f-bffb-21ff4c3e68c2
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e234c829-8c54-451b-9dca-b40163502e19
          stepCounter: c74012cc-622b-41c3-9cdd-66e224bdbfcc
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_BUDGET_T_BUDGET: 34296832-56af-448c-8aa3-b1417a68df43
          LOAD_BUDGET_R_VERSION_FX: be7a3a5f-199b-4588-a06a-4701f7a8b755
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_COST_CENTER
          - locationName: TARGET
            nodeName: LOAD_BUDGET_T_BUDGET
          - locationName: UNKNOWN
            nodeName: DIM_LO_BUDGET_VERSION
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_VERSION_FX
          - locationName: UNKNOWN
            nodeName: DIM_LO_COST_CENTER
          - locationName: UNKNOWN
            nodeName: DIM_LO_DEST_ORGANIZATION
          - locationName: UNKNOWN
            nodeName: DIM_LO_GL_ACCOUNT
          - locationName: UNKNOWN
            nodeName: DIM_LO_GROSS_NET
          - locationName: UNKNOWN
            nodeName: DIM_LO_AFE_TYPE
          - locationName: UNKNOWN
            nodeName: DIM_LO_LEASE_OPS_HIER
          - locationName: UNKNOWN
            nodeName: DIM_LO_PRODUCT_TYPE
          - locationName: UNKNOWN
            nodeName: DIM_LO_CC_CORP_HIER_CURRENT
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','LOAD_BUDGET_T_BUDGET') }} LOAD_BUDGET_T_BUDGET
              JOIN {{ ref('UNKNOWN','DIM_LO_BUDGET_VERSION') }} DIM_LO_BUDGET_VERSION
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = DIM_LO_BUDGET_VERSION.IDX
               AND DIM_LO_BUDGET_VERSION.VERSION_TYPE='BUDGET'
              JOIN {{ ref('TARGET','LOAD_BUDGET_R_VERSION_FX') }} LOAD_BUDGET_R_VERSION_FX
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = LOAD_BUDGET_R_VERSION_FX.FK_R_VERSION_IDX
               AND LOAD_BUDGET_T_BUDGET.OP_CURR_CODE = LOAD_BUDGET_R_VERSION_FX.OP_CURR_CODE
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_COST_CENTER') }} DIM_LO_COST_CENTER
                ON LOAD_BUDGET_T_BUDGET.COST_CENTRE = DIM_LO_COST_CENTER.cc_num
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_DEST_ORGANIZATION') }} DIM_LO_DEST_ORGANIZATION
                ON LOAD_BUDGET_T_BUDGET.DEST_ORG_ID = DIM_LO_DEST_ORGANIZATION.org_id
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_GL_ACCOUNT') }} DIM_LO_GL_ACCOUNT
                ON LOAD_BUDGET_T_BUDGET.major_acct = DIM_LO_GL_ACCOUNT.major_acct
               AND LOAD_BUDGET_T_BUDGET.minor_acct = DIM_LO_GL_ACCOUNT.minor_acct
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_GROSS_NET') }} DIM_LO_GROSS_NET
                ON NVL(DIM_LO_GL_ACCOUNT.GROSS_OR_NET_CODE,'N') = DIM_LO_GROSS_NET.GROSS_OR_NET_CODE -- AFE based line item defaults to NET LEFT JOIN {{ ref('UNKNOWN','DIM_LO_AFE_TYPE') }} DIM_LO_AFE_TYPE      ON LOAD_BUDGET_T_BUDGET.AFE_TYPE = DIM_LO_AFE_TYPE.AFE_TYPE  LEFT JOIN {{ ref('UNKNOWN','DIM_LO_LEASE_OPS_HIER') }} DIM_LO_LEASE_OPS_HIER     ON NVL(DIM_LO_AFE_TYPE.LINE_NO ,DIM_LO_GL_ACCOUNT.LINE_NO) = DIM_LO_LEASE_OPS_HIER.LINE_NO LEFT JOIN {{ ref('UNKNOWN','DIM_LO_PRODUCT_TYPE') }} DIM_LO_PRODUCT_TYPE     ON DIM_LO_GL_ACCOUNT.prod_code = DIM_LO_PRODUCT_TYPE.prod_code LEFT JOIN {{ ref('UNKNOWN','DIM_LO_CC_CORP_HIER_CURRENT') }} DIM_LO_CC_CORP_HIER_CURRENT     ON DIM_LO_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY=DIM_LO_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
        name: STAGE_BUDGET
        noLinkRefs: []
  name: STAGE_BUDGET
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
