fileVersion: 1
id: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
name: VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f082091-2258-4fe3-8a1c-57a3cf659424
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa554cce-aa4e-4c5e-bed7-4dd950e90af0
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8aacc73-ad23-4f3f-84ac-40ae05a95868
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bdbfeb3-13e8-442d-9aed-8d56112464b2
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5792a9a-2069-4858-8e9b-67d8e14ae916
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 449144c9-0612-47a3-aa8d-4d5a5839c450
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 209ea55c-e844-4ba2-81d0-75cb30fc1e84
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 290506b2-3b5c-43c9-adec-0c26685119a4
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 945d2db9-d254-465c-8eb6-47c208963863
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b55f17c-eaf7-41be-81e8-1511ca98facd
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b858adae-4f79-4219-be32-8e30d6cf333b
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96e616e8-f0da-466d-b452-9b2a4d91c15c
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dfbf611-8044-4023-9303-6d28ce396ab0
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28354c2e-d1a2-4efc-bb1a-b5f6a4b27b9f
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b857756-baaf-446b-99dc-3705a6c1d139
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8474c817-ed24-4714-9682-d81badbb4351
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 339bc49c-526a-465c-8238-60b140f32388
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 093df048-a345-4bba-8eea-252aa09a0aca
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 668f98d1-52c6-4e15-b6f9-a9f0448c33fa
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fee92307-11b5-4d28-8771-4ecdf5e7db4a
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4413a38-35dc-4b7f-963a-a99d31267b82
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c790732c-e794-40bb-8e30-4b67cbe4f242
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5266194c-0c5c-4ffd-a1e2-f73edae53e4a
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12007602-9bbe-4af8-abde-d0999aa59ede
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d25ada26-ef28-4a02-92c5-ec1ac7a0d0c8
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d54199f7-d275-4649-9560-3be3621d9a72
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0580cc05-9623-48cd-b439-ab6a7fdc178c
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c5c3f56-211b-42ec-8d06-95d79e12c0e5
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e617eb43-b007-4d4a-9e39-8654774fe539
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62cb0094-e7da-452e-8f75-9ff9d8b3de66
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29f70d2b-44fb-40c2-ace1-9569bdec6c83
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b01c50a-ac04-425e-b21f-e5c8179e2f83
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c19873da-3007-4607-8aa6-02e49498057d
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a7d28dc-0b23-4e35-96ff-b25bc6829d8d
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76cac64d-d99e-4ef1-97cc-e672b14bd54e
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f959cc5-3ea3-4513-a384-3f6a12348b17
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e69a27-9678-4325-b06c-88ddbd67e067
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9ba970b-ac96-4b7c-8370-2096939dfc22
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c724a735-8902-44db-b698-62eeb71e243b
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f5dd18-09b5-4487-ad3a-6817a2503576
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4264f345-af33-4cf4-ae91-fc53e91a5982
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 804440e4-1482-42db-bac9-b71d959cd343
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7bb2bd8-3340-4e58-8a20-23ee6f8c8e0d
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ff57042-ec29-40a6-911a-4381194ed0d3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b7cb2a8-1e1c-4f1e-883f-3122a97c2105
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57ac190f-0b4d-4c4b-bd49-e555a1aabaf2
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dd4eca1-23b7-48a3-9e16-25189a254e58
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6078465-1781-44f6-adc4-1e934e936b7c
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 102711e7-0c8f-4def-85b7-98acd8445111
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1be3a8bb-76c8-4664-b9d4-19eb4713fbfc
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09d5c249-00d2-428f-b66b-6047d4bd5806
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0674dc6e-63b4-4d3a-8131-bc3907e705a3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ff9d076-fa66-45f1-b23a-d0e9992528d7
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c62ff5f-a58f-4d28-8075-704b1093047d
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8432ab42-92ca-4a2a-8264-618258a81b2c
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65702267-8925-410a-9454-e0bf59cbbf7a
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84800970-4fad-4016-83fa-268eb5cc5eb9
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0b273ac-e043-4ee0-aa97-c4abedf67933
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58620edf-c383-4a9e-8697-f08af42a0f4d
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67c8011f-ba45-4a70-966f-00d4e76e0b8b
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97175a5f-937e-4df5-965a-02298f5410ef
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40fafa9f-a8b7-4bcc-8e13-66a7f61019b0
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45446965-7ab1-4b3d-8a83-23edad694f26
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f86f4da-6d89-462a-89fc-75cde9da0921
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e51e1200-32d6-4003-b0e5-70bcbc9616d4
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 851c7eae-5096-4b15-8011-3db81829235e
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8ba8ea3-a13c-466d-9fcc-b369c30fec1e
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d43bd47c-5d87-4e09-b17a-73883c60b1ba
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37b3f6fd-5ee8-4c5f-aaa2-612cefdb55a7
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9954d46-2cb8-4670-aaec-6163edd515ed
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11f424f4-a46f-4a8a-b25a-82565103da36
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0cbe89f-8732-4c49-af76-019e93819f99
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f4ad04f-8d11-4d64-ab29-d1cde0606cd3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ab579f9-6297-4302-a8bf-1bdc8fcfb02d
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67837649-9af0-4f7c-bb1d-6e00a8b067ef
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff0a1052-4893-49d5-b465-552039cb2f66
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b859f894-9247-4f45-9f3c-900bce2298af
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f0f9f0-52b2-4c99-9a4a-df30c4b607da
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72693e63-7f83-4aa6-86c9-0029bae791a1
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6ffe312-1a48-4aaa-b636-5767bb61faf9
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39aed6e2-9a56-469c-ad39-c62968146169
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f1d8b44-ec0b-4f2f-9dbb-68f98393b823
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5aab0e90-27b2-47c7-9f2a-ad083e3b5605
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82d381c0-8e2b-42e4-8dbc-f002d12203f2
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f4c84d-d4db-4498-9e72-6db8265679e8
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad9a5197-b941-4264-9816-ac9292d4cf0e
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fb3f2f1-11c6-421b-b4ce-fcbe13d35f4b
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76ad00b5-2d0d-4cd5-bfe3-c663d5783d5f
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40861f14-a125-4d5b-b8cd-c28365b8f583
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c1ccc02-a23d-4e0a-b5ed-f050925f4c5e
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a1b60b3-8960-48c2-b211-84851244251e
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37f8a081-47fb-42c3-8367-d585400cd763
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7ed3b96-5713-46a4-860d-e36689a815cc
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c185cef-13ba-41f8-8aad-6950de1925d7
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2e57b1e-2f63-41d1-945e-7ec44d90520a
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02660c81-3a73-4fed-9ade-8253f418e5df
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20d11f90-3b56-4fd2-bc69-cd63bd31ed9b
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7e95f3a-6dd2-43ea-a806-43f937906233
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e787b86-0833-42dc-b18b-6a12c83c26a9
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53b8a811-7810-4cda-a804-545105420070
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7092e5fd-4453-42a0-b468-74f666d0bf1b
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11401a9b-d596-4c61-a4a5-2523694adfce
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2801b4a-d5d2-4846-86df-f3cc02b7df59
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d501584-c861-4f31-b729-97b342446464
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e7b31d0-1ce8-45a4-9b65-5dfeee8ced70
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39812040-cf13-4958-bdc9-e4061d919575
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eecd1124-57ae-4381-9ff4-b9736bcae451
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a80618bb-cab1-4468-b2d5-a1b9b04109e6
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5647f4fa-c4cb-42d3-94ab-5f256aa8480b
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cb8b707-104a-4bb6-9633-f839d4456f07
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b383c3f2-e2c6-478c-8064-63de06be7cd2
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39fe52b8-b3fc-46f7-a4de-26e60a9462b5
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6854379a-0664-417c-b674-3ecb9385707d
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 079df523-a1fe-43ea-8623-77c01e6968ec
          stepCounter: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NORM_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH: 61c97f20-a5af-4ef6-ad3b-cc136478bd4a
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH') }} AS WITH MJ AS (
                    SELECT *
                      FROM (
                            SELECT DISTINCT(UNIT_NAME) AS WELL_NAME ,
                                   Try_Cast(CHILD_ACCOUNT AS float) AS CHILD_ACCOUNT_NUMBER ---pls keep this as float!!----
             ,
                                   Try_Cast(METER_NUMBER AS float) AS METER_NUMBER,
                                   COST_CENTER AS CC_NUM ,
                                   '' AS CC_NAME,
                                   Area AS AREA ,
                                   CORE_AREA AS CORE_AREA,
                                   PROVINCE ,
                                   FACILITY,
                                   FOREMAN ,
                                   '' AS RUN_NAME,
                                   '' AS BATTERY ,
                                   TYPE AS TYPE,
                                   'Non PV' AS SOURCE
                              FROM DS_POWER.NONPV_ENTITIES NPV
                             WHERE CHILD_ACCOUNT IS NOT NULL
                               AND COUNTRY='Germany'
                         UNION ALL SELECT DISTINCT(WELL_NAME),
                                   CHILD_ACCOUNT_NUMBER ,
                                   METER_NUMBER,
                                   COALESCE(CC_NUM, AREA) AS CC_NUM ,
                                   CC_NAME,
                                   AREA ,
                                   CORE_AREA,
                                   PROVINCE ,
                                   FACILITY,
                                   FOREMAN ,
                                   RUN_NAME,
                                   BATTERY ,
                                   WELL_TYPE AS TYPE,
                                   'ProdView' AS SOURCE
                              FROM WS_EDW.VIEW_FDC_PWRANALYTICS PV
                             WHERE COUNTRY = 'GERMANY'
                               AND CHILD_ACCOUNT_NUMBER IS NOT NULL
                           ) MJ3
                     CROSS JOIN DS_POWER.VET_DIMDATE M
                     WHERE Year(Date) > 2020
                       AND Year(Date) <= Year(GetDate())
                   ),
                   PV_AGG_A AS (
                    SELECT MJ.CHILD_ACCOUNT_NUMBER ,
                           MJ.DATE ,
                           Sum(IFNULL(PV.WATER_M3,0)) + Sum(IFNULL(PV.OIL_M3,0)) + Sum(IFNULL(PV.GAS_E3M3,0)) AS BOE ,
                           count(*) AS WELL_COUNT ,
                           1.00/count(*) AS WELLCOUNT_PRORATION
                      FROM MJ
                      LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV
                        ON MJ.WELL_NAME = PV.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01')))
                     GROUP BY MJ.CHILD_ACCOUNT_NUMBER,
                              MJ.Date
                   ),
                   PV AS (
                    SELECT MJ.WELL_NAME,
                           PV_W.UWI ,
                           IFNULL(PV_W.CC_NUM,MJ.CC_NUM) AS CC_NUM,
                           PV_W.CC_NAME ,
                           IFNULL(MJ.Province,PV_W.PROVINCE) AS PROVINCE,
                           IFNULL(MJ.CORE_AREA,PV_W.CORE_AREA) AS CORE_AREA ,
                           IFNULL(MJ.AREA,PV_W.AREA) AS AREA,
                           IFNULL(MJ.Foreman,PV_W.FOREMAN) AS FOREMAN ,
                           PV_W.RUN_NAME,
                           IFNULL(MJ.Facility,PV_W.FACILITY) AS FACILITY ,
                           PV_W.BATTERY,
                           PV_W.WELL_TYPE ,
                           PV_W.SURFACE_LOCATION,
                           PV_W.OPERATING_HOURS ,
                           PV_W.DOWNTIME_HOURS,
                           PV_W.ON_PROD_DATE ,
                           PV_W.LAST_PROD_DATE,
                           PV_W.PROD_YEAR ,
                           PV_W.PROD_MONTH,
                           PV_W.PROD_YEARMONTH ,
                           PV_W.WORKING_INTEREST,
                           PV_W.PUMP_TYPE ,
                           PV_W.METER_NUMBER,
                           MJ.CHILD_ACCOUNT_NUMBER AS CHILD_ACCOUNT_NUMBER ,
                           PV_W.FIELD_COMMENTS,
                           PV_W.SURFACE_LATITUDE ,
                           PV_W.SURFACE_LONGITUDE,
                           MJ.Date AS EOPRODMONTH ,
                           (datefromparts(Prod_year,right(cast(prod_yearmonth AS varchar),2),01)) AS FOM ,
                           IFNULL(PV_W.WATER_M3,0) AS WATER_M3,
                           IFNULL(PV_W.OIL_M3,0) AS OIL_M3 ,
                           PV_W.GAS_E3M3,
                           PV_W.OIL_BOE,
                           PV_W.GAS_BOE ,
                           IFNULL(PV_W.BOE,0) AS BOE,
                           PV_AGG_A.BOE AS TOTALBOE ,
                           PV_AGG_A.WELL_COUNT AS PV_WELL_COUNT,
                           PV_AGG_A.WELLCOUNT_PRORATION,
                           PV_AGG_A.WELL_COUNT ,
                           SOURCE ,
                           CASE WHEN PV_AGG_A.BOE = 0                                          THEN 1.00/PV_AGG_A.WELL_COUNT
                                WHEN PV_AGG_A.BOE IS NULL AND 1.00/PV_AGG_A.WELL_COUNT IS NULL THEN 1.00
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS PRORATION_BOE ,
                           CASE --No production  then divide equally ---

                                WHEN (IFNULL(PV_AGG_A.BOE,0) = 0 AND PV_AGG_A.WELL_COUNT >= 1) OR ((IFNULL(PV_W.WATER_M3,0)+IFNULL(PV_W.OIL_M3,0)+ IFNULL(PV_W.GAS_E3M3,0)) = 0 AND PV_AGG_A.WELL_COUNT >= 1) THEN 1.00/PV_AGG_A.WELL_COUNT ---else 1 ---

                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3+PV_W.GAS_E3M3)/PV_AGG_A.BOE
                                 END AS WELL_PRORATION
                      FROM MJ
                      LEFT JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV_W
                        ON MJ.Well_Name = PV_W.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),5,2), '-01')))
                      LEFT OUTER  JOIN PV_AGG_A
                        ON MJ.CHILD_ACCOUNT_NUMBER = PV_AGG_A.CHILD_ACCOUNT_NUMBER
                       AND MJ.Date = PV_AGG_A.Date
                   ),
                   Fin AS (
                    SELECT PB.COUNTRY ,
                           PV.PROVINCE AS PROVINCE ,
                           PB.LANGUAGE ,
                           PB.CURRENCY ,
                           UTILITY_PROVIDER ,
                           INVOICE_NUMBER ,
                           ACCOUNT_NUMBER ,
                           PB.DELIVERY_POINT ,
                           CONSUMPTION_MONTH ,
                           PB.METER_NUMBER AS METER_NUMBER ,
                           try_cast(PB.Cost_Center AS nvarchar(255))AS COST_CENTER ,
                           PV.CC_NAME AS CC_NAME ,
                           PV.CORE_AREA AS CORE_AREA ,
                           PV.AREA ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Total_Consumption_kWh
                                ELSE Total_Consumption_kWh
                                 END AS TOTAL_CONSUMPTION_KWH ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Peak_Consumption_kWh
                                ELSE Peak_Consumption_kWh
                                 END AS PEAK_CONSUMPTION_KWH ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Off_Peak_Consumption_kWh
                                ELSE Off_Peak_Consumption_kWh
                                 END AS OFF_PEAK_CONSUMPTION_KWH ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Registered_Demand_kVA
                                ELSE Registered_Demand_kVA
                                 END AS REGISTERED_DEMAND_KVA ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Billed_Demand_kVA
                                ELSE Billed_Demand_kVA
                                 END AS BILLED_DEMAND_KVA ,
                           CURRENT_METER_READ_DATE ,
                           CURRENT_METER_READ ,
                           PREVIOUS_METER_READ_DATE ,
                           PREVIOUS_METER_READ ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Total_Amount_Due
                                ELSE Total_Amount_Due
                                 END AS TOTAL_AMOUNT_DUE ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 = 0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                              THEN IFNULL(Well_Proration,0) *Subtotal
                                ELSE Subtotal
                                 END AS SUBTOTAL ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Energy_Cost
                                ELSE Energy_Cost
                                 END AS ENERGY_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Peak_Energy_Cost
                                ELSE Peak_Energy_Cost
                                 END AS PEAK_ENERGY_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Off_Peak_Energy_Cost
                                ELSE Off_Peak_Energy_Cost
                                 END AS OFF_PEAK_ENERGY_COST ,
                           pv.WELLCOUNT_PRORATION *Basic_Cost AS BASIC_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Demand_Cost
                                ELSE Demand_Cost
                                 END AS DEMAND_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Reactive_Cost
                                ELSE Reactive_Cost
                                 END AS REACTIVE_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Transmission_Cost
                                ELSE Transmission_Cost
                                 END AS TRANSMISSION_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Other_Cost
                                ELSE Other_Cost
                                 END AS OTHER_COST ,
                           SERVICE_ADDRESS ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Carbon_Tax
                                ELSE Carbon_Tax
                                 END AS CARBON_TAX ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Carbon_Tax_GST
                                ELSE Carbon_Tax_GST
                                 END AS CARBON_TAX_GST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Federal_Tax_GST
                                ELSE Federal_Tax_GST
                                 END AS FEDERAL_TAX ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *PST
                                ELSE PST
                                 END AS PST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *MST
                                ELSE MST
                                 END AS MST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *VAT
                                ELSE VAT
                                 END AS VAT ,
                           Cast(Meter_Type AS varchar) AS METER_TYPE ,
                           BILL_MULTIPLIER ,
                           RATE ,
                           POWER_FACTOR ,
                           PEAK_DEMAND ,
                           BILL_DAYS ----- Prodview ---------
             ,
                           PV.CC_NUM AS CC_NUM ,
                           PV.PROD_YEARMONTH ,
                           PV.Well_Name AS WELL_NAME ,
                           CASE WHEN PV.FOREMAN IS NULL THEN PV.FOREMAN
                                ELSE PV.FOREMAN
                                 END AS FOREMAN ,
                           PV.RUN_NAME ,
                           BATTERY ,
                           UWI ,
                           WELL_TYPE ,
                           PV.SURFACE_LOCATION ,
                           PV.SURFACE_LATITUDE ,
                           PV.SURFACE_LONGITUDE ,
                           PV.OPERATING_HOURS ,
                           PV.DOWNTIME_HOURS ,
                           PV.OIL_M3 ,
                           PV.WATER_M3 ,
                           PV.GAS_E3M3 ,
                           PV.OIL_BOE ,
                           PV.GAS_BOE ,
                           PV.BOE ,
                           CASE WHEN PV.FACILITY IS NULL THEN PV.FACILITY
                                ELSE PV.FACILITY
                                 END AS FACILITY ,
                           WORKING_INTEREST ,
                           PUMP_TYPE ,
                           PV.Source ,
                           (Well_Proration*(Energy_Cost + Demand_Cost + VAT + PST))+ (PV.WELLCOUNT_PRORATION*Basic_Cost) AS TOTAL_COST
                      FROM WS_EDW.VIEW_PWRANALYTICS_VET_POWER_MTH_UNION PB
                      LEFT JOIN PV
                        ON PV.CHILD_ACCOUNT_NUMBER = PB.DELIVERY_POINT
                       AND PV.FOM = (PB.CONSUMPTION_MONTH)
                     WHERE Country = 'Germany'
                   ) SELECT COUNTRY,
                   PROVINCE ,
                   LANGUAGE,
                   CURRENCY ,
                   UTILITY_PROVIDER,
                   INVOICE_NUMBER ,
                   ACCOUNT_NUMBER,
                   DELIVERY_POINT ,
                   CONSUMPTION_MONTH,
                   METER_NUMBER ,
                   COST_CENTER,
                   CC_NAME ,
                   CORE_AREA,
                   AREA ,
                   TOTAL_CONSUMPTION_KWH,
                   PEAK_CONSUMPTION_KWH ,
                   OFF_PEAK_CONSUMPTION_KWH,
                   REGISTERED_DEMAND_KVA ,
                   BILLED_DEMAND_KVA,
                   CURRENT_METER_READ_DATE ,
                   CURRENT_METER_READ,
                   PREVIOUS_METER_READ_DATE ,
                   PREVIOUS_METER_READ,
                   TOTAL_AMOUNT_DUE ,
                   SUBTOTAL,
                   ENERGY_COST ,
                   PEAK_ENERGY_COST,
                   OFF_PEAK_ENERGY_COST ,
                   BASIC_COST,
                   DEMAND_COST ,
                   REACTIVE_COST,
                   TRANSMISSION_COST ,
                   OTHER_COST,
                   SERVICE_ADDRESS ,
                   CARBON_TAX,
                   CARBON_TAX_GST ,
                   FEDERAL_TAX,
                   PST ,
                   MST,
                   VAT ,
                   METER_TYPE ,
                   BILL_MULTIPLIER ,
                   RATE ,
                   POWER_FACTOR ,
                   PEAK_DEMAND,
                   BILL_DAYS ,
                   CC_NUM,
                   PROD_YEARMONTH ,
                   WELL_NAME,
                   FOREMAN ,
                   BATTERY,
                   UWI ,
                   WELL_TYPE,
                   RUN_NAME ,
                   SURFACE_LOCATION,
                   SURFACE_LATITUDE ,
                   SURFACE_LONGITUDE,
                   OPERATING_HOURS ,
                   DOWNTIME_HOURS,
                   OIL_M3 ,
                   WATER_M3,
                   GAS_E3M3 ,
                   OIL_BOE,
                   GAS_BOE ,
                   BOE,
                   FACILITY ,
                   WORKING_INTEREST,
                   PUMP_TYPE ,
                   SOURCE,
                   TOTAL_COST ,
                   '' AS NORM_TYPE
              FROM Fin
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PWRANALYTICS_VET_POWER_MTH_UNION
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_UNION') }}
        name: VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
