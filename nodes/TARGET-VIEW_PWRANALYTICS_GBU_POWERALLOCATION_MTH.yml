fileVersion: 1
id: 64230f2d-85b4-4f26-914a-4bab06d04516
name: VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af30d338-5ff8-4ea6-9919-e3bf9ed1bd19
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f9a67-3d0a-4308-8da6-2c872317607b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69163493-156e-4558-81b7-567a60bd0620
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d34a6f6-0a3e-4ca5-b097-b36f860c667a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce468a5e-3bd7-44cd-a98d-1831275b2425
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ff86e3-9b52-456f-8d68-728597308eb3
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5632ebb8-8166-495e-b949-9ddd202fb69a
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43c724ed-fff6-48c7-ae2c-3b5ddee88deb
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14da29b5-d6a0-40b0-8785-d3c0af68f355
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebe2ef39-6f47-46f3-81b2-74c57ad76e3a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13d1b567-707c-4801-80d7-b23506946a6d
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a902f4d7-62cd-473d-bbe3-8931852772d4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41515b67-197f-4270-b02a-63fd286f8ff8
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3e91efb-6ec0-4569-b119-033fb4e4721a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e081cc1-3940-42f7-b502-e954edfe9e45
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51e8d3ad-9d54-4599-a4f9-99a75e33923b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4f5c579-c184-4140-a603-22d58d6d6584
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3df7eb8-8e35-4b14-81ca-1be68ec9404b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3487253-71c4-481a-86e5-414626d117ba
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33c8515b-de83-4168-ad80-c2fc9c50172a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee9e0419-ab16-43df-adfa-39e752f71161
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ab53299-259b-4928-b0c2-dab7fb86f9a7
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a456171-d9ca-4fad-a5e7-0e8ceccc26f9
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 720a87f9-ef09-496a-aa7f-aad3d5efcf4b
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dc75de2-ee04-4dcd-b895-5d853a29b78d
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5c74d3a-d7d9-4960-983e-db91fb538068
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bd3bf25-93e3-460d-b908-e437ddd2c7bb
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5f28d0f-a40a-44fc-a596-6181b3950041
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42592a16-d334-48c6-ae30-b87d0a899d4f
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fbee53c-3df1-45ea-ac33-7d167009271a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b975287-071a-4844-9e07-29b484526d7e
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ab3767-a40c-45b0-b64c-8b10f24c65df
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 785a3bb0-8046-4deb-836e-255687168362
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4ad9561-afaf-4f35-b2f5-d791d2aea243
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8445107d-628b-4e2c-9737-876223108cde
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b416c4b-2762-432d-bbc8-e3d7f5d29446
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eb69af5-54c7-4263-8d8a-ed780675393a
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57159ea2-95bc-4567-a6af-f8d8e3901cdc
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7be89ea0-346f-42c5-8b28-d06987123c40
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ebb5afe-e9e6-4322-b028-cb62db41a8df
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95b5ad62-4de9-4992-a6bf-b23bfc4781d9
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eea745f5-fedf-46e2-b5bf-c70c86e62e60
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fd688a7-b8d1-4b48-a515-623dfd877cce
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc5d994d-bdf2-4740-a17b-786534bd35cf
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e54742d-2a90-443e-9235-f76a2077cdcf
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10f9a403-baf1-40e6-84d8-ff0972bee74a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c44bc0c-faae-4f24-a040-d9d114ceff74
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b12196d2-2e5a-49a9-836f-936508f2b3a2
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 297f99f5-8262-4dc9-a85a-aae0b0cee3e3
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47e97593-b106-4d8a-8196-b85b365245a4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34eb2890-685e-4651-96c3-1d97d2ce30ba
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ea5b4eb-1d80-404e-b698-1ea010245a80
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f577789a-cc9e-4382-8324-2085ce20a2f3
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73c890a4-2f50-4c2b-948e-a34b5627393e
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26a4cb9b-9439-435e-8917-eeeea2954d70
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0b46c7b-4c29-46f6-a9dd-506c0990b0b4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c10843-cfab-42ab-9df6-5f1803407890
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 308df3ee-a506-4fef-a6eb-b268045802b4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4151d154-a0f7-4de9-9d3f-d2184bd637a5
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24f9e44-d123-4115-af96-0ddb3e0aa6ab
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9c2dc13-16b6-4a41-8577-2d0635e5d250
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f35e291-cba0-4245-a0a6-e70f74bdf89d
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 215bdd2f-9883-45b9-a70c-24f1151862a2
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31faba84-0aae-4753-9d49-2d33c2c2dc56
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8aee42c5-5ade-4f4e-afac-7ed1ecac191d
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 968a0c92-58fa-4dc2-b08e-34733ca91cea
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3fefe0b-dd93-4d7e-9924-b8ad460df144
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ecad125-b597-4621-b72d-d824fa8e2124
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dda387e-f8b4-47a4-9bfe-52139672df4b
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02769d7f-4192-46e6-90a2-154b3bc98685
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 537d47d6-5840-4a1a-9afd-026d1aa67480
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fe8b719-27aa-4121-af25-14812967ba1c
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5041cae6-8c60-4efe-b768-10038d99fad5
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dca269bf-1c09-4bf9-bb35-b1565f4a933f
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bf96de8-be78-45fb-bbc5-54516b9edc10
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f89272dd-8e07-4f72-b8ef-1c2be3c2463d
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb6d102-7f58-4704-bdc9-1b85f6a974ed
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92e0e283-6f84-49c4-910c-57bc5feb9d2a
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 021a816a-7e41-4b8e-b675-5748aaba72fe
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0156b41d-03af-48fc-bab2-ce8ff4d0561c
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 778179fe-76e2-4483-bb9e-b17b8fc5d6b7
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 805b9987-db78-4ca1-aff0-643c007478b5
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8165284a-362e-49e1-8f03-856a3bd31cea
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 048b15fb-6770-46f9-bc8e-55adfcd17130
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7977c21-7309-4841-8a55-a7de137c4f09
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9948e142-86c5-4111-82d4-e3d0ad2c3633
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 952e6ba9-dc92-4704-815b-8c6afb059cb1
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e98ffcc8-ad64-4f23-814f-e26a10ce4ce6
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33da730e-1876-4932-b6b7-c5a972caed42
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cbf4950-b203-4014-929d-bf6792ce0d24
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fe33c3a-5454-4104-ade2-89fc573d68e8
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23732ef6-7cf7-40e2-9885-afbb1802c002
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96a36349-a9c5-4217-83e9-b8e89e979f96
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8b05299-c4ee-46a7-b819-d0eacf8adefe
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 724e8491-989a-439b-9035-f3c8b58067d8
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9303cdf-f55e-479a-9878-f94c0484fec6
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba1e6ba7-340f-40ed-a661-cfcbe1b677f3
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 013eb361-f111-4d0b-9148-9552ee922a85
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68f98b7e-325f-419a-b41b-d27ea505de84
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc68a16c-c697-4c34-94a1-9911e462a912
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30b5e2f2-ff18-4582-9e01-4c2259ee6c80
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31f32380-565a-4e73-89e0-4ef2a29efe59
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b56487ac-27bc-41f8-8ccd-b2e0a5e69089
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d40e0441-74a0-4ad3-a4a4-52356d8c5233
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e601f611-0566-4ec1-bfc4-4fcac3fde0f0
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 292dbac8-be22-409f-920d-fb1afda6ff26
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22aad1ad-538d-4367-9c2b-a66073fb5514
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a847db7-507b-425f-9380-96a99f8323be
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 914f00db-7feb-4d24-bbdd-0e87b645d7d7
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a40baf38-f3dc-462c-81ae-d97f84caceef
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0ed73ff-e6f3-4c0c-83ce-752c91ad92c3
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caeab6e5-269d-4dc2-8ec3-4d130525785f
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fdd50ae-270a-42a0-ab95-2db4d6126e3c
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95de1ff9-6e13-45b8-98c2-ed04ca68bd03
          stepCounter: 64230f2d-85b4-4f26-914a-4bab06d04516
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NORM_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH: 64230f2d-85b4-4f26-914a-4bab06d04516
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH') }} AS WITH MJ AS (
                    SELECT *
                      FROM (
                            SELECT DISTINCT(UNIT_NAME) AS WELL_NAME ,
                                   Try_Cast(CHILD_ACCOUNT AS float) AS CHILD_ACCOUNT_NUMBER ---pls keep this as float!!----
             ,
                                   Try_Cast(METER_NUMBER AS float) AS METER_NUMBER,
                                   COST_CENTER AS CC_NUM ,
                                   '' AS CC_NAME,
                                   Area AS AREA ,
                                   CORE_AREA AS CORE_AREA,
                                   PROVINCE ,
                                   FACILITY,
                                   FOREMAN ,
                                   '' AS RUN_NAME,
                                   '' AS BATTERY ,
                                   TYPE AS TYPE,
                                   'Non PV' AS SOURCE
                              FROM DS_POWER.NONPV_ENTITIES NPV
                             WHERE CHILD_ACCOUNT IS NOT NULL
                               AND COUNTRY='Germany'
                         UNION ALL SELECT DISTINCT(WELL_NAME),
                                   CHILD_ACCOUNT_NUMBER ,
                                   METER_NUMBER,
                                   COALESCE(CC_NUM, AREA) AS CC_NUM ,
                                   CC_NAME,
                                   AREA ,
                                   CORE_AREA,
                                   PROVINCE ,
                                   FACILITY,
                                   FOREMAN ,
                                   RUN_NAME,
                                   BATTERY ,
                                   WELL_TYPE AS TYPE,
                                   'ProdView' AS SOURCE
                              FROM WS_EDW.VIEW_FDC_PWRANALYTICS PV
                             WHERE COUNTRY = 'GERMANY'
                               AND CHILD_ACCOUNT_NUMBER IS NOT NULL
                           ) MJ3
                     CROSS JOIN DS_POWER.VET_DIMDATE M
                     WHERE Year(Date) > 2020
                       AND Year(Date) <= Year(GetDate())
                   ),
                   PV_AGG_A AS (
                    SELECT MJ.CHILD_ACCOUNT_NUMBER ,
                           MJ.DATE ,
                           Sum(IFNULL(PV.WATER_M3,0)) + Sum(IFNULL(PV.OIL_M3,0)) + Sum(IFNULL(PV.GAS_E3M3,0)) AS BOE ,
                           count(*) AS WELL_COUNT ,
                           1.00/count(*) AS WELLCOUNT_PRORATION
                      FROM MJ
                      LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV
                        ON MJ.WELL_NAME = PV.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01')))
                     GROUP BY MJ.CHILD_ACCOUNT_NUMBER,
                              MJ.Date
                   ),
                   PV AS (
                    SELECT MJ.WELL_NAME,
                           PV_W.UWI ,
                           IFNULL(PV_W.CC_NUM,MJ.CC_NUM) AS CC_NUM,
                           PV_W.CC_NAME ,
                           IFNULL(MJ.Province,PV_W.PROVINCE) AS PROVINCE,
                           IFNULL(MJ.CORE_AREA,PV_W.CORE_AREA) AS CORE_AREA ,
                           IFNULL(MJ.AREA,PV_W.AREA) AS AREA,
                           IFNULL(MJ.Foreman,PV_W.FOREMAN) AS FOREMAN ,
                           PV_W.RUN_NAME,
                           IFNULL(MJ.Facility,PV_W.FACILITY) AS FACILITY ,
                           PV_W.BATTERY,
                           PV_W.WELL_TYPE ,
                           PV_W.SURFACE_LOCATION,
                           PV_W.OPERATING_HOURS ,
                           PV_W.DOWNTIME_HOURS,
                           PV_W.ON_PROD_DATE ,
                           PV_W.LAST_PROD_DATE,
                           PV_W.PROD_YEAR ,
                           PV_W.PROD_MONTH,
                           PV_W.PROD_YEARMONTH ,
                           PV_W.WORKING_INTEREST,
                           PV_W.PUMP_TYPE ,
                           PV_W.METER_NUMBER,
                           MJ.CHILD_ACCOUNT_NUMBER AS CHILD_ACCOUNT_NUMBER ,
                           PV_W.FIELD_COMMENTS,
                           PV_W.SURFACE_LATITUDE ,
                           PV_W.SURFACE_LONGITUDE,
                           MJ.Date AS EOPRODMONTH ,
                           (datefromparts(Prod_year,right(cast(prod_yearmonth AS varchar),2),01)) AS FOM ,
                           IFNULL(PV_W.WATER_M3,0) AS WATER_M3,
                           IFNULL(PV_W.OIL_M3,0) AS OIL_M3 ,
                           PV_W.GAS_E3M3,
                           PV_W.OIL_BOE,
                           PV_W.GAS_BOE ,
                           IFNULL(PV_W.BOE,0) AS BOE,
                           PV_AGG_A.BOE AS TOTALBOE ,
                           PV_AGG_A.WELL_COUNT AS PV_WELL_COUNT,
                           PV_AGG_A.WELLCOUNT_PRORATION,
                           PV_AGG_A.WELL_COUNT ,
                           SOURCE ,
                           CASE WHEN PV_AGG_A.BOE = 0                                          THEN 1.00/PV_AGG_A.WELL_COUNT
                                WHEN PV_AGG_A.BOE IS NULL AND 1.00/PV_AGG_A.WELL_COUNT IS NULL THEN 1.00
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS PRORATION_BOE ,
                           CASE --No production  then divide equally ---

                                WHEN (IFNULL(PV_AGG_A.BOE,0) = 0 AND PV_AGG_A.WELL_COUNT >= 1) OR ((IFNULL(PV_W.WATER_M3,0)+IFNULL(PV_W.OIL_M3,0)+ IFNULL(PV_W.GAS_E3M3,0)) = 0 AND PV_AGG_A.WELL_COUNT >= 1) THEN 1.00/PV_AGG_A.WELL_COUNT ---else 1 ---

                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3+PV_W.GAS_E3M3)/PV_AGG_A.BOE
                                 END AS WELL_PRORATION
                      FROM MJ
                      LEFT JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV_W
                        ON MJ.Well_Name = PV_W.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),5,2), '-01')))
                      LEFT OUTER  JOIN PV_AGG_A
                        ON MJ.CHILD_ACCOUNT_NUMBER = PV_AGG_A.CHILD_ACCOUNT_NUMBER
                       AND MJ.Date = PV_AGG_A.Date
                   ),
                   Fin AS (
                    SELECT PB.COUNTRY ,
                           PV.PROVINCE AS PROVINCE ,
                           PB.LANGUAGE ,
                           PB.CURRENCY ,
                           UTILITY_PROVIDER ,
                           INVOICE_NUMBER ,
                           ACCOUNT_NUMBER ,
                           PB.DELIVERY_POINT ,
                           CONSUMPTION_MONTH ,
                           PB.METER_NUMBER AS METER_NUMBER ,
                           try_cast(PB.Cost_Center AS nvarchar(255))AS COST_CENTER ,
                           PV.CC_NAME AS CC_NAME ,
                           PV.CORE_AREA AS CORE_AREA ,
                           PV.AREA ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Total_Consumption_kWh
                                ELSE Total_Consumption_kWh
                                 END AS TOTAL_CONSUMPTION_KWH ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Peak_Consumption_kWh
                                ELSE Peak_Consumption_kWh
                                 END AS PEAK_CONSUMPTION_KWH ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Off_Peak_Consumption_kWh
                                ELSE Off_Peak_Consumption_kWh
                                 END AS OFF_PEAK_CONSUMPTION_KWH ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Registered_Demand_kVA
                                ELSE Registered_Demand_kVA
                                 END AS REGISTERED_DEMAND_KVA ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Billed_Demand_kVA
                                ELSE Billed_Demand_kVA
                                 END AS BILLED_DEMAND_KVA ,
                           CURRENT_METER_READ_DATE ,
                           CURRENT_METER_READ ,
                           PREVIOUS_METER_READ_DATE ,
                           PREVIOUS_METER_READ ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Total_Amount_Due
                                ELSE Total_Amount_Due
                                 END AS TOTAL_AMOUNT_DUE ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 = 0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                              THEN IFNULL(Well_Proration,0) *Subtotal
                                ELSE Subtotal
                                 END AS SUBTOTAL ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Energy_Cost
                                ELSE Energy_Cost
                                 END AS ENERGY_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Peak_Energy_Cost
                                ELSE Peak_Energy_Cost
                                 END AS PEAK_ENERGY_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Off_Peak_Energy_Cost
                                ELSE Off_Peak_Energy_Cost
                                 END AS OFF_PEAK_ENERGY_COST ,
                           pv.WELLCOUNT_PRORATION *Basic_Cost AS BASIC_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Demand_Cost
                                ELSE Demand_Cost
                                 END AS DEMAND_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Reactive_Cost
                                ELSE Reactive_Cost
                                 END AS REACTIVE_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Transmission_Cost
                                ELSE Transmission_Cost
                                 END AS TRANSMISSION_COST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Other_Cost
                                ELSE Other_Cost
                                 END AS OTHER_COST ,
                           SERVICE_ADDRESS ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Carbon_Tax
                                ELSE Carbon_Tax
                                 END AS CARBON_TAX ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *Carbon_Tax_GST
                                ELSE Carbon_Tax_GST
                                 END AS CARBON_TAX_GST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) * Federal_Tax_GST
                                ELSE Federal_Tax_GST
                                 END AS FEDERAL_TAX ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *PST
                                ELSE PST
                                 END AS PST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *MST
                                ELSE MST
                                 END AS MST ,
                           CASE WHEN PV.WATER_M3 = 0 AND PV.OIL_M3 =0 AND GAS_E3M3 = 0 AND PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER) AND PV.Well_Count > 1 THEN 0
                                WHEN PB.Delivery_Point IN (PV.CHILD_ACCOUNT_NUMBER)                                                                             THEN IFNULL(Well_Proration,0) *VAT
                                ELSE VAT
                                 END AS VAT ,
                           Cast(Meter_Type AS varchar) AS METER_TYPE ,
                           BILL_MULTIPLIER ,
                           RATE ,
                           POWER_FACTOR ,
                           PEAK_DEMAND ,
                           BILL_DAYS ----- Prodview ---------
             ,
                           PV.CC_NUM AS CC_NUM ,
                           PV.PROD_YEARMONTH ,
                           PV.Well_Name AS WELL_NAME ,
                           CASE WHEN PV.FOREMAN IS NULL THEN PV.FOREMAN
                                ELSE PV.FOREMAN
                                 END AS FOREMAN ,
                           PV.RUN_NAME ,
                           BATTERY ,
                           UWI ,
                           WELL_TYPE ,
                           PV.SURFACE_LOCATION ,
                           PV.SURFACE_LATITUDE ,
                           PV.SURFACE_LONGITUDE ,
                           PV.OPERATING_HOURS ,
                           PV.DOWNTIME_HOURS ,
                           PV.OIL_M3 ,
                           PV.WATER_M3 ,
                           PV.GAS_E3M3 ,
                           PV.OIL_BOE ,
                           PV.GAS_BOE ,
                           PV.BOE ,
                           CASE WHEN PV.FACILITY IS NULL THEN PV.FACILITY
                                ELSE PV.FACILITY
                                 END AS FACILITY ,
                           WORKING_INTEREST ,
                           PUMP_TYPE ,
                           PV.Source ,
                           (Well_Proration*(Energy_Cost + Demand_Cost + VAT + PST))+ (PV.WELLCOUNT_PRORATION*Basic_Cost) AS TOTAL_COST
                      FROM WS_EDW.VIEW_PWRANALYTICS_VET_POWER_MTH_UNION PB
                      LEFT JOIN PV
                        ON PV.CHILD_ACCOUNT_NUMBER = PB.DELIVERY_POINT
                       AND PV.FOM = (PB.CONSUMPTION_MONTH)
                     WHERE Country = 'Germany'
                   ) SELECT COUNTRY,
                   PROVINCE ,
                   LANGUAGE,
                   CURRENCY ,
                   UTILITY_PROVIDER,
                   INVOICE_NUMBER ,
                   ACCOUNT_NUMBER,
                   DELIVERY_POINT ,
                   CONSUMPTION_MONTH,
                   METER_NUMBER ,
                   COST_CENTER,
                   CC_NAME ,
                   CORE_AREA,
                   AREA ,
                   TOTAL_CONSUMPTION_KWH,
                   PEAK_CONSUMPTION_KWH ,
                   OFF_PEAK_CONSUMPTION_KWH,
                   REGISTERED_DEMAND_KVA ,
                   BILLED_DEMAND_KVA,
                   CURRENT_METER_READ_DATE ,
                   CURRENT_METER_READ,
                   PREVIOUS_METER_READ_DATE ,
                   PREVIOUS_METER_READ,
                   TOTAL_AMOUNT_DUE ,
                   SUBTOTAL,
                   ENERGY_COST ,
                   PEAK_ENERGY_COST,
                   OFF_PEAK_ENERGY_COST ,
                   BASIC_COST,
                   DEMAND_COST ,
                   REACTIVE_COST,
                   TRANSMISSION_COST ,
                   OTHER_COST,
                   SERVICE_ADDRESS ,
                   CARBON_TAX,
                   CARBON_TAX_GST ,
                   FEDERAL_TAX,
                   PST ,
                   MST,
                   VAT ,
                   METER_TYPE ,
                   BILL_MULTIPLIER ,
                   RATE ,
                   POWER_FACTOR ,
                   PEAK_DEMAND,
                   BILL_DAYS ,
                   CC_NUM,
                   PROD_YEARMONTH ,
                   WELL_NAME,
                   FOREMAN ,
                   BATTERY,
                   UWI ,
                   WELL_TYPE,
                   RUN_NAME ,
                   SURFACE_LOCATION,
                   SURFACE_LATITUDE ,
                   SURFACE_LONGITUDE,
                   OPERATING_HOURS ,
                   DOWNTIME_HOURS,
                   OIL_M3 ,
                   WATER_M3,
                   GAS_E3M3 ,
                   OIL_BOE,
                   GAS_BOE ,
                   BOE,
                   FACILITY ,
                   WORKING_INTEREST,
                   PUMP_TYPE ,
                   SOURCE,
                   TOTAL_COST ,
                   '' AS NORM_TYPE
              FROM Fin
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PWRANALYTICS_VET_POWER_MTH_UNION
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_UNION') }}
        name: VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_GBU_POWERALLOCATION_MTH
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
