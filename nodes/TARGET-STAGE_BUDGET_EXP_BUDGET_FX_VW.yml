fileVersion: 1
id: c5d8693c-128f-4575-8d53-2d73d7f38e27
name: STAGE_BUDGET_EXP_BUDGET_FX_VW
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Budget Export Staging table for direct load into BI_REPORT.BUDGET_FX_VW@BIPR"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f59460a-6697-4f81-aa1c-214abe906fa9
          stepCounter: c5d8693c-128f-4575-8d53-2d73d7f38e27
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: VERSION_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18c3f021-ced1-4959-b750-294bc1deaf91
                stepCounter: d876a688-7405-416c-a8d2-c320880c01c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67f26261-1ffe-4b4f-adad-0f74d68db278
          stepCounter: c5d8693c-128f-4575-8d53-2d73d7f38e27
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SYMBOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa1041eb-29f0-4362-a2b7-d6fcdaa38dd8
                stepCounter: 9bb59105-be11-44bf-8ca3-0f995e0fc39a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe7caa3d-f8e6-48eb-b967-1e179bf7c780
          stepCounter: c5d8693c-128f-4575-8d53-2d73d7f38e27
        config: {}
        dataType: NUMBER(14,10)
        defaultValue: ""
        description: ""
        name: FACTOR_FROM_CAD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0849049c-c7c7-4849-b910-d873d05f9c2b
                stepCounter: 9bb59105-be11-44bf-8ca3-0f995e0fc39a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d490290-d95c-47be-b3ee-2fabce3bfe08
          stepCounter: c5d8693c-128f-4575-8d53-2d73d7f38e27
        config: {}
        dataType: NUMBER(14,10)
        defaultValue: ""
        description: ""
        name: FACTOR_TO_CAD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0849049c-c7c7-4849-b910-d873d05f9c2b
                stepCounter: 9bb59105-be11-44bf-8ca3-0f995e0fc39a
            transform: 1/LOAD_BUDGET_R_VERSION_FX.FX_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dc408cb-a726-4b3e-bf93-7d322045697b
          stepCounter: c5d8693c-128f-4575-8d53-2d73d7f38e27
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The calendar date for this row.
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_CHAR(DIM_DATE.CALENDAR_DATE,'YYYY-MM-DD')
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_BUDGET_R_VERSION: d876a688-7405-416c-a8d2-c320880c01c1
          LOAD_BUDGET_R_VERSION_FX: 9bb59105-be11-44bf-8ca3-0f995e0fc39a
          DIM_DATE: e36e3241-fb91-480b-b6e9-be9a8d12930f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_VERSION
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_VERSION_FX
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','LOAD_BUDGET_R_VERSION') }} LOAD_BUDGET_R_VERSION
              JOIN {{ ref('TARGET','LOAD_BUDGET_R_VERSION_FX') }} LOAD_BUDGET_R_VERSION_FX
                ON LOAD_BUDGET_R_VERSION.IDX = LOAD_BUDGET_R_VERSION_FX.FK_R_VERSION_IDX
              JOIN (
                    SELECT CALENDAR_DATE
                      FROM {{ ref('TARGET','DIM_DATE') }}
                     WHERE DAY(CALENDAR_DATE)=1
                   ) DIM_DATE
                ON YEAR(LOAD_BUDGET_R_VERSION.EFFECTIVE_DATE) = YEAR(DIM_DATE.CALENDAR_DATE)
        name: STAGE_BUDGET_EXP_BUDGET_FX_VW
        noLinkRefs: []
  name: STAGE_BUDGET_EXP_BUDGET_FX_VW
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
