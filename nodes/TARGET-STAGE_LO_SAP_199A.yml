fileVersion: 1
id: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
name: STAGE_LO_SAP_199A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef5e245-7515-4734-ac7c-24060cf0ab6c
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9ed435e-4790-41d8-856f-c94685de8f41
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dd5416b-c82a-4b1d-8dbf-9e980b607b53
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4c3a825-a088-4705-91dd-badf6129e0ed
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f53cfb9e-a32b-4dde-a45f-21355ced342b
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b2f65b3-a637-4a97-ab93-3541d8bf73cc
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d3716dc-0d82-40bf-9b00-49534fb51cab
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ac22199-9f9b-4003-8595-41aea2b07088
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aa3d04d-7d8b-4614-af20-1d5764762fb5
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49ba0f2b-2e5d-4400-bc75-5f1a90cb148d
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e0110b8-67b4-4c60-948f-6e22a8dd52bc
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86dbc070-211c-4ad7-b5cc-d655275af940
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af8ca661-ed9e-41f9-9158-2fbbbb372b17
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 648cb97f-b285-44e5-8566-ae0083165f64
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92a2f4bc-12df-40fd-b438-0ff608581aa5
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e42fadb6-2ad7-4845-9054-3c7c87a2b500
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 847bf9cb-e6f3-43a9-be76-4a7a91df50f6
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40961cd3-818a-49e1-8e2c-c087d3bcbe0a
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 319f5f8e-bbc2-4109-bcd8-2ca702f83bb5
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fbf89d6-0f96-462b-932e-fd5c8366ac76
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7f9fbab-cb40-41d9-8518-72a7080863f0
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d20adf2-caa1-4397-b704-c9ad360cafd6
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b61b0c3-6bd1-4b0f-bee2-679c7c6b7d3d
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e1f8c70-3dae-4305-84a0-7928ba53aa53
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ee27029-0bec-4e87-b054-ae8be92517a4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c2141e9-14b6-4919-aad2-ec2fb633f856
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8cf4072-997e-443a-a921-1d6dd51eac73
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8b99ebd-2789-46c9-84a0-2e64730f763c
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33964490-8b05-4fd0-b8dd-a78920056994
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ace830-b068-455c-a74a-9b14efa12c7b
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f1ec9de-5b18-4c27-ba1f-253b791ebcb5
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7bd5777-3a7d-479c-a875-fb259f8f21f6
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 920f1bdb-c209-4b3f-ab74-3a8b86214c49
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 993361db-e7be-4b78-b8c1-1269b6e674f5
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 535b6bef-33b6-4de3-aa28-466df068d500
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4b53b11-c674-46fb-ab39-65ad0b1e7cf0
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a712ddf9-5278-4a3c-b8d7-d056033adad4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bbfff3a-5dec-46ca-b0ae-0e5d47956721
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d48944be-32e7-41cc-bdf2-291d10895988
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dce7044f-739d-4c71-a6d1-3a1330159b9e
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f2a080f-4186-4393-b739-0193ea4cb5a4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5e5eb14-e097-428a-a9b1-cf33454fdfed
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa94291-9657-4a60-a7a7-edc20424da73
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ff31584-d6ec-43f1-926d-b7a1a5f3fb22
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a07a99-e64f-48c4-9aed-08cc628abc54
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36e7eaf5-5249-49f3-86c1-c862b40e696e
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c51361a7-84ea-4e27-9409-d2e3818c394f
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f02d163-a5e8-4937-9cec-b7c41704b5a2
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 523162d9-d412-460c-a9a4-cf6d12e54660
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e7a6e3a-8b3c-4f70-8cb2-f2d858faa534
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CURRENT_TIMESTAMP()
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a4fd744-f3e6-45be-820f-ebb5503f7d31
          stepCounter: 9ac8bf6e-6f49-4bfe-b9b8-46a8d1424ab0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_FIRST_PASS: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_FIRST_PASS
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_FIRST_PASS') }} STAGE_LO_SAP_FIRST_PASS
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '199A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             WHERE STAGE_LO_SAP_FIRST_PASS.LINE_NO_GROUP = '199'
             GROUP BY STAGE_LO_SAP_FIRST_PASS.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_FIRST_PASS.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_FIRST_PASS.EXCHANGE_RATE,
                      STAGE_LO_SAP_FIRST_PASS.OP_CURR_CODE,
                      STAGE_LO_SAP_FIRST_PASS.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_FIRST_PASS.OP_NONOP
        name: STAGE_LO_SAP_199A
        noLinkRefs: []
  name: STAGE_LO_SAP_199A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
