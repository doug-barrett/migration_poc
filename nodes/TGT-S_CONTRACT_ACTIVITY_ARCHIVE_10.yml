fileVersion: 1
id: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
name: S_CONTRACT_ACTIVITY_ARCHIVE_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Appends a monthly snapshot of the contract activity. As business keys change for dim_contract_line_key the snapshot is extended to take columns from dim_contract_line at the point in time too"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f47baa5-b063-4fda-b106-164512e4b570
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Generated column used to join to correct Price Volume Schdule Line
        name: PROVIDER_FUNDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9862be27-8b73-452f-af9a-79ce2b427d91
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bdedb1a-960e-488c-9e18-fa55229ddff8
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c010ef7e-c6b6-49eb-89cd-6831d3f57b23
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00d9aa03-5352-449c-a31d-bfed43ac060f
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: health_specialty_code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c383dd-7682-44b4-a9df-88932212427a
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b20b333-6e43-48d4-a499-c349f6d17812
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.health_specialty_code=dim_MOH_health_specialty.health_specialty_code
        name: DIM_MOH_HEALTH_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 375aa674-b449-4e37-9b05-5f9c4dbd3acc
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d3b7975-aac3-415b-8e29-b68e556e3ece
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.facility_code=dim_health_facility.health_facility_code
        name: DIM_HEALTH_FACILITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82d56ae0-1eeb-457b-9922-e695c6996fdb
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18230181-fce5-46b6-ab3a-b3d461111a06
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: facility_code
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a15fb04-d30c-48c0-ba61-ac2c3daf76c9
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4d8ca6a-e5ea-4ab6-a6e8-2a35bc7ad92e
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe35e53-1d30-46fe-8e66-09094457ebc8
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1704383b-744e-4e24-8a6b-7c74cfe3d286
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REPORTING_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8344ac46-d066-412c-897b-d907c29cc22d
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c3a8840-cfd6-4df2-9807-96a0ae05c0f4
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f471265e-e464-430d-8c2d-abcaee386963
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15944f9f-52e8-4c12-8722-8faee03e8cdb
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c18eaa37-27c9-4ad8-8182-db91b546cde9
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23f50b12-ad73-473f-a739-8d8aa3bc3c93
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89b44581-cd1f-4515-bc37-aaf9053a0bb0
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfd3fb4a-d770-470a-8016-2ad1e3f78605
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9772b5d-8c69-47ea-933b-14e3152b88fd
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24637200-982b-4d00-8182-8cb932e8ad84
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e184949-ecd7-4851-8432-26acf94061b6
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa9bf52d-15e5-4dcf-ad29-bd433230982a
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ad1b870-86c6-4970-ba8d-432f8315d842
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e33343da-439a-4587-b1e3-8e933367b93b
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.admin_category_reference_no=dim_admin_category.admin_category_reference_no
        name: DIM_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b06529c7-c2e2-47bd-ad76-68151b7003e5
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab9f472f-80a4-4b22-891a-5d01b7114039
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdcfb70a-0b63-47e1-931a-b682902bed18
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9b73196-9419-44d9-abb6-6686ab2d4f05
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PURCHASER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a23a57a0-f164-4fe7-a335-91b1de51dadc
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d7634c5-872a-436f-8b81-b5941cd966ae
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CONTRACT_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 362f0472-6a0f-4bbb-b7b8-3ffa9de0cc67
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6ed506f-9ef9-44b1-8447-734b2c00324a
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc737284-14f4-452a-ac12-6adc5ba5718e
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4983c36d-388d-478e-a681-e82fbcc9c367
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22e17109-b8c2-4162-9d08-0dce00159f4c
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3187434c-928a-4a1a-81fa-f2c96a4ee367
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: field for auditing purposes . exposed text value of purchase unit as it may not map correctly to valid value
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3591b4-b91d-4354-b7f8-81c52900ada6
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed817037-e027-4a45-8168-459934e64946
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: This is the volume of units for the method by which the event is funded. i.e. WIES or 1 for procedure funded purchase units.
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e24cc067-ba09-47d8-88d7-cc6feb931272
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cd30771-2bb3-42b5-80a7-98efc9818722
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: This is the volume of units for the method by which the event is funded. i.e. WIES or 1 for procedure funded purchase units.  NNPAC counts client unit of measure with a volume 0 so whilst this volume counts it as 1 so that it the volumes can be reported in the cotnract volume reporting
        name: LOCAL_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd34ae5f-2158-4ad1-88a9-aed35113cae1
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dd8ff7c-7e15-4c12-9dfa-02aeb778de41
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c63997d2-2356-4927-8629-4c0081bb6752
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 462e55a6-eb21-46d3-a059-b610f7f8036b
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c38d0ce-5104-498b-9962-d30ec40825bf
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b07e8d0-a72b-421d-8d69-ca2577320e94
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1def154-f34e-4d4d-b167-dd4cf2aa42d8
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8827032f-2690-4a5c-aee9-4c572d843f45
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7d8166e-1470-49e1-ba9a-0632e37a7e9c
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7afa976-9de3-4c56-874b-100111e31adb
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: MHOP_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19df8653-fa46-42f0-a21c-5f8ff8999a85
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d39c1122-4e46-4249-8aa9-61667f6489dc
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: AMED_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b6de778-aea9-48ec-82b2-652ad92158d5
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 912982dc-b9e1-4ad4-b3e4-e4b43c93c47d
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: SURG_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb39b38d-3f4c-4f3c-a6a5-7f7e2261fc18
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 605ca915-a874-4d2f-9811-f603719adf16
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: CWF_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f336a0a2-a5fc-4db5-a48a-d8856a5fb4b8
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7de8818d-3565-4870-b7eb-218de9b23c4f
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f953af-f72e-4c87-bf43-4126ae07480a
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74b0e86c-eee8-4c00-b58f-4904a23162e2
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: OTH_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92945760-b9e2-44a5-817c-cfbf54234aca
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34af9c30-7610-4122-b0f7-7fceeb65b705
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Activity that matches a price volume schedule contract line. Y means that it is matched to funded contract line. N means that there is no match
        name: FUNDED_ACTIVITY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9d213fa-1e10-4cb4-b71f-0d2aa6b88dbb
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31cbbe86-cc70-4ca9-a0c2-660d35cc8af2
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COSTED_ACTIVITY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0805c49-679a-4c5f-ac9f-fea9337956fb
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a2463d3-8101-4084-a2dd-ccd551adad8c
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ESTIMATED_ACTIVITY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51e79422-8edb-4ac2-b3e9-938ccb2ce046
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5799454-6fcc-4602-9281-279f936b4c52
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: 'Flags encounters that have purchase unit volume as Y and where there is no volume as N. Events can legitimately have no volume if they are not outcomed, patient DNAs or they occur in the future. '
        name: EVENTS_WITH_PURCHASE_UNIT_VOLUME_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b81264e-7c7b-495f-a567-e39384ec3d90
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 011725c3-4b5f-421d-8ae4-193762ad0784
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: the price the DHB funding arm is paying the provider
        name: PLANNED_PRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a77d6e3-3270-4f70-b6bc-4b916f64f1e4
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc7713d5-c8c7-4272-a149-348ad73b23f2
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Planned price x purchase unit volume
        name: REVENUE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f757e3a-d865-4370-a267-b97361937bc0
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfc9babc-49e8-43cb-ac3c-82ba91f224e5
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: HISTORICAL_REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84b243af-88d0-4c72-a3a6-91d4657e0b4c
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de7eff79-608d-4de3-9613-13f91dcbb782
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f97e051-1cca-4503-9604-4f412f254262
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d80913fa-e627-4e00-bcda-9e44c1ba2ac1
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.domicile_code=
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da425d0-9ed5-4e6d-a070-fa4250d50a9f
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b10b67e8-7f9f-4472-aef7-a2514735ce4c
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1ee3ff-d382-4e14-91a7-62e8a2ecef28
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bc21f6c-dd36-4b9d-9149-7e92286db4ea
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3302170-022c-43d4-a6a1-c720bc789728
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdacf584-4323-4d1a-8773-ca137e2e93e3
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_CONTRACT_REPORTING_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac5b05fa-c9ad-4c02-9838-642115bca3bf
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40c3b7e7-e93b-474d-a65e-b27c6ae63357
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_activity_20.clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a45137a4-2854-4aeb-86f1-b4d8fa3d813e
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f04a4d2-e9d4-4f5f-aa5f-3b15670d730b
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key relating to a unique line in the Price Volume Schedule
        name: DIM_CONTRACT_LINE_ORIGINAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a089622c-29df-43d2-a167-1f603c12c592
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8e049ef-0196-453e-814e-5975ba6443d9
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INT
        defaultValue: ""
        description: Unique Identifier for the contract line in the original price volume schedule
        name: PVS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 478d3b94-f12b-41c3-a240-03a15410b697
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64097c8d-1260-40e6-b11d-0c6c4973b64a
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INT
        defaultValue: ""
        description: Fiscal Year relating to the Price Volume Schedule
        name: FISCALYEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c73d057-d522-49b1-b926-5b9c57b6dc3c
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 482530b6-bc78-4093-a4f2-4ad99d0aef00
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: Fiscal Period (month) generated from the phasing process
        name: FISCALPERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a4e2089-a3c8-45b6-9892-c428545740b3
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a918de37-7a10-4860-bac1-73d073cc1691
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: The description of the purchase unit activity as defined by the Purchase Unit Data Dictionary
        name: PURCHASE_UNIT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c289385-efa5-41c6-a4e1-206bf9687177
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4b5d8d2-247b-4d31-add6-f5e1ed4f1fe0
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: The type of unit used to quantify the activity.
        name: UNIT_OF_MEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a254e5a-548a-4de6-b54e-906108284788
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a1335dc-9b88-4e54-a19b-7b6758add550
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(1)
        defaultValue: ""
        description: A flag denoting if the activity is Casemix (WIES) funded or not. WIES (Weighted Inlier Equivalent  Separation). As defined by the NZ Casemix Framemwork published annually by the MoH.
        name: WIES_FUNDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9737e21f-34e2-41eb-be30-2d193cef1357
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9bd15a7-9a2a-4add-82d3-5b1e7b4b988f
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(25)
        defaultValue: ""
        description: MOH template column which splits the Price Volume Schedule between the arms of the DHB
        name: FUNDER_PROVIDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3b0af9d-2015-4465-a0b6-e472423c5e6f
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df32aa52-fa10-4189-baa3-72514307854a
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(38,20)
        defaultValue: ""
        description: The contracted volume decided upon in the Price Volume Schedule for the entire fiscal year.
        name: ANNUAL_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45e4e7f0-6fd5-4623-8af7-d079a55113e3
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5241ba78-83e1-42a9-b283-0fa3962ba478
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: The price is derived from the National Pricing Programme
        name: NATIONAL_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e49f353-4a17-4f6d-a7d0-181980dcd7cb
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd06bf83-91e1-4c61-8665-a512a810abc7
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: The current operating group associated with the RC originally mapped to the contract line in the Price Volume Schedule'
        name: OPERATING_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b161bb80-af94-436a-8677-4c1ca6baef5f
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fc68800-1d0c-410b-a072-9c2e620200bb
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: The description of the RC originally mapped by the Finance Manager to the contract line in the Price Volume Schedule'
        name: PLANNED_RC_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5adf32d-4db1-41ed-a647-2f639bc04bb1
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c498d3-c2cf-4582-b124-e68266110084
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(10)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: The code of the RC originally mapped by the Finance Manager to the contract line in the Price Volume Schedule'
        name: PLANNED_RC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79c01748-d950-4bde-a451-a6caf51f2fdf
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14c4781f-cdba-4a66-88c8-8f648babaf55
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: An abbreviated name of the purhcase unit for presenting on report. Provided by the report analysts.'
        name: PURCHASE_UNIT_SHORT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76712c42-7780-4158-b466-ab8c7b6dbd19
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 269f8c0a-866b-4c11-b331-b3d7da0598a3
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(38,6)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: Shows the monthly split of the contract volume based on the Phasing Method applied to the activity.'
        name: MONTHLY_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6fc3ded-c969-4b89-a2d1-e5b1de2f6023
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6942668a-e52d-4228-9e14-b95f3f1326a2
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(38,6)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: Shows the revenue equivalent of the phased monthly volume * price'
        name: MONTHLY_REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee6aa318-e2c2-4646-8f48-01046ab5f2e7
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd8ed807-c616-4788-a370-7f7a1771ab8b
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: Flag controlling whether the contract line appears in printed Contract Volume Reports. If its a programme based contract its not helpful to track on monthly basis'
        name: SHOW_IN_AVR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3e33078-099a-4c9c-a81d-62959edadf21
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ac7b596-a1d7-486a-88fc-f27beb358635
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: MoH defined purchase unit grouping from the purhcase unit data dictionary. Loosely determines service area.
        name: PURCHASE_UNIT_GROUP_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fb60bf4-c949-4733-8ba7-9d11d20f30cf
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb150528-9dae-46ba-aa8c-f26062d67c32
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: NUMERIC(38,20)
        defaultValue: ""
        description: The percentage of the contracted volume split for the reporting period.
        name: PHASING_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b417c10-cfaf-4169-b892-5ba9b016a743
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b439b51-5725-4869-9c27-f9062981fd7a
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: The legacy AVR report had section headings that were mapped against the contract line. '
        name: AVR_SECTION_HEADING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 833ec2b1-de0f-446f-8d1f-280cde970b91
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cad76670-7b02-44ae-9f1b-eaa519975f35
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: Responsibility Centre Description from oracle'
        name: CURRENT_RESPONSIBILITY_CENTRE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c49a87d-405c-4239-a69b-05d2c5fc5230
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4f3d813-c341-4a63-8847-28391f574383
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: 'WDHB Mapped Column in the PVS: Responsibility Centre Level3 Desc'
        name: CURRENT_OPERATING_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af702a64-4787-4ba0-a85f-75c423867e59
                stepCounter: 5abfd600-5dd0-4ae2-9b8d-f5d80b479c2f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dee2d1e-04a7-45d9-bc43-5002ba97a65f
          stepCounter: 5e9bbd8d-83ac-4cda-902e-2ca657c16a15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acced659-bc17-4503-8585-123cb1b88609
                stepCounter: 9378e4a4-ac4f-4373-a709-764a736c5b9d
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CONTRACT_ACTIVITY_20: 9378e4a4-ac4f-4373-a709-764a736c5b9d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTRACT_ACTIVITY_20
        join:
          joinCondition: FROM {{ ref('TGT','S_CONTRACT_ACTIVITY_20') }}
        name: S_CONTRACT_ACTIVITY_ARCHIVE_10
        noLinkRefs: []
  name: S_CONTRACT_ACTIVITY_ARCHIVE_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
