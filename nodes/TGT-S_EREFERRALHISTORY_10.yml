fileVersion: 1
id: a6455497-d5e2-48ab-8174-9ab3d46cd92e
name: S_EREFERRALHISTORY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b54e8cde-30a3-4066-b0e7-8074fa172ab7
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c067d95-60ae-41ad-9a8a-79965e32bdb6
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a239cce-c043-4574-ab15-8f24c892b76e
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STATUS_CHANGED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 759b960d-fdd5-4cc9-b188-1dc763adaa46
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ASC_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY referralId ORDER BY [updateDateTime] ASC,id ASC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08a04012-88b0-416e-80e5-86a370f69995
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DESC_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY referralId ORDER BY [updateDateTime] DESC,id DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaeded62-f195-43c0-9225-b0f970dbe8f8
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REFERRAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67788de1-1d3e-4409-9aaf-67f698b3aee6
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14588eca-d081-4315-b2cd-9ae2fd7af18f
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINIC_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4685b7ea-a36c-4399-8597-af3762b34bd3
                stepCounter: 5a1bab4c-fbbd-4118-84c4-caa78d82403e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15d24b9b-7598-406f-87bb-4ba833a1c1e3
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: UPDATE_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e806bdab-6e71-4e45-813f-8e8fc3db2a92
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90dc8632-b047-45ce-b89b-47689ccdf7e3
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3aa0e18-5bdb-4db6-8f0b-297d12e31241
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10f3981e-feb9-427e-9f37-3d9e05ea0805
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(4000)
        defaultValue: ""
        description: ""
        name: COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0c76e84-5f10-418a-970e-22c547568eec
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0257ccd5-4cc0-461c-8b36-f8b9305c6730
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: HISTORYTYPECODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1361aef-a3e9-48ea-bb7c-53018c0918b0
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63a76f5c-851d-4c22-9abc-512ca551e50d
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22c07995-ff5a-4283-b03f-495c255871d4
                stepCounter: 98c51b98-78ab-4bcb-9870-bf59fc721a41
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3a12692-46dc-471b-b4ee-8f28dbb5116e
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: USER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c8cd886-401a-42cd-8f8c-2a2f456bcba0
                stepCounter: 244e53f9-449b-4fe6-87f5-18542b22b4ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeaceba0-8756-4309-9051-dd0d3c01604f
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUBSERVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4865814-e38a-4709-9023-9fa357868c5d
                stepCounter: df7ea2b5-d0be-4ebc-a060-e4f58253a22d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f76853a-4fc2-4163-b15c-6b835ca0c42d
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: CLINIC_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4d232b0-dd4f-4f27-9235-3e6040018e8e
                stepCounter: 5a1bab4c-fbbd-4118-84c4-caa78d82403e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17c50e88-c99b-4e23-ba1a-f7caaba654ee
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINIC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad8ee96c-f7ec-45ce-84f8-8d28d25284cb
                stepCounter: 5a1bab4c-fbbd-4118-84c4-caa78d82403e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dee6678-e096-4ab7-a25a-564e1c324800
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: SERVICE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d71a9da4-0cdb-480c-9cff-2367c26f8ce8
                stepCounter: 6e5f86ec-860d-4b48-baca-9c13f1859e07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c55d9097-35d8-4395-a69e-ca78723ee53b
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(4000)
        defaultValue: ""
        description: ""
        name: PRIORITISATION_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e32a97f-f98e-4769-80b2-66c0134440c1
                stepCounter: 1510bca2-ee4b-4586-b2e1-0e75adfc0dfa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54ffbebb-0926-418b-984d-8f9550bf0754
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: RFA_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce57da51-92a2-41c7-bdc9-74e88394d8b6
                stepCounter: 02749d1b-0752-467f-8406-957f3ef05ff1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2bf4f18-9043-4ee2-afc1-5e5637eeb9e6
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STATUS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8cfe981-133d-417e-b5e2-abcd4db4b054
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 794b2370-451c-412e-b527-b93e28383555
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TRIAGE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 324a377c-0b53-4339-8b05-95edde30f502
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33867a42-3c5a-45e1-90b7-a834d5f92660
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: SUBSERVICE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 451f559a-b396-4355-b2ea-1996fb8bdd22
                stepCounter: df7ea2b5-d0be-4ebc-a060-e4f58253a22d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b50e39e3-4359-4d68-beda-82ac4f2b9825
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FSA_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37e52b6d-9c51-4dca-bb1c-5ebf08768eb2
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06b75728-e8aa-4561-aa38-206536d0d43e
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: PASREFERRAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46a2a4a0-bb22-4878-a8c1-b58c617a74df
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ac46d92-4f22-481c-9508-703b6af2a260
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NOTIFICATION_SENT_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79283060-3dd4-4bf2-b4fb-8b4c87e41408
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c751d59-4818-47fb-b4fa-f82272824bcb
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: PRIORITY_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f847f63f-ead4-4db3-ae0a-da44255bb19e
                stepCounter: 7425ceb0-46d6-49af-825b-9b70b8b7058c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68714d15-f2d8-4eb9-9f2f-3eaef9f46dc6
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: HAS_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a581dc86-ac26-4df3-8f3f-92df911b9608
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6a5cdd0-7c37-4921-a1f2-727ac67fa816
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NOTIFY_REFERRER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6edb21d-b2d0-4e70-a3e7-c2f5d7bf91b9
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18d2b98b-3ac7-46b2-8d5b-df88da369aea
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REASON_FOR_ACTION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7921ae26-8204-4283-bcdc-1fc4eb0caa7a
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d952386-ae56-4263-a117-20fcaf1c81df
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d934ca1-4b6a-4dbc-8fcc-d4de92ae1e01
                stepCounter: 45f42544-57a7-43cf-a188-39d5f4cb3d22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8281acbe-3f95-4b3f-9ced-7eac60aa4f04
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: STATUS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 361a9faf-c42b-4cf6-a9a1-27d6d11ece90
                stepCounter: 8095d170-1f14-409d-b317-a4ee62b26ffe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da020b27-210a-470b-8b17-ad637c7fb9e6
          stepCounter: a6455497-d5e2-48ab-8174-9ab3d46cd92e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_REFERRALHISTORY
        join:
          joinCondition: |-
            FROM l_ReferralHistory rh
              LEFT JOIN l_LK_HistoryType ht
                ON ht.code = rh.historyTypeCode
              LEFT JOIN l_LK_DHB DHB
                ON DHB.id = rh.dhbId
              LEFT JOIN l_user us
                ON us.id = rh.userId
              LEFT JOIN l_LK_Service serv
                ON serv.id = rh.serviceId
              LEFT JOIN l_LK_subService subserv
                ON subserv.id = rh.subserviceId
              LEFT JOIN l_LK_Status st
                ON st.id = rh.statusId
              LEFT JOIN l_ReasonForAction ra
                ON ra.id = rh.reasonForActionId
              LEFT JOIN l_triage t
                ON t.id = rh.triageId
              LEFT JOIN l_LK_Priority pr
                ON pr.id = t.priorityId
              LEFT JOIN l_Clinic cl
                ON cl.id = t.clinicId
        name: S_EREFERRALHISTORY_10
        noLinkRefs: []
  name: S_EREFERRALHISTORY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
