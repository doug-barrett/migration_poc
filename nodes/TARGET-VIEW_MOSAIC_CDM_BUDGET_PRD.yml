fileVersion: 1
id: b0b18280-97fe-473b-8926-086a41527815
name: VIEW_MOSAIC_CDM_BUDGET_PRD
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77f3753b-db27-47de-8475-0ad797231cfe
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_VERSION_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be18fc2e-516e-459d-8de2-4ea118f6bf4c
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.R_VERSION_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d43bab2-6099-4523-96ad-7142926c8c5c
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BUDGET_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbb0b9dd-4f32-4aec-a042-de214fab66da
                stepCounter: 74461e80-5de2-4088-b526-5e077f26d4dd
            transform: TARGET.BUDGET_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45ad2b37-deef-449f-879a-394a99767113
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: BUDGET_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1af3a01c-23d3-4a60-967d-45022b25af63
                stepCounter: 506c49f4-4f4a-4269-b1ef-836009369c73
            transform: TARGET.BUDGET_EFFECTIVE_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c065c425-470a-451b-9c63-580af61f15e3
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_SRC_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6096e497-01f2-4dfd-9eb4-4b4a75759061
                stepCounter: 5319d3c0-2801-41bf-ba4a-bd4f94a0c6b4
            transform: TARGET.R_SRC_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f98f9523-399b-4bd7-993d-4ad6c649b074
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e039eb32-848d-4d6d-a38e-3f4e9e838c29
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.CASE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c615db6-1793-48a5-81a5-0158d8dffd37
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21ead381-fc0e-4503-bc25-234177292aed
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.CASE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1dfc41f-a1d3-4f59-a582-2e6ca0060cba
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: VINTAGE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bc2d8c7-8c47-4645-847d-715ee9f81e1c
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.VINTAGE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648f7369-d925-47a0-85ee-2aedd13933cc
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: VINTAGE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e2d1085-95af-47d4-b8e2-202387228b09
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.VINTAGE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2652ad4-871e-4a44-a7e5-81d392307f7c
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f018ec4-9e51-4cdd-aa86-ff6f73f36ffa
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.ENTITY_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7265aacc-2ac5-4200-a913-112f2b953d9b
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eecfbf45-70c1-4ab1-8940-dfc069ab1bc7
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.ENTITY_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4603889-2de8-42c0-a86c-975d097e7cbe
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 722cde9e-be51-4a1a-b941-5c9dc43e4ee6
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.ENTITY_UUID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 649b5bb9-8ea8-4ed7-8e2f-3af586290a58
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19a227b0-31e5-47c1-9c0a-b2e978b7da21
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.ACCT_PER_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ccebdd7-c633-4811-b120-d175d2d5682e
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ACCT_GROUP_CODE
        name: ACCT_GROUP_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77389f6-92c2-4348-815c-6f6a47661749
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.ACCT_GROUP_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48fd6d19-d40c-4b6a-a2eb-200e19f5110c
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: SAP Functional Area
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2c65aad-3d3f-448d-b08a-61eaaaa25297
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.FUNCTIONAL_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b1a6762-446d-4151-96e5-62ceba70dfe0
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: SAP Account
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06fddf13-b5aa-441e-a2da-84c6702543a7
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.ACCOUNT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7041ed07-03d6-492b-b1f8-4b3af551e616
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ed21f6f-f0d8-472c-af89-3ed33157101b
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.CC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02e499d5-e1e4-4725-bf72-6f31a928d44d
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DEST_ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ee0933c-f2d5-4856-b72d-02479f2247f2
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.DEST_ORG_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b281659-7a94-40dd-b9da-cd12cca36025
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae04033c-b572-4c18-b5aa-13c420dac1a9
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 736f2474-544d-4432-9f64-fa85018c993a
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: NUMBER(14,10)
        defaultValue: ""
        description: ""
        name: OP_FX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36903cdd-71e3-42c0-acac-df5d506ef134
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.OP_FX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bed3a45-03f1-4896-be04-40307722dc59
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c001948a-232a-4334-9783-49dbd5b2e688
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COUNTRY_CODE,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71e0c3e1-a917-4a47-9ef9-1567718ed31c
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7232afab-1540-48f7-8fee-6f30b110639d
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.PROV_CODE,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b27e9049-252b-4cfa-ab20-cb06a1896e46
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8d8af15-264c-40af-8b0b-4dce3b18ed31
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COREAREA_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd57bfc1-01b7-4e2c-987a-eec4e75478c1
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a489a103-50e2-4347-8d34-6965b140eea8
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.AREA_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6130752a-0f94-4c4b-af5b-95b9de2e6515
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3de449d8-75b7-4097-918c-39a43e892f85
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: NVL(DIM_LO_SAP_COST_CENTER.OPERATOR_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de646896-555d-43ab-b064-ed52f795922d
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30b7cb8f-ebee-460e-8fe2-5ca84a8a32be
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.VOL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fd8f744-672b-4b1e-92e7-ab01eb21f89e
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: VOL_UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2461986-1e39-409c-a8e2-16fa48b949ea
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.VOL_UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d47f62f8-b483-4c0e-8412-8b7f4eae3f59
          stepCounter: b0b18280-97fe-473b-8926-086a41527815
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4231e36-ca42-49da-bd05-ba7510504de9
                stepCounter: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
            transform: TARGET.CREATE_DT
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_MOSAIC_CDM_BUDGET_PRD_OIL: 863d0d25-2433-4440-b6ae-e2ffc3f1994e
          STAGE_MOSAIC_CDM_BUDGET_PRD_GAS: 506c49f4-4f4a-4269-b1ef-836009369c73
          STAGE_MOSAIC_CDM_BUDGET_PRD_CON: 5319d3c0-2801-41bf-ba4a-bd4f94a0c6b4
          STAGE_MOSAIC_CDM_BUDGET_PRD_NGL: 74461e80-5de2-4088-b526-5e077f26d4dd
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 067903b4-15b6-458b-abc2-85946f5a3432
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_OIL
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_GAS
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_CON
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_NGL
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_OIL') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_GAS') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_CON') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_NGL') }}
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON TARGET.CC = DIM_LO_SAP_CC_CORP_HIER_CURRENT.CC_NUM
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON TARGET.CC = DIM_LO_SAP_COST_CENTER.CC_NUM
        name: VIEW_MOSAIC_CDM_BUDGET_PRD
        noLinkRefs: []
  name: VIEW_MOSAIC_CDM_BUDGET_PRD
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
