fileVersion: 1
id: a135744b-94c6-4bc4-8cc2-b6299ac99a05
name: VIEW_MOSAIC_CDM_BUDGET_PRD
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e4e94ea-8e78-4ef4-8485-9da9c4ee3272
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_VERSION_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aac2205c-48b9-4e51-8096-3d3505a6e803
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.R_VERSION_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcbf0b7f-213e-482c-89f8-4eb5b70134c9
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BUDGET_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9707db66-545f-427a-b15f-5bd67a0c1fd9
                stepCounter: 09e033d6-1ec8-40e7-bf69-909c99dcefee
            transform: TARGET.BUDGET_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d182afe8-be1d-4a1f-95bd-7bbb6e9e47f3
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: BUDGET_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7192458-7505-4bcb-8a84-7c20bf4dbb18
                stepCounter: d598c270-a947-4ce0-8f27-03c1cd2b360d
            transform: TARGET.BUDGET_EFFECTIVE_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d61be18-d87a-4b6d-9703-3bfc1f5d1558
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_SRC_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6faf55ba-b4ee-4cef-b818-a59ea85b9c1c
                stepCounter: c2ae0cfe-6e9f-4aa0-b8fb-b42e2dcc7d0e
            transform: TARGET.R_SRC_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18366167-6a9e-4ba7-a501-747adc434bdf
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78d92eb5-f24b-4a48-9ae9-62d0be0c7ef6
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.CASE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33c5aec0-e1b0-4f52-88fb-79464fd8c566
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cde73666-eda2-467c-8b6f-54ddbe979904
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.CASE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 672b2484-ec43-47d4-8b31-7a03782c5925
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: VINTAGE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8a13066-0746-4b42-a5e0-194778a1b6b2
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.VINTAGE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c238fb8b-cdb9-42cd-9f31-61cd5bd712d5
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: VINTAGE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68cfa250-4853-4100-90d5-00f693f7a4d5
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.VINTAGE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78de4b5f-136c-4cf7-9b6c-0a3112607612
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21b270c1-e343-447f-bfae-f0a9417b1afd
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.ENTITY_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee9af093-c53a-41db-8446-973f9b7f1939
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 998da72d-5cef-4896-8d91-21b3f675b3c2
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.ENTITY_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8d09bc0-0d21-4a14-88d9-81ef558218df
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c81ad4d-d639-491e-9382-3d937342a7c2
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.ENTITY_UUID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e1cd128-6f27-4867-be4a-900bfb6e6ec6
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75c2bb2a-46ce-494e-983a-2250e9e721aa
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.ACCT_PER_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3c52d2b-f752-4dcf-b446-939b3cf1dca1
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ACCT_GROUP_CODE
        name: ACCT_GROUP_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c245dbfe-12d9-4efd-9acd-3f9f71bfb7db
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.ACCT_GROUP_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51504e27-f004-41e7-9a92-7959f21bd9dc
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: SAP Functional Area
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56399aeb-d3fe-4a91-8658-847fa719c06d
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.FUNCTIONAL_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c4dd074-4a11-4811-9916-ea102ddf062f
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: SAP Account
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a407fe64-c4a1-45de-9433-3498088b7aa3
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.ACCOUNT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa8da58e-3c52-4cca-8c9f-e0c092dc0ca4
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26c23d3b-3610-49e3-98ab-5349830354ec
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.CC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7d7b986-5771-456c-82fc-fdec97a98aba
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DEST_ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1f013ae-c2be-4446-b17d-b4c0c3a27bc1
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.DEST_ORG_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37eaa1f8-abbd-4608-b18e-9287f497ce80
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c1521d9-0711-4c0e-af78-6313c4e4cf6c
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3ef36ed-40e2-4e15-9f1b-9c69ed79af10
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: NUMBER(14,10)
        defaultValue: ""
        description: ""
        name: OP_FX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8194e67-685d-476a-84ac-c311065b4d6c
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.OP_FX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50b9023f-29d8-4e85-a405-2bd1834bc5da
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be6bca3-bee7-4f89-90bd-4834062f282a
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COUNTRY_CODE,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5afe7d9f-808d-4e02-bbe3-bfa6dddf64cc
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a738a046-11b0-4082-a0f6-a86c56484c91
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.PROV_CODE,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cce769d-8353-4389-9809-f8d873cb2fb4
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619126d9-0cd3-45df-bfbd-2f5dca6da0bd
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COREAREA_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5782b936-9b64-4dfd-b1b6-fe38e030c45b
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8da7e4-2ee4-4296-8f0a-7c334356d71e
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.AREA_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 059bbc40-9710-4a05-8376-5d1fa3523ba1
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d57224cf-3acd-4744-a6ec-a049020f4eb3
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: NVL(DIM_LO_SAP_COST_CENTER.OPERATOR_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6ff6acb-8e62-4c36-856f-fc34952a7d08
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: NUMBER(36,8)
        defaultValue: ""
        description: ""
        name: VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f9050ee-0e16-4b4f-861e-8911cb469ec8
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.VOL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc886abf-e65c-426a-b334-2d41e409acf7
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: VOL_UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddb7949f-4eb3-46c7-8a86-a5ec0d7dd8f3
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.VOL_UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4cc76c8-1c0c-4edd-9a77-5aeb8eb8afb4
          stepCounter: a135744b-94c6-4bc4-8cc2-b6299ac99a05
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 861fb6fd-e1be-4e1f-af56-ab286540e17f
                stepCounter: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
            transform: TARGET.CREATE_DT
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_MOSAIC_CDM_BUDGET_PRD_OIL: fbcb28cd-8163-46b8-8dab-8f4392dacdc9
          STAGE_MOSAIC_CDM_BUDGET_PRD_GAS: d598c270-a947-4ce0-8f27-03c1cd2b360d
          STAGE_MOSAIC_CDM_BUDGET_PRD_CON: c2ae0cfe-6e9f-4aa0-b8fb-b42e2dcc7d0e
          STAGE_MOSAIC_CDM_BUDGET_PRD_NGL: 09e033d6-1ec8-40e7-bf69-909c99dcefee
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 2cca214d-2f7a-400c-a483-58b288ed6097
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_OIL
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_GAS
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_CON
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_PRD_NGL
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_OIL') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_GAS') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_CON') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_PRD_NGL') }}
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON TARGET.CC = DIM_LO_SAP_CC_CORP_HIER_CURRENT.CC_NUM
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON TARGET.CC = DIM_LO_SAP_COST_CENTER.CC_NUM
        name: VIEW_MOSAIC_CDM_BUDGET_PRD
        noLinkRefs: []
  name: VIEW_MOSAIC_CDM_BUDGET_PRD
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
