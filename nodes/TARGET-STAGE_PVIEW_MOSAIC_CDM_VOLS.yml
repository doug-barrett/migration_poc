fileVersion: 1
id: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
name: STAGE_PVIEW_MOSAIC_CDM_VOLS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33e813bd-80cf-4908-9d1e-2415a2e3eab9
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7014a46b-a09f-4d32-ae9a-66b516c1d8d6
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba1d29b8-edfd-45a2-9acc-683b6ec50e0e
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41799d5c-90ae-4e93-aa1c-51daa903f567
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERIOD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41a8eedd-7047-4828-99a5-49b8444d80ae
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de014f43-c079-41be-be65-5ef17b8cd2ad
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6d1c243-5729-4607-b143-18969c894f1c
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84c2e90c-25c5-4b2c-a586-411562b4131d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fe4d9f8-e223-4f24-a7ee-f911bd6ebd3f
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f342daf-352b-4bba-8d23-2cb8e4272900
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0bf22cc-d650-47e6-a74c-3efeeed995af
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90040229-c62c-42c9-bb07-2139dea4c0cc
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fef79b09-91e9-4eb6-ba5d-7bc6ac8a68e6
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GAS_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72044088-bc78-4485-a428-dcf7e220d0ea
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a8bf3e0-4605-42d8-952d-e12b80f99266
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aee0ff94-da2f-4bb5-aac4-7a9492fe0821
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8f6ae1-15cb-4bad-b309-5020a5336519
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 301f6d58-7fe5-40a8-bf93-31a90fc7777e
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WATER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 854073f7-974c-410f-ad3a-5d74fe0e782a
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIELD_CONDENSATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a5db73e-1ebd-49fd-8f16-4ab37ddfc804
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 774a2c5d-49b3-4c71-8d60-1320685188eb
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec5af183-7931-46a7-a809-cc2cea111399
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fb02260-a456-465b-bed3-9232d2058471
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a66b707-cde1-44a8-90f1-067393b8223c
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc3b9525-f068-4807-9ed0-e731c681b270
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ff4d05-e0b2-44f3-aeee-3302260778d7
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd7cb6f-3240-43b7-8466-e1f54574e4db
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13eada8d-f31e-4e63-b500-3c5bb0c6a188
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8567e2ac-8df0-4345-a7fd-bb3602629bae
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SULPHUR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ed3de45-207b-4730-9f8e-cef3a7daa4e2
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FLUID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b8d0aee-f78f-425d-8284-90e435bba08b
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962ca092-8160-49e1-bd11-5560781451af
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8550c79d-7b16-4497-8853-7df67d9a5fa0
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7249a87-6d73-4ccc-a6ec-ab498983d3e0
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d741e04a-cbf4-4789-afc5-b1e71a726bfd
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdf92f72-da4f-4c24-9744-5becb72b2de6
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09277d3f-8795-4fda-9ef4-e7300297d650
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23f7626d-bdab-4b22-9481-91c9dae20c7e
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6f9cc29-72f5-4604-8a2b-d78b84a731ac
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22f6d50c-8e72-4b28-8516-b6b0f6db24bd
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98a4c169-afeb-4df8-b8fe-501de0554eb6
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: STEAM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 571f0b5e-1bcf-43a4-aafd-8f189233afae
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLYMER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f56f082-07fd-4709-8a35-c16fddcf7118
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOLVENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39e5c5f8-6e23-49a7-9831-733ac834d089
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ALKALI_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cdd4f99-dc29-4379-b3a2-c1d92dc6e0fe
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67188303-b6dc-4071-85b3-11d04139cc81
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4218dc49-776f-46b3-8c1f-eb59d153a117
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FWHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e454f3a-d3f2-4583-b2cd-40ab96ad3ba4
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f023fa24-6316-4faa-9155-08ace7f5188d
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FBHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b422fb5-c41f-49aa-ace2-91de27ece643
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ebbb6b6-8c3c-4134-b75c-22c089b12e38
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CASING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f47f5cce-108b-472c-a43a-5bc2d2562aa3
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 906d5b6e-538c-4702-8049-33a625df42cf
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TUBING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10af379-bdbe-42bc-b41b-1fb7bb49e843
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83fe3487-d73c-4967-8b86-137866c63b67
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: LINE_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce930dfe-6b7d-4b90-9462-803e255a4b1c
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac4e895f-47bb-4586-865a-1210305101e2
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERFORMANCE_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 956f6c2f-7dda-420f-93ec-9dab6c32910e
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CHOKE_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83ea1ca3-6335-41e7-a9ea-5d9d9f134217
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaefa7e3-249d-416b-87a8-1744cd0510b2
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cf6aa8f-2e96-43a3-8472-6ee102299445
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5348c21-456e-4850-bdd6-fe890e21bf65
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DAY_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc92edc5-4035-449f-9e9f-17200a6bda5f
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 805c214d-303d-4b78-8d4c-b1ef743d55c8
          stepCounter: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PVIEW_MOSAIC_CDM_VOLS: f9cfb800-3f1f-47c6-b8f1-4db10113fe2f
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ ref_no_link('TARGET','STAGE_PVIEW_MOSAIC_CDM_VOLS') }} AS WITH GasVolumes AS(
                    SELECT p.dttm,
                           p.idflownet,
                           p.volnewprodallocgas,
                           p.idrec,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'D31DB03FC64C4413B39FEBBED5004D42' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'E6FCADB21222494393E582D914245BBF' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = '13520ED8659449F38B5085DA7F464CDB' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN upper(u.district) IN ('ALBERTA')                 THEN p.volprodgathgas / 1000
                                ELSE p.volnewprodallocgas / 1000
                                 END AS gas,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volinjectgas * 1.0494811) / 1000
                                ELSE p.volinjectgas / 1000
                                 END AS injgas
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday p
                     INNER JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                   ),
                   saskGasVolumes AS(
                    SELECT fd.balfactgas,
                           f.idrec AS idrecfacility,
                           fd.dttm
                      FROM DS_PRODVIEW.pvt_pvfacilitymonthdaycalc fd
                      JOIN DS_PRODVIEW.pvt_pvfacilitymonthcalc fm
                        ON fd.idrecparent = fm.idrec
                      JOIN DS_PRODVIEW.pvt_pvfacility f
                        ON fm.idrecparent = f.idrec
                   ),
                   saskFacilities AS (
                    SELECT DISTINCT f.idrec
                      FROM DS_PRODVIEW.PVT_pvfacility f
                     WHERE typ2 = '322'
                       AND typregulatory = 'Crude Oil Multiwell Proration Battery'
                   ),
                   ab_bc_volumes AS (
                    SELECT d.idrec ,
                           d.dttm AS production_date ,
                           d.idflownet ,
                           d.idrecunit ,
                           d.idrecparam ,
                           d.durop * 24 AS hours ,
                           d.durop * 24 AS hours_inj ,
                           d.volprodgathgas / 1000 AS gas ,
                           d.volnewprodallocoil AS oil ,
                           d.volnewprodallocwater AS water ,
                           NULL AS ngl ,
                           d.volnewprodalloccond AS cond ,
                           d.volinjectgas / 1000 AS inj_gas ,
                           d.volinjectwater AS inj_water
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON d.idrecunit = u.idrec
                     WHERE upper(u.district) IN ('ALBERTA')
                   ),
                   ab_bc_ngls AS (
                    SELECT p.idflownet ,
                           p.idrecunit ,
                           p.dttm AS production_date ,
                           sum(coalesce(p.volc1liq, 0)) AS methane ,
                           sum(coalesce(p.volc2liq, 0)) AS ethane ,
                           sum(coalesce(p.volc3liq, 0)) AS propane ,
                           sum(coalesce(p.volic4liq, 0) + coalesce(p.volnc4liq, 0)) AS butane ,
                           sum(coalesce(p.volc6liq, 0) + coalesce(p.volc7liq, 0)) AS pentane ,
                           sum(coalesce(p.volic5liq, 0) + coalesce(p.volnc5liq, 0)) AS field_condensate
                      FROM DS_PRODVIEW.PVT_pvunitdispmonthday p
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                      LEFT JOIN DS_PRODVIEW.PVT_pvunitnode n
                        ON p.idrecdispunitnode = n.idrec
                     WHERE lower(n.typdisphcliq) = 'ngl'
                       AND upper(u.district) IN ('ALBERTA', 'BRITISH COLUMBIA')
                     GROUP BY p.idflownet ,
                              p.idrecunit ,
                              p.dttm
                   ) SELECT CAST(w.wellidregulatory AS varchar(50)) AS well_name,
                   d.dttm AS production_date,
                   CAST('D' AS varchar(1)) AS period_type,
                   CAST((d.durop * 24) AS float) AS hours,
                   CAST((d.durop * 24) AS float) AS hours_inj,
                   CAST(d.volnewprodallocoil AS float) AS oil,
                   CAST(CASE WHEN d.idrecfacility IN (saskFacilities.idrec) THEN saskGasVolumes.balfactgas * d.volprodgathgas / 1000 ELSE GasVolumes.gas END AS float) AS gas,
                   CAST(GasVolumes.injgas AS float) AS gas_inj,
                   CAST(NULL AS float) AS gas_cost,
                   CAST(d.volnewprodallocwater AS float) AS water,
                   CAST(d.volinjectwater AS float) AS water_inj,
                   CAST(NULL AS float) AS water_cost,
                   CAST(abbcvol.cond AS float) AS field_condensate,
                   CAST(abbcngl.ethane AS float) AS ethane,
                   CAST(NULL AS float) AS ethane_inj,
                   CAST(abbcngl.propane AS float) AS propane,
                   CAST(NULL AS float) AS propane_inj,
                   CAST(abbcngl.butane AS float) AS butane,
                   CAST(NULL AS float) AS butane_inj,
                   CAST(CASE WHEN abbcngl.production_date IS NOT NULL THEN abbcngl.field_condensate ELSE d.volnewprodalloccond END AS float) AS pentane_plus,
                   CAST(NULL AS float) AS pentane_plus_inj,
                   CAST(NULL AS float) AS sulphur,
                   CAST(NULL AS float) AS fluid,
                   CAST(CASE WHEN u.division = 'UNITED STATES' THEN d.volnewprodallocngl ELSE NULL END AS float) AS ngl,
                   CAST(NULL AS float) AS helium,
                   CAST(NULL AS float) AS helium_inj,
                   CAST(NULL AS float) AS helium_cost,
                   CAST(NULL AS float) AS carbon_dioxide,
                   CAST(NULL AS float) AS carbon_dioxide_inj,
                   CAST(NULL AS float) AS carbon_dioxide_cost,
                   CAST(NULL AS float) AS sand,
                   CAST(NULL AS float) AS sand_inj,
                   CAST(NULL AS float) AS steam_inj,
                   CAST(NULL AS float) AS polymer_inj,
                   CAST(NULL AS float) AS solvent_inj,
                   CAST(NULL AS float) AS alkali_inj,
                   CAST(NULL AS float) AS diluent_inj,
                   CAST(NULL AS float) AS diluent_cost,
                   CAST(p.preswh AS float) AS fwhp,
                   CAST(p.presbh AS float) AS fbhp,
                   CAST(p.prescas AS float) AS casing_pressure,
                   CAST(p.prestub AS float) AS tubing_pressure,
                   CAST(p.presline AS float) AS line_pressure,
                   CAST(NULL AS float) AS performance_index,
                   CAST(p.szchoke AS float) AS choke_size,
                   CAST(w.idrec AS varchar(32)) well_idrec,
                   CAST(d.idrec AS varchar(32)) day_idrec,
                   CAST(current_timestamp() AS timestamp_ntz) AS DSS_LOAD_DATE
              FROM DS_PRODVIEW.PVT_pvunitcomp AS w
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON w.idrecparent = m.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonthday d
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON d.idrecunit = u.idrec
              LEFT JOIN DS_PRODVIEW.PVT_pvUnitCompParam p
                ON d.idrecparam = p.idrec
             INNER JOIN GasVolumes
                ON GasVolumes.idrec = d.idrec
              LEFT JOIN saskGasVolumes
                ON (saskGasVolumes.idrecfacility = d.idrecfacility AND saskGasVolumes.dttm = d.dttm)
              LEFT JOIN saskFacilities
                ON saskFacilities.idrec = d.idrecfacility
              LEFT OUTER JOIN ab_bc_volumes abbcvol
                ON abbcvol.idrecunit = d.idrecunit
               AND abbcvol.production_date = d.dttm
              LEFT OUTER JOIN ab_bc_ngls abbcngl
                ON abbcngl.idrecunit = d.idrecunit
               AND abbcngl.production_date = d.dttm
             WHERE m.dttmstart >= DATE_TRUNC('Month', ADD_MONTHS(CURRENT_DATE(), -10))
               AND w.wellidregulatory IS NOT NULL
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: STAGE_PVIEW_MOSAIC_CDM_VOLS
        noLinkRefs: []
  name: STAGE_PVIEW_MOSAIC_CDM_VOLS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
