fileVersion: 1
id: 98fc33d5-a6ca-4da5-883b-200fbfd01754
name: STAGE_PVIEW_MOSAIC_CDM_VOLS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eff46aa-144c-4206-b66c-c2291ab48fcb
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295d169a-8764-40e9-9347-7e6746bb1d69
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 128217fb-f1f3-4bf5-a520-0b078fe941e6
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49948320-db9c-4a57-a4af-dcff01315eb8
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERIOD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 690e5f83-2fc0-4c3b-873e-0de455feffa9
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc9b65f4-d3ad-4731-87e1-d4e4f22f8f48
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 964deab5-9372-4a90-b76f-92934ea52e9a
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e92701-932c-44a3-8a80-84585564dcb2
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: befde632-dc53-4b18-8361-3dbce0c1897c
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed079b9e-40b2-4ef1-a22a-2af799344a29
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a1eebb5-3c04-445b-813f-4edd75bf50a7
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb6415a-5401-4be1-a750-7dc668fa02b5
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 757b64e6-842c-4285-8931-e7da2ece9f2d
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GAS_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80291043-7696-49a9-a3ce-7f4479dd4b8c
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d150863-195c-46f9-b422-962623c38c57
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa1a627c-00f9-4edf-8b9e-f6a59882b788
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7984656-93a2-45f4-8fc0-3e4f11df74e8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2dc6ce1-e13f-40dd-9a7f-24f2391f90cf
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WATER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb812546-a182-43e7-bdd8-cec72ada5b9a
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIELD_CONDENSATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82c9eaf6-696b-4c4e-bd08-47c7095828c3
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cefae6d2-02b3-487c-af7b-af402168355a
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45ae062b-362f-454f-8e20-658b62b4f15e
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc5858ad-dc0b-4820-8254-386b4c195782
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9fd4afb-69f1-48cd-8621-3ae33124e592
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ef4b682-da40-46a1-a367-7dd4164dee40
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efcc44f9-6d0f-4620-b57a-2b77367b8fb3
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5839b94-93f3-48a5-80b9-9758740db524
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e28b8092-930e-43e6-9afb-dcb64adb9ac9
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87190830-b823-4721-b358-8e8af639d9d5
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SULPHUR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee4920e-a23e-4f8a-a7bf-671cfd996541
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FLUID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e5dedb3-fcff-459d-9666-f59aa5549258
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fdfffed-e6ec-4c8d-806e-5228b53b4ba7
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a36963-f104-48c8-ba0d-208c29decd13
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9985c1e7-be72-4fd2-8ff6-f2218d2751f0
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 169ad8d7-0882-46fc-9970-9e66d724ae14
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22ad800e-fc21-46be-9cea-d76830cad778
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddd76583-f22a-412e-8023-0cd207035aff
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9b1cb85-206f-48bf-ba07-bccca3dcf56d
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd2dd5d9-3b7c-46fa-beff-19ee2b5c48b8
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ded8599-0ca0-4195-b49e-36a405e7662d
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a687e52f-077a-45ad-b566-9e20c6f37c2e
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: STEAM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5d012c3-a63a-4ff4-b21a-fff91a6c80b6
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLYMER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a920ceea-2e7b-484e-a819-c07bbd1dd95b
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOLVENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e28ef8ae-d5dc-4588-878e-ec6ae6f23d59
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ALKALI_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4ac1c3-bee7-4f87-82bf-eeec78f44729
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b72cfb9-5998-43f1-b9d5-0d8f071795a3
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76649bed-61d4-449c-91b7-a4821f7ea9bb
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FWHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e39e0f91-da22-4c5f-a206-240e833d3a8f
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aa81147-01fa-487c-915c-8e65652a7155
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FBHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bf7a9b8-71d6-4610-bc03-2f8fcdae2a3e
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb52e0d1-7b00-4a46-af78-d7606dff4c0c
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CASING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cc4c5c0-41bd-4baf-9231-65a7b10166d3
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 402cadba-6d64-46c6-b2d5-8d6d83e9b22d
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TUBING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee6f2c1-12c9-4465-b37b-154bba143d3c
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84585708-a23e-4351-b4e0-2e5cdca5359a
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: LINE_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8a8a322-d205-40f9-8a30-6c67d8cf8295
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adbf84b3-e3d2-48ee-bd85-5425748d80ed
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERFORMANCE_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e65a32e-9f15-498f-9821-2fd4a80c008f
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CHOKE_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0cf42e-9f0f-4201-b634-280b4b6f36fa
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a288773c-31a2-4e6f-b0cd-6634ffc605fc
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f76be576-f021-42f1-a5bc-c6dfa35d25fb
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f71340db-429b-46ff-beb0-ca066a18a4fe
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DAY_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e85cf3cd-21cb-480f-91e9-89a679db2cc4
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe5df454-1539-48ff-917d-c49b915d7e99
          stepCounter: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PVIEW_MOSAIC_CDM_VOLS: 98fc33d5-a6ca-4da5-883b-200fbfd01754
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ ref_no_link('TARGET','STAGE_PVIEW_MOSAIC_CDM_VOLS') }} AS WITH GasVolumes AS(
                    SELECT p.dttm,
                           p.idflownet,
                           p.volnewprodallocgas,
                           p.idrec,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'D31DB03FC64C4413B39FEBBED5004D42' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'E6FCADB21222494393E582D914245BBF' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = '13520ED8659449F38B5085DA7F464CDB' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN upper(u.district) IN ('ALBERTA')                 THEN p.volprodgathgas / 1000
                                ELSE p.volnewprodallocgas / 1000
                                 END AS gas,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volinjectgas * 1.0494811) / 1000
                                ELSE p.volinjectgas / 1000
                                 END AS injgas
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday p
                     INNER JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                   ),
                   saskGasVolumes AS(
                    SELECT fd.balfactgas,
                           f.idrec AS idrecfacility,
                           fd.dttm
                      FROM DS_PRODVIEW.pvt_pvfacilitymonthdaycalc fd
                      JOIN DS_PRODVIEW.pvt_pvfacilitymonthcalc fm
                        ON fd.idrecparent = fm.idrec
                      JOIN DS_PRODVIEW.pvt_pvfacility f
                        ON fm.idrecparent = f.idrec
                   ),
                   saskFacilities AS (
                    SELECT DISTINCT f.idrec
                      FROM DS_PRODVIEW.PVT_pvfacility f
                     WHERE typ2 = '322'
                       AND typregulatory = 'Crude Oil Multiwell Proration Battery'
                   ),
                   ab_bc_volumes AS (
                    SELECT d.idrec ,
                           d.dttm AS production_date ,
                           d.idflownet ,
                           d.idrecunit ,
                           d.idrecparam ,
                           d.durop * 24 AS hours ,
                           d.durop * 24 AS hours_inj ,
                           d.volprodgathgas / 1000 AS gas ,
                           d.volnewprodallocoil AS oil ,
                           d.volnewprodallocwater AS water ,
                           NULL AS ngl ,
                           d.volnewprodalloccond AS cond ,
                           d.volinjectgas / 1000 AS inj_gas ,
                           d.volinjectwater AS inj_water
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON d.idrecunit = u.idrec
                     WHERE upper(u.district) IN ('ALBERTA')
                   ),
                   ab_bc_ngls AS (
                    SELECT p.idflownet ,
                           p.idrecunit ,
                           p.dttm AS production_date ,
                           sum(coalesce(p.volc1liq, 0)) AS methane ,
                           sum(coalesce(p.volc2liq, 0)) AS ethane ,
                           sum(coalesce(p.volc3liq, 0)) AS propane ,
                           sum(coalesce(p.volic4liq, 0) + coalesce(p.volnc4liq, 0)) AS butane ,
                           sum(coalesce(p.volc6liq, 0) + coalesce(p.volc7liq, 0)) AS pentane ,
                           sum(coalesce(p.volic5liq, 0) + coalesce(p.volnc5liq, 0)) AS field_condensate
                      FROM DS_PRODVIEW.PVT_pvunitdispmonthday p
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                      LEFT JOIN DS_PRODVIEW.PVT_pvunitnode n
                        ON p.idrecdispunitnode = n.idrec
                     WHERE lower(n.typdisphcliq) = 'ngl'
                       AND upper(u.district) IN ('ALBERTA', 'BRITISH COLUMBIA')
                     GROUP BY p.idflownet ,
                              p.idrecunit ,
                              p.dttm
                   ) SELECT CAST(w.wellidregulatory AS varchar(50)) AS well_name,
                   d.dttm AS production_date,
                   CAST('D' AS varchar(1)) AS period_type,
                   CAST((d.durop * 24) AS float) AS hours,
                   CAST((d.durop * 24) AS float) AS hours_inj,
                   CAST(d.volnewprodallocoil AS float) AS oil,
                   CAST(CASE WHEN d.idrecfacility IN (saskFacilities.idrec) THEN saskGasVolumes.balfactgas * d.volprodgathgas / 1000 ELSE GasVolumes.gas END AS float) AS gas,
                   CAST(GasVolumes.injgas AS float) AS gas_inj,
                   CAST(NULL AS float) AS gas_cost,
                   CAST(d.volnewprodallocwater AS float) AS water,
                   CAST(d.volinjectwater AS float) AS water_inj,
                   CAST(NULL AS float) AS water_cost,
                   CAST(abbcvol.cond AS float) AS field_condensate,
                   CAST(abbcngl.ethane AS float) AS ethane,
                   CAST(NULL AS float) AS ethane_inj,
                   CAST(abbcngl.propane AS float) AS propane,
                   CAST(NULL AS float) AS propane_inj,
                   CAST(abbcngl.butane AS float) AS butane,
                   CAST(NULL AS float) AS butane_inj,
                   CAST(CASE WHEN abbcngl.production_date IS NOT NULL THEN abbcngl.field_condensate ELSE d.volnewprodalloccond END AS float) AS pentane_plus,
                   CAST(NULL AS float) AS pentane_plus_inj,
                   CAST(NULL AS float) AS sulphur,
                   CAST(NULL AS float) AS fluid,
                   CAST(CASE WHEN u.division = 'UNITED STATES' THEN d.volnewprodallocngl ELSE NULL END AS float) AS ngl,
                   CAST(NULL AS float) AS helium,
                   CAST(NULL AS float) AS helium_inj,
                   CAST(NULL AS float) AS helium_cost,
                   CAST(NULL AS float) AS carbon_dioxide,
                   CAST(NULL AS float) AS carbon_dioxide_inj,
                   CAST(NULL AS float) AS carbon_dioxide_cost,
                   CAST(NULL AS float) AS sand,
                   CAST(NULL AS float) AS sand_inj,
                   CAST(NULL AS float) AS steam_inj,
                   CAST(NULL AS float) AS polymer_inj,
                   CAST(NULL AS float) AS solvent_inj,
                   CAST(NULL AS float) AS alkali_inj,
                   CAST(NULL AS float) AS diluent_inj,
                   CAST(NULL AS float) AS diluent_cost,
                   CAST(p.preswh AS float) AS fwhp,
                   CAST(p.presbh AS float) AS fbhp,
                   CAST(p.prescas AS float) AS casing_pressure,
                   CAST(p.prestub AS float) AS tubing_pressure,
                   CAST(p.presline AS float) AS line_pressure,
                   CAST(NULL AS float) AS performance_index,
                   CAST(p.szchoke AS float) AS choke_size,
                   CAST(w.idrec AS varchar(32)) well_idrec,
                   CAST(d.idrec AS varchar(32)) day_idrec,
                   CAST(current_timestamp() AS timestamp_ntz) AS DSS_LOAD_DATE
              FROM DS_PRODVIEW.PVT_pvunitcomp AS w
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON w.idrecparent = m.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonthday d
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON d.idrecunit = u.idrec
              LEFT JOIN DS_PRODVIEW.PVT_pvUnitCompParam p
                ON d.idrecparam = p.idrec
             INNER JOIN GasVolumes
                ON GasVolumes.idrec = d.idrec
              LEFT JOIN saskGasVolumes
                ON (saskGasVolumes.idrecfacility = d.idrecfacility AND saskGasVolumes.dttm = d.dttm)
              LEFT JOIN saskFacilities
                ON saskFacilities.idrec = d.idrecfacility
              LEFT OUTER JOIN ab_bc_volumes abbcvol
                ON abbcvol.idrecunit = d.idrecunit
               AND abbcvol.production_date = d.dttm
              LEFT OUTER JOIN ab_bc_ngls abbcngl
                ON abbcngl.idrecunit = d.idrecunit
               AND abbcngl.production_date = d.dttm
             WHERE m.dttmstart >= DATE_TRUNC('Month', ADD_MONTHS(CURRENT_DATE(), -10))
               AND w.wellidregulatory IS NOT NULL
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: STAGE_PVIEW_MOSAIC_CDM_VOLS
        noLinkRefs: []
  name: STAGE_PVIEW_MOSAIC_CDM_VOLS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
