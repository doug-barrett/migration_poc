fileVersion: 1
id: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
name: S_OUTPATIENT_SESSION_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fa4ee97-ae82-4e23-811f-4984d76ed610
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aebe51f-afa6-4a67-b614-6d02432831d2
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbe20870-117a-4791-a9b1-a9fbbb9c0cda
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ddf0097-a3e9-4227-b06e-b4ec27a9d3b9
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 111fb4f1-c78a-4cdd-9c28-4b16eb1ed4ee
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d59c173-815d-4bac-b08f-16eeb6e77d12
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48c04bff-3000-425f-9f96-9ad238cee421
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9ab472f-f190-4ac5-bf04-e6fc218f491b
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORGANISATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0af1a171-4d87-4b92-bab5-a77d9d83a28e
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f5a1861-3a21-4112-97ef-d9301174041a
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAFF_TEAM_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b49e1f14-fdea-4f01-ab4f-c43523fd8f10
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47b81cd2-7f70-4a5e-b7d7-665a16a88697
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1820583-23be-4261-bdae-40eda026bc41
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c2471b2-b923-4423-9c83-fc7fe7977984
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58f9fd14-fe41-4979-9ac6-f1e057c3c36d
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 857ebc02-d7b8-4baa-baf5-4cb6bbfd674a
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73dcef6c-cd0b-46d7-9806-a2bcf07e7e0f
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9461471-943d-4da6-a94d-32a430e91a52
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_CANCEL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71c551f5-4e44-4da1-8fdc-e9ccf8334dde
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64b66fdd-f8a2-4a1e-bdf7-c72618d605f4
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd46a4df-2dbb-4306-95a2-03d325fc85bf
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89d646b7-f9d3-4093-8cea-0d422e3b8189
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0262e776-b2a0-4ba0-9469-0d60130f8c46
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9cd46d1-21df-480f-b06c-789946b9e710
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b801819-985f-4724-b70d-50632d93abfe
                stepCounter: 4c45cc7f-f1b6-486a-a5d9-4c991d02faf7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d436bb3-0a40-445e-932f-e030bad04c06
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CHANGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 805faae2-e5dc-46ff-9940-6d9f1f50c32d
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 641b056d-525b-44ba-a3e2-03f1e340178b
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3d6090c-c60b-4bdc-aaae-524d716c7606
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41190506-204a-4316-a961-557a1ecc355a
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_FREQUENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82de73f8-8920-4fb4-9869-75389c8348a8
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be253d66-618f-491d-86f1-237f8b600451
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_FREQUENCY_OFFSET_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2a7b8a0-d7aa-49c7-88e5-658407a8b908
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 820119d5-0003-4d14-bf61-a95443e06cdb
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_FREQUENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bd1bbd7-27ef-4d38-ae43-3a891560e724
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f8ae113-5af2-4b29-b11e-633bb37db762
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_FREQUENCY_OFFSET_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 038f0abe-245a-4039-8c96-d8ee08d8e06a
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57f99620-1653-429a-83b2-bf94deb3ee19
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0890bf16-4287-46d8-98d8-67da1cc1d70d
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0716038-f01e-4d15-9bf2-d086a809d261
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_LATE_START_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa44ca0c-fe9a-4111-bf5d-45bdc72376cb
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b6209c5-4168-4531-80a7-0f41fa45026a
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20c2341a-8b7e-4ff2-94a4-72b015c2691f
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66e6693f-259f-43b7-a5a0-3c5c8f61bdd9
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SESSION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e7f2778-4d11-4214-a799-d6e6f31945bc
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: LEFT(ds_session_05.appointment_code+':'+ISNULL(ds_session_05.appointment_desc,''),255)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdcb8bca-8852-4657-a5f3-51499fd5bdc9
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_DAY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20c2341a-8b7e-4ff2-94a4-72b015c2691f
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: |-
              CASE WHEN appointment_code LIKE '%AD%' THEN 'All Day'
                          WHEN appointment_code LIKE '%AM%' THEN 'AM'
                          WHEN appointment_code LIKE '%PM%' THEN 'PM'
                          ELSE 'Not Specified'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba7d07ea-6f0c-4ed9-9061-847ddf0bdef6
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GROUP_CLINIC_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c2d921a-52d6-4fdb-aaf4-9825e910172a
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6008eaab-2971-435d-a3eb-ebcf8e7afb2c
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EXCLUDE_HOLIDAYS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c58e46a8-d5a5-4b6b-bff1-b3489629769c
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14458751-ba63-472b-bc7d-a1e0628d6500
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FINAL_SESSION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c167fe83-f9cc-44fe-93bc-86b6b3b89805
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c931265-ac6e-4d20-b714-3c606e05cba9
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CANCELLED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0262e776-b2a0-4ba0-9469-0d60130f8c46
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: |-
              CASE WHEN dim_session_status.session_status_code IN ('SESOH','SESCN')--('Session on Hold','Session Cancelled')
               THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6abd00ab-12e4-494c-aa3e-94934f38d132
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: If the template flag is No and there is no template linked this indicator is 'N'  If there is a template linked the value is 'Y' irrespective of the iPM template flag
        name: TEMPLATE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 269210eb-4fd1-4173-a1f7-d504579cfacd
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: |-
              CASE WHEN ds_session_05.template_flag= 'N' AND ds_session_05.template_reference_no IS NOT NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 840b175b-e492-49dc-9344-2c37fe42cde3
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c675007b-9b02-4e12-a764-ce4c8121b656
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5ad13ee-127d-4a9a-bf52-3d7b2edbf0e0
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e8dc075-0195-406b-a0a0-0bf59fa8f3a8
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb19e2a6-ac9c-4c92-b09a-4b6744d9a394
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration UOM
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dced947-4f6a-484c-aacf-c42812e27f28
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_SLOT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65ad9e33-e6d2-40ad-9141-f1df660679fb
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a79f221-1555-48fa-b800-ca0a78f360e6
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a62225f-a755-4166-9814-3b631418394f
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ISNULL(ds_session_05.session_duration_mins,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3295226c-5e55-4646-904c-433ec15bb2df
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_DURATION_CALC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73dcef6c-cd0b-46d7-9806-a2bcf07e7e0f
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ISNULL(DATEDIFF(mi,ds_session_05.start_date,ds_session_05.end_date),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f1dae33-373f-44be-a9fe-17705285203b
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CLINICS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20c2341a-8b7e-4ff2-94a4-72b015c2691f
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: |-
              CASE WHEN appointment_code LIKE '%AD%'                                                                                                                          THEN 2
                          WHEN appointment_code LIKE '%AM%'                                                                                                                          THEN 1
                          WHEN appointment_code LIKE '%PM%'                                                                                                                          THEN 1
                          WHEN appointment_code NOT LIKE '%AD%' AND appointment_code NOT LIKE '%AM%' AND appointment_code NOT LIKE '%PM%' AND DATEDIFF(N,start_date,end_date) >= 270 THEN 2
                          WHEN appointment_code NOT LIKE '%AD%' AND appointment_code NOT LIKE '%AM%' AND appointment_code NOT LIKE '%PM%' AND DATEDIFF(N,start_date,end_date) <= 270 THEN 1
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c5a8706-9a51-4f6e-8f8e-1c7d8f312cf7
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_ACTUAL_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_session_05.session_duration_mins / ds_session_05.slot_duration_mins,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 008d7eee-c057-4c58-87d0-3eb830926546
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e150997-06bf-4b43-bab0-21517c677a7d
                stepCounter: 87130f70-257b-4d4c-8ea1-256f416d8520
            transform: ISNULL(s_service_point_time_slot.available_slots,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 990c0a3c-5fa0-4538-8b24-45a78083562c
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_NEW_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad42607a-43f1-484d-8a6c-9602d0f4128f
                stepCounter: 87130f70-257b-4d4c-8ea1-256f416d8520
            transform: |-
              CASE WHEN ISNULL(s_service_point_time_slot.FUP_slots,0) > 0 THEN 0
                          ELSE ISNULL(s_service_point_time_slot.new_slots,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fcbef51-dd61-4783-afb4-4888afb0a3db
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_FUP_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e79d15-f7a7-475d-b8c3-b9ef26738465
                stepCounter: 87130f70-257b-4d4c-8ea1-256f416d8520
            transform: |-
              CASE WHEN ISNULL(s_service_point_time_slot.new_slots,0) > 0 THEN 0
                          ELSE ISNULL(s_service_point_time_slot.FUP_slots,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19e1bd5e-fa7a-4c5c-9bd6-bf1ad72de22c
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_MIXED_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e150997-06bf-4b43-bab0-21517c677a7d
                stepCounter: 87130f70-257b-4d4c-8ea1-256f416d8520
            transform: |-
              CASE WHEN ISNULL(s_service_point_time_slot.new_slots,0) + ISNULL(s_service_point_time_slot.fup_slots,0) > 1 OR (ISNULL(s_service_point_time_slot.new_slots,0) = 0 AND ISNULL(s_service_point_time_slot.fup_slots,0) = 0) THEN ISNULL(s_service_point_time_slot.available_slots,0)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e5c66a3-7d51-4744-bb1f-fd1d8bc9eee0
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PATIENTS_MAX_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5652df3e-6301-4aa0-b6db-fa012b5c606f
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ISNULL(ds_session_05.max_patients,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74928ab1-c30b-4841-a8a6-f769a1ea8b80
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b4aa930-e064-42c2-a33d-39abf32a1e31
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ISNULL(s_outpatient_appointment_summary_v.appointments_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6021c38c-a763-4f26-93a4-714c5507890c
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 143dc2d7-2425-4e4e-a1d8-d5210a96d5f8
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ISNULL(s_outpatient_appointment_summary_v.new_attends_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3684ff1-552e-485c-87ef-792c5157a301
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c892d0b4-b689-4a09-a4a0-598a81f2f38d
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ISNULL(s_outpatient_appointment_summary_v.new_DNA_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf91d23b-447f-4b41-a2c6-46761d815642
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edf7e435-de48-424c-8219-cadee0458a45
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ISNULL(s_outpatient_appointment_summary_v.new_incomplete_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 076cb841-7907-4d43-959d-d3afd1f3759c
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac6cd69d-aa28-4b4e-b75e-902d546b0575
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ISNULL(s_outpatient_appointment_summary_v.FUP_attends_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4990d0e8-4136-41bc-ae10-f5cf0796de12
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9823e61-c400-47b3-9dd3-c79b52ef6f51
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ISNULL(s_outpatient_appointment_summary_v.FUP_DNA_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a61ad44-664b-40e3-bcaf-6ffdbad5a58d
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0e46fa1-3a40-460a-becc-cae80009c6dc
                stepCounter: b00c29c9-9d43-44b5-a0f9-6ebb40068695
            transform: ISNULL(s_outpatient_appointment_summary_v.FUP_incomplete_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eae0c5c-823b-4d93-bffc-f1781128e7fc
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_SESSION_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb698660-b7e5-4a8c-85bd-38f80de5ff93
                stepCounter: b8f2e9ed-f4de-4673-a6a6-77921306ca70
            transform: |-
              -- ROW_NUMBER() OVER (PARTITION BY ds_session_05.service_point_session_reference_no
               -- ORDER BY ds_session_05.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8bd0c56-a3a7-41fd-8ad5-e247860a32ed
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_SESSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7952fa10-2080-42db-b874-b4d7c511b0a0
                stepCounter: b8f2e9ed-f4de-4673-a6a6-77921306ca70
            transform: --COUNT(1) OVER (PARTITION BY ds_session_05.service_point_session_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96bef029-07e0-4d51-96d6-c4eaa6e6005b
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ae8667-ce3a-4caa-b007-49c54ab45d30
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 123c88da-2c47-4e7b-bd1c-6968c2960bb5
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc171a9c-0f9b-489d-970f-5856190bda9f
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: INSTRUCTIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68562c8f-40e3-4a3c-bc2e-3c8489d6cfb9
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 485bafc8-935f-4da8-a9ad-a715957ea9dc
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e052672-32a1-4601-b092-9bbc08fc6fbf
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdddc6e5-6939-44ca-b8a1-99e5789a75a9
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SESSION_WEEKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c93ee2e-f50c-4821-a4af-ac75348af466
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b3eb9c4-2220-47f2-a8d4-b8a6f92e3c6a
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5a0bac5-983e-4117-a3c4-870caca232aa
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 879ba5bb-0acc-475d-8b5d-3d04a9659f5a
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4755f18-1867-41e5-ae91-8d459b74bc0d
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bc9ef55-e719-40be-8128-6edff9f5140f
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4c4c830-594d-4b36-a49b-e2a4beb9fd78
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cd098ec-0802-4acc-bc13-8340e93e796f
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbb355cb-c687-4507-b806-e8a52fd7ca80
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f34ffae8-f5f0-4bae-b859-2965826d4d5c
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24e3c798-836d-40a4-9256-02dd4a324946
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaf974af-edc8-4577-b21b-ec413d01fe59
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EXCLUDE_HOLS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c58e46a8-d5a5-4b6b-bff1-b3489629769c
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16c465a4-f1b1-4ff3-b3ed-440ce3c5d7cc
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4a0b3af-082e-419d-a1dc-bb45f7aa3864
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eb8fbde-8b7d-42f4-99ca-17037bc0f811
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e978a9d-75e7-491a-8406-fc9282e42674
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a17bfaee-a6e8-4003-ba33-1bbfc720b902
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ab08457-bdd3-4abc-98fa-a24a449dca84
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 967e86ef-7bca-4775-80b7-9b503b72ef7a
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b2c6d74-f8f4-4518-8507-2035a0fdf90e
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b3b9891-e6ef-467d-9e46-82cd69c46ff4
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00d70629-7d7d-4c5a-bb88-37c8fe6523f5
                stepCounter: 8152c67e-e9e3-43f0-b624-8ba3f0ba31aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b131cd3-0dab-4e48-b2ea-5ac60cfd7592
          stepCounter: 24fa0dcd-24e0-46f2-a2c8-197ec73f7d57
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_SESSION_05
        join:
          joinCondition: |-
            FROM ds_session_05
              JOIN ds_session_05_v
                ON ds_session_05_v.service_point_session_reference_no = ds_session_05.service_point_session_reference_no
             INNER JOIN dim.dim_clinic
                ON dim_clinic.clinic_reference_no = ds_session_05.service_point_reference_no
               AND ds_session_05.start_date BETWEEN dim_clinic.dss_start_date AND dim_clinic.dss_end_date
              LEFT OUTER JOIN dim.dim_session_status
                ON ds_session_05.session_status_reference_no = dim_session_status.session_status_reference_no
               AND ISNULL(dim_session_status.dss_start_date, GETDATE()-10000) <= ds_session_05.start_date
               AND ISNULL(dim_session_status.dss_end_date, GETDATE()+10000) >= ds_session_05.start_date
              LEFT OUTER JOIN s_service_point_time_slot
                ON ds_session_05.service_point_session_reference_no = s_service_point_time_slot.service_point_session_reference_no
              LEFT OUTER JOIN s_outpatient_appointment_summary_v
                ON ds_session_05.service_point_session_reference_no = s_outpatient_appointment_summary_v.outpatient_session_reference_no
              LEFT OUTER JOIN dim.dim_outpatient_session dim_outpatient_session
                ON dim_outpatient_session.session_code = ds_session_05.appointment_code
               AND dim_outpatient_session.session_desc = ds_session_05.appointment_desc
             WHERE 1=1
               AND ds_session_05.dss_update_time > @v_pa_outpatient_incremental
                OR dim_outpatient_session.session_code IS NULL
        name: S_OUTPATIENT_SESSION_10
        noLinkRefs: []
  name: S_OUTPATIENT_SESSION_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
