fileVersion: 1
id: a14f6494-a680-4a92-992d-bb9f336b1a04
name: S_PATIENT_ADDRESS_COPY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc7fc87e-b740-4121-ad3a-855d1f22ef96
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bb6989f-3b3d-4572-8586-6ead81d9288a
                stepCounter: e952df2a-b46c-4e7e-a0d9-796e3d1da26d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d697b71-cb1b-47b5-acb5-6f5b406f21ea
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 453cfd50-ee1a-410a-b247-84813f63a6b1
                stepCounter: e952df2a-b46c-4e7e-a0d9-796e3d1da26d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50152b8b-299a-48a4-bc73-5d46ab7dd90f
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0c5a757-c86b-4961-95bd-b1ab201333f4
                stepCounter: e952df2a-b46c-4e7e-a0d9-796e3d1da26d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ac3bd00-c7ea-48df-a2ce-67e64514cdeb
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 330bb5ea-63e8-475b-9d2d-8bdc890dd3da
                stepCounter: e952df2a-b46c-4e7e-a0d9-796e3d1da26d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dabaec9-ce05-47b0-849b-5b0568d00c4c
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 228515a1-a04c-4089-8463-ad2aea6791b9
                stepCounter: 283949d0-53d0-4de1-a6c2-eb2852c50f7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6ac4cde-ac65-4b78-8fbf-576430cadeca
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: DOMICILE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5526f9a-56b1-4fe2-98c8-4cdb04552ef7
                stepCounter: 283949d0-53d0-4de1-a6c2-eb2852c50f7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7edb2f31-699c-4c5a-896e-6b96fbdc250f
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cce74d16-f8f6-4643-9e24-29f3606fce08
                stepCounter: 283949d0-53d0-4de1-a6c2-eb2852c50f7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87e7ac6a-7db8-4636-a656-fa5e9a4a9dd2
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DHB_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa344fa3-6f40-447f-ab93-2a6ee7acb706
                stepCounter: 283949d0-53d0-4de1-a6c2-eb2852c50f7d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2722f26b-a2ba-4922-aae3-6e64d5626e64
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DHB_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f045c7-434a-46c8-a665-3fc0a2548bdb
                stepCounter: 8e1da246-e978-4769-84e6-56526d77064b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a070c4e4-b0db-4e49-a991-52e061acfe0b
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a79a624-9887-413a-8dca-b782f6327b11
                stepCounter: 8e1da246-e978-4769-84e6-56526d77064b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb312968-3308-4a60-bd84-086010fbc3a3
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82be67f2-583e-4594-8b88-a0e1dbdd779b
                stepCounter: 8e1da246-e978-4769-84e6-56526d77064b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40ac2845-be35-4376-a116-1043a310e6ee
          stepCounter: a14f6494-a680-4a92-992d-bb9f336b1a04
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_ADDRESSES
        join:
          joinCondition: |-
            FROM ds_pims_patients
             INNER JOIN ds_pims_address_roles
                ON ds_pims_address_roles.patnt_refno = ds_pims_patients.patnt_refno
               AND ds_pims_address_roles.patnt_refno IS NOT NULL
             INNER JOIN ds_pims_addresses
                ON ds_pims_addresses.addss_refno = ds_pims_address_roles.addss_refno
               AND ds_pims_addresses.adtyp_code = 'POSTL'
             INNER JOIN l_reference_MOH_Domicile
                ON ds_pims_addresses.hdist_code = l_reference_MOH_Domicile.dom
               AND retired_year IS NULL
               AND l_reference_MOH_Domicile.dom IS NOT NULL
              LEFT OUTER JOIN ds_pims_reference_values
                ON ds_pims_addresses.cntry_refno = ds_pims_reference_values.rfval_refno
              LEFT OUTER JOIN l_reference_MOH_DHB
                ON l_reference_MOH_Domicile.dhb_area = l_reference_MOH_DHB.DHB
        name: S_PATIENT_ADDRESS_COPY
        noLinkRefs: []
  name: S_PATIENT_ADDRESS_COPY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
