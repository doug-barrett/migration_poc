fileVersion: 1
id: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
name: STAGE_LO_SAP_FINAL
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8aeb552f-bf05-4725-a17f-4b4a53d5c543
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70863540-ff3c-475f-bcfd-2cccee88e537
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e29057f-f7c1-4a28-a9fa-9bfbedae84f2
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Activity Period Date as integer
        isBusinessKey: true
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4ecff6e-9d28-4cb4-ad87-31e922ac0ae8
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_ACTVY_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc28fb49-03f5-4f67-8fc0-8fef583a83bd
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Accounting Period Date as integer
        isBusinessKey: true
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 933820d2-c93c-4055-8fbe-229b86bb02a2
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_ACCT_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3de467d-73ce-4dfa-8ed7-d83f7a0b839a
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d6ee51d-5c58-4be6-8d5f-53558192552d
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3253afeb-3960-42d4-b943-0668c5d89801
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16fc5b22-dc7e-4c95-9af4-81a167e23143
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9bd38e9-3af6-47af-84e9-f7eb4c0d04f8
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c874eb7-3d58-482f-986c-113fc425f28d
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3a91199-05bc-4f10-bfb1-96f00e1f6fbc
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ec066eb-644c-44e5-a6de-dfad754186fb
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90f9aab8-3c98-45bf-b92b-2321ca07cc85
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2211afa5-c867-439d-a0fc-59b9776c0baa
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caa37774-22ed-4218-997c-55e4aac7e72f
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d402caac-3e01-4656-818a-56d26aaa2ee8
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LEASE_OPS_HIER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ce31092-7679-4f79-bde8-ec7c9dbde34c
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8abddb3-c26f-4fb2-aeac-d738f765225d
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LEASE_OPS_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 572aaf65-3a07-4112-8228-2d5e03c0bbeb
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 406ddbbf-02d1-4b6c-ad4e-cafe16f5de12
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LINE_ITEM_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7851e53a-518d-4c63-a002-38af17027c7f
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86b9d4ed-7a33-4129-99eb-d5c9caf7b002
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_VOUCHER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 637225c7-4325-4463-9ded-60b9dd47c6ab
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 824bb3b2-75e0-48b0-8dc0-6afc8bd31683
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_AFE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cdd8d6c-9527-4885-b594-a084c09b87f5
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb0d2750-6e15-40ae-a7e0-ecda902e0e86
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_INVOICE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17735bd2-7135-4482-b280-49be59046104
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_ORDER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3ce6a76-480f-4229-8666-f68fcd59c237
                stepCounter: d5af52cd-460f-4473-aea6-9d6cb06937f3
            transform: NVL(FACT_LO_SAP_ACTUALS.DIM_ORDER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 147c0a99-90db-452f-912a-a9ed57c2e09b
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7338e132-5279-45f6-9b1e-062acc986e4e
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: NVL(STAGE_LO_SAP_UNION.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2804559a-5697-4011-88cf-e5ead8b549d2
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates if amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 496d8302-61f2-45ce-a743-9e720ecfc996
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1708c144-4fc8-4bfa-88ca-c4e9e026e8d2
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Lease Ops Hierarchy Line Number
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf8c7aae-6fe4-4423-8c95-af3e67191f55
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faea3276-574a-4ad3-8599-fddb1a819887
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Indicates if amounts are Op or Nonop
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 661dd7e6-5892-4da7-b18e-7e203b4a8ec9
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a46dac80-65c6-462b-8a42-f4d47f5e9761
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Amount in CAD
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07cc9f33-789f-48ba-8b65-fcfee9cb323f
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd5b09a-0258-424b-89b0-23ec66a8bd6b
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: CAD_AMT with Lease Ops Hier FLIPSIGN applied
        name: CAD_AMT_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07cc9f33-789f-48ba-8b65-fcfee9cb323f
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: STAGE_LO_SAP_UNION.CAD_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29a75b4f-2360-4aa4-a3ab-bf7b25fd427e
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Amount in local operation currency
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c429959-2bab-4a21-9668-a7daf902200c
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 731649f1-39ce-46a1-87d4-e3d118f774e3
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: OP_AMT  with Lease Ops Hier FLIPSIGN applied
        name: OP_AMT_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c429959-2bab-4a21-9668-a7daf902200c
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: STAGE_LO_SAP_UNION.OP_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc57bb1a-efc5-4df2-b4bb-7e2c3889ce09
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Gross Line Item Net Op Amount
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f932362c-958c-4af8-ad01-93a9a7de7b7f
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe600a78-1fd3-4501-a63e-23060f17c3a3
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Gross Line Item Net Op Amount with Lease Ops Hier FLIPSIGN applied
        name: NET_OP_AMT_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f932362c-958c-4af8-ad01-93a9a7de7b7f
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: STAGE_LO_SAP_UNION.NET_OP_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ebf3d0b-71e5-4cf3-9bd7-d17738ffac44
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Local operational currency code
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cebcbd55-2c53-4917-ac5a-b23ab113423c
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65560ff7-6b7b-487c-82fe-51eb2f8da288
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Local operational CAD exchange rate
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9488ae20-671d-4a54-a50c-8a2ead6a0e45
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d80f471e-4c38-4b46-820a-abdcffe65d30
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Canadian Amount
        name: DENOM_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5857a97b-509a-409e-85c0-cac8f5f2dbac
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec13db21-ba50-4f15-96bb-dab5b585d3ba
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Operational Amount
        name: DENOM_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec7d5346-4294-4ef4-b821-a9bb87f836ed
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50b6ef02-3e26-4283-8821-72442d413ba3
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 316d8782-ebc1-4474-be10-4d1a61bee86b
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6b63d64-2279-4728-a178-c3666480313b
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent) with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_BOE_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 316d8782-ebc1-4474-be10-4d1a61bee86b
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: STAGE_LO_SAP_UNION.LI_VOL_BOE * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dc4b567-bb52-43bf-baa5-bc9814d0bb0d
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68968d7c-f245-4f19-9264-90e4ed217e95
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8df565f1-81de-48f3-b37b-24795ec510fc
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3) with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_M3_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68968d7c-f245-4f19-9264-90e4ed217e95
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: STAGE_LO_SAP_UNION.LI_VOL_M3 * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41388145-b7db-48be-8e7f-b14cc03b5b45
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54bb1bfc-7855-487a-b255-ead107d6ae7d
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 930c2158-ca18-47f9-9773-302468363b99
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3) with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_NM3_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54bb1bfc-7855-487a-b255-ead107d6ae7d
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: STAGE_LO_SAP_UNION.LI_VOL_NM3 * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8445b132-9a90-485d-a4cd-00d8c354d6ef
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in Imperial Measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 097e8b05-032b-43ef-b5fb-ffa351223d65
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91e60a87-70ed-4982-b420-9da8e729b444
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in imperial measurement with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_IMPERIAL_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 097e8b05-032b-43ef-b5fb-ffa351223d65
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: STAGE_LO_SAP_UNION.LI_VOL_IMPERIAL * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33f69884-d235-4540-997d-45ada20abb2a
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line item Volume in BOE (Barrel of Oil Equivalent)
        name: DENOM_LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3441889a-13ee-4205-a514-b8b7374f934c
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2b18d23-6f08-4b81-b0c0-4f535618db0b
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line item Volume in cubic meters (m3)
        name: DENOM_LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: facd75cb-df19-402d-99da-7fe8965ab811
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b864ceb-d43b-4a92-958c-a197ec4f3a40
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line item Volume in normalized cubic meters (nm3)
        name: DENOM_LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62c1a931-9e69-41a5-a551-1fd74b63ca49
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf2c2870-ee98-47af-90c2-72b68fa40da1
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line Item Volume in imperial measurement
        name: DENOM_LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2849fce6-a2a0-4d6f-b160-aec144db27a3
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81f48033-7003-4767-950d-f66bf3d80814
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Business Unit Role controlling RLS access
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8a2af3f-3c81-43f5-bed5-ffb6a448597f
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58f26aa4-b797-4330-9d42-e0c29da9cf9f
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 089ef87f-7c60-4d47-ac07-24d7a9d226cd
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eccd57a-47e1-4b50-bec3-5a63ff7858ee
          stepCounter: e7944d16-ad7a-4a07-a3a4-4f835d2c4610
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 327bc2e2-2021-4d87-b6d9-7e4e8c5a41ae
                stepCounter: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_UNION: bd1ba5c4-dcb5-4cc6-adce-865ca4b066b1
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 067903b4-15b6-458b-abc2-85946f5a3432
          FACT_LO_SAP_ACTUALS: d5af52cd-460f-4473-aea6-9d6cb06937f3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_UNION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: FACT_LO_SAP_ACTUALS
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_UNION') }} STAGE_LO_SAP_UNION
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON STAGE_LO_SAP_UNION.DIM_LEASE_OPS_HIER_KEY = DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON STAGE_LO_SAP_UNION.DIM_COST_CENTER_KEY = DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY = DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
              LEFT JOIN (
                    SELECT DISTINCT DIM_LINE_ITEM_KEY,
                           DIM_ORDER_KEY
                      FROM {{ ref('TARGET','FACT_LO_SAP_ACTUALS') }}
                   ) FACT_LO_SAP_ACTUALS
                ON STAGE_LO_SAP_UNION.DIM_LINE_ITEM_KEY = FACT_LO_SAP_ACTUALS.DIM_LINE_ITEM_KEY
             WHERE NOT (NVL(STAGE_LO_SAP_UNION.CAD_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.OP_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_OP_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_CAD_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_M3,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_NM3,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_IMPERIAL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_BOE,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_M3,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_IMPERIAL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_BOE,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_NM3,0) = 0)
        name: STAGE_LO_SAP_FINAL
        noLinkRefs: []
  name: STAGE_LO_SAP_FINAL
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
