fileVersion: 1
id: 66a1dc16-5670-4860-9aba-64eacad53237
name: STAGE_LO_SAP_FINAL
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9aee9f5-2ca9-446b-9490-3d150a8e993a
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0bee7b-560a-41c5-b491-9a75f9009dba
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c236ae40-6db3-4f20-a70d-b4ca4e02ffcc
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Activity Period Date as integer
        isBusinessKey: true
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 360883a5-46b6-407f-91bf-9a008b6939ca
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_ACTVY_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22a41084-5cf0-4426-8748-4f138183aba1
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Accounting Period Date as integer
        isBusinessKey: true
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 899068ea-8494-4210-a5a1-181d7de95d39
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_ACCT_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a403f64-dd68-4e8a-be37-19f1c0169930
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8eed7246-b514-47e5-a3af-d0db96ff01fa
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 522c3817-a075-450c-8dee-41e01f95f379
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb51e93b-5801-4a52-8113-549346235838
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e616ffd6-1df1-438f-b65f-0ebd642d85ae
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0177532a-cc83-4f4e-853a-d0289ff09e3a
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3834cf52-14ad-44ce-a2e6-bc616f65d75e
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ed68b7-ad22-4f0e-b3da-4b35af6e25f6
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 841f838b-f90d-45c2-a74d-3dd0744e0952
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 164fc65f-0438-4e01-8b14-e1c8a175db17
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35dfc703-aea8-4ae4-9ead-937fa697e0dd
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6d491b-c30e-40cf-9548-898d1923ef39
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LEASE_OPS_HIER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6c74a87-416d-4f35-adac-b4181145fd7a
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf08d364-d95c-4584-8d17-3ed0ab2ff20b
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LEASE_OPS_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 185a6442-65ee-4ccf-b9a6-029ebe525bfc
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f53678a6-5752-421f-a297-76c7d5b44ed7
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_LINE_ITEM_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6a50e8d-6d29-4bd5-b3f3-ff464cef1b24
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1e02fba-f077-4df8-b468-1c74f99ee9a3
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_VOUCHER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f19e7554-4975-4c10-893e-ea2af2499d98
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea927d3d-aa1f-4460-8316-0039c592cde7
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_AFE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1784f292-2184-4833-ae07-6a18d9f38e93
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c2f6bfd-643f-4332-b257-bd37a64b0f3d
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_INVOICE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4d38c49-890b-4ba0-b221-154e134c2e22
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_ORDER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 410c6a43-3c6a-42c5-984f-1e9e3b63e47e
                stepCounter: a12e113e-c1e1-48ab-9f81-fdc5cfa0e26c
            transform: NVL(FACT_LO_SAP_ACTUALS.DIM_ORDER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb488c95-3238-41d6-b0a6-3e2d606a7261
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: System Generated Key
        isBusinessKey: true
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dfbeb81-6be7-4edf-a8d3-0f831e7c571b
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: NVL(STAGE_LO_SAP_UNION.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc2646fc-56b4-4f79-bc72-b2aca22d6b61
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates if amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28435c98-1e36-4ff2-b2a6-14f112707c02
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14b6295b-fc47-4d75-9551-d78514546e95
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Lease Ops Hierarchy Line Number
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bad3d96c-53c1-4074-a1cb-5713015cdcdc
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8c290f2-1158-4cdb-a361-38bb3fd72ff5
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Indicates if amounts are Op or Nonop
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0f17943-18b8-438b-ae68-d529bb096abe
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2a2b418-ff99-4ab0-874b-9a67ab014e59
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Amount in CAD
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf6d3c44-cfd6-4026-bde8-25caeda11585
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55602ba5-5328-47bb-a614-7cae229fdbd6
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: CAD_AMT with Lease Ops Hier FLIPSIGN applied
        name: CAD_AMT_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf6d3c44-cfd6-4026-bde8-25caeda11585
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: STAGE_LO_SAP_UNION.CAD_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e5df9e0-57fc-4e06-a192-1d5995564857
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Amount in local operation currency
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cdebfad-80cf-4119-9540-f566020f6385
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e0afd47-d448-4ac8-9605-be10d001188e
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: OP_AMT  with Lease Ops Hier FLIPSIGN applied
        name: OP_AMT_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cdebfad-80cf-4119-9540-f566020f6385
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: STAGE_LO_SAP_UNION.OP_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cd13083-fb57-4f06-acdc-df27e72a4550
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Gross Line Item Net Op Amount
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 927388ea-3e36-4a4b-a8bd-ac3d66aaada4
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 858d3ec2-730f-4913-8cba-f2165df52229
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Gross Line Item Net Op Amount with Lease Ops Hier FLIPSIGN applied
        name: NET_OP_AMT_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 927388ea-3e36-4a4b-a8bd-ac3d66aaada4
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: STAGE_LO_SAP_UNION.NET_OP_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bd7b590-83d9-4238-aca0-9c0c135dbf80
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Local operational currency code
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d7b9b46-b76b-4b5c-928a-7c29c579a31e
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e1e45b7-0276-4152-8bb6-3f131f4cd128
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Local operational CAD exchange rate
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d04aa87-dea4-4b3f-81d1-e9eca913b457
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0db8e57f-9713-4b13-9bed-aee163aeb69a
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Canadian Amount
        name: DENOM_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c76b6d21-ecd5-4e7d-bca9-a5017b81be1e
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22cc378a-4f23-45d9-8bc8-f8f1ff3dbcce
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Operational Amount
        name: DENOM_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb46b17e-0841-40c8-80df-23de9de8a1ab
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7375e8ef-23e6-4fa2-947a-ba025a80f2ee
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2526490d-d288-4e67-bdcb-c1f70286ede7
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 180e1122-1e76-4ae1-8e3a-24d2425988d4
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent) with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_BOE_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2526490d-d288-4e67-bdcb-c1f70286ede7
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: STAGE_LO_SAP_UNION.LI_VOL_BOE * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61dfc365-1c88-4752-b2bb-b67e4f021a43
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bcbbe72-9c4d-44cf-b797-53ab9612e457
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc176d5b-a8aa-4368-835e-2b596724165b
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3) with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_M3_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bcbbe72-9c4d-44cf-b797-53ab9612e457
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: STAGE_LO_SAP_UNION.LI_VOL_M3 * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4bd1954-ed1a-4bef-a6f1-f37c9c3ed645
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d75f49cd-a492-47aa-8dcf-80fc97a44a6d
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 337398c4-76f8-4b1d-a764-d85aa63b52a8
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3) with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_NM3_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d75f49cd-a492-47aa-8dcf-80fc97a44a6d
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: STAGE_LO_SAP_UNION.LI_VOL_NM3 * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89583984-bfa3-47fc-b173-c58410d3182f
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in Imperial Measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f548c8e0-3db6-4fec-bf32-703a2a937887
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 053e0dc7-b612-4168-94a8-fda54554560b
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line Item Volume in imperial measurement with Lease Ops Hier FLIPSIGN applied
        name: LI_VOL_IMPERIAL_FLPD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f548c8e0-3db6-4fec-bf32-703a2a937887
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: STAGE_LO_SAP_UNION.LI_VOL_IMPERIAL * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b6338a5-53eb-440d-bad8-3d1371da4ac9
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line item Volume in BOE (Barrel of Oil Equivalent)
        name: DENOM_LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f46331af-86ed-4140-8d55-cab8996b9c8b
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 759ae294-2c1a-4e4e-9a9c-1a617e270f43
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line item Volume in cubic meters (m3)
        name: DENOM_LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 536686d0-b0a4-4300-bca0-f37cd0f8c29b
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b576746-ed9d-481d-89ee-7424f37cec34
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line item Volume in normalized cubic meters (nm3)
        name: DENOM_LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a935520-bcb6-4435-8101-0fbd3a1c67a2
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b55f338a-0efd-48de-9ddd-f802050a70a7
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Measure Calculation Denominator Line Item Volume in imperial measurement
        name: DENOM_LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5298cc3e-4380-42e1-a048-79ce91a17cc9
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bbacfbc-de68-4b58-81cd-52e0a6758bde
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Business Unit Role controlling RLS access
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa9fccf0-4e6f-416f-be20-01e6e544d09c
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37e73764-4525-48a1-8091-c29a4c5a1aa4
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59cad466-3a33-4a2e-8aa2-3236f70c7bb9
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32ab726f-bd0f-42a0-9112-822f55290938
          stepCounter: 66a1dc16-5670-4860-9aba-64eacad53237
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c884df3-1665-43a1-8486-6ebe66af5b1a
                stepCounter: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_UNION: 802e08eb-c0d8-474e-aff7-e2131d5dbd6b
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 2cca214d-2f7a-400c-a483-58b288ed6097
          FACT_LO_SAP_ACTUALS: a12e113e-c1e1-48ab-9f81-fdc5cfa0e26c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_UNION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: FACT_LO_SAP_ACTUALS
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_UNION') }} STAGE_LO_SAP_UNION
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON STAGE_LO_SAP_UNION.DIM_LEASE_OPS_HIER_KEY = DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON STAGE_LO_SAP_UNION.DIM_COST_CENTER_KEY = DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY = DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
              LEFT JOIN (
                    SELECT DISTINCT DIM_LINE_ITEM_KEY,
                           DIM_ORDER_KEY
                      FROM {{ ref('TARGET','FACT_LO_SAP_ACTUALS') }}
                   ) FACT_LO_SAP_ACTUALS
                ON STAGE_LO_SAP_UNION.DIM_LINE_ITEM_KEY = FACT_LO_SAP_ACTUALS.DIM_LINE_ITEM_KEY
             WHERE NOT (NVL(STAGE_LO_SAP_UNION.CAD_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.OP_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_OP_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_CAD_AMT,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_M3,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_NM3,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_IMPERIAL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.LI_VOL_BOE,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_M3,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_IMPERIAL,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_BOE,0) = 0 AND NVL(STAGE_LO_SAP_UNION.DENOM_LI_VOL_NM3,0) = 0)
        name: STAGE_LO_SAP_FINAL
        noLinkRefs: []
  name: STAGE_LO_SAP_FINAL
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
