fileVersion: 1
id: c95052e4-4e24-4bba-985e-591ae1a08940
name: S_CONTRACT_VOLUME
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9c66e80-0cc8-4184-9774-2fef38a06498
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_contract_volume_phased_budget_10.PVS_ID=dim_contract_line.PVS_ID
        name: DIM_CONTRACT_LINE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa91b0e6-2a01-489b-a2fe-98e37274a1c6
                stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2e928b4-675e-4dbf-a891-88a3b8fb8450
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_CONTRACT_REPORTING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23741342-89d2-42c3-92de-f9be3eca3c3c
                stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fa19e4c-73c4-4b65-ad89-ca5a1aa55cfc
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(38,6)
        defaultValue: ""
        description: Budget revenue from the Price Volume Schedule at the phasing time period grain.
        name: BUDGET_REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c241f5c6-71cd-4310-aae5-6da9a384b3c9
                stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
            transform: s_contract_volume_phased_budget_10.budget_volume*s_contract_volume_phased_budget_10.planned_price
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dae142a1-abc9-4d73-8a7b-7541d5339ef5
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(38,6)
        defaultValue: ""
        description: Budget volume from the Price Volume Schedule at the phasing time period grain.
        name: BUDGET_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c241f5c6-71cd-4310-aae5-6da9a384b3c9
                stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2aa8232-6935-4875-9678-f4513f4a732e
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(38,6)
        defaultValue: ""
        description: ""
        name: PLANNED_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b48aa1-6bb0-47ff-ad70-4b3a03a51d34
                stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 785fc768-e4ab-41f9-870d-71f4d686814a
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: Total Budget Cost
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a2741a-a8df-4a8b-a897-6a1abdd8737d
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc3fe2e2-e485-481e-af28-d1fc484783da
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: Total Cost
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8df149ee-c18b-4deb-ac05-060fc8ad8b5a
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18d70167-6dc0-4c00-9dae-3331251e040d
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: AMED_cost
        name: AMED_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1434572-39cd-47ad-8c24-8bd4fda3afb9
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1bf5e81-e664-4f2e-9781-026390df875b
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: MHOP_cost
        name: MHOP_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e6c9321-b7c2-4ba4-91d9-4cb75619464a
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 199db1d4-a6be-4e53-ac17-3aa806051f88
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: SURG_cost
        name: SURG_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44f0feff-5416-4b66-8bca-8b3a2df82c65
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 271d94ba-1c62-42cd-b787-0811777bd0bc
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: CWF_cost
        name: CWF_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ad4edb9-5a9b-411e-9974-c04a8393ed4a
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e7e1ce1-d068-4373-97a5-af0d5798acc7
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ESC_cost
        name: ESC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21f87f1f-4525-442e-8f95-e8027da20bc7
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7938aa1-3ab5-4dd2-8713-ba95a31d742b
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: OTH_cost
        name: OTH_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525d5e1e-6d1d-460d-90c3-b1451f19cf81
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e52302eb-b711-454c-a1b5-aa8366ec6826
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: PLANNED_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dba410cb-0b25-40c2-8466-bf91653630e0
                stepCounter: 6972231e-40d6-4be7-bbb4-55c5ea1debae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d9e5bfa-34fa-4b04-9127-0a2aefa4032b
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ACTUAL_REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: s_contract_volume_phased_budget_10.planned_price * s_contract_activity_v.actual_volume
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62725cf9-5788-4032-b6c0-e04c44431b3d
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: The distinct count of source encounters. Equivalent to count of discharges and count of outpatient attendances.
        name: ENCOUNTER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a657054-1f4f-4df4-9003-8b2b44906e7c
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77480718-dc7f-4b2b-bc24-40b0d83c84e0
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: The distinct count of source encounters. Equivalent to count of discharges and count of outpatient attendances.
        name: UNCODED_ENCOUNTER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1fc3340-687b-4a03-b78a-e6fa8c7850d9
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b22ac0fb-4a04-4892-a981-348fa943c4d4
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: The distinct count of source encounters. Equivalent to count of discharges and count of outpatient attendances.
        name: CODED_ENCOUNTER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a581bcf9-c262-49c7-97b6-c4c838b6739f
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f274123-8132-4bf0-92ca-8890c9ba37f6
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: This is the volume of units for the method by which the event is funded. i.e. WIES or 1 for procedure funded purchase units.
        name: ACTUAL_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: s_contract_activity_v.actual_volume
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29870d0f-40aa-4aae-a41d-b369f1e69c1b
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags activity that has a cost attached to the events
        name: COSTED_ACTIVITY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IFNULL(s_contract_activity_v.actual_cost,0) =0 THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f314ea49-f016-4211-a252-3732f2c8cf82
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags activity that has a contract attached to the events
        name: FUNDED_ACTIVITY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IFNULL(s_contract_volume_phased_budget_10.dim_contract_line_key,0) = 0 THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c25a0fc8-0517-4b6e-883f-99d717e22755
          stepCounter: c95052e4-4e24-4bba-985e-591ae1a08940
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESTIMATED_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44898c0a-b7f8-4592-94ad-6ea85d858cdf
                stepCounter: 99b355af-7875-4d7c-bf43-9ec9000fe53c
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CONTRACT_VOLUME_PHASED_BUDGET_10: 6972231e-40d6-4be7-bbb4-55c5ea1debae
          S_CONTRACT_ACTIVITY_V: 99b355af-7875-4d7c-bf43-9ec9000fe53c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTRACT_VOLUME_PHASED_BUDGET_10
          - locationName: TGT
            nodeName: S_CONTRACT_ACTIVITY_V
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_CONTRACT_VOLUME_PHASED_BUDGET_10') }}
              LEFT OUTER JOIN {{ ref('TGT','S_CONTRACT_ACTIVITY_V') }}
                ON s_contract_volume_phased_budget_10.dim_contract_line_key = s_contract_activity_v.dim_contract_line_key
               AND s_contract_volume_phased_budget_10.dim_contract_reporting_date_key = s_contract_activity_v.dim_contract_reporting_date_key
        name: S_CONTRACT_VOLUME
        noLinkRefs: []
  name: S_CONTRACT_VOLUME
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
