fileVersion: 1
id: e297bb84-da80-41bb-b7cc-116debd50b63
name: STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 367610f1-2b93-4555-9ca2-da7586887348
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a325d6d-9888-46c6-b63e-bb58769b857e
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21c4622d-f70f-4642-bc74-eea847d2830f
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76c58856-0a87-43cf-8276-fa3246715ac8
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b2631b9-abbc-48a1-bf75-4973d2c08068
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fd0a796-c008-4f26-978e-fbcbcf5267b3
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa774014-c1a8-4598-9c6c-58022357299e
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46aa1225-7393-4687-a69d-d82459db251b
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b294886-1935-4e21-847e-0baf44bebc1f
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9f4d08b-4e36-4918-83ed-de2dfe32a4d0
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e4d315e-3f76-4564-9aac-a86d10e88f69
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9f4d08b-4e36-4918-83ed-de2dfe32a4d0
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',1)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 014af0c4-04a3-4c7a-8d9c-236381e93897
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9f4d08b-4e36-4918-83ed-de2dfe32a4d0
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: INITCAP(SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',2))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65ba1295-7370-4eb0-b87d-c3abe6a53507
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: EVENT DETAIL
        name: GA_DIMENSION15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12b9cb52-0b20-4c4a-bd8b-c0ae79101185
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c240443a-3f0b-4f5c-8a6e-901cde2fd31c
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: FORCE ID
        name: GA_DIMENSION16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a044c16e-3c72-4906-98a5-dcfd82c41930
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION16,''), '<[^>]+>|/.*', '')) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.FORCE_ID,''), '<[^>]+>|/.*', ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51cae812-e585-43c9-adcb-8cf512ebde23
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06471b4b-33d1-4c43-9dcb-9102c5163572
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41a9bfeb-3fd7-48aa-89e3-9689cb2babff
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca5a1404-c60d-4ff9-be94-b0146969934e
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3bb5045-0ab6-4ce5-9310-2faae80940f7
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6b18f34-1777-4e6b-a439-92647267be53
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22e36dc7-bbc5-4eaa-a1e1-4d2f89437488
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9faf5d41-3200-4ff6-bbed-73152a114cfd
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c255454-7745-436c-985c-e8d749634b0a
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75029bdd-4ce2-4f3d-a7d2-719101a477e4
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c862cb-5444-40af-8ca5-20182882b224
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f20c5d8b-b4a7-4957-8ee7-92a69ea4e4a3
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0059294d-c570-4d3f-b6f4-db6d219ce229
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37cd4e36-acb6-42a3-9c00-3dff28db0128
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7aade0d-dc5a-4c6b-8c8c-5a8484e0b2c7
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e73d51a4-1cf5-4812-8a74-fc81b96cac57
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8888727e-95eb-40d9-81f7-e4deb148a144
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f44dee2-6949-40bd-812b-38c709208626
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__INGESTED_AT,3) \N \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5c09e27-b926-4314-9bc1-5c931a9f6882
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619822be-a43f-4e33-9f51-4586490b9c5e
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dfd8715-2884-4910-b356-68324407e5a2
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 167cfdf9-1fde-4d25-b3a8-3a893d26ed1e
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae5612fd-ae7d-40a0-9068-e456bdea5298
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f357da1f-23f3-483f-9c4e-69e9be8e4c72
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5275cf9d-9f2d-4b11-94ca-2072650bfd59
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 520a530d-0fa0-4e72-a410-27f9d038e470
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a492073-517f-486e-843f-f0ffc3c3098c
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c06f24b-6538-4bbf-a010-07e07642660c
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39c2dd4a-aa52-4c2f-858a-cc74d0a56c2f
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c06f24b-6538-4bbf-a010-07e07642660c
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: CASE GA_HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f18d9653-bcd9-469b-be15-e5ddc808a419
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dddd22a-53ab-40a4-8e29-573519b242cb
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a3f12a4-e8f1-442b-b21d-a577584225a9
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f00c7dc7-06f7-4707-81d8-4aaf080c88dc
                stepCounter: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e55265a7-e5bd-4bbe-8d7f-f2ffc7ce1914
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34f3b33e-e0fd-4bfc-8635-d06b202db01c
          stepCounter: e297bb84-da80-41bb-b7cc-116debd50b63
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_SALES_PAGE_AGENCY_DETAIL: 4640d578-ab5c-4728-8a1f-8ba90f15df4c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_SALES_PAGE_AGENCY_DETAIL
        join:
          joinCondition: FROM {{ ref('LOAD','LOADOPC_SALES_PAGE_AGENCY_DETAIL') }} LOADOPC_SALES_PAGE_AGENCY_DETAIL
        name: SRC_STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT_1
        noLinkRefs: []
  name: STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
