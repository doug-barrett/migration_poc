fileVersion: 1
id: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
name: STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7452d73-e9a9-4444-bdc4-1bf6e9539555
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc4d3cc3-feaf-4f09-8044-285011d4610f
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd7e0ab8-3572-43f7-8aab-539736df9e00
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c454594f-b128-4a52-9621-c8824299e2c1
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a97c72f-ec15-46c5-a160-14e3cf6a8480
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39e001bb-d4e9-4715-8558-3ef44b189b98
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b15b2acc-4e16-4e58-a216-69aedea22e5f
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c153c1a1-e78e-481c-a84e-4ffdee0fddee
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54e71e75-cd87-4ee5-8f50-f060962c92b9
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2465c72-a609-4f24-ab54-5edf3a67fcca
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c38b912e-dbd2-4aeb-870a-445d8ed0f25f
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2465c72-a609-4f24-ab54-5edf3a67fcca
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',1)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e8d926-1d3c-458f-90a3-7e2dc40ea85f
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2465c72-a609-4f24-ab54-5edf3a67fcca
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: INITCAP(SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',2))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cca4152-0947-46c3-bbd0-009e5c196088
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: EVENT DETAIL
        name: GA_DIMENSION15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b73fe199-9462-4ab7-a947-ffa34cb49b6f
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 341ffcee-791b-4206-afc9-90fdf211ad82
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: FORCE ID
        name: GA_DIMENSION16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dc732c9-043a-42aa-bd38-a824ee171413
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION16,''), '<[^>]+>|/.*', '')) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.FORCE_ID,''), '<[^>]+>|/.*', ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b998475-4328-4aa8-bd70-6f7334e78d22
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28a523a8-7caa-45e3-9386-eee376a4ebe4
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3bb16c5-69cb-40f9-b252-ff559f97cac9
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4ce7542-0055-4d99-aeab-cac8b4af803a
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47c160eb-aeb6-4f9f-a431-570d18afde1a
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f248846e-c4f4-46dc-92ba-10715789ef3e
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e55f7164-911e-4732-8bd4-f300e39dcbac
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb6665d-96a1-4c51-bff4-8671dbe59545
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d47d44c-b4e2-4b71-854e-5a42c8d1edb1
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d57d497-6ed1-45f3-a408-ec9c57bbd7fd
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5788ab17-0dda-4b92-b70d-32d5dc262f8e
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 538057ed-c6f0-4e51-a752-137810acd21b
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19a29f83-047c-4bb5-bcf9-c280ed1db07f
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dec2e08f-5525-447d-b056-41d6f38fc41f
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b8bc899-7f10-4bb1-b51e-6a0e0aaec53e
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77efc9c1-5cc0-4844-8826-101b51035dab
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e487b9b-eafa-4672-99a0-e5178d50b2e5
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc398122-8b3d-4925-ad9d-5d2d2defbcc0
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__INGESTED_AT,3) \N \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcec166a-63df-4b37-bb55-2373990dfc57
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3c2525c-5c9a-4f37-9a80-ebbf40a20891
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e58b2f2b-6ef1-4e68-ae7d-49ca10670f96
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e082f43-de81-491d-ad0f-0371f2932046
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ffa7f5b-93ae-4177-9d82-f7668de8d02e
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e709d3d-6bd6-4973-925f-6c58b0af3f15
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7540a97a-a927-414d-b2bb-117919ec08ad
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 253cf10f-8a31-44ef-9e5c-13bbc1788707
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36f38e59-734a-40c3-9364-2c556990d21d
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a64a5cd3-f6c7-4c42-b999-a3f0783da303
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b6188e1-e7f0-4c9d-8ecc-9f346137394c
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a64a5cd3-f6c7-4c42-b999-a3f0783da303
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: CASE GA_HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa19c97c-ed07-475f-ab03-5e22b0ea13e0
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8d47efb-6dcf-4368-bcc1-1476cd3fbb47
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c48489be-7979-483a-8c2e-42b0bd2240e8
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dabd30ba-d018-4f21-8a80-4efb0d5990cf
                stepCounter: 5842591a-0175-452f-a74d-17ab1a9ebe0c
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dc26a21-8646-4c26-a68f-6ae2b1420abf
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bce769f-9aa1-4834-98ba-67448de41b27
          stepCounter: 5a9f04bd-7bc0-41f9-b5b1-07a7d5b00565
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_SALES_PAGE_AGENCY_DETAIL: 5842591a-0175-452f-a74d-17ab1a9ebe0c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_SALES_PAGE_AGENCY_DETAIL
        join:
          joinCondition: FROM {{ ref('LOAD','LOADOPC_SALES_PAGE_AGENCY_DETAIL') }} LOADOPC_SALES_PAGE_AGENCY_DETAIL
        name: SRC_STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT_1
        noLinkRefs: []
  name: STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
