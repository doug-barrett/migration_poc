fileVersion: 1
id: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
name: STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84819b5e-d3fc-4ca3-8aa9-e4926a968acb
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73c61978-7e98-4a6c-a56f-ea104b05320b
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f372e67a-5e65-4ef0-866b-95adfe6858ff
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e786096-48a9-4444-ba8c-1610f84cb9e5
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b280fc6-05da-4e89-9115-ad3f258542c0
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24c035e4-bbab-4c00-b733-8ec19e8c3df1
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d656ec6a-0e81-4fd2-8787-53e1bcbb1e48
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c215ec3-ca06-47ef-b091-264f63c86c0f
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ebf8265-7530-4d11-a15b-408942b0160d
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c763ea9-a603-4af3-bf01-efc4ee72a45d
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2762707e-eb06-4537-b2ee-074e76f063b3
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c763ea9-a603-4af3-bf01-efc4ee72a45d
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',1)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e500e47-124b-453e-8d0b-dc019a10521a
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c763ea9-a603-4af3-bf01-efc4ee72a45d
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: INITCAP(SPLIT_PART(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION12,'-',2))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd8a0f1e-1f9a-48f6-801b-b21c5f1a92c5
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: EVENT DETAIL
        name: GA_DIMENSION15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c880d3a7-4f63-41a5-96e9-67d09b2c9ec8
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a485b378-0229-418b-970a-a22070c1d8c8
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: FORCE ID
        name: GA_DIMENSION16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 920f1829-9a00-48d6-9382-ac536da8703e
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADOPC_SALES_PAGE_AGENCY_DETAIL.GA_DIMENSION16,''), '<[^>]+>|/.*', '')) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TRIM(REGEXP_REPLACE(COLLATE(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.FORCE_ID,''), '<[^>]+>|/.*', ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f2dfd41-e906-4cfe-81e7-a4048955c508
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 745bab7a-f403-4ef2-b503-0654b02ecb99
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1a0154b-4520-47a7-a5d7-c817efdd8102
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c0ebb56-b081-426c-aeb6-af9c4739eb6b
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aed00d8f-cb42-4aeb-9c24-5e555dbdfba3
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e4ef17d-628f-43a8-92b0-5a8067c57eb0
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3972655d-3fa0-4e8e-9e22-bf271f1efeaf
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d42b50f-7a9d-4eae-96e5-011b29322323
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be13fc7b-12c3-4c82-9dc0-eb6a31a51c9a
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551ff8fa-3f4e-44c8-9aec-c69f5033e918
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0d7a67a-1ec3-4141-8188-d9cfb380a724
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ca07313-a85d-43f1-b8cd-e1b81bb9d41c
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8257338-f431-495c-87a9-688c9696015f
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a73ba6c-b1e6-4240-9ec6-ee756b46bdd8
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce28942a-3649-471c-bb85-557fe6d285e0
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46b114d6-0a1d-4a0d-8204-de5bea9c6e4b
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91f5ee9e-e0a8-4f52-92db-72a3a5907885
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25061e33-990b-4037-ab62-bfb6664a4964
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__INGESTED_AT,3) \N \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f013d856-4432-45d4-8016-4332f3e0176f
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fa7bfc4-7757-4acf-ab17-49f201892396
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_SALES_PAGE_AGENCY_DET_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37bf0d78-0974-407e-b17b-51dae3ccaec0
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a95affa9-4d2d-40f9-aa48-eee0edd38ec5
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9beebce3-cdb8-4a0b-b576-d1ee9bf79ad0
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e041494-2b61-452d-9747-49c5664c30d7
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2825e072-04cb-4009-9597-959e82aa3fee
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e25758b5-4601-4072-8814-ea8db405b12f
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79fb1b48-4693-426e-a0b5-100a5fdec416
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1b8b542-b376-4319-b1e2-5cbf462c9cfb
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22e600a5-00ba-4496-b1e0-9b46ea8fa9cb
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1b8b542-b376-4319-b1e2-5cbf462c9cfb
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: CASE GA_HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET'\N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST'\N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA'\N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT'\N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT'\N ELSE NULL\NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 905160e7-e653-4e61-a418-70cef3c44458
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37702e62-1b00-461b-9097-feafeb359423
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9046c6e2-619f-4bdb-98b3-ce3d63298e35
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efc42ed1-9f29-467b-b548-a057979c2bc4
                stepCounter: 98423fb6-98b0-408a-8d70-d07135e5f4c5
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1c24bda-566f-48e7-8e21-b2b9291a424b
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d34ec52-84aa-4af0-b009-be2c99a2879a
          stepCounter: 5e5445e9-3c8f-4c4a-8f7c-cc1aaacc9f7f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_SALES_PAGE_AGENCY_DETAIL: 98423fb6-98b0-408a-8d70-d07135e5f4c5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_SALES_PAGE_AGENCY_DETAIL
        join:
          joinCondition: FROM {{ ref('LOAD','LOADOPC_SALES_PAGE_AGENCY_DETAIL') }} LOADOPC_SALES_PAGE_AGENCY_DETAIL
        name: SRC_STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT_1
        noLinkRefs: []
  name: STAGEOPC_SALES_PAGE_AGENCY_DETAIL_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
