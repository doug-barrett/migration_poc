fileVersion: 1
id: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
name: STAGE_LO_SAP_FIRST_PASS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "First Pass on Lease Ops data to apply general Lease Op transformations and business logic to Lease Op Line Number base data"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9ed435e-4790-41d8-856f-c94685de8f41
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e855ea-bbb0-41c0-a1f4-7ea303625573
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4c3a825-a088-4705-91dd-badf6129e0ed
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ff6933c-f92c-41a3-9034-cfda778bc298
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b2f65b3-a637-4a97-ab93-3541d8bf73cc
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b4aebb-734b-417e-9764-2bfa7e30745b
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ac22199-9f9b-4003-8595-41aea2b07088
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbffcf2d-e879-4aa7-8f5c-da13c3566984
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4109c70b-6276-4581-8de8-5ced46b1a3f4
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56a3ff0b-0b06-4af1-83da-ea047cb5d959
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e0110b8-67b4-4c60-948f-6e22a8dd52bc
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d14caff2-76a5-4195-b701-bf5cc4d9fc01
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32b933c2-409f-45ad-8868-e4ac49483cfa
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6d96925-2fbd-456d-977a-7bbf0b6ea3fe
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648cb97f-b285-44e5-8566-ae0083165f64
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 859d1f85-505b-465d-8523-52c0e20198b8
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a99d019-3814-462f-9a11-d1eeb00a9351
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78872246-71de-43a5-8791-48db31cbac83
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 847bf9cb-e6f3-43a9-be76-4a7a91df50f6
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0c0329e-65ff-4091-a2e0-77846bf127a2
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91f293ee-f924-4f88-8c41-1ddd63c8ba4e
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1241b2c-9510-4ce4-ba39-851b4038161c
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09b3f06c-70c8-413a-9ba9-9786907e41c0
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24840581-4023-4df6-850a-f655f1215c8f
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01b22ce5-9ca6-4010-8477-458b45d60eb8
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db6ae8ed-01c9-4a44-a9b9-5034622e15cd
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d63b69e4-342d-4d52-a423-410f5e9e66d0
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962b481d-f5ef-4468-a460-b291ac6fed54
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08c9b83a-c44c-4b51-87c4-9c84136d7593
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd258b7d-ba9d-4b79-8eb0-d9823a3c4850
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f490057-d806-45f8-800d-c87327ea7ae2
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 581eb06d-8390-4fc6-bbf6-1c894f335002
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ee27029-0bec-4e87-b054-ae8be92517a4
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8c82458-6107-48fa-bdf5-f29178ffa29c
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8cf4072-997e-443a-a921-1d6dd51eac73
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a42a06c-cee7-431a-b10c-1024c8373703
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33964490-8b05-4fd0-b8dd-a78920056994
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4187806-6fb0-4008-8fae-c5314c7de44f
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f1ec9de-5b18-4c27-ba1f-253b791ebcb5
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0ae8c0f-cb6d-4f0d-a1b7-0e3212a4bb82
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 920f1bdb-c209-4b3f-ab74-3a8b86214c49
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a99ffc8-8995-470f-a2b2-b056209b05ce
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 535b6bef-33b6-4de3-aa28-466df068d500
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecc1aa0d-49c7-4ea7-bbed-2d3f2a2dda1d
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a712ddf9-5278-4a3c-b8d7-d056033adad4
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1a300ee-b49a-4120-8709-e3c4acd12a19
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d48944be-32e7-41cc-bdf2-291d10895988
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80a7205c-00fe-4c49-b95a-ac5f7b3dcede
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f2a080f-4186-4393-b739-0193ea4cb5a4
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8c2079e-6e40-4db2-9c54-51b90b14f37f
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fa94291-9657-4a60-a7a7-edc20424da73
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ab6f4f9-8488-4e6c-b793-ad4f7c231f27
                stepCounter: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85a07a99-e64f-48c4-9aed-08cc628abc54
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 626d2db0-4f67-43d4-be75-12c5d1844a3e
                stepCounter: 592816dc-3717-40cf-ac36-2ff66c9e8146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54f7bf38-b7ea-4fec-80fc-0384282407ae
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f02d163-a5e8-4937-9cec-b7c41704b5a2
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef3c2271-4562-4757-b3fb-4c06a6a7bd23
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95dfac1f-9fd0-411d-a4e4-7c2bd684d81c
          stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f95936c9-a0bf-48a9-ae62-9d717c5d662b
                stepCounter: e14ab72e-3f25-44f0-b70c-6a0192afcc50
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_SRC: 1ff5cf34-33b5-49d8-9ea9-7a7fd80612af
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
          DIM_LO_SAP_GL_ACCOUNT: eded27ac-fd68-4b41-8110-94b692c365d5
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
          DIM_LO_SAP_GROSS_NET: 592816dc-3717-40cf-ac36-2ff66c9e8146
          DIM_LO_SAP_PRODUCT_TYPE: e14ab72e-3f25-44f0-b70c-6a0192afcc50
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_SRC
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GROSS_NET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_PRODUCT_TYPE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_SRC') }} STAGE_LO_SAP_SRC
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON STAGE_LO_SAP_SRC.DIM_LEASE_OPS_HIER_KEY = DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON STAGE_LO_SAP_SRC.DIM_GL_ACCOUNT_KEY = DIM_LO_SAP_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON STAGE_LO_SAP_SRC.DIM_COST_CENTER_KEY = DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_GROSS_NET') }} DIM_LO_SAP_GROSS_NET
                ON STAGE_LO_SAP_SRC.DIM_GROSS_NET_KEY = DIM_LO_SAP_GROSS_NET.DIM_GROSS_NET_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_PRODUCT_TYPE') }} DIM_LO_SAP_PRODUCT_TYPE
                ON STAGE_LO_SAP_SRC.DIM_PRODUCT_TYPE_KEY = DIM_LO_SAP_PRODUCT_TYPE.DIM_PRODUCT_TYPE_KEY
        name: STAGE_LO_SAP_FIRST_PASS
        noLinkRefs: []
  name: STAGE_LO_SAP_FIRST_PASS
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
