fileVersion: 1
id: 84ec3238-f8fe-4bb7-8d23-79da878209b1
name: S_ADMISSION_DECISION_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac6bd698-12e7-4910-9374-6153ce48b3bb
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: ""
        name: ADMISSION_DECISION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7b669c3-0fb6-4470-b568-e1163f9feece
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f329c0b2-5cd5-4399-891d-e04a96f67c29
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6b1d570-ab21-4484-af9e-3e1c2adce785
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 097be79b-d177-411b-acbe-9e7ce52ec17e
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce51273f-70e3-4e3c-bae5-a1940d6881cb
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb9adbe3-d9b7-4e75-bb33-e43e5a04d00e
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a77227d-fe2d-4957-8b5f-94eba89b915b
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26aad57a-3e7b-4c58-8691-ecffbc94dc69
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb78fedf-f6ce-4201-be1f-6a8cb227f236
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 028dbc01-f17a-4c99-b33c-2a96b4fe4730
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fcb3fc1-01be-49a8-b570-ad7ab1d97b5e
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b0996f-a22d-42ed-9211-b29dcd99e938
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b417e0d7-cc18-4d07-bab2-cfd142f09d29
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4da12a5c-e8ab-40aa-b7c5-331fc74e6644
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROPOSED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c951140-8996-4792-a750-1583c87c2be6
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2367e2aa-db10-4a14-883e-27fcaece41c7
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Decision-To-Admit Date
        name: DECISION_TO_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c1c59df-4674-4821-833e-0a8d768ecf4d
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: |-
              CASE WHEN ds_pims_admission_decisions.dta_dttm < '1984-01-01' THEN NULL
                          ELSE ds_pims_admission_decisions.dta_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2466afd-a12f-4c62-ad1c-23b722b2e0f3
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfaebdc2-4aab-46d2-8cec-6566ae1aff64
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e8d636e-3ce7-405a-98b6-1eb4438e89cb
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25874fc1-8705-4ec0-9fa5-7c4dca8bea75
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 228c5dd2-0e8b-462f-8af0-59b1c15a42de
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e437af1b-1500-49a2-9388-a07e0ac21da0
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e57337a8-dc75-4e8c-a477-67ada4a05312
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51dff33f-52a4-4e86-8fe7-e946abf8c24b
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd596eda-432e-4153-bc36-2473ecd36a47
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: ""
        name: OWNER_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85912645-9e76-41c0-9cc4-2f4048cba1db
                stepCounter: b24b0c9f-e49f-475f-85ff-e698230d18e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc11688-f0be-40e8-9f74-85706cfce5f3
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ds_pims_admission_decisions.dta_dttm < '1984-01-01' OR ds_pims_admission_decisions.admit_notaf_dttm < '1984-01-01' THEN 'DT'
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6bdf952-5149-48e0-acd4-f7d736e9b02f
          stepCounter: 84ec3238-f8fe-4bb7-8d23-79da878209b1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_ADMISSION_DECISIONS
        join:
          joinCondition: FROM ds_pims_admission_decisions
        name: S_ADMISSION_DECISION_05
        noLinkRefs: []
  name: S_ADMISSION_DECISION_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
