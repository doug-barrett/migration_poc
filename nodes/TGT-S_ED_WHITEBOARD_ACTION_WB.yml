fileVersion: 1
id: e4ae683c-74f4-4480-bcda-2d04bbdbb795
name: S_ED_WHITEBOARD_ACTION_WB
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Having data before cut over dates. Cut off dates for centric whiteboard were 11/05/2021 for WTH and 18/05/2021 for NSH."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 591994a1-fcd0-4ea7-8d61-dec9d3652935
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: whiteboard unique id from WB cacheAudit table
        isBusinessKey: true
        name: WHITEBOARD_ACTION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28af2511-1b9e-40a0-b93f-c3ebb59de045
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34942ade-4528-40e0-bec2-f2597af07dba
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM encounter number
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28148ac6-f1e9-4912-b369-e3c49dd3c95a
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d214b94-f91b-44f2-bcb8-88e49a4521d4
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: stay_reference_no
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fdd0bbe-b439-4a54-9369-47ba2403f062
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_specialty_code=dim_ED_WB_action_specialty.ED_WB_action_specialty_code
        name: DIM_ED_WB_ACTION_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f82753d0-edfd-496c-b75f-87ce16d0feb9
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 330fc1ec-7d9d-45b5-aa99-edbb0d00a602
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM specialty under which the action was performed
        name: WB_ACTION_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 489a5620-95d7-4b38-8b44-f174da06bdaf
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f715872-25bb-43c6-a44b-94a858dc3b65
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM specialty group EMMED or other as they are managed independently
        name: SPECIALTY_CODE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0aaa14e7-0647-4491-a25e-921dc43d7b78
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d97ca7ce-bc41-45f0-aef7-c018851bd8c4
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_performed=dim_ED_WB_action.WB_action_performed
        name: DIM_ED_WB_ACTION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d10b623-3d79-4fd4-bb6b-a1d0034b3510
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71cf1a88-4820-4d86-b5c8-adb5a6d47bcb
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_WB_ACTION_ASSIGNED_CONSULTANT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f6991c5-0d84-4e9e-9e46-1804355b65b3
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a9476fc-2561-49f4-9ebd-70c0cdf22c2e
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WB_ACTION_PERFORMED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 784281d6-9a91-4630-a393-3fb8ec642158
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8201836b-3472-475a-a386-48353191650b
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: WB_ACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d951769-83b1-46a5-9c21-46f9550233c3
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48789892-98cc-403c-ab6f-d3fb9c593de5
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_ED_WB_ACTION_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e693ec94-025d-43ca-bbf3-b25e0c747816
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cafac325-a79f-4ec8-8cfe-cf5ae3c63828
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WB_ACTION_SEENBY_DOCTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8eeb8bc5-e11f-40d2-956e-85f3c23a8290
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05a4ad7d-8840-45d5-a5ca-532526f552de
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM assigned consultant at time of action
        name: WB_ACTION_ASSIGNED_CONSULTANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c7f2d07-4c52-4f0b-86b0-5af5585199da
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9c845d-600b-4670-826e-cefb8cff296c
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime the record was crated
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0211114-9656-4780-b744-1637b687c670
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97215993-f76d-4c2e-a138-29f221775e0f
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59444088-64fc-49d9-ac48-435956dfa817
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc47edc1-8073-4774-b369-c43c1bb43011
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd16d1ed-0733-4567-83e8-ee684dca2255
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1ecbae9-33a8-493d-8c53-91b9f5fbdba2
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 814ba1fb-c25c-4b2c-a149-622d06bd9233
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dc3d25c-18ca-41cb-9f20-8c6a6c45dc25
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.service_point_code=dim_ED_location.ED_location_reference_no
        name: DIM_ED_LOCATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b6a142f-c4ae-45bb-8e84-22d471760c10
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50fc8bb7-6daa-4154-a396-b64ec0ef6573
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence tof action within encounter
        name: ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 564ea732-941e-4331-9d29-087174d003d2
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2faf4d90-ba28-43a3-aa45-53e6c2d1a3ed
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e9cecf7-e7c5-456a-b832-24259226e539
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1dc9577-c947-4827-8abc-f56bd2888a39
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence of seen by action within encounter
        name: SEEN_BY_ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6269abe-8b77-4dd3-a9a1-f6d1a901cf0c
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe6cf697-219c-462a-8d3a-001170c0ebca
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence withing an encounter grouping removal actions with thier corresponding actions
        name: REMOVAL_ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47de9c16-85f9-4b27-b8aa-fbcd6d692342
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39c850df-236f-4ecb-b599-04e43fd9bc4e
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence or seen bys within an specialty grouping
        name: SPECIALTY_GROUP_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be31b63b-063a-4fa3-851c-8fdd9e03b145
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d33429a1-87a7-485b-a21b-e9ad2ec3ea2d
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Reverse Sequence for seen bys within an specialty grouping
        name: SPECIALTY_GROUP_SEQUENCE_REV
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cfb3a04-c53a-47c0-b8f4-07cea03997e6
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 813abfdf-7321-4cca-b608-db42471a4dec
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Grouping removal actions with thier corresponding actions
        name: REMOVAL_GROUPING
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2aca2b3f-732f-42f2-b81d-ce5551e9918e
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8a08bde-96d7-48d6-b1cb-11b7ca33f6ed
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Was the action performed to remove a previous action? 1 = yes
        name: REMOVE_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33a018b7-d1ff-449a-a385-b4f5a18790a1
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3196a9e1-f851-4756-a15d-43657e71757c
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Is the action deleted by a removal action
        name: REMOVED_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b353ae3d-f1a2-4718-85d2-b3e245f791b0
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3d79d4f-e889-4fdf-bbdc-ccd44d2459f9
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Was the action performed a seenby action? 1 = yes
        name: SEEN_BY_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb49749b-688f-4284-987e-1352e1a0ea5a
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a71c545-4d6f-450a-abdf-d0b01c50afc7
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence to handle non unique concerto user ids
        name: AUDIT_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1912d6d-d34b-47ac-95c5-1ca48fe5739f
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ad9f9fb-836d-4549-b714-e3ae9ea76152
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence to handle non unique concerto user ids
        name: RN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COUNT(1) OVER(PARTITION BY attendance_encounter_id ORDER BY WB_action_date,create_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b51328-1a88-4156-95a1-d3cacb3c1c43
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: INT
        defaultValue: ""
        description: Action type sequence within an event
        name: EVENT_ACTION_TYPE_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a56d478b-3009-449e-8a6a-1f2207973442
                stepCounter: 98519a1a-1fc2-43e5-ab12-7075ad39673e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06c18d0b-c306-4284-8fab-b2a0cc709e03
          stepCounter: e4ae683c-74f4-4480-bcda-2d04bbdbb795
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_ED_WHITEBOARD_ACTION: 98519a1a-1fc2-43e5-ab12-7075ad39673e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_ED_WHITEBOARD_ACTION
        join:
          joinCondition: FROM {{ ref('TGT','DS_ED_WHITEBOARD_ACTION') }} ds_ed_whiteboard_action --left join s_ed_stay_50 on ds_ed_whiteboard_action.attendance_encounter_id = s_ed_stay_50.attendance_encounter_id  --and WB_action_date between stay_start_date and stay_end_date  where WB_action_date < '19-May-2021'
        name: S_ED_WHITEBOARD_ACTION_WB
        noLinkRefs: []
  name: S_ED_WHITEBOARD_ACTION_WB
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
