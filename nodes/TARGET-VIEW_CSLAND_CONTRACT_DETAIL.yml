fileVersion: 1
id: cfa98a45-88c3-4476-81e7-459489f66767
name: VIEW_CSLAND_CONTRACT_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1d67ad9-482d-4363-9bd4-d05f73aca03d
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ddc2c77-44ca-4ebf-8ec2-51a5366bb957
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c75af3b-5a51-4dbc-809d-005ebcac99a1
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_SUB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5311fdd4-1983-49b0-9d14-7a03cd4fe426
                stepCounter: 4221f284-d6bf-4b60-ac30-e667525cafde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 774c9f03-6be3-47da-bde0-24ceb3cf20e8
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61b6135b-ec4c-434a-ad91-a86dffc8985c
                stepCounter: 4221f284-d6bf-4b60-ac30-e667525cafde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e72c369-f493-4ac5-87c6-7b9f32376c5d
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f84a508-f7b1-4790-9207-df8d153f4c0f
                stepCounter: cf4619bd-ff98-448a-b1fe-3f970ba190ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 964acdf2-0db7-441a-8722-9676237814e2
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49d0e4bc-4c37-41b3-9dbb-6a84a9e27199
                stepCounter: cf4619bd-ff98-448a-b1fe-3f970ba190ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c3034f9-c71b-4f5b-8abf-5406fc853c2b
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5704d5a6-2649-4898-91a4-ecc168d3a604
                stepCounter: 4221f284-d6bf-4b60-ac30-e667525cafde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d552ecc-79d2-4945-ab32-c3579e10aa76
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a42b41c-0e55-47a9-9687-e83bbdab5dd4
                stepCounter: 4221f284-d6bf-4b60-ac30-e667525cafde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 793d420c-a3f7-4563-91b3-33f29f82202a
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 841013fd-fb5b-47a4-93d7-19d873889349
                stepCounter: 3a2577e9-f7eb-4fea-beab-0fe9e54f2830
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 478d1da2-f2a9-4795-8f95-e07425851336
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63346fa8-d71f-4bcc-8249-29054f456da0
                stepCounter: 3a2577e9-f7eb-4fea-beab-0fe9e54f2830
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a6ae131-ac57-4c00-9250-4f784a6df372
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5abf21b3-fd6d-49af-8e79-a473993d7acf
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f33c8f-f52e-4125-baca-543726b2bf1c
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CONTRACT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a48fe368-3267-4e9e-ad52-863a0dd74e88
                stepCounter: bffbef83-12da-42af-b5ac-c73068a34aca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f61b5d3-6458-4bec-b452-0001d7607e99
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(90)
        defaultValue: ""
        description: ""
        name: CONTRACT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e7e26e0-6aba-41cb-838e-3471af1de63e
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e35282e-9fd2-4590-bc7f-b90f97eeb5e5
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3835015d-b8b6-4e54-9b96-78fb8182b927
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31f72066-32fc-4ade-9a41-c79b9a777964
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c8cc46b-e154-4ed7-8643-c67ab73e9853
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 150bc157-8515-4d87-8920-c63e69e19c1b
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: REVISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 723a808b-271d-4bea-b1d6-99ca29b075e9
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0640217-67c4-4fa6-b314-c7444352c91a
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: TERMINATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8920d589-d19a-4043-996f-eea30ed35352
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea3b5da5-a173-42ae-a61e-c01388ad4ce2
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SERVICE_TERMS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 477e370c-36cb-4851-b08f-d5301ee2f2cf
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 429fac62-fdc8-4967-b744-1f0201359833
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SERVICE_TERMS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce812ddc-cb1f-43e6-b0d1-a50f54d63516
                stepCounter: a66bfd4e-1864-4a88-b335-3eb70fad4549
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61cedfe5-d495-4643-8391-b6cb7799c51e
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PRODUCER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae56168e-708f-4ee9-8a1e-217c589f9d1c
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5742ae7-13e4-4c69-b2b9-9d66ee251bf3
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PRODUCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71571695-8e3b-42c1-9771-29ae336b75eb
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROCESSOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6816739f-8bb6-4134-ae59-20e5424bd8c4
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4373212f-0a11-4ac8-adff-9d611d410449
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PROCESSOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8177bbdf-038b-4225-b9df-999711993276
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: UNIT_CODE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f911c0c5-eb8d-4b6d-8037-af911acafc98
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffe55ba0-3e98-44c5-bd3d-d7f1a821ca61
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 053bea8d-7836-4400-97ef-73e0ea2d7257
                stepCounter: a147fd8b-0758-4003-bc5e-507297a3e9d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7507c934-d6a1-4454-b1c3-5b1651032596
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ROFR_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1df86c4-ad5f-4867-b232-4b9c07fff393
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9684069b-8e5f-4287-bbb7-d2365b51cdf5
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ASSIGNMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 690360b3-30c0-4101-953d-7c895b6ef445
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 980b7e36-f9e4-4035-8079-d0b6d9bede34
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ASSIGNMENT_TERMS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6242579f-a2d3-4306-8747-847a018c1216
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e60690b9-cb7b-4e01-b9da-33ed05d2c506
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SEGREGATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b8b1ad2-3e70-4c90-8646-04d210f93870
                stepCounter: 11480038-015c-4ac1-be71-658d92ed9740
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a350c91-9f74-4f92-a076-fd46d50e5057
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BASE_REMARKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c27ba11c-546a-4447-b989-933539e69a78
                stepCounter: 92f3e1e8-3863-477c-a77d-c29fae2fbc3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e326ac08-a585-4fc2-9288-7b459e226959
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OPERATOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 198738c4-4467-4e6c-8405-5b1c45d09ec1
                stepCounter: 4221f284-d6bf-4b60-ac30-e667525cafde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68afce41-101e-485c-80e0-f2cec5523362
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2c7a4be-de52-45be-b13e-d408cf9a253f
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUB_REMARKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abb53b61-874d-4772-a59b-b7c8891b6abd
                stepCounter: 841de1d1-92ef-42a0-a35e-a6e9027b3190
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f264dd68-2b38-406e-90e2-4ee4aee14548
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: LAND_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 715d1bc6-e921-4742-82e4-eb5c65b95d2e
                stepCounter: 4a98da03-fa9f-4977-ad0f-fd3c3e9eeb83
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00d2d62f-6740-43a9-9bf5-693778d6d8d8
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: RIGHTS_HELD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff836109-a79c-4c10-96b2-7add2620854a
                stepCounter: 7550e4ae-4ff9-45b8-b11d-d366729efb28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 585c07e4-ed6f-418f-99fd-78da0bf5f926
          stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39e42ef1-6bcb-4bd5-b581-1ef58ebff89f
                stepCounter: 4221f284-d6bf-4b60-ac30-e667525cafde
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW WS_EDW.VIEW_CSLAND_CONTRACT_DETAIL AS SELECT CB.FILE_NUMBER "CONTRACT_FILE_NUMBER",
                   CS.FILE_SUB "CONTRACT_FILE_SUB",
                   CS.FILE_STATUS "CONTRACT_FILE_STATUS_CODE",
                   TCFS.DESCRIPTION "CONTRACT_FILE_STATUS",
                   TCFS.AI_FLAG,
                   CS.STATUS_DATE,
                   CS.AREA "AREA_CODE",
                   TA.NAME "AREA",
                   TA.PROVINCE,
                   CB.CONTRACT_TYPE "CONTRACT_TYPE_CODE",
                   TC.DESCRIPTION "CONTRACT_TYPE",
                   CB.CONTRACT_NAME,
                   CB.CONTRACT_DATE,
                   CB.EFFECTIVE_DATE,
                   CB.REVISION_DATE,
                   CB.TERMINATION_DATE,
                   CB.TERM "SERVICE_TERMS_CODE",
                   TST.DESCRIPTION "SERVICE_TERMS",
                   CB.PRODUCER "PRODUCER_CODE",
                   BT.NAME "PRODUCER",
                   CB.PROCESSOR "PROCESSOR_CODE",
                   BT2.NAME "PROCESSOR",
                   CB.UNIT_CODE "UNIT_CODE_CODE",
                   TUC.DESCRIPTION "UNIT_CODE",
                   CB.ROFR "ROFR_FLAG",
                   CB.ASSIGNMENT "ASSIGNMENT_FLAG",
                   CB.ASSIGNMENT_TERMS "ASSIGNMENT_TERMS_FLAG",
                   CB.SEGREGATION "SEGREGATION_FLAG",
                   CBR.REMARKS "BASE_REMARKS",
                   CS.OPERATOR "OPERATOR_CODE",
                   BT3.NAME "OPERATOR",
                   CSR.REMARKS "SUB_REMARKS",
                   REPLACE(CL.LAND_DESCRIPTION,CHR(13)||CHR(10),CHR(10)) "LAND_DESCRIPTION",
                   REPLACE(CR.RIGHTS_HELD,CHR(13)||CHR(10),CHR(10)) "RIGHTS_HELD",
                   TRIM(CB.FILE_NUMBER)||TRIM(CS.FILE_SUB) "CONTRACT_FILE_KEY"
              FROM DS_CSLAND.C_BASE CB,
                   DS_CSLAND.C_SUB CS,
                   DS_CSLAND.T_CTYPE TC,
                   DS_CSLAND.T_CFSTATUS TCFS,
                   DS_CSLAND.T_SRVTERMS TST,
                   DS_CSLAND.BA_TABLE BT,
                   DS_CSLAND.BA_TABLE BT2,
                   DS_CSLAND.BA_TABLE BT3,
                   DS_CSLAND.T_UNITCODE TUC,
                   DS_CSLAND.C_LEGAL CL,
                   DS_CSLAND.C_RIGHTS CR,
                   DS_CSLAND.T_AREA TA,
                   (
                    SELECT FILE_NUMBER,
                           REPLACE(LISTAGG(TO_CHAR(REMARKS_DATE,'YYYY-MM-DD')||': ['||TRIM(REMARKS_TYPE)||'] - '||REMARKS, '~'),'~',chr(10)) "REMARKS"
                      FROM (
                            SELECT *
                              FROM DS_CSLAND.C_BASE_REMARK
                             ORDER BY FILE_NUMBER,
                                      REMARKS_DATE,
                                      OCCURRENCE
                           )
                     GROUP BY FILE_NUMBER
                   ) CBR,
                   (
                    SELECT FILE_NUMBER,
                           FILE_SUB,
                           REPLACE(LISTAGG(TO_CHAR(REMARKS_DATE,'YYYY-MM-DD')||': ['||TRIM(REMARKS_TYPE)||'] - '||REMARKS, '~'),'~',chr(10)) "REMARKS"
                      FROM (
                            SELECT *
                              FROM DS_CSLAND.C_REMARK
                             ORDER BY FILE_NUMBER,
                                      FILE_SUB,
                                      REMARKS_DATE,
                                      OCCURRENCE
                           )
                     GROUP BY FILE_NUMBER,
                              FILE_SUB
                   ) CSR
             WHERE CS.FILE_STATUS = TCFS.CODE
               AND CB.FILE_NUMBER = CS.FILE_NUMBER(+)
               AND CB.CONTRACT_TYPE = TC.CODE(+)
               AND CB.TERM = TST.CODE(+)
               AND CB.PRODUCER = BT.PRIMARY_KEY(+)
               AND CB.PROCESSOR = BT2.PRIMARY_KEY(+)
               AND CS.OPERATOR = BT3.PRIMARY_KEY(+)
               AND CB.UNIT_CODE = TUC.CODE(+)
               AND CS.AREA = TA.CODE(+)
               AND CB.FILE_NUMBER = CBR.FILE_NUMBER(+)
               AND CS.FILE_NUMBER = CSR.FILE_NUMBER(+)
               AND CS.FILE_SUB = CSR.FILE_SUB(+)
               AND CS.FILE_NUMBER = CL.FILE_NUMBER(+)
               AND CS.FILE_SUB = CL.FILE_SUB(+)
               AND CS.FILE_NUMBER = CR.FILE_NUMBER(+)
               AND CS.FILE_SUB = CR.FILE_SUB(+) ;
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_C_BASE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_C_BASE') }}
        name: VIEW_CSLAND_CONTRACT_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_CONTRACT_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
