fileVersion: 1
id: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
name: VIEW_CSLAND_CONTRACT_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b34397a8-3d7f-4178-a70c-3de8c8a85465
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e581ed8-cde2-471c-8a9a-f2952a278999
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36956d9f-a6d4-4861-a2d3-0e604da141c8
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_SUB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d29d3c7-d90f-4d6a-a7d4-fbdf70a5a1c6
                stepCounter: ff402c46-c4c2-4298-8741-e8e3c49d1c09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e575bac-be2f-45cc-bebc-0480db6b46e1
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51290a6c-6fdb-4701-9889-c7f0d7889fdf
                stepCounter: ff402c46-c4c2-4298-8741-e8e3c49d1c09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8221a819-3f63-4ec8-abc3-7bfb6fc0a3c3
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06d147a1-3d34-4452-abf4-55c95a99eb36
                stepCounter: fe6eeb06-3426-40e8-b6e1-9341b73ee24a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6044d76-4fe2-44f2-8c1b-2e0d03d3c0b1
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e5ec84b-d3e9-46ff-afa1-318e699f5320
                stepCounter: fe6eeb06-3426-40e8-b6e1-9341b73ee24a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2c6da78-9615-441d-a1e9-cc7e84e182f8
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c71abeac-bbb4-4314-8ddc-2332049a0c47
                stepCounter: ff402c46-c4c2-4298-8741-e8e3c49d1c09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9a07aed-19e3-4db7-9e80-9652e9c38088
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19efa92d-ab46-4d74-81ec-54dc1d7766b2
                stepCounter: ff402c46-c4c2-4298-8741-e8e3c49d1c09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01c5ffed-3153-4a79-885e-718462587340
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d1b75dd-f46a-4298-bed2-16f8d08f3c50
                stepCounter: c1ee5439-922c-4ab1-bed9-7f3eb0d4002f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c52069fd-f900-4457-b1b4-05e70835865b
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db5f8d32-f48a-4577-a385-877316a949f1
                stepCounter: c1ee5439-922c-4ab1-bed9-7f3eb0d4002f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25f605e5-9d41-4dc7-9428-99a6c7d3c0cd
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63b318a5-0633-4988-9ea1-296ef523b442
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 172f3a29-5918-44f5-a2e8-280f4815137f
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CONTRACT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46ed4716-6578-4357-9084-76d6b1036c40
                stepCounter: c583f77e-8399-4a1d-820f-60856e7a2d78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12648127-af28-45f6-8bfe-38f46b82a7c4
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(90)
        defaultValue: ""
        description: ""
        name: CONTRACT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3af47e5-18b7-4895-94b9-627bb34fd497
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e68dfb3-f074-417a-aede-61dea97ee9b3
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bb1ec76-95f4-47e8-9101-5ebef338697c
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 134344af-39ea-4c88-9504-612443be6649
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 802bb095-0c5b-449c-a989-ec4e572c2480
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a79f5c92-d2e4-4dd8-96b8-5ee1e9d251ff
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: REVISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2f1e8e8-1695-4bb8-b576-e0f49fab39db
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b02d7ff0-6677-4cc0-b911-99681b86503b
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: TERMINATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5b06c5f-1606-4e67-b6c3-f2fb59df458c
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5133e4f-391c-4e1d-a89b-f7e82429a9c2
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SERVICE_TERMS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d158bb6-70fe-4d33-a82e-b0c46b403e37
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57e940b5-bc90-4937-811e-e091f8a641e3
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SERVICE_TERMS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17fa656a-e6b9-4a62-8ebf-63cb6325c8af
                stepCounter: 9887a64c-8364-43f8-bed0-21f2567bf6b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 180323a5-bcac-41ae-8841-8b8e85fedf03
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PRODUCER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7ed9d35-ef11-4aa1-b484-dcfef0503060
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 400aaff2-2238-4733-8197-5332e5a1bd04
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PRODUCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50de1471-1f72-4f75-97ca-6acda099b798
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROCESSOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d3cb0d2-4e12-4411-9317-12da9e7bae47
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6353115c-c91a-47c5-80cc-0465ba25a931
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PROCESSOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4705ac-4553-46ae-9ded-2287f5b750c4
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: UNIT_CODE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7e3e503-75af-4f2f-b0d1-05d297fd3c7b
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c59ecce1-d7fc-4a6e-958c-a621fcee13e7
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35d65df3-7244-450e-a965-0429637d445c
                stepCounter: 63d76a90-b53f-4b33-992c-ea68b22f6e43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 228a05d0-f3a7-4dbf-aca4-c628fe2a60b8
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ROFR_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebff2d9-b14d-4f33-95b6-adabc94dcea4
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4913d15-96a7-4e60-afd3-8c8041e86c18
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ASSIGNMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3640e3ac-6724-4945-b264-0e75f5039d8e
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5e6117c-1837-4983-9836-0fc2633ac80f
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ASSIGNMENT_TERMS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd696254-94c1-4177-a61d-f6cf7ba037af
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c9b3884-1cb2-4719-91aa-7c42791de3c7
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SEGREGATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0eb85ff9-a17a-4369-97fd-1157bae75385
                stepCounter: 6f655c3d-99dc-4f43-8eaa-319487bff776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b72342f6-56ba-49df-979a-e6383c7c687a
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BASE_REMARKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac59fc1b-0aba-464c-aac8-29534b0813d0
                stepCounter: 68499119-5d3c-4db1-a662-118fba8386f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c551618a-0296-4ff8-b93a-9095dc1ac34f
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OPERATOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2077bb62-ef44-4361-8ca2-540cdda9ed9a
                stepCounter: ff402c46-c4c2-4298-8741-e8e3c49d1c09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4750442c-839d-4592-b6fe-bfaff49a467a
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6ae35b9-86ac-425d-aa88-f98701c904e9
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUB_REMARKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34cb1527-c159-4303-8381-96699c5edfdf
                stepCounter: 39ebcf91-c50e-4de5-9b96-77b2560c2896
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 844bcd0d-4db3-4034-a456-285552c73b30
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: LAND_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c6c28e8-7850-4371-b383-73bde01e61ae
                stepCounter: 71a2bdf6-80b2-4dff-8129-4a56274dcf3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33314133-693e-479f-a125-1e0272b693d3
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: RIGHTS_HELD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f7b242-400f-4365-b79a-5af1b5304627
                stepCounter: ee80ff16-0e49-43a0-a51d-579b3cd83731
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bd53338-b0e3-4df1-9469-50c0ad5d5418
          stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469f4212-35c3-4386-b40b-f5cb857d5a8c
                stepCounter: ff402c46-c4c2-4298-8741-e8e3c49d1c09
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW WS_EDW.VIEW_CSLAND_CONTRACT_DETAIL AS SELECT CB.FILE_NUMBER "CONTRACT_FILE_NUMBER",
                   CS.FILE_SUB "CONTRACT_FILE_SUB",
                   CS.FILE_STATUS "CONTRACT_FILE_STATUS_CODE",
                   TCFS.DESCRIPTION "CONTRACT_FILE_STATUS",
                   TCFS.AI_FLAG,
                   CS.STATUS_DATE,
                   CS.AREA "AREA_CODE",
                   TA.NAME "AREA",
                   TA.PROVINCE,
                   CB.CONTRACT_TYPE "CONTRACT_TYPE_CODE",
                   TC.DESCRIPTION "CONTRACT_TYPE",
                   CB.CONTRACT_NAME,
                   CB.CONTRACT_DATE,
                   CB.EFFECTIVE_DATE,
                   CB.REVISION_DATE,
                   CB.TERMINATION_DATE,
                   CB.TERM "SERVICE_TERMS_CODE",
                   TST.DESCRIPTION "SERVICE_TERMS",
                   CB.PRODUCER "PRODUCER_CODE",
                   BT.NAME "PRODUCER",
                   CB.PROCESSOR "PROCESSOR_CODE",
                   BT2.NAME "PROCESSOR",
                   CB.UNIT_CODE "UNIT_CODE_CODE",
                   TUC.DESCRIPTION "UNIT_CODE",
                   CB.ROFR "ROFR_FLAG",
                   CB.ASSIGNMENT "ASSIGNMENT_FLAG",
                   CB.ASSIGNMENT_TERMS "ASSIGNMENT_TERMS_FLAG",
                   CB.SEGREGATION "SEGREGATION_FLAG",
                   CBR.REMARKS "BASE_REMARKS",
                   CS.OPERATOR "OPERATOR_CODE",
                   BT3.NAME "OPERATOR",
                   CSR.REMARKS "SUB_REMARKS",
                   REPLACE(CL.LAND_DESCRIPTION,CHR(13)||CHR(10),CHR(10)) "LAND_DESCRIPTION",
                   REPLACE(CR.RIGHTS_HELD,CHR(13)||CHR(10),CHR(10)) "RIGHTS_HELD",
                   TRIM(CB.FILE_NUMBER)||TRIM(CS.FILE_SUB) "CONTRACT_FILE_KEY"
              FROM DS_CSLAND.C_BASE CB,
                   DS_CSLAND.C_SUB CS,
                   DS_CSLAND.T_CTYPE TC,
                   DS_CSLAND.T_CFSTATUS TCFS,
                   DS_CSLAND.T_SRVTERMS TST,
                   DS_CSLAND.BA_TABLE BT,
                   DS_CSLAND.BA_TABLE BT2,
                   DS_CSLAND.BA_TABLE BT3,
                   DS_CSLAND.T_UNITCODE TUC,
                   DS_CSLAND.C_LEGAL CL,
                   DS_CSLAND.C_RIGHTS CR,
                   DS_CSLAND.T_AREA TA,
                   (
                    SELECT FILE_NUMBER,
                           REPLACE(LISTAGG(TO_CHAR(REMARKS_DATE,'YYYY-MM-DD')||': ['||TRIM(REMARKS_TYPE)||'] - '||REMARKS, '~'),'~',chr(10)) "REMARKS"
                      FROM (
                            SELECT *
                              FROM DS_CSLAND.C_BASE_REMARK
                             ORDER BY FILE_NUMBER,
                                      REMARKS_DATE,
                                      OCCURRENCE
                           )
                     GROUP BY FILE_NUMBER
                   ) CBR,
                   (
                    SELECT FILE_NUMBER,
                           FILE_SUB,
                           REPLACE(LISTAGG(TO_CHAR(REMARKS_DATE,'YYYY-MM-DD')||': ['||TRIM(REMARKS_TYPE)||'] - '||REMARKS, '~'),'~',chr(10)) "REMARKS"
                      FROM (
                            SELECT *
                              FROM DS_CSLAND.C_REMARK
                             ORDER BY FILE_NUMBER,
                                      FILE_SUB,
                                      REMARKS_DATE,
                                      OCCURRENCE
                           )
                     GROUP BY FILE_NUMBER,
                              FILE_SUB
                   ) CSR
             WHERE CS.FILE_STATUS = TCFS.CODE
               AND CB.FILE_NUMBER = CS.FILE_NUMBER(+)
               AND CB.CONTRACT_TYPE = TC.CODE(+)
               AND CB.TERM = TST.CODE(+)
               AND CB.PRODUCER = BT.PRIMARY_KEY(+)
               AND CB.PROCESSOR = BT2.PRIMARY_KEY(+)
               AND CS.OPERATOR = BT3.PRIMARY_KEY(+)
               AND CB.UNIT_CODE = TUC.CODE(+)
               AND CS.AREA = TA.CODE(+)
               AND CB.FILE_NUMBER = CBR.FILE_NUMBER(+)
               AND CS.FILE_NUMBER = CSR.FILE_NUMBER(+)
               AND CS.FILE_SUB = CSR.FILE_SUB(+)
               AND CS.FILE_NUMBER = CL.FILE_NUMBER(+)
               AND CS.FILE_SUB = CL.FILE_SUB(+)
               AND CS.FILE_NUMBER = CR.FILE_NUMBER(+)
               AND CS.FILE_SUB = CR.FILE_SUB(+) ;
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_C_BASE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_C_BASE') }}
        name: VIEW_CSLAND_CONTRACT_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_CONTRACT_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
