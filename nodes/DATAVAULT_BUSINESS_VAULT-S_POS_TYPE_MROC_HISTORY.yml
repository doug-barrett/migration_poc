fileVersion: 1
id: ebb1ad1f-ae6c-4745-a0da-110e87f97484
name: S_POS_TYPE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22b4d80b-4c53-453a-9580-298f5de94649
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_POS_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21e7a034-7393-4c60-8385-47f5dddfbeae
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e51bced0-14a5-4849-a91c-ea4d1138bb4b
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 392fcee3-edaf-4807-b16f-2d3aa5f29cf3
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 294cbe24-f462-406e-b603-b32023bee3fc
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 191d9ac3-ccfc-407a-a19d-9d9fc312db03
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70a60daa-78d1-4bfc-9db4-68e23dda5f27
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: POS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efe5c794-fed1-4406-8c0c-ff6ec4a76f5b
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f00e781a-2f83-4b5a-a05b-bbfb0dc535cb
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: POS_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90b9804a-64fd-4ff1-94cc-a038e0a9d084
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acb46e1c-77b6-4935-bec9-5611553ae7fe
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(11)
        defaultValue: ""
        description: ""
        name: POS_TYPE_INST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14114d2a-03b8-41bc-aeaf-edf7f4ebd2b5
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6d23329-15c1-4e95-9f9d-b134ff9c4ccc
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_HARDWARE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82ec5f39-e66d-497d-bb65-953aa7113cbd
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32922cb9-faa3-4c3a-9e8e-ea0580fd87f5
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d70c6f04-ee48-4464-90d7-f6ea31c2ac5c
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3705a940-a198-48eb-8e2b-8196d7bb9521
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_MCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a2ce41-76c0-4d5a-8de5-8c2ddc42eb29
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d545bbba-bc67-4325-b0e8-5510314ae6ac
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db9f8385-7869-4a91-9c75-df1ecd886d88
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23a2b5f1-676f-4c85-afec-55635b656ba2
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_VHQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab51d28e-f0ea-48ca-8f46-b1ec8782f426
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df31b689-ebc4-4153-93d8-ba7e3a95eb9d
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_BFIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b37756e6-72f4-42e9-87b2-4de74aa7c129
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b2c673f-4851-4845-aed9-0bd81c3da44b
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_VIRTUAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84dfe693-fc4f-46cf-a926-4fb2ae2777f3
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b096b1f-6e87-4c56-8452-49b78535441e
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_ID_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 246ea9ed-67ca-4a41-a174-7a1321b64b57
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2d38594-e80a-4369-b069-b650075ff23b
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_SN_REQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f7c3459-fe95-4ba7-9f07-955e82d2b5ea
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c22de330-1863-4f28-88d1-dd4631c8d4e5
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: POS_TYPE_POS_ID_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7833af7d-cb68-4c9d-8ab3-5a9ee738323e
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23d5c5a7-9ec1-465b-b95e-57395f92a9f1
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_TMS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdbec8f7-76db-41ef-a075-2606b524b49d
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73114810-7946-4cac-80ae-1c8c6a427b13
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_TMS_ENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ef7c7b3-8ab4-426f-9df2-9eff3d460f3c
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0be26b88-9318-4f42-b220-903321aa336d
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_ID_GENERATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bf2f4d0-66f3-483d-bd60-4e36786f353a
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ca8bd6b-5e0b-4bd7-bc47-297d9bcffe54
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b22130a-cae3-4f7b-b503-96f09980f3fb
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d68096c-d225-4ea0-a839-b0c43b1ce0c6
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cef0f2a0-ce92-49d7-bc65-229af16bbd9d
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 942fd503-1dd8-4b57-9196-8af9a1751e40
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccb9a64d-8e60-4716-96da-597cc0a91ea5
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd5ace87-0c68-4e55-b2e0-63b9056040cd
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b17f2fcc-94a0-476a-a902-12ba16dc24c5
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5890518-8c24-4ad4-9d43-a3029c46d960
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53afb78b-5e1e-46e7-b030-310e00a201ff
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f6cafa-e51a-42e5-a662-d3331f4c139d
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cfe2d30-6f44-4d91-bc9f-a1df7627be68
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f7f13f-b32c-4b24-819e-efa8664ce6f0
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f419dce5-b408-42e5-8ced-8e7c9cecfa96
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61e089a7-81bf-4c25-8424-9038ac0e5963
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a493b9fa-7961-4dcb-a81e-6d6472fe4a25
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d352e75-ea43-4af9-9132-1b478306b9d6
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51440775-9e85-49f9-aeaa-bd0a3a7348d4
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 014e3b84-5352-4026-8797-13cf13294fc8
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ae9919-e14d-4f0e-9ccb-e54362249b74
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a147ac01-e00f-4ebb-a001-5acd66a0a876
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c43de0b-a51d-455d-834d-4afbd8b42fb2
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 757472fd-d809-460a-836c-59af689f6d45
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_pos_type ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5842ae71-6da5-4a8c-bc28-ed99e84f5e9a
          stepCounter: ebb1ad1f-ae6c-4745-a0da-110e87f97484
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_pos_type ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_POS_TYPE_MROC: e71cd662-66e1-41df-87d8-3956421a8a55
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_POS_TYPE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }} s_pos_type_mroc
        name: S_POS_TYPE_MROC_HISTORY
        noLinkRefs: []
  name: S_POS_TYPE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
