fileVersion: 1
id: 4ca2a89d-b26e-4a49-be91-9200852d2813
name: S_POS_TYPE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 963cb996-dd6c-4310-9f3e-398d71cc8c8d
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_POS_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0eb71d0-6f4e-4152-a371-a77f90dbda08
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86975a8f-bc7d-4d5d-8f8c-3e3b6d8cf844
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e315408b-8517-4696-ad63-5355d1fa619b
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3837bd7f-7178-4566-8fef-b3fc6c7e7d98
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6994c435-4c30-4819-b2cd-361733df9f60
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f08af5e-7f22-4ea7-a65c-c1a18a0e1407
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: POS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1af8595-0c16-46e0-814d-6832a61d57d5
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3305e9a5-74cd-49f1-b058-0b904d3be4e6
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: POS_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d85751b5-1328-4f11-9c8a-47c1c7453227
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ca05e24-5c9a-4a16-a226-38822264eea5
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(11)
        defaultValue: ""
        description: ""
        name: POS_TYPE_INST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4ac6388-548e-4252-99aa-95c226b0bee4
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c2d3e3b-c561-4848-97ef-4200d6695536
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_HARDWARE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2c232b9-f9d8-4c38-80ee-4370f555a7e4
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87e94fff-64fe-49bf-b694-089d8e6b479f
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 999feb12-76bd-48b5-b07e-b8151356a0f0
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b28008d-1fc2-4382-9838-eca705396dd4
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_MCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dce8743f-f19a-4ad0-86d1-734bd4126f21
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 736b19e4-8824-4f15-b6a1-89c818c98b27
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 903e0667-2325-4390-83ce-08d84c23c775
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 776e1a4b-bbb3-45d4-b850-bd7568b7c042
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_VHQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07d0c5ba-1790-4b85-80e2-e625ac0bf52d
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 677a174b-4470-488e-9578-173f738782ee
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_BFIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 940651d6-9746-4586-9ad5-d33db043b3ca
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15713b1d-b69e-48d5-98ec-d9efbcddb214
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_VIRTUAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 963d81f0-0074-4890-93ce-22a2871db700
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf717a20-2ce5-4823-8b75-6cecfafa01b7
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_ID_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9c3027a-d12b-4528-988a-1cff9f6d29c1
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc338562-e4f2-41c6-a864-5f3e873b969e
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_SN_REQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26133f93-050d-401e-92dc-dc53e422385e
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f50da0d-f4f1-4fef-b88f-4a0f4856a98a
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: POS_TYPE_POS_ID_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4731f93f-be6f-489e-b697-ef44df17cdcf
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75006f32-276d-4780-a578-159d04f7578f
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_TMS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa5a857a-186f-495c-88c2-ac504edfe46a
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91772d8e-d79f-46dd-8aed-bde6661de14a
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_TMS_ENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a42baaaa-d66d-4549-9456-a93b95a4fff5
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a52b5c4-5921-4067-a740-fb15b2e7fedd
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_ID_GENERATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f412c250-e701-4b39-9b86-43587c917c01
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b71b95c5-b028-4322-ac3c-d3db0a8ccb54
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b324b7ad-5262-482d-8310-2dd5fb379adf
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72ca6072-579c-45c9-9720-f82b59f11456
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dc27977-fd52-4193-8f89-a038a1f56813
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29ce1adf-3057-4630-8712-1c0f1ccb84b5
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d6b5fa3-2ec5-4271-908a-ce7cb9384988
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2717165-a93b-45ba-8b12-dc2cbb195caa
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be46c8c4-3330-424b-9832-a17ed10e5d34
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d599e07-cdfb-4bfc-af3f-0d69a1e2c341
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d873438d-8c8e-49ad-8bd7-f53dc946eea9
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61aec318-a174-4c4f-9ded-b934b24a3fd4
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4cbd8a9-1c42-474d-b649-02b6845417af
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72f04e80-1a9b-4bf0-9da2-b78bceacbfd1
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44f05808-ef3e-42fd-b4c5-c4e3e3a43ced
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4df476f3-be02-4578-b2a4-a678a05ddeea
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fbc9173-ea25-4256-8c41-124742a0979f
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e81715a3-aea3-4dde-927c-67d88710e96b
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff65e5d2-0bcf-4b00-8835-7838ca26b4d7
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 911279bc-43dd-475e-8480-38bdc8996a56
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 009ac564-9f72-4aa9-9244-20632e29ad97
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 325af3ff-5285-4e2f-9ac0-c0f532068f22
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 486e64d3-9a8e-4ac8-a549-52ef46113085
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51124491-80b6-426d-812b-b6a3953e6919
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_pos_type ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71031fae-9b36-4f69-8aa9-fa1288d3330b
          stepCounter: 4ca2a89d-b26e-4a49-be91-9200852d2813
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_pos_type ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_POS_TYPE_MROC: 60a7d36a-d509-4601-b614-5f984e74d7f4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_POS_TYPE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }} s_pos_type_mroc
        name: S_POS_TYPE_MROC_HISTORY
        noLinkRefs: []
  name: S_POS_TYPE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
