fileVersion: 1
id: 830769eb-dabb-4431-bd8d-e33ce844bc55
name: VIEW_MOSAIC_RES_ENTITY_EXT_UDL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50f2170b-777b-433e-9dcc-aae12a664885
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9d16927-b100-487c-ac1c-9f683f5791d0
                stepCounter: 7983e4cc-6de2-4f85-aff4-c624178dea05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccb1dec7-c5f3-4fcd-a54d-5e232a2dc11d
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 20
        name: PROJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e05d058-b73a-4eeb-a862-cb0b3e58a5d9
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 10
        name: PROPERTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bc52ce3-9e0c-4ffe-86e2-b8b4bf590c87
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 241
        name: CAPITAL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 277fa9cb-6754-4f7f-b4f2-20a86585c39d
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 247
        name: ENTITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98b20267-cd1a-4e63-ac73-58ab4e608fd1
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 246
        name: FUTURE_LOC_FORM_PLAY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fe8fff5-8ae3-481a-b35d-157e959b04b0
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 260
        name: FUTURE_LOC_IR_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbed3c06-22da-4283-9b65-18a69646d677
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 12240
        name: ENTITY_RESERVE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67fd99dd-10e9-483d-a952-741635f94eeb
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 20240
        name: ENTITY_REVIEW_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acf49778-247a-42b0-ae9c-756c1cef3ff1
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 24240
        name: ENTITY_REVIEW_STAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d6382dd-d056-4f0b-920c-f62c51577eec
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 28240
        name: CAPITAL_RECONCILIATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a874854a-e93b-4eae-9703-1e267ea7de86
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 60240
        name: MCD_TYPE_WELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37fe1838-d28c-4316-9770-a014468d306b
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 4240
        name: PROVED_BOOKING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4d4782f-88e6-4d66-82e6-318e09f6611e
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 4241
        name: PROBABLE_BOOKING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04424337-0f0b-4e6e-ab09-5be45b734e5c
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 36240
        name: MCD_ZONE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e5908ff-f6d7-4b83-bebe-d58441e70bac
                stepCounter: 64fdc454-597d-4a2b-840d-38eaa558ba4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c55bfda-964a-452c-a5f7-b5d6eb752f82
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 461d296e-7c57-44d5-a5ab-c32ee7bc004c
                stepCounter: 10b5d14f-b232-4bbd-8c14-2b69466d7135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8383da4-6cbe-4fc7-9a27-dd8d91d5fc22
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_STATE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08eb7728-1e1d-4f7e-a00c-b7a8ce824c6b
                stepCounter: 7983e4cc-6de2-4f85-aff4-c624178dea05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c0ecb5b-3b1b-4e94-8951-d8e86e065901
          stepCounter: 830769eb-dabb-4431-bd8d-e33ce844bc55
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_MOSAIC_RES_ENTITY_EXT_UDL: 830769eb-dabb-4431-bd8d-e33ce844bc55
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_MOSAIC_RES_ENTITY_EXT_UDL') }} AS SELECT ee.entity_name AS Entity_Name,
                   ep.Project AS Project,--20
             epy.Property AS Property,--10
             ct.Capital_Type AS Capital_Type,--241
             et.Entity_Type AS Entity_Type,--247
             flfp.Future_Loc_Form_Play_Type AS Future_Loc_Form_Play_Type,--246
             flir.Future_Loc_IR_Group AS Future_Loc_IR_Group,--260
             ecat.Entity_Reserve_Category AS Entity_Reserve_Category, --12240
             rstat.Entity_Review_Status AS Entity_Review_Status,--20240
             rstag.Entity_Review_Stage AS Entity_Review_Stage, --24240
             crecon.Capital_Reconciliation AS Capital_Reconciliation, --28240
             mctw.MCD_Type_Well AS MCD_Type_Well, --60240
             pvby.Proved_Booking_Year AS Proved_Booking_Year, --4240
             pbby.Probable_Booking_Year AS Probable_Booking_Year, --4241
             mczn.MCD_Zone_Name AS MCD_Zone_Name, --36240
             ee.entity_id,
                   ee.entity_state_id,
                   ee.uuid AS entity_uuid
              FROM DS_MOSAIC_RES.ECONOMIC_ENTITY ee,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Project
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 20
                   ) ep,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Property
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 10
                   ) epy,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Capital_Type
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 241
                   ) ct,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Type
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 247
                   ) et,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Future_Loc_Form_Play_Type
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 246
                   ) flfp,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Future_Loc_IR_Group
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 260
                   ) flir,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Reserve_Category
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 12240
                   ) ecat,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Review_Stage
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 24240
                   ) rstag,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Review_Status
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 20240
                   ) rstat,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Capital_Reconciliation
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 28240
                   ) crecon,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS MCD_Type_Well
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 60240
                   ) mctw,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Proved_Booking_Year
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 4240
                   ) pvby,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Probable_Booking_Year
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 4241
                   ) pbby,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS MCD_Zone_Name
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 36240
                   ) mczn
             WHERE ee.entity_id = ep.entity_id(+)
               AND ee.entity_id = epy.entity_id(+)
               AND ee.entity_id = ct.entity_id(+)
               AND ee.entity_id = et.entity_id(+)
               AND ee.entity_id = flfp.entity_id(+)
               AND ee.entity_id = flir.entity_id(+)
               AND ee.entity_id = ecat.entity_id(+)
               AND ee.entity_id = rstag.entity_id(+)
               AND ee.entity_id = rstat.entity_id(+)
               AND ee.entity_id = crecon.entity_id(+)
               AND ee.entity_id = mctw.entity_id(+)
               AND ee.entity_id = pvby.entity_id(+)
               AND ee.entity_id = pbby.entity_id(+)
               AND ee.entity_id = mczn.entity_id(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_ENTITY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_ENTITY') }}
        name: VIEW_MOSAIC_RES_ENTITY_EXT_UDL
        noLinkRefs: []
  name: VIEW_MOSAIC_RES_ENTITY_EXT_UDL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
