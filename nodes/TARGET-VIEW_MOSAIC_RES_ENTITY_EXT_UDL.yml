fileVersion: 1
id: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
name: VIEW_MOSAIC_RES_ENTITY_EXT_UDL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e587a47-6d4e-4d36-996b-d4e94058aa31
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2fc22e-f90d-4d39-a1a3-20b55bdc81b7
                stepCounter: fcfe2c3f-26a1-4593-9ae8-832f5b53c465
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05fdb91f-0e68-4420-bd3e-3f392aa6e613
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 20
        name: PROJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a75188e8-eb9b-47a1-956c-521a49050be2
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 10
        name: PROPERTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7591d33-4674-4327-b10d-6c9f84ebfe57
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 241
        name: CAPITAL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8cbe6ab-aa8a-4d9e-94e0-0ace61557a81
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 247
        name: ENTITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfc579ba-4448-4353-b73d-3fb15e00d57a
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 246
        name: FUTURE_LOC_FORM_PLAY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5230d86c-1152-41b5-9b57-0085a1ff6fe8
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 260
        name: FUTURE_LOC_IR_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 084da4c0-2045-4874-a8e6-7016630a26c3
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 12240
        name: ENTITY_RESERVE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78248099-9ee6-4755-887c-0f13830f16b3
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 20240
        name: ENTITY_REVIEW_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d597c8e7-d4fe-4888-bf2a-1ec4ace17028
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 24240
        name: ENTITY_REVIEW_STAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 809448a1-3de1-4b1d-85e1-290aeebbffce
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 28240
        name: CAPITAL_RECONCILIATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d24da19-286e-4a5a-90c8-764092043ef7
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 60240
        name: MCD_TYPE_WELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba2e3190-c87a-4b71-a5ed-96315cea0fb0
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 4240
        name: PROVED_BOOKING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 736ca5ae-f18b-4929-b412-c6db16116a8e
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 4241
        name: PROBABLE_BOOKING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acf7dc00-b378-4de3-b609-1ed6a57c63a8
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: UDL_ID = 36240
        name: MCD_ZONE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4766c1e5-c17b-462f-bdda-9c8707eaec0c
                stepCounter: 7e4987bd-3dd6-418c-be64-ac00c9ca14aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f08ace-7ad9-4e0b-84b5-05e8892e61c1
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1b242f8-0517-496f-a60c-1661307be419
                stepCounter: baaca8f3-c467-468d-b21e-556818466e23
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc78a299-3e45-4caa-906e-f3ee4eb5ae0c
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_STATE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 711e0616-a31b-47aa-a03f-bb8d0a868db1
                stepCounter: fcfe2c3f-26a1-4593-9ae8-832f5b53c465
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 037fd0b5-ac3d-4870-978b-37c466f901b0
          stepCounter: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_MOSAIC_RES_ENTITY_EXT_UDL: 03b7f47b-da37-4693-a87f-1aaa7e8c88dd
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_MOSAIC_RES_ENTITY_EXT_UDL') }} AS SELECT ee.entity_name AS Entity_Name,
                   ep.Project AS Project,--20
             epy.Property AS Property,--10
             ct.Capital_Type AS Capital_Type,--241
             et.Entity_Type AS Entity_Type,--247
             flfp.Future_Loc_Form_Play_Type AS Future_Loc_Form_Play_Type,--246
             flir.Future_Loc_IR_Group AS Future_Loc_IR_Group,--260
             ecat.Entity_Reserve_Category AS Entity_Reserve_Category, --12240
             rstat.Entity_Review_Status AS Entity_Review_Status,--20240
             rstag.Entity_Review_Stage AS Entity_Review_Stage, --24240
             crecon.Capital_Reconciliation AS Capital_Reconciliation, --28240
             mctw.MCD_Type_Well AS MCD_Type_Well, --60240
             pvby.Proved_Booking_Year AS Proved_Booking_Year, --4240
             pbby.Probable_Booking_Year AS Probable_Booking_Year, --4241
             mczn.MCD_Zone_Name AS MCD_Zone_Name, --36240
             ee.entity_id,
                   ee.entity_state_id,
                   ee.uuid AS entity_uuid
              FROM DS_MOSAIC_RES.ECONOMIC_ENTITY ee,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Project
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 20
                   ) ep,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Property
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 10
                   ) epy,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Capital_Type
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 241
                   ) ct,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Type
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 247
                   ) et,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Future_Loc_Form_Play_Type
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 246
                   ) flfp,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Future_Loc_IR_Group
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 260
                   ) flir,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Reserve_Category
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 12240
                   ) ecat,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Review_Stage
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 24240
                   ) rstag,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Entity_Review_Status
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 20240
                   ) rstat,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Capital_Reconciliation
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 28240
                   ) crecon,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS MCD_Type_Well
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 60240
                   ) mctw,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Proved_Booking_Year
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 4240
                   ) pvby,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS Probable_Booking_Year
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 4241
                   ) pbby,
                   (
                    SELECT DISTINCT EU.ENTITY_ID,
                           UE.ELEMENT_LABEL AS MCD_Zone_Name
                      FROM DS_MOSAIC_RES.ENTITY_UDL EU,
                           DS_MOSAIC_RES.UDL_ELEMENT UE
                     WHERE EU.UDL_ID = UE.UDL_ID
                       AND EU.UDL_ELEMENT_ID = UE.UDL_ELEMENT_ID
                       AND UE.UDL_ID = 36240
                   ) mczn
             WHERE ee.entity_id = ep.entity_id(+)
               AND ee.entity_id = epy.entity_id(+)
               AND ee.entity_id = ct.entity_id(+)
               AND ee.entity_id = et.entity_id(+)
               AND ee.entity_id = flfp.entity_id(+)
               AND ee.entity_id = flir.entity_id(+)
               AND ee.entity_id = ecat.entity_id(+)
               AND ee.entity_id = rstag.entity_id(+)
               AND ee.entity_id = rstat.entity_id(+)
               AND ee.entity_id = crecon.entity_id(+)
               AND ee.entity_id = mctw.entity_id(+)
               AND ee.entity_id = pvby.entity_id(+)
               AND ee.entity_id = pbby.entity_id(+)
               AND ee.entity_id = mczn.entity_id(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_RES_ECONOMIC_ENTITY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_MOSAIC_RES_ECONOMIC_ENTITY') }}
        name: VIEW_MOSAIC_RES_ENTITY_EXT_UDL
        noLinkRefs: []
  name: VIEW_MOSAIC_RES_ENTITY_EXT_UDL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
