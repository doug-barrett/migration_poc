fileVersion: 1
id: 86fc213c-961f-4dc9-aece-606ea605f28a
name: STAGE_LO_SAP_66A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "This view creates NONOP totals that can be displayed regardless of the OP / NONOP reporting layer filter. ie. the NONOP rows generated are really OP."
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9353da4d-2da3-4050-95be-e54f8c9f4db9
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7fdf67a-e425-404d-9cf4-849164dc0b16
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8114e19d-e0cb-4666-8ff3-c9590d0bbbc4
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e51bb39-6eb7-4505-aff3-d4ae01d83936
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bb9f6dd-6680-43d5-a6f3-0203422ecfdb
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0663322a-3952-4256-b1ca-13d853412805
                stepCounter: eefa6fde-3665-412e-bba8-d4a58bcbbf39
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d86435d-9726-4e70-af89-2a9bbf088b32
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bccf843f-90b8-4941-a0e2-c82ac22a38b5
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d2575e7-3078-4ecb-9e3b-4028e7aa5550
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1be5c09a-42cd-4a5e-80b8-12dd2e2969d2
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfdfa86e-2948-4f93-a5c4-99a12faa4f31
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b12dcd6-8002-4415-938d-e7b1c3ecd4a7
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6259b14-ee86-4eb0-b7b1-f9623ea2c924
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dd22b3f-54f5-4cec-bfc1-7fce5dcc0e57
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26852e61-02e4-4620-8911-2204c8ced605
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33ca29ee-e10b-4607-9f25-8606cf283a8f
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf563602-b233-42a1-ad75-0e69290bf32a
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1049565-a405-4d66-92dc-5c5a231d94cf
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fe31cf6-e644-460e-969b-c3913973f342
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a38097a9-58f5-41d8-b81c-9f027913f981
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a465cc06-a492-4cf3-948a-d1fcee3d750c
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbdc0be1-59cd-48fe-8951-c53a22d441da
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 718e1090-a454-442f-b2c8-8ab07030a2b9
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 831ca85d-03d8-4283-948b-9573cdc0465a
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa825158-7815-437a-acd9-f6796a4b20a7
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15b22d0c-f271-4540-8c0b-ccaad9f10743
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94bbb329-7bc7-4f76-9546-f4f5b7b51dd7
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 968ed2b5-13a1-40a0-b9a2-59ed934adf1e
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a661b107-bb93-452f-bbe6-52167e57a652
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20e27afa-1198-451d-9d25-c9353a8fcfef
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc2d13d0-d706-4c30-97c7-821dd8adb7d0
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49bea6bd-7dbf-4754-810a-d130bfa8a8cc
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1472f2b2-0579-40c4-b385-4e842d0a93ea
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2ed7bbd-fefd-4989-bc61-f321a0043013
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c140ce0-9c6d-4c3f-8611-c2997ba1f537
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f57c7525-c573-4348-ace0-f500c19bc890
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c437cc62-ef79-4bfe-8b87-0e8a0eceaa0d
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37198052-41ac-4250-b04d-80af8930660a
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a680f9ea-5ff3-4184-a78f-50a50b48fa26
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 191c4fbf-b8a9-422f-ba8e-ed9f91eb9b31
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01bee524-a84c-4c10-acf5-da5e445ad93a
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9c9ac39-0e0c-4cbb-8ee9-55b655300f6e
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f03bd78f-a926-4152-bf51-fe5309c0d417
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd5bb24a-b97a-4168-a069-8e89850af0e5
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e03c2a5b-09f8-44dd-bd96-2dc5e568554c
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fc43302-eef8-4774-9fd9-c0790d8f1541
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b83ddda1-8a6e-4ac3-8fb4-28b0a3f01cd5
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c65368c9-1778-4e84-884b-0514e08d7c3e
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfbbd24c-f5e4-4d06-9d52-2ae01e3ca15e
          stepCounter: 86fc213c-961f-4dc9-aece-606ea605f28a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_60A: fed629e0-7830-4277-b323-42025afcec75
          STAGE_LO_SAP_65A: eefa6fde-3665-412e-bba8-d4a58bcbbf39
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_60A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_65A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_60A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_60A') }} STAGE_LO_SAP_60A
                     WHERE STAGE_LO_SAP_60A.OP_NONOP = 'NONOP'
                 UNION ALL SELECT STAGE_LO_SAP_65A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_65A') }} STAGE_LO_SAP_65A
                     WHERE STAGE_LO_SAP_65A.OP_NONOP = 'NONOP'
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '66A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_66A
        noLinkRefs: []
  name: STAGE_LO_SAP_66A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
