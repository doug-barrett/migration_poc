fileVersion: 1
id: 70383085-d296-4057-87b1-586a9a869196
name: STAGE_LO_SAP_66A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "This view creates NONOP totals that can be displayed regardless of the OP / NONOP reporting layer filter. ie. the NONOP rows generated are really OP."
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91cb2cc9-2b0b-48b7-a84e-f4d74093d8c7
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4258ad0f-2363-4c4d-94e5-abdae9e60a2d
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5db4cce-9d8f-48a0-b185-c2abaf880ccf
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d75401ad-8b4a-4a0e-9bc7-f7f7576c153e
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2792df21-af96-4646-8b9e-6b2db24ebe8c
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 814bcc1a-40d1-4113-86ac-bb6da4b92a5e
                stepCounter: 4fe24b35-de82-4407-bc45-6149c107644c
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c23bbbb0-8f1b-4802-88c4-d93bd69cf7c2
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fc80944-9594-4a74-8eb8-2ce9244b859b
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2024e0fa-01da-426f-85c3-83b8b18a647a
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20a3bc8a-c142-40cb-81ef-0e0e8cbf0093
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e04e7fc-8678-4022-8e54-9f2e0197436b
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61d7b6fb-1b0a-4ef0-ac58-1db48e4b69ca
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ffbed2c-b02c-46b7-9a69-52175f489545
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2adc0bb0-5ed3-40c0-afc7-06bb95c58855
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43c12e51-3f9b-4e1b-8289-227f4d21b7da
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 615eefce-37ea-43de-abd0-8e7e81534866
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bddd159-7f21-4142-89f7-4c9b6324eec4
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21f5e4ff-7ce2-45be-bf52-f86f0a8a155e
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c9821c7-dbe7-48cd-a602-f5b65fddf536
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff87cbac-195b-4dc5-ba52-0a05fb571c04
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93520f0b-57ea-4070-bc53-8be966d79e87
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ae4ba88-9832-4a05-883e-3242950828eb
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26a03d5e-1140-4526-9c23-2a68316c1552
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9a4e117-6332-460e-82ce-7f857c13a828
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e21b461c-25c5-42fb-9a59-d83f7d6397b2
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8a1b54e-f3da-4a06-b375-da2d0105d9ec
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d655231-74f4-4e05-bd22-040a41315d2a
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae5d0c3e-7837-4067-be8e-b64627fef373
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0214ccbe-96fd-416f-9f1b-3f5d55864e62
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92bd2e06-e0fc-4796-96f3-5c2ab229e85c
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd59464f-d779-4288-9992-60508a491452
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30c091c4-4c4b-40f1-b949-c020c1ed2710
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412726ed-f0ba-457b-93cb-cbb0bf95b868
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba4d9fc6-0e84-403f-9236-52fa41e32692
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f04af16c-5d04-4006-ac00-9c2482b67480
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4323623d-239d-49da-942c-209829abb319
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d00b820c-3100-4d37-924b-141240f1418e
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2172c816-2a04-49ec-910f-00ef38337c3e
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad973a36-3c01-4c66-aea8-d22d336680a9
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18a9ce26-2e0b-4e1a-9329-5a25288ee0b7
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 575333aa-b1d5-4b16-889e-ccf8420c7008
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75c49100-f87c-46df-aa65-b2c17451340b
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebf58c79-c9a7-444f-aadf-8879f8f00f6b
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cedfb16-688a-4756-8afb-20f9e9548be1
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b348d818-a55d-4fa5-868e-87e3e72534ed
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4fc826-eb32-4c28-908b-4d687e3fa21a
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aca4f17-4dfa-4a00-b151-06bd5fbd8a9a
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62ae0ea4-a4e2-41c6-bb9a-21eacade4937
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7cd22ba-8c29-4d3a-bce6-f1fe6460c6e8
          stepCounter: 70383085-d296-4057-87b1-586a9a869196
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_60A: bae625da-e586-450a-9593-857b575ce3c6
          STAGE_LO_SAP_65A: 4fe24b35-de82-4407-bc45-6149c107644c
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_60A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_65A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_60A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_60A') }} STAGE_LO_SAP_60A
                     WHERE STAGE_LO_SAP_60A.OP_NONOP = 'NONOP'
                 UNION ALL SELECT STAGE_LO_SAP_65A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_65A') }} STAGE_LO_SAP_65A
                     WHERE STAGE_LO_SAP_65A.OP_NONOP = 'NONOP'
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '66A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_66A
        noLinkRefs: []
  name: STAGE_LO_SAP_66A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
