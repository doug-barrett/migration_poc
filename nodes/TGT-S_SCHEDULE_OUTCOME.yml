fileVersion: 1
id: ddbc7113-6d78-4caf-9b21-20aad3edb86f
name: S_SCHEDULE_OUTCOME
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cff0215-c4c6-4c5f-a978-1e6b8958d29c
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97aebd53-8994-45f0-9fea-1b3150a90054
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f48fc70-6118-4e43-a2a2-d23b5aa8fc18
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f78eced7-73f6-4521-8a0a-3cf9d58b5060
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f483d-a948-4558-87f8-d3e65fffac3c
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fa3b7bc-7975-4a70-baa4-47f25d37716a
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_REFERENCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc52b689-cd00-4eb4-ae6e-f2b338d8975a
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9eb75b19-5ab1-4c9b-bae5-e4cf694e3936
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d93e8a96-b2c6-4ecb-bd0a-f2f089d15d02
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ebb8429-a263-4769-8f9d-7634f75eb020
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83a3aaf-eb08-4e0f-b5c8-1be21d38ef47
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfd9f367-6761-4a98-844d-0821c9d3ade5
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: CHAR(2)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_OUTCOME_DECISION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8a96d86-d8f4-423f-909d-86aecf5ccdaa
                stepCounter: c5af9a41-74ab-465e-9aaf-79749dda9c70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6050609-d916-416b-abf7-0ab4e810d4e8
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_OUTCOME_DECISION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dec263b-7749-432f-9637-dc9934b4356a
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: CHAR(2)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffb17bb1-02f3-439e-b6c8-b59954b90886
                stepCounter: c5af9a41-74ab-465e-9aaf-79749dda9c70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d67ee46-070c-4143-9dc9-03af255223fa
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_OUTCOME_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8718432-1adb-4080-80fc-c5c98c1376b1
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: CHAR(2)
        defaultValue: ""
        description: ""
        name: DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52d7ac76-6c92-4ebe-9587-dcd44690328d
                stepCounter: c5af9a41-74ab-465e-9aaf-79749dda9c70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d708838-0534-4482-9e2a-dd0d6e53d329
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: DESTINATION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05fd43ba-7f50-4308-940f-e53639d6dd74
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: If the outcome is to go to another organisation this is the code of the organisation
        name: DESTINATION_ORGANISATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04294915-d183-4008-97b7-fc43ce05f00d
                stepCounter: c5af9a41-74ab-465e-9aaf-79749dda9c70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a211c6cf-e023-4519-98f0-3001ef725b3e
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 601cdefc-4370-4e31-b3cb-000ad4f7c8a8
                stepCounter: c5af9a41-74ab-465e-9aaf-79749dda9c70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d1f0937-1302-4280-bfb1-8e9eccb640cc
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a5adb6d-19b5-487a-adfc-678e5b9120d5
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9092e17d-80c4-4561-879d-9a8376829660
                stepCounter: c5af9a41-74ab-465e-9aaf-79749dda9c70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1532e55-56d2-4505-bae4-04883e3a4c71
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acf899a1-66f1-46d9-a96d-48988ce712f1
          stepCounter: ddbc7113-6d78-4caf-9b21-20aad3edb86f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_MAPPINGS_SCHEDULE_OUTCOME: c5af9a41-74ab-465e-9aaf-79749dda9c70
          L_REFERENCE_MOH_NPF_CODESETS: 868516a7-a8ad-4623-b272-3600113b2439
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
          - locationName: TGT
            nodeName: L_MAPPINGS_SCHEDULE_OUTCOME
          - locationName: TGT
            nodeName: L_REFERENCE_MOH_NPF_CODESETS
        join:
          joinCondition: FROM ds_pims_reference_values -- AND GETDATE() BETWEEN ds_pims_reference_values.start_dttm AND IFNULL(ds_pims_reference_values.end_dttm,GETDATE())      left JOIN {{ ref('TGT','L_MAPPINGS_SCHEDULE_OUTCOME') }}  ON ds_pims_reference_values.rfval_refno = l_mappings_schedule_outcome.RFVAL_REFNO    Left JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} DEST    ON l_mappings_schedule_outcome.destination = DEST.Code     and DEST.codeset = 'DEST'      Left JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} ENCOUTR    ON l_mappings_schedule_outcome.encounter_outcome_reason = ENCOUTR.Code     and ENCOUTR.codeset = 'ENCOUTR'    Left JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} ENCOUTD    ON l_mappings_schedule_outcome.encounter_outcome_decision = ENCOUTD.Code     and ENCOUTD.codeset = 'ENCOUNTD'        Left JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} excpout    ON l_mappings_schedule_outcome.exception_outcome = excpout.Code     and excpout.codeset = 'excpout'    Left JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} excprea    ON l_mappings_schedule_outcome.exception_outcome_reason = excprea.Code     and excprea.codeset = 'excprea'    WHERE ds_pims_reference_values.rfvdm_code = 'SCOCM'
        name: S_SCHEDULE_OUTCOME
        noLinkRefs: []
  name: S_SCHEDULE_OUTCOME
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
