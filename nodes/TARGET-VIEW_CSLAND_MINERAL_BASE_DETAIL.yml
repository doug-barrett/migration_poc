fileVersion: 1
id: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
name: VIEW_CSLAND_MINERAL_BASE_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea956d93-9566-44af-b5c6-e1486fd06432
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec6cc487-83c4-4e79-a09b-59ab8256340d
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bc0f315-4747-496a-aa34-33a9c54943c7
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c74ad83-1185-4440-a81e-bf4f440c1e33
                stepCounter: 0262c838-b2e7-4efa-a1c3-480401f1b8d9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6ae7e2a-16eb-42a8-9fd7-a2aec2bf2c7c
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d33fbc5d-b124-494e-8ea5-c199cb163da1
                stepCounter: 0262c838-b2e7-4efa-a1c3-480401f1b8d9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f057951-3b92-4c82-b2a8-12e0cf2c8ce4
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: LESSOR_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fa63ca3-96a6-4a87-966e-353988d64803
                stepCounter: 1cc3a9d8-56fa-4344-a653-532ec46eed02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1175432e-c171-46d6-8f89-4d354f38ac32
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        name: LEASE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa9fb7a-0378-4050-9577-7376d3094fab
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e062a279-f9b0-49c1-8422-f480a9c85c1d
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: LEASE_PAYOR_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7da26e24-0394-4260-8387-5f8323199a0b
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 403c9087-12d8-4f09-85e3-e7d3dff33786
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: LEASE_PAYOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3101f0db-4c2c-452e-8b09-87f3ddbe13c2
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: NUMBER(11,8)
        defaultValue: ""
        description: Registered Interest
        name: REGIST_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cf26c8e-58a8-4234-9cfd-f992df7e9f13
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67bfade3-1875-489b-96cf-efe1f78439a3
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: NUMBER(11,8)
        defaultValue: ""
        description: Mineral Interest
        name: MINERAL_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1df59240-10f7-47d5-be63-4a30acbbd067
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 461f3397-3640-46ac-81d9-1a4d78b15415
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RENTAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46c59c39-777e-4b73-a8cb-f065eb2bbc19
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e7a29a0-8ec7-4af0-a471-d9181a898283
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: RENTAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46c59c39-777e-4b73-a8cb-f065eb2bbc19
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0f0b526-ce16-4057-b880-797cd59dfae4
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: DECIMAL(9,2)
        defaultValue: ""
        description: ""
        name: RENTAL_DOLLAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9768043a-3677-40a3-af49-816afebe9dd4
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a55d1d7-6920-42be-bac3-6e96f647dc32
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a299b3bd-06fc-4106-a9d3-585089e02c57
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5318e034-d7cf-4dd9-98f1-d25cd319bc58
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ACRE_HECTARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37ef8051-59de-4b6b-a86f-08a3fca7cfb0
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cfe5d79-cfc7-44e8-8d22-4c0fd354f793
          stepCounter: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_BASE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec6cc487-83c4-4e79-a09b-59ab8256340d
                stepCounter: b0d76c6e-75d3-46d5-bfc8-467255171059
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_MINERAL_BASE_DETAIL: 1ec804db-d8f7-4bbd-b1dd-109f6ec0f395
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_MINERAL_BASE_DETAIL') }} AS SELECT LB.FILE_NUMBER "MINERAL_FILE_NUMBER",
                   TMFS.DESCRIPTION "MINERAL_FILE_STATUS",
                   TMFS.AI_FLAG,
                   TL.DESCRIPTION "LESSOR_TYPE",
                   LB.LESSOR_NUMBER "LEASE_NUMBER",
                   LB.LEASE_PAYOR "LEASE_PAYOR_BA",
                   BT.NAME "LEASE_PAYOR_NAME",
                   LB.REGIST_INTEREST,
                   LB.MINERAL_INTEREST,
                   LB.RENTAL_DATE,
                   TO_CHAR(LB.RENTAL_DATE,'MM') "RENTAL_MONTH",
                   LB.RENTAL_DOLLAR,
                   LB.EXPIRY_DATE,
                   LB.ACRE_HECTARE "ACRE_HECTARE_FLAG",
                   TRIM(LB.FILE_NUMBER) "MINERAL_FILE_BASE_KEY"
              FROM DS_CSLAND.L_BASE LB,
                   DS_CSLAND.T_MFSTATUS TMFS,
                   DS_CSLAND.T_LESSOR TL,
                   DS_CSLAND.BA_TABLE BT
             WHERE LB.FILE_STATUS = TMFS.CODE(+)
               AND LB.LEASE_PAYOR = BT.PRIMARY_KEY(+)
               AND LB.LESSOR_TYPE = TL.CODE(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_L_BASE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_L_BASE') }}
        name: VIEW_CSLAND_MINERAL_BASE_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_MINERAL_BASE_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
