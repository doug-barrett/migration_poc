fileVersion: 1
id: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
name: VIEW_CSLAND_MINERAL_BASE_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac7c1c78-0566-43a8-8599-d03144fe36f2
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22a8e39b-dfd8-4ae1-aadd-222ad5e03fcc
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40bab3f4-761f-4dde-9dc0-66745008a2c3
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe144a4b-92b2-41ae-9c17-131cd5be29ba
                stepCounter: d33d07c8-06cd-4cdc-a7a2-85d24e09ae22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aa928f8-e5ed-46a5-94d1-9b514c13afe8
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ec879eb-cf4f-4f29-b213-2578c0d9627c
                stepCounter: d33d07c8-06cd-4cdc-a7a2-85d24e09ae22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef26dce7-6e0e-4821-a9c8-834b94e48ced
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: LESSOR_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73ea1d2e-8eec-4f68-abd1-90ca7c8dcc3a
                stepCounter: 27c2b920-5561-4173-b077-71bffec0e226
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ed57c49-d3ea-442a-9c2c-54f97cc532d8
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        name: LEASE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 417c6a59-9ac8-4b2f-9c34-55cda42304e1
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 045e061b-2e0b-4a8d-bdb5-670ae468f494
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: LEASE_PAYOR_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4c92f78-27e8-4962-9773-5153f0a437df
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49717530-e781-4059-9daa-2261a8b3c2ed
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: LEASE_PAYOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba06770b-be0b-430b-b6e5-3846ab096768
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: NUMBER(11,8)
        defaultValue: ""
        description: Registered Interest
        name: REGIST_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dba3d677-2a1e-4084-beae-449c056ad144
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a4d5ec6-a464-4e79-bf09-2f85d1734354
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: NUMBER(11,8)
        defaultValue: ""
        description: Mineral Interest
        name: MINERAL_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b8c3b5d-fd56-4ac0-9cf6-507d9c491211
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fbcc679-189c-448e-8cd4-6741f2a18883
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RENTAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b42ea87-5097-4cbe-b012-d8d6724fe775
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b099618-aa74-4197-a0b4-3ec8a2c2ead0
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: RENTAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b42ea87-5097-4cbe-b012-d8d6724fe775
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 408d67a8-c964-4e88-83f0-fd869c24767d
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: DECIMAL(9,2)
        defaultValue: ""
        description: ""
        name: RENTAL_DOLLAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82cdd8bc-c9a2-41b2-bfc6-ec5d128afea8
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f042fab-42f3-43ea-98d7-fde899d04443
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0cf6da6-9af0-4cba-8922-2d407dd7f23b
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec85397a-112b-483c-b20d-6fba86330281
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ACRE_HECTARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c96be4c0-8f81-4e4d-bbe4-ddfa5d740c14
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d7d8dcc-239a-4614-9325-64879568146a
          stepCounter: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_BASE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22a8e39b-dfd8-4ae1-aadd-222ad5e03fcc
                stepCounter: 7168ebdd-0399-4c2f-93aa-2707cce501da
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_MINERAL_BASE_DETAIL: f2e2c2df-fa5b-494c-b3a9-0bf08584531e
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_MINERAL_BASE_DETAIL') }} AS SELECT LB.FILE_NUMBER "MINERAL_FILE_NUMBER",
                   TMFS.DESCRIPTION "MINERAL_FILE_STATUS",
                   TMFS.AI_FLAG,
                   TL.DESCRIPTION "LESSOR_TYPE",
                   LB.LESSOR_NUMBER "LEASE_NUMBER",
                   LB.LEASE_PAYOR "LEASE_PAYOR_BA",
                   BT.NAME "LEASE_PAYOR_NAME",
                   LB.REGIST_INTEREST,
                   LB.MINERAL_INTEREST,
                   LB.RENTAL_DATE,
                   TO_CHAR(LB.RENTAL_DATE,'MM') "RENTAL_MONTH",
                   LB.RENTAL_DOLLAR,
                   LB.EXPIRY_DATE,
                   LB.ACRE_HECTARE "ACRE_HECTARE_FLAG",
                   TRIM(LB.FILE_NUMBER) "MINERAL_FILE_BASE_KEY"
              FROM DS_CSLAND.L_BASE LB,
                   DS_CSLAND.T_MFSTATUS TMFS,
                   DS_CSLAND.T_LESSOR TL,
                   DS_CSLAND.BA_TABLE BT
             WHERE LB.FILE_STATUS = TMFS.CODE(+)
               AND LB.LEASE_PAYOR = BT.PRIMARY_KEY(+)
               AND LB.LESSOR_TYPE = TL.CODE(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_L_BASE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_L_BASE') }}
        name: VIEW_CSLAND_MINERAL_BASE_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_MINERAL_BASE_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
