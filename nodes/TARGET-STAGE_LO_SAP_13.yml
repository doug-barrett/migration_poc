fileVersion: 1
id: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
name: STAGE_LO_SAP_13
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dd1839c-b888-4212-8fc8-6d68f2aedcbb
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9ed435e-4790-41d8-856f-c94685de8f41
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab41b99b-ca1d-49e8-9ebf-261c4fa9669f
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4c3a825-a088-4705-91dd-badf6129e0ed
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6118ce8c-c6de-4188-9cbe-9702d2141a66
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b2f65b3-a637-4a97-ab93-3541d8bf73cc
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4762df3f-c36c-4c05-b4c3-532f1ce7edb7
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ac22199-9f9b-4003-8595-41aea2b07088
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64d41adc-991d-4ea2-b08f-ae1d547f5dd2
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4109c70b-6276-4581-8de8-5ced46b1a3f4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45971113-cb3b-40bb-afd4-ded9b356f387
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e0110b8-67b4-4c60-948f-6e22a8dd52bc
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a6c70f4-3afa-4f6f-b41a-75c8d6509f45
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32b933c2-409f-45ad-8868-e4ac49483cfa
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc45244d-f26e-4172-b7df-63953c1f7809
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 648cb97f-b285-44e5-8566-ae0083165f64
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6221b27-ddc5-4d39-8bd1-58852e3486b0
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e7d42b-9a84-4fce-8aca-c6ed36e22813
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 847bf9cb-e6f3-43a9-be76-4a7a91df50f6
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e78af8e-bee7-42f3-b37e-2f37545e7089
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91f293ee-f924-4f88-8c41-1ddd63c8ba4e
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aa98cc4-1da3-496d-9b94-7e002800b24b
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09b3f06c-70c8-413a-9ba9-9786907e41c0
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2abf0835-fe29-46b6-9a97-62632c1f4d40
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01b22ce5-9ca6-4010-8477-458b45d60eb8
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 535f4a67-51cb-4025-a59b-68b4c38b5cf7
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63b69e4-342d-4d52-a423-410f5e9e66d0
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd9e7bdd-33e6-4789-92c8-1a3562efe739
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08c9b83a-c44c-4b51-87c4-9c84136d7593
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6e72ffc-79d2-4825-bb01-dfe35d42948c
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5cb5375-198c-4719-b8d9-58fc84a452af
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ee27029-0bec-4e87-b054-ae8be92517a4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ad02c3e-8e07-44a8-b895-bea4368a359b
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8cf4072-997e-443a-a921-1d6dd51eac73
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25480813-fcf1-4354-aec4-29e51d9c7c0f
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33964490-8b05-4fd0-b8dd-a78920056994
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afb93a1f-8098-4303-acc3-753fb6fe6a54
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f1ec9de-5b18-4c27-ba1f-253b791ebcb5
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53719a63-6df2-4d33-abcd-4033a39ee048
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 920f1bdb-c209-4b3f-ab74-3a8b86214c49
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fbdc67e-4668-4be6-b100-2489d2df606c
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 535b6bef-33b6-4de3-aa28-466df068d500
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db648fe1-60b2-4183-8154-9e6f72aea695
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a712ddf9-5278-4a3c-b8d7-d056033adad4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67dc6442-1ad0-4bbf-9cc3-823c5de4f4e5
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d48944be-32e7-41cc-bdf2-291d10895988
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c4d52a-3b8f-4bc8-afe2-0b9423f63dcc
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f2a080f-4186-4393-b739-0193ea4cb5a4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 332f3495-678d-4ccc-a703-cb36c400bb0e
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa94291-9657-4a60-a7a7-edc20424da73
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 892a5e8c-a576-4b65-b923-c7537f0cf1a9
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a07a99-e64f-48c4-9aed-08cc628abc54
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b36a6db-cb3e-4171-989d-0deccf250626
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e62d5a41-22e9-469f-bb25-18ace7b4b103
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f02d163-a5e8-4937-9cec-b7c41704b5a2
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba5c432e-9d03-46ca-aeb2-1c5b3c69df14
          stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95dfac1f-9fd0-411d-a4e4-7c2bd684d81c
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_FIRST_PASS: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
          DIM_LO_SAP_LINE_ITEM: d0ab4a94-a909-487b-8651-345f5baff59d
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_FIRST_PASS
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LINE_ITEM
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_FIRST_PASS') }} STAGE_LO_SAP_FIRST_PASS
              JOIN {{ ref('TARGET','DIM_LO_SAP_LINE_ITEM') }} DIM_LO_SAP_LINE_ITEM
                ON (STAGE_LO_SAP_FIRST_PASS.DIM_LINE_ITEM_KEY = DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY)
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON (DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = DECODE(STAGE_LO_SAP_FIRST_PASS.LINE_NO, '20.1','13.1', '20.2','13.2', '20.3','13.3', '20.4','13.4'))
             WHERE STAGE_LO_SAP_FIRST_PASS.LINE_NO IN ('20.2','20.3','20.4')
                OR (STAGE_LO_SAP_FIRST_PASS.LINE_NO = '20.1' AND (DIM_LO_SAP_LINE_ITEM.ACCT_GROUP_CODE='OIL' OR DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY = 0))
        name: STAGE_LO_SAP_13
        noLinkRefs: []
  name: STAGE_LO_SAP_13
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
