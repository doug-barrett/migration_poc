fileVersion: 1
id: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
name: S_HEALTHCARE_PROFESSIONAL_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a739ac7-665b-498f-b9e8-0753f46e500f
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Professional_Code
        name: HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ff4ff09-2e99-4e5a-82f8-b0abd31eea27
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 072bda64-a2c2-437d-8a6f-2c89ec950e07
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Healthcare_Professional_Description
        name: HEALTHCARE_PROFESSIONAL_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6812ab07-91b7-4739-93b0-1119411873be
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24548cf5-7041-495d-877f-e1343bfba4fa
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Healthcare_Professional_Reference_Number
        name: HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba4d12f9-d1f2-4ef1-8808-63e3c486d2cc
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd78eaee-9609-4626-b992-8df79d46c9f8
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Healthcare_Professional_Type_Reference_Number
        name: HEALTHCARE_PROFESSIONAL_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb595aff-6fb5-4a32-8375-85bfe32f3baa
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 390f36e4-057e-4cd8-9170-de26d6f71815
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Healthcare_Professional_Type_Code
        name: HEALTHCARE_PROFESSIONAL_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd0efb9c-3e8d-4e11-9bc8-26fe590968a1
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ec1ae80-3640-4861-af59-e3d826568351
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Healthcare_Professional_Type_Description
        name: HEALTHCARE_PROFESSIONAL_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37d4b083-3560-4f5e-ba9b-4a9dca85683d
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26461f95-906d-479f-91af-61e98fb8977f
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Healthcare_Professional_Title_Reference_Number
        name: HEALTHCARE_PROFESSIONAL_TITLE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a747e288-1f4a-4fc6-ba7e-6b65a0a682cc
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa5c44dc-8113-4ae1-a185-e9e51c9de65e
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Healthcare_Professional_Title_Code
        name: HEALTHCARE_PROFESSIONAL_TITLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a38e0044-d23a-493d-9c3a-a0da8813b511
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd0112d4-7297-4c1a-b8d9-a2b6d993a3d0
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Healthcare_Professional_Title_Description
        name: HEALTHCARE_PROFESSIONAL_TITLE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0821e1a4-dd78-499f-929f-de750c9a96ef
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53bc161d-2563-4153-9fba-258ab82aa805
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Healthcare_Professional_Forename
        name: HEALTHCARE_PROFESSIONAL_FORENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ed291f5-1129-4686-bdde-8217405adda0
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f2d46b8-4e17-4a64-8c75-31c8146f055a
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Healthcare_Professional_Surname
        name: HEALTHCARE_PROFESSIONAL_SURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07add24a-cfad-4c17-83a5-da52c402c49d
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a554f6b2-5fe1-4ee3-80df-750e7a81f0f8
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: healthcare_professional_fullname
        name: HEALTHCARE_PROFESSIONAL_FULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3147e8b-2973-4782-9abb-e5dbd550bbed
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a0f871b-4944-4238-bad9-a6eecd7d5a6f
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Healthcare_Professional_Gender_Reference_Number
        name: HEALTHCARE_PROFESSIONAL_GENDER_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a354f1de-c162-4eba-acc9-6f6aada259d2
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75cd2792-4a31-41d9-b06f-62600f8ce841
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Healthcare_Professional_Gender_Code
        name: HEALTHCARE_PROFESSIONAL_GENDER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a69b57f-38a8-4832-8f31-d3d584d5f043
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7f753e1-1705-40b0-9205-5664dd61626b
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Healthcare_Professional_Gender_Description
        name: HEALTHCARE_PROFESSIONAL_GENDER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95c268c5-9ea4-4359-b09e-985ee832e33c
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9770deb7-3b24-417e-8ec7-04a71197daf0
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Healthcare__Qualifications
        name: HEALTHCARE_QUALIFICATIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee09ff10-d9df-4a46-988e-c05e49a70018
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a9c6527-d3fd-45f9-a28a-fec499980e5c
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Healthcare_Specialty_Code
        name: HEALTHCARE_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b6e4c53-b09f-482d-851e-1f6cf17a9301
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeff6b4a-edaf-48f1-9266-d72a9c01c588
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Healthcare_Specialty_Description
        name: HEALTHCARE_SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74df9753-669e-49c8-aa87-65d3273064f2
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4b1d5d7-ba81-4e6c-81a1-2f66de62d08b
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Organisation_Code
        name: HEALTHCARE_ORGANISATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daa0f2e8-ea00-4db5-a10c-7fc168c7e294
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97f115bc-fbc9-4d26-a058-e79225f52ff6
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Healthcare_Organisation_Description
        name: HEALTHCARE_ORGANISATION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e43148a5-da98-459d-aecf-bed723424abc
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e3ff0c9-398a-4dce-b2bd-f98e02630f70
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: Healthcare_Team_Code
        name: HEALTHCARE_TEAM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5af807b6-2779-48d9-9623-97312939c851
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e400514-3f17-4485-99d3-77ef303e2ae3
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Team_Name
        name: HEALTHCARE_TEAM_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4b3a96a-23cf-4c9e-a41f-af52715880ad
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25aa69de-b2f2-4e18-851e-1287b88e0d30
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Healthcare_Professional_Validity_Start_Date
        name: HEALTHCARE_PROFESSIONAL_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e173810e-1da1-4097-8d1a-c03b3900f178
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c3afb5f-046b-4fed-8dbb-c817ab453a64
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Healthcare_Professional_Validity_End_Date
        name: HEALTHCARE_PROFESSIONAL_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77d274d3-3c5f-47c0-946c-d344a2d8b6ba
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d549025-1c63-4eb2-8dc0-bd54c7d38bc9
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MAIN_EMPLOYEE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1871188d-d026-48e0-8458-da07bfe8b19f
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: max(main_employee_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f4a6276-2a94-4a61-8230-ff9da5eab9f0
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HPI_PROFESSIONAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e08926e9-c937-4a24-bf57-49944032484e
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: max(s_healthcare_professional_10.HPI_professional_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe840be9-f412-4162-92e3-b1f300f18c12
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HPI_COMMON_PERSON_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78344533-7215-4d53-af6c-33f3d1717fc7
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: max(s_healthcare_professional_10.HPI_common_person_number)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9080b0fe-d79f-4009-806f-b344bd178788
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: NATIONAL_REGISTRATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af7d27e5-4223-4014-9933-a757e2482431
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: max(s_healthcare_professional_10.national_registration)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f5ac4b1-2bc3-48b9-a066-f6e22bad8002
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: email
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7314a3cf-2b15-4a8c-b78b-639815ddd42f
                stepCounter: 7e94ee97-9e95-4b23-af97-237274ab7c11
            transform: max(s_healthcare_professional_10.email)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5649a006-f301-4fe8-b1e2-88b27eeedc49
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: clinical_portal_username
        name: CLINICAL_PORTAL_USERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: max(s_healthcare_professional_10.clinical_portal_username)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 853fcf3a-c8e8-4567-ac03-2559b5fb0c40
          stepCounter: ecbc2bcf-4a2c-4fea-b03e-9fc83e673fe7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_HEALTHCARE_PROFESSIONAL_10: 7e94ee97-9e95-4b23-af97-237274ab7c11
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_HEALTHCARE_PROFESSIONAL_10
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_HEALTHCARE_PROFESSIONAL_10') }} s_healthcare_professional_10
             GROUP BY healthcare_professional_code ,
                      healthcare_professional_desc ,
                      healthcare_professional_reference_no ,
                      healthcare_professional_type_reference_no ,
                      healthcare_professional_type_code ,
                      healthcare_professional_type_desc ,
                      healthcare_professional_title_reference_no ,
                      healthcare_professional_title_code ,
                      healthcare_professional_title_desc ,
                      healthcare_professional_forename ,
                      healthcare_professional_surname ,
                      healthcare_professional_fullname ,
                      healthcare_professional_gender_reference_no ,
                      healthcare_professional_gender_code ,
                      healthcare_professional_gender_desc ,
                      healthcare_qualifications ,
                      healthcare_specialty_code ,
                      healthcare_specialty_desc ,
                      healthcare_organisation_code ,
                      healthcare_organisation_desc ,
                      healthcare_team_code ,
                      healthcare_team_name ,
                      healthcare_professional_validity_start_date ,
                      healthcare_professional_validity_end_date ,
                      dss_update_time
        name: S_HEALTHCARE_PROFESSIONAL_20
        noLinkRefs: []
  name: S_HEALTHCARE_PROFESSIONAL_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
