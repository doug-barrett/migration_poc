fileVersion: 1
id: 5d699aae-3805-461c-9b37-05ed93ed9f40
name: STAGE_LO_SAP_13A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ab2306d-ff80-441b-8727-daa76b657dd3
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dd1839c-b888-4212-8fc8-6d68f2aedcbb
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a4e16dd-1396-4e5d-b502-8ba6823c1a21
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab41b99b-ca1d-49e8-9ebf-261c4fa9669f
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4bd95f5-c372-40ac-806e-c544f4a6d916
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6118ce8c-c6de-4188-9cbe-9702d2141a66
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fd70e91-0fa8-4f67-ac53-04fcbd6382b9
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4762df3f-c36c-4c05-b4c3-532f1ce7edb7
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3562ba2-d5ea-4600-b0cf-59a479de2b86
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c682b1b4-185d-41dd-8734-89b024f83ab0
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45971113-cb3b-40bb-afd4-ded9b356f387
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 241e924c-2318-405b-a33c-6a85ef0a1ba9
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c3e1e37-eace-47c8-b177-b4806ef34b28
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc45244d-f26e-4172-b7df-63953c1f7809
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9370323d-b9f0-43e0-a880-cb0b9de1ff8e
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40d3825f-0199-49c3-b4a6-97f5356fc02a
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9e7d42b-9a84-4fce-8aca-c6ed36e22813
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbf0bb54-adff-41cd-a09b-76f9ccf6c631
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7128cc70-72d9-4d37-a649-e7df113c1b88
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09c27a28-5020-43bf-a8c0-7608509ea3cd
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52c481d1-e158-4725-b224-59b20f90f187
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bcc61ba-9a4c-42af-baf6-6adb830c432e
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 281acf7e-dcfe-4859-b051-21dbd0b1fe6d
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4059a1-2859-4999-8c8b-d1fd5021b8a9
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da1f1fb-afaf-4e58-a9c3-44fdee61a047
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd3a2bb1-1648-4235-b7e2-001af99140d5
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed3007ea-c722-4616-9b62-f42f1dd2e10b
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afb93a1f-8098-4303-acc3-753fb6fe6a54
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: SUM(STAGE_LO_SAP_13.LI_VOL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 257a2290-79d4-4e09-af2d-85b9d876c753
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53719a63-6df2-4d33-abcd-4033a39ee048
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: SUM(DECODE(STAGE_LO_SAP_13.LINE_NO, '13.4',STAGE_LO_SAP_13.LI_VOL_M3*'{{ parameters.M3_BOE_FACTOR }}', STAGE_LO_SAP_13.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b6702a5-4fbf-45dc-a1d1-6929c622514f
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fbdc67e-4668-4be6-b100-2489d2df606c
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: SUM(DECODE(STAGE_LO_SAP_13.LINE_NO, '13.4',STAGE_LO_SAP_13.LI_VOL_IMPERIAL/'{{ parameters.GAS_IMPERIAL_FACTOR }}', STAGE_LO_SAP_13.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a020620e-185d-49a9-8da2-e9c4fac8dbe8
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db648fe1-60b2-4183-8154-9e6f72aea695
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: SUM(STAGE_LO_SAP_13.LI_VOL_BOE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d0c2eef-aa16-4420-ad34-0894ef9e101d
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67dc6442-1ad0-4bbf-9cc3-823c5de4f4e5
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: SUM(DECODE(STAGE_LO_SAP_13.LINE_NO, '13.4',STAGE_LO_SAP_13.LI_VOL_NM3*'{{ parameters.NM3_BOE_FACTOR }}', STAGE_LO_SAP_13.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16c56fe4-0c04-4cfc-a56f-aab449ce2c91
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8c4d52a-3b8f-4bc8-afe2-0b9423f63dcc
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0ef1c1c-2fd4-4fe5-9bcb-33d49f1aa5dd
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 332f3495-678d-4ccc-a703-cb36c400bb0e
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f452b22-57a7-42f2-b968-db8757f672cb
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 892a5e8c-a576-4b65-b923-c7537f0cf1a9
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8057ec8d-2a86-4175-ba38-701298b77fe8
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6893d431-061b-4ce8-be11-494ed7691736
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e62d5a41-22e9-469f-bb25-18ace7b4b103
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42263873-3e6b-4cf2-8ab2-530d7acd4686
          stepCounter: 5d699aae-3805-461c-9b37-05ed93ed9f40
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_13: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_13
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_13') }} STAGE_LO_SAP_13
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '13A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY STAGE_LO_SAP_13.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_13.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_13.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_13.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_13.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_13.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_13.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_13.EXCHANGE_RATE,
                      STAGE_LO_SAP_13.OP_CURR_CODE,
                      STAGE_LO_SAP_13.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_13.OP_NONOP
        name: STAGE_LO_SAP_13A
        noLinkRefs: []
  name: STAGE_LO_SAP_13A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
