fileVersion: 1
id: c2922fb1-3c81-4aac-b158-28a03d60df49
name: STAGE_LO_SAP_13A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d12d5c18-5076-45a9-bbbf-71956f49c49f
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6781077d-323a-4315-bf82-dfb02a59a625
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6817e4e2-e074-48b1-9ec7-c4d854e577d4
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42201b35-9a0b-45c5-8df7-d42771319019
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48f583ac-c3cd-4e8c-a7bf-01b29de32390
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a3a254f-49e5-4065-82ed-d9841d5d8880
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f185ecfa-7109-48cb-8a87-df92a835f76c
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1128cbc-db73-42b6-8ca1-8c8b5bffe357
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd9dd74b-86cc-4cc8-95f3-49eb8b8d0ea6
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba4e8286-5a3d-4892-a12e-663e16a11876
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 070eddde-ec79-4406-adb9-48eca810f00a
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0435ef1d-38b9-45f0-a111-2fbe8df15ddd
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf291766-80b1-49e6-8d62-d37007edc480
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bd72309-5d52-4075-823a-34cb4c56030d
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 263c29be-a59d-4253-af85-133b094c8c55
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbfe7114-8615-414c-854e-9b3a76efbcac
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f528ae89-2d84-4016-9b5b-b934095dfe47
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 029fff23-6348-4ea5-bed4-e8fb8156ea3f
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fe49e61-787a-4afa-ada3-27cb2a544432
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d801ee00-0e95-41ee-a2ed-fd120760e0e3
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 430fd50a-803f-456a-bda1-f9550288bed9
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f516be23-af25-4c7c-9418-a7d49e7754a6
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82a40b7a-7829-4c81-bcb0-764123aec8e4
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46aecb0e-bacd-483c-851c-83e84ddc82f1
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80ae4d6f-e1dc-450d-b49a-f4f491b52b9d
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf8b0e74-135d-4749-8a75-934dd586933d
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1723bb3-9102-4743-8a48-5922cf83aa34
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e93316e-9731-4e5a-9ae7-f703d36b17a9
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: SUM(STAGE_LO_SAP_13.LI_VOL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fd4c350-567e-4113-ac02-5cb104a3d681
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f92810-bc9d-40db-9178-bd0ba95f28a3
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: SUM(DECODE(STAGE_LO_SAP_13.LINE_NO, '13.4',STAGE_LO_SAP_13.LI_VOL_M3*'{{ parameters.M3_BOE_FACTOR }}', STAGE_LO_SAP_13.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f97b067-cb62-44e7-9641-68b4300eaddc
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 231b9e59-3112-47a5-a190-d0da96a9c431
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: SUM(DECODE(STAGE_LO_SAP_13.LINE_NO, '13.4',STAGE_LO_SAP_13.LI_VOL_IMPERIAL/'{{ parameters.GAS_IMPERIAL_FACTOR }}', STAGE_LO_SAP_13.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76c2a270-59b8-40ee-9ebc-201e20dcdfbc
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33e23b4c-eefc-4d61-a70c-fa101836a9f8
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: SUM(STAGE_LO_SAP_13.LI_VOL_BOE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1013364a-d753-49f2-afc5-b7ae125c9784
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9759dde9-81c4-45e7-88cb-9c65edd0d6b7
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: SUM(DECODE(STAGE_LO_SAP_13.LINE_NO, '13.4',STAGE_LO_SAP_13.LI_VOL_NM3*'{{ parameters.NM3_BOE_FACTOR }}', STAGE_LO_SAP_13.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e1b3718-c0eb-4482-8147-3ac34dbd1110
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9715569d-88f1-41f1-917f-e50633228020
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a3bc91f-bc7c-4421-8100-f36cebbea789
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91368635-5ecf-476f-be5c-6df5b2af3d84
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f3cac5-ef32-416a-9560-dd6ce7a03353
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571396df-cc64-4518-a8e9-7ba2de1be4e2
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1618f224-0a65-4b88-9e1d-32651ad21399
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7488b489-dd0f-4531-8d57-b42ae51a2a1b
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35481294-4dd5-4f95-bd05-afea6549d9e3
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe1d00d4-8e7b-4465-a0c8-7fbd4e5a67ef
          stepCounter: c2922fb1-3c81-4aac-b158-28a03d60df49
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_13: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_13
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_13') }} STAGE_LO_SAP_13
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '13A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY STAGE_LO_SAP_13.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_13.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_13.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_13.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_13.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_13.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_13.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_13.EXCHANGE_RATE,
                      STAGE_LO_SAP_13.OP_CURR_CODE,
                      STAGE_LO_SAP_13.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_13.OP_NONOP
        name: STAGE_LO_SAP_13A
        noLinkRefs: []
  name: STAGE_LO_SAP_13A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
