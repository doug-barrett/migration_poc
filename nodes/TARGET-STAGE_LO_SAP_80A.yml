fileVersion: 1
id: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
name: STAGE_LO_SAP_80A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ab277bd-2293-4081-a914-d1d76fa22d0b
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c24cdf6e-8df8-4d83-85b0-904141ac6599
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ff3c468-78e3-4992-8e46-582694a43181
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae021d60-2b26-4424-a5d9-59f489ead55f
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebf8cb31-afb6-43df-984e-ee88785138ac
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d68a96f3-805d-4fd1-8c31-e2b44b39a57f
                stepCounter: 42a21a17-4fe1-4cdb-adac-be5e849918ea
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 930c48d2-61c7-42bb-a2a1-6d5cefd500b8
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5370454-c2cc-47bb-aafc-31c560a236d0
                stepCounter: 0d5ae7d2-34ba-43f0-b8d2-a1a4910da576
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a65b75f-8a16-4ff9-8c91-7d8bd252ea2a
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93375505-d8a0-4477-a6fc-111b2fed9c21
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e672c2d-e9fc-4cc5-aac6-5f6dc836bd42
                stepCounter: 7264c4d7-6959-48bb-b933-f944255adb7f
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 182af21b-727b-4397-8cfa-3247d2f18aa5
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 636e7523-6c10-41e1-a6ec-52225c601d17
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f314b046-8233-4451-a954-a10b97528668
                stepCounter: 98a317d9-4ad6-46b1-9bc3-a3b980264876
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fd2db28-1314-496a-bb19-54484884a836
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 221ebc68-c41d-4dec-a57f-e7bee1a353c9
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 942c2010-b64d-4263-86b7-a111afe33a63
                stepCounter: 9d7ce1cb-76c1-48f6-b7b6-762ad65cf8fb
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 053d9042-0ffa-4d99-9c5d-bf31a36cb3f4
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a2a7e26-d004-4e9e-a5fd-6586f3194517
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4186763-9d0d-4221-a6d9-a0cc4ebf35d5
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b015ab3-31c9-4379-a295-7d2cfc65563d
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0ac99d2-06ac-4c96-8b03-a35b53eb7ad1
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f793e8d3-7226-4482-af59-529b6c9d400c
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6222fa4c-b32d-4456-b58b-470b619ee765
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1897ef54-0523-4dc1-a66c-871446ec90f7
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f891247-27eb-494e-a290-5a2ccc90884a
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a6060f3-5c7d-4f35-87e2-594ba8228814
                stepCounter: bffac1cf-288d-42f6-a1ab-ac15b1edf2b6
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c962078d-c486-42ba-8faa-fbe5612e98d1
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f41431e-e5ca-4dc6-9746-6b351c60438a
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5ee34fa-bb8a-481d-8de7-2794e44196f7
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c23a10c-bfb6-4005-b9e1-3ce64af47d32
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b50b824e-bdf6-43e9-b44b-2b03f9f989e1
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba405822-7e21-41f3-95f2-90718461ef77
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe773cb1-ed4e-4bda-98cd-b28102c125c7
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a0343d-33ac-4f20-a4b4-949d555e53b3
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 526327cc-a975-4fd2-bd0c-403202678547
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 661cba08-6a15-4ab0-95b7-dcc0c5c11419
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1276737-a827-48ec-84f3-10c2a415066b
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e44f9fed-a47c-4ea6-ba13-7b5009180f4e
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 515ed479-5c89-4ed7-9ef0-e6d0bd0d049c
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcfaf7e2-08b2-462e-b214-c861d13cddf7
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bbca964-55d9-4a65-a713-c4339c961ea9
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5b05c9d-06f0-438f-9a51-1669128571b5
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 843d9f03-db21-4ead-bdff-8eff0edd67cd
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c890f91-e760-4e06-997f-6eb37d3a2054
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24b0dd8b-f7bc-40f1-9705-d5d46f83cb29
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeffca2a-7bc4-42ef-868f-6f03c9fb6c7f
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d8e97a7-2d15-435c-ab3b-c89b025735a3
                stepCounter: 42d9fa78-f81b-4028-8808-08f53f70bc9a
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ef9e4ca-bbcb-4857-af58-c70719c22b35
          stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_20A: 42d9fa78-f81b-4028-8808-08f53f70bc9a
          STAGE_LO_SAP_25A: 42a21a17-4fe1-4cdb-adac-be5e849918ea
          STAGE_LO_SAP_30A: 0d5ae7d2-34ba-43f0-b8d2-a1a4910da576
          STAGE_LO_SAP_40A: f98646cc-7f95-4803-964e-99e86b22da8b
          STAGE_LO_SAP_42A: 7264c4d7-6959-48bb-b933-f944255adb7f
          STAGE_LO_SAP_45A: bffac1cf-288d-42f6-a1ab-ac15b1edf2b6
          STAGE_LO_SAP_50A: 98a317d9-4ad6-46b1-9bc3-a3b980264876
          STAGE_LO_SAP_72A: 9d7ce1cb-76c1-48f6-b7b6-762ad65cf8fb
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_20A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_25A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_30A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_40A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_42A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_45A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_50A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_72A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_20A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_20A') }} STAGE_LO_SAP_20A
                 UNION ALL SELECT STAGE_LO_SAP_25A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_25A') }} STAGE_LO_SAP_25A
                 UNION ALL SELECT STAGE_LO_SAP_30A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_30A') }} STAGE_LO_SAP_30A
                 UNION ALL SELECT STAGE_LO_SAP_40A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_40A') }} STAGE_LO_SAP_40A
                 UNION ALL SELECT STAGE_LO_SAP_42A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_42A') }} STAGE_LO_SAP_42A
                 UNION ALL SELECT STAGE_LO_SAP_45A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_45A') }} STAGE_LO_SAP_45A
                 UNION ALL SELECT STAGE_LO_SAP_50A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_50A') }} STAGE_LO_SAP_50A
                 UNION ALL SELECT STAGE_LO_SAP_72A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_72A') }} STAGE_LO_SAP_72A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '80A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_80A
        noLinkRefs: []
  name: STAGE_LO_SAP_80A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
