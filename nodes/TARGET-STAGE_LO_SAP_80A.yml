fileVersion: 1
id: 175558ec-f91d-404c-bf6f-7289a5ba4432
name: STAGE_LO_SAP_80A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e36db70-c89f-4674-b78f-2706b681a5af
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd95686f-9fd3-4da2-8f24-04abdc50673c
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 111b85f3-ab20-4ba5-8023-28067939388c
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a25356f-f371-44cc-b487-efb91c0c4751
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38b0180d-2bbe-4c21-a621-bb6cf30035cd
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2da59c9b-8ee0-4517-b423-b9ce8b6d2a65
                stepCounter: bb262bfd-56cf-47ac-b6f2-44db8af5b2d6
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c92dd02-91d4-4c34-99df-a6805e13c93d
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8d297a-51e1-4f13-8f5e-981097a09c0c
                stepCounter: de612469-394c-4711-ac30-397e774b3582
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c025374-67fc-49b7-b26e-56ae94eee03a
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40659dba-88a7-44f7-8a74-0a8e87393489
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b278ef4a-8e89-41cd-a1f7-d478b41d2dca
                stepCounter: d8e6052c-1f2e-4a39-a93e-a534f97558f6
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39a3522b-e21c-45c3-915a-17d58f0ceb14
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddca916a-2ea6-466b-93c0-c2dfc6f86e9e
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 759d3651-9d46-448d-b1e1-d86504c95011
                stepCounter: f595ab1f-e57d-49c2-90cf-8c94521784bb
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9193e79-b382-428c-8f08-aa3927d8f599
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e77590a9-3346-4ead-a254-fcefcf2e8735
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04a43ee5-8d88-4bcf-908b-f583ac4a8bb7
                stepCounter: 8a363714-a684-4751-b5e6-657186391f80
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc75a66d-b1e8-4a79-9ece-cb777863b0b9
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48b7baf6-a499-4bc4-8ef8-0a901dd0ddf2
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b57ffd9-8812-4702-bc7a-d18df3d51bfe
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff3d34cb-9b46-4523-87a0-7fa72a7dbc00
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3715e943-0265-4344-a876-7e38d37bffb3
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5dabe3b-3cc8-4752-aea3-4701aa7ca446
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e65fe7b2-540e-436e-b9e3-94e1d4bbe3ed
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71118413-808f-488f-9d82-9975d1eab888
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c1453fb-9c6c-4535-bfaf-47e320d3b93d
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19fccea6-d8d5-457f-a9c5-bb3dc3850ef5
                stepCounter: bd862475-f3d6-4917-b585-55a2a2bc7592
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70c81554-7c0c-47ac-9d27-251fbe65855b
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e506878c-60dd-4474-a614-773358cc83fc
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4125db9-1013-41ca-a71a-b89ae2d5f15f
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2876311f-c869-4300-b849-f181aff97c8e
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37612632-c867-415d-bcc9-836a1397abaf
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27709b77-a2a3-446b-a8e4-e40ca09b530c
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d450f0c6-74a2-4c66-b652-ddf70b520fc4
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d1eec08-bac2-4bd9-8e97-bb06695167c6
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9db5f218-cf2a-4afe-8ea0-c1898439fab2
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88aa272d-af93-47dd-b6d4-fd0f240215f5
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 136eb159-faad-46f1-a467-e00b22f38b98
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e45b4c2c-cd32-4017-88d8-b6fa0c01a871
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ded51c88-1b16-4f56-8f76-79199aeeb016
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 585824ed-0fe6-4fad-81e2-68db2d7cc83d
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d36fd29f-d56a-4522-bc21-229ac7304d6a
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdb91660-456c-4c1b-a6d7-6d86ef0d77e9
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57280888-f636-4420-a830-c2c69fc8a3bb
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bb4f6bb-7731-4e00-9cfa-f56b80b5d0ac
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8d04ff4-0bab-459f-a65a-f050ae6b7be2
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58982312-56be-4b31-a53b-fc4f30ac663a
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef11503e-5653-4602-b368-92e4d20189b2
                stepCounter: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38405c69-3eb1-48fa-b156-98eea000fd60
          stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_20A: 5ee3e7d6-6c38-47f7-9f7d-85d28dafeef4
          STAGE_LO_SAP_25A: bb262bfd-56cf-47ac-b6f2-44db8af5b2d6
          STAGE_LO_SAP_30A: de612469-394c-4711-ac30-397e774b3582
          STAGE_LO_SAP_40A: 7ae18038-e473-4708-b512-99f3867d252c
          STAGE_LO_SAP_42A: d8e6052c-1f2e-4a39-a93e-a534f97558f6
          STAGE_LO_SAP_45A: bd862475-f3d6-4917-b585-55a2a2bc7592
          STAGE_LO_SAP_50A: f595ab1f-e57d-49c2-90cf-8c94521784bb
          STAGE_LO_SAP_72A: 8a363714-a684-4751-b5e6-657186391f80
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_20A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_25A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_30A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_40A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_42A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_45A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_50A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_72A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_20A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_20A') }} STAGE_LO_SAP_20A
                 UNION ALL SELECT STAGE_LO_SAP_25A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_25A') }} STAGE_LO_SAP_25A
                 UNION ALL SELECT STAGE_LO_SAP_30A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_30A') }} STAGE_LO_SAP_30A
                 UNION ALL SELECT STAGE_LO_SAP_40A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_40A') }} STAGE_LO_SAP_40A
                 UNION ALL SELECT STAGE_LO_SAP_42A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_42A') }} STAGE_LO_SAP_42A
                 UNION ALL SELECT STAGE_LO_SAP_45A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_45A') }} STAGE_LO_SAP_45A
                 UNION ALL SELECT STAGE_LO_SAP_50A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_50A') }} STAGE_LO_SAP_50A
                 UNION ALL SELECT STAGE_LO_SAP_72A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_72A') }} STAGE_LO_SAP_72A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '80A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_80A
        noLinkRefs: []
  name: STAGE_LO_SAP_80A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
