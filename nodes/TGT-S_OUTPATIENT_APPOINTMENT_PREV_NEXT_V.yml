fileVersion: 1
id: d24f0f27-35bc-459b-b716-9851c1f5b4cd
name: S_OUTPATIENT_APPOINTMENT_PREV_NEXT_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57f01a7a-9273-4dca-8b3a-e15b019c5eb9
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a6b5beb-58fc-426f-b455-6c53d329dda6
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cce950f0-02d0-4f39-b4e8-a9719f6ffd51
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ee4b93d-e76b-49a0-9928-970a1f7472b4
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 441eb11e-c516-4220-b453-9e21e4a13fbf
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ec140d-8ef2-4805-939f-bd6f6d116528
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6eea900-85e2-4048-a1f5-3694b6b09d75
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0ac545-d89b-4695-ba3d-63fe35c2f488
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 513632e4-2941-4356-a8fa-3e7a1ed0ac22
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c80e9823-9b77-407b-9b3d-7d1e717f6567
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 193880f5-1e92-45c9-889c-113474f3c1b0
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c03773-b9cf-448d-9734-c0065b3a90e2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 810b4dbd-a5ca-450e-a199-ca49c390b149
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52cde62f-bb34-4059-943b-cd89e05e1357
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f10031d8-9ec1-4ef9-a59b-72286d4ede4f
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e3ba2f-de6d-40c4-9153-31d74afaf5d9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c37fa521-f37f-4840-879e-23282eac0416
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224beca2-8103-4b0b-872a-96dbb7c26df5
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e8d4c04-5ea7-4a95-b74d-306b7cca3ee0
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca69a25-9d37-4dfd-b6ae-4ed9d9f5b399
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d44c04cb-515c-4f37-9450-6d11c8655ba7
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CURR_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb5c1902-35d3-4eca-b98e-ecffc5c61252
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CURR_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9380d66-5983-4026-9354-2d031043c32c
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0ac545-d89b-4695-ba3d-63fe35c2f488
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbc6ae23-9732-4108-adc4-99862ed91ac0
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c80e9823-9b77-407b-9b3d-7d1e717f6567
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b95fea03-7b76-4333-8aba-d622864fa27b
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c03773-b9cf-448d-9734-c0065b3a90e2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a21d98f5-863b-4a3c-9e09-3e0847857e70
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52cde62f-bb34-4059-943b-cd89e05e1357
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ae6622e-2182-4b66-ad72-2a0e7a1dfbad
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e3ba2f-de6d-40c4-9153-31d74afaf5d9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 815fede2-7235-41a1-9f8b-beeb0f837dd2
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224beca2-8103-4b0b-872a-96dbb7c26df5
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a47e2c6-4360-4fe8-9650-638cd4fd6e05
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca69a25-9d37-4dfd-b6ae-4ed9d9f5b399
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47bc0f8a-3260-40c8-a8f6-2a51e511f540
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daa882c2-cce6-4bd1-bbd5-1967bcddcbe7
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d95ea86f-8783-4467-a257-2522a3f82eaa
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0ac545-d89b-4695-ba3d-63fe35c2f488
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86f69944-f867-4915-a264-179434cd8a27
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c80e9823-9b77-407b-9b3d-7d1e717f6567
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69f688c4-8cd4-4cb6-87c1-2fc536698e10
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c03773-b9cf-448d-9734-c0065b3a90e2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3dcea4f-453c-4b8a-b5a0-26b98e103a0e
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52cde62f-bb34-4059-943b-cd89e05e1357
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a494982-d9ed-42ad-b391-7e2a94336d93
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e3ba2f-de6d-40c4-9153-31d74afaf5d9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17e152f0-4866-4ff2-be49-ed8be3eb74ad
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224beca2-8103-4b0b-872a-96dbb7c26df5
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17ffbf0a-3d36-45da-9cc4-8707d326d76f
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca69a25-9d37-4dfd-b6ae-4ed9d9f5b399
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ced149ba-ba84-497e-99ee-9ccfd7eaa4d5
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eafad7c-578a-407a-aed4-4d43edb79a8b
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e41ed13-c099-4ea4-8417-de8da442d31e
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0ac545-d89b-4695-ba3d-63fe35c2f488
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c1c77ce-ce81-4307-8b1e-fa7bfb271865
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c80e9823-9b77-407b-9b3d-7d1e717f6567
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225a301b-9a31-478a-9c58-2f84977a41b3
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c03773-b9cf-448d-9734-c0065b3a90e2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8a112cb-bc00-4007-b0f7-12552f5fa35c
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52cde62f-bb34-4059-943b-cd89e05e1357
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fb1d75d-37d8-4293-926f-083072495b4f
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e3ba2f-de6d-40c4-9153-31d74afaf5d9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e166104b-99d6-40a9-aba9-acabf111ca3d
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224beca2-8103-4b0b-872a-96dbb7c26df5
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc473a54-3dd1-4f98-8f02-a17b70f64594
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca69a25-9d37-4dfd-b6ae-4ed9d9f5b399
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc26b6c5-9a27-4e69-a114-00ccca5bf5a0
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b094f51-9c62-46b9-88ad-fc132416ba2f
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd01fe57-b4ca-4651-8d11-6cac8de4434c
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dc8f95b-ce3b-4208-ae26-5475e033c636
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1431ba62-a7f1-4f7c-87d5-3d4f0500d47a
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2e5d2b-e950-45f5-9e66-7a2331652c66
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fafab08-0c57-4007-8957-08f780d9bd6c
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e775217d-96cf-4add-9d62-825a7df86579
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9a86ddb-59da-45bd-8eed-53d3edf4de3d
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0ac545-d89b-4695-ba3d-63fe35c2f488
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3951c108-3986-4fc7-9f33-71e98ad81901
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c80e9823-9b77-407b-9b3d-7d1e717f6567
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24b230b5-72e3-43d6-86eb-684dfd166d32
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c03773-b9cf-448d-9734-c0065b3a90e2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca202917-48c0-450c-abff-7ea65b9bed5f
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52cde62f-bb34-4059-943b-cd89e05e1357
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cfb94b4-e53a-4e63-9c3d-6fac603a2710
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e3ba2f-de6d-40c4-9153-31d74afaf5d9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17d3a96e-bbea-46ba-a24d-b36069760d43
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224beca2-8103-4b0b-872a-96dbb7c26df5
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d031426-2b79-4b20-b93d-82ff1cf7a350
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca69a25-9d37-4dfd-b6ae-4ed9d9f5b399
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd3a98c7-e608-490d-a062-0cc6de56d9f0
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab047975-3d71-4c63-8c8e-23da38dac6ca
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52f39092-4004-4d6d-b36c-971e20d49fa5
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dc8f95b-ce3b-4208-ae26-5475e033c636
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd606d0-1c9f-4b54-83ca-2c78e455b6d0
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2e5d2b-e950-45f5-9e66-7a2331652c66
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04d39781-b4ed-4fe4-b066-1839a45a2ba4
          stepCounter: d24f0f27-35bc-459b-b716-9851c1f5b4cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e775217d-96cf-4add-9d62-825a7df86579
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT curr.patient_reference_no curr_patient_reference_no ,
                   curr.patient_NHI curr_patient_NHI ,
                   curr.outpatient_session_reference_no curr_outpatient_session_reference_no ,
                   curr.outpatient_appointment_reference_no curr_outpatient_appointment_reference_no ,
                   curr.outpatient_appointment_encounter_id curr_outpatient_appointment_encounter_id ,
                   curr.outpatient_clinic_reference_no curr_outpatient_clinic_reference_no ,
                   curr.outpatient_specialty_reference_no curr_outpatient_specialty_reference_no ,
                   curr.outpatient_health_specialty_code curr_outpatient_health_specialty_code ,
                   curr.appointed_clinician_reference_no curr_appointed_clinician_reference_no ,
                   curr.seen_by_clinician_reference_no curr_seen_by_clinician_reference_no ,
                   curr.appointment_start_date curr_appointment_start_date ,
                   curr.appointment_end_date curr_appointment_end_date ,
                   prev.outpatient_appointment_reference_no prev_outpatient_appointment_reference_no ,
                   prev.outpatient_appointment_encounter_id prev_outpatient_appointment_encounter_id ,
                   prev.outpatient_clinic_reference_no prev_outpatient_clinic_reference_no ,
                   prev.outpatient_specialty_reference_no prev_outpatient_specialty_reference_no ,
                   prev.outpatient_health_specialty_code prev_outpatient_health_specialty_code ,
                   prev.appointed_clinician_reference_no prev_appointed_clinician_reference_no ,
                   prev.seen_by_clinician_reference_no prev_seen_by_clinician_reference_no ,
                   prev.appointment_start_date prev_appointment_start_date ,
                   prev.appointment_end_date prev_appointment_end_date ,
                   next.outpatient_appointment_reference_no next_outpatient_appointment_reference_no ,
                   next.outpatient_appointment_encounter_id next_outpatient_appointment_encounter_id ,
                   next.outpatient_clinic_reference_no next_outpatient_clinic_reference_no ,
                   next.outpatient_specialty_reference_no next_outpatient_specialty_reference_no ,
                   next.outpatient_health_specialty_code next_outpatient_health_specialty_code ,
                   next.appointed_clinician_reference_no next_appointed_clinician_reference_no ,
                   next.seen_by_clinician_reference_no next_seen_by_clinician_reference_no ,
                   next.appointment_start_date next_appointment_start_date ,
                   next.appointment_end_date next_appointment_end_date ,
                   first.outpatient_appointment_reference_no first_outpatient_appointment_reference_no ,
                   first.outpatient_appointment_encounter_id first_outpatient_appointment_encounter_id ,
                   first.outpatient_clinic_reference_no first_outpatient_clinic_reference_no ,
                   first.outpatient_specialty_reference_no first_outpatient_specialty_reference_no ,
                   first.outpatient_health_specialty_code first_outpatient_health_specialty_code ,
                   first.appointed_clinician_reference_no first_appointed_clinician_reference_no ,
                   first.seen_by_clinician_reference_no first_seen_by_clinician_reference_no ,
                   first.appointment_start_date first_appointment_start_date ,
                   first.appointment_end_date first_appointment_end_date ,
                   first.patient_arrived_date last_appointment_arrived_date ,
                   first.patient_seen_by_date last_appointment_seen_by_date ,
                   first.patient_departed_date last_appointment_departed_date ,
                   last.outpatient_appointment_reference_no last_outpatient_appointment_reference_no ,
                   last.outpatient_appointment_encounter_id last_outpatient_appointment_encounter_id ,
                   last.outpatient_clinic_reference_no last_outpatient_clinic_reference_no ,
                   last.outpatient_specialty_reference_no last_outpatient_specialty_reference_no ,
                   last.outpatient_health_specialty_code last_outpatient_health_specialty_code ,
                   last.appointed_clinician_reference_no last_appointed_clinician_reference_no ,
                   last.seen_by_clinician_reference_no last_seen_by_clinician_reference_no ,
                   last.appointment_start_date last_appointment_start_date ,
                   last.appointment_end_date last_appointment_end_date ,
                   last.patient_arrived_date last_appointment_arrived_date ,
                   last.patient_seen_by_date last_appointment_seen_by_date ,
                   last.patient_departed_date last_appointment_departed_date
              FROM s_outpatient_appointment_10 curr
              LEFT OUTER JOIN s_outpatient_appointment_10 prev
                ON prev.patient_reference_no = curr.patient_reference_no
               AND prev.patient_appointment_seq_num = curr.patient_appointment_seq_num - 1
              LEFT OUTER JOIN s_outpatient_appointment_10 NEXT
                ON next.patient_reference_no = curr.patient_reference_no
               AND next.patient_appointment_seq_num = curr.patient_appointment_seq_num + 1
              LEFT OUTER JOIN s_outpatient_appointment_10 FIRST
                ON first.patient_reference_no = curr.patient_reference_no
               AND first.patient_appointment_seq_num = 1
              LEFT OUTER JOIN s_outpatient_appointment_10 LAST
                ON last.patient_reference_no = curr.patient_reference_no
               AND last.patient_appointment_seq_num = curr.patient_appointment_count
        dependencies:
          - locationName: TGT
            nodeName: S_OUTPATIENT_APPOINTMENT_10
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_OUTPATIENT_APPOINTMENT_10') }}
        name: S_OUTPATIENT_APPOINTMENT_PREV_NEXT_V
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_PREV_NEXT_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
