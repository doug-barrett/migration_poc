fileVersion: 1
id: 2b193351-c43d-4efb-936d-880bb9e4be7d
name: STAGEOPUS_CONTACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c82f4caf-ffc6-4627-8540-c8eb835534a0
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d27bab1-908a-45ed-8090-7015841bc822
                stepCounter: 462915c7-9ccc-4fc7-9a2e-272382246a50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e567089f-c745-48a5-8b40-9bd737e0ad79
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f879a1e2-5120-4536-9fcb-b3204f88c288
                stepCounter: 462915c7-9ccc-4fc7-9a2e-272382246a50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68641cf7-a7a7-49b1-83df-980dba8844b5
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 464e6559-287e-4f4f-807d-f4aee23cc926
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8aad6164-9ec5-46cf-8948-9c93b431e3ea
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ba07f55-74cc-4451-b076-6a340a0019b6
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e18d534d-cc22-45a7-a7ea-0f764467a8a9
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d83084f-46a2-403f-b6da-89f8359fd7a6
                stepCounter: f8a801c8-c819-47cc-8bd5-f210a3dd0f07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fd65f3c-e8d3-4f4e-b003-bf2c71934816
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5584bd23-424a-482f-b286-d807f9fa0c12
                stepCounter: 462915c7-9ccc-4fc7-9a2e-272382246a50
            transform: IFNULL(TRY_CAST(STAGECONTACTS_1.LEVEL1FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48e735fd-8ece-401d-9695-9e8153bfb26f
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bc5a56f-ed79-4cfa-971b-1753a3719ea1
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: IFNULL(TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df6c2b65-7728-4893-aad6-038e1d6b6d0a
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8acfc4fa-711e-4bf3-b5aa-0cefb9a8bc3a
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a61d564-4340-4477-b832-8ffea2058f9c
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6140718a-b592-4285-9dcc-79fb784e3334
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c87ad5b9-2dad-47a2-8bf9-ffb232ff6879
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ef23293-9912-4591-af3f-3e0304bcc8f6
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0652ca78-31e4-474e-9b3e-5e44a87ce7a3
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 025f7775-4fc6-4def-9486-db2f558ab249
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: LOWER(LOADOPUS_CONTACT.EMAIL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d07b79d7-11af-49c9-8cf0-dcbd81cb043a
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a50ea3ae-34ea-49ca-aaf8-0d90599b5b1e
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f04a428-bef7-4c17-bd05-2c4b91eaaf22
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6990e086-cfe7-476f-ac45-5aeb4f288963
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94df576a-a00b-44b5-aa34-cfb6390bcc19
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPETEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d0dcf38-5d45-4fcf-b4dd-11bc269ed843
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74884097-cb52-407b-a7cc-c4460b04688e
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d22d9597-178a-4fd1-a7cb-0a1bff1ceae1
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da98bc79-d481-4c9e-b5f6-5333d553409d
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65f3fde2-3b46-47d7-9dcc-62968f688094
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27caf982-ae54-4123-9e1b-6a0883079c8b
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dda19700-611f-4483-989d-ad320fd2eb76
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14952c54-e784-44ea-a220-2fa1a15bc771
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35514cff-44a5-467d-8b88-5b5f51e9363d
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bee1286-7e22-44c4-9366-2387f4c06c0e
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51010794-747e-446b-965d-51ffbbc8aa52
                stepCounter: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a3e7125-f079-4790-962a-f07d67b11ec8
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc375527-38da-437f-93e3-212d5e6ec7f0
          stepCounter: 2b193351-c43d-4efb-936d-880bb9e4be7d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_CONTACT: 9bc55833-89ea-4fdd-b779-3a872fa6db3d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
          - locationName: LOAD
            nodeName: LOADOPUS_CONTACT
          - locationName: STAGE
            nodeName: STAGECONTACTS_1
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_CONTACT') }} LOADOPUS_CONTACT
              LEFT JOIN STAGE.STAGEACCOUNT_2 STAGEACCOUNT_2
                ON TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT) = STAGEACCOUNT_2.FORCEID
              LEFT JOIN STAGE.STAGECONTACTS_1 STAGECONTACTS_1
                ON STAGECONTACTS_1.EMAIL = LOADOPUS_CONTACT.EMAIL
               AND STAGECONTACTS_1.FORCEID = TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT)
              LEFT JOIN LOAD.LOADOPUSACCOUNT
                ON LOADOPUS_CONTACT.ORGANIZATIONID=LOADOPUSACCOUNT.ORGANIZATIONID
        name: STAGEOPUS_CONTACT
        noLinkRefs: []
  name: STAGEOPUS_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
