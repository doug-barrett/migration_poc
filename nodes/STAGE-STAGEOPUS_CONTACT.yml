fileVersion: 1
id: 09854eaa-31e2-42f4-a469-e944e0db0002
name: STAGEOPUS_CONTACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e7c1376-67f3-4783-a14c-46464123556f
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f4bb45f-e8c6-4286-bc39-e586ab063adb
                stepCounter: c5e315d3-e958-412c-9010-fdab12e91f73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffec1c33-7724-4010-b266-f07690a87e67
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af1aadc1-73c7-4a19-b9e7-9599a1f7cbea
                stepCounter: c5e315d3-e958-412c-9010-fdab12e91f73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4bd15a9-2664-4cc5-964e-3e911a0243e5
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c73b18-aa78-48c8-b24b-646862d2cd25
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d76a8740-cc19-4d10-ba51-3b58869d5a8b
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02941564-df6d-48a1-a005-4c4e6546fb94
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f199f154-2c05-49c4-8d62-e836d6539a92
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 022e2370-cf66-4fda-a81d-87a02a8d0eb7
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69bba188-9824-47ec-bc06-a8590ba2daf4
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad951021-4c66-4337-8b70-5190b27e9437
                stepCounter: c5e315d3-e958-412c-9010-fdab12e91f73
            transform: Ifnull(try_cast(StageContacts_1.Level1ForceId AS int),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 447c554b-f76d-44a2-a181-435cfb9ad5b5
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 928d2ddf-93e3-479d-87b4-8f0c4c12aeec
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: Ifnull(try_cast(LoadOPUS_CONTACT.FORCEID AS int),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56aa19c5-e6ac-43d5-ade1-23cf2fb2daeb
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f94f9182-c1ce-4757-aa9b-6814e9d03973
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22cb7e18-e2d7-4fae-9737-0c3a35420954
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 218354f0-16bf-4408-aaf5-e5248042aca5
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad176ac6-a38a-41d6-b5d1-a436a0771cb4
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cb3bc9c-d6c8-4a12-8780-2ef11cef215c
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d46e66e-d302-4385-8800-d1f9ef2769be
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd8a49b0-c1be-4831-ab57-3895b0c77c63
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: LOWER(LoadOPUS_CONTACT.EMAIL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82703710-8de7-473a-bd32-d17bd1234aad
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7da86ace-78a7-4100-a0d9-01deb82ac88e
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3158301a-30d7-4af6-a22b-8ed4f5eda79d
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1736e3f-30ae-40d2-b473-04912b2983fd
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40c568b6-2651-4d51-a40c-a7917f6ed7bb
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCEPETEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca80dab-8b1e-467b-8587-12fa35888f12
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abe7dd68-b7da-48db-8d6d-9ba11fc69794
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71ea81b6-393f-44c9-9c66-4cb056a6d0ce
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b052d1c-00a7-4ccc-89ef-a053278d83f8
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 510aaa9b-e18a-4277-8039-4ba9b1c8f412
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 008b3a75-bfd7-4b89-9eb2-c28802b7924c
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aedea126-7b87-4f65-8252-7f4f0682c215
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a51d5a1-2950-4fa0-bce1-76f870c7a9b1
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe282de5-e823-47b8-9871-cf72b58022bf
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5084905-30d5-42ab-b83c-312358f3cbd7
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d02c2569-3997-410e-be5c-fceced31ad57
                stepCounter: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a04aacd-11ff-4348-a19d-d57c23547e68
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 326b8cfc-c9b6-41c2-a845-d46addc9f118
          stepCounter: 09854eaa-31e2-42f4-a469-e944e0db0002
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_CONTACT: 6ac20b6e-8a6c-4f88-8bd2-d50e0fa207a4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
          - locationName: LOAD
            nodeName: LOADOPUS_CONTACT
          - locationName: STAGE
            nodeName: STAGECONTACTS_1
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_CONTACT') }} LoadOPUS_CONTACT
              LEFT JOIN stage.stageaccount_2 stageaccount_2
                ON try_cast(LoadOPUS_CONTACT.forceid AS int) = stageaccount_2.forceid
              LEFT JOIN stage.StageContacts_1 StageContacts_1
                ON StageContacts_1.Email = LoadOPUS_CONTACT.EMAIL
               AND StageContacts_1.ForceId = try_cast(LoadOPUS_CONTACT.FORCEID AS int)
              LEFT JOIN load.loadopusaccount
                ON LoadOPUS_CONTACT.OrganizationId=LoadOPUSACCOUNT.OrganizationId
        name: STAGEOPUS_CONTACT
        noLinkRefs: []
  name: STAGEOPUS_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
