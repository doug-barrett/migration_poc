fileVersion: 1
id: 5e23afad-afff-4545-bc14-109653809e02
name: STAGEOPUS_CONTACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ad70ed0-c658-4ec8-ab25-b711e41c807d
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcc237d4-da8f-4073-8dba-9b2e0ec29326
                stepCounter: 18492ffd-b37c-46fa-841a-770cf79346da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef44d9b5-4f14-4387-9fbf-2aaba3b8caab
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d011ea77-57de-479e-854e-75c68dfb9a16
                stepCounter: 18492ffd-b37c-46fa-841a-770cf79346da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3caf3c35-0c81-40d6-944f-a8a3bd4cdba8
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6671ee20-2170-4070-99f8-ce0ab73e0d76
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bca7a257-6b22-4832-8e4c-13810b999efa
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6b2bf55-845c-47ee-b874-123e73fd7791
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 455b4ba5-f0ed-428e-b2e8-a4f1e09e9390
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 219653b3-102e-4987-bc00-e5f479753673
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ef326a3-84a3-4227-b02a-f9cfc2790dba
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac2935e9-3c7f-4841-9f23-1d25fa9db39d
                stepCounter: 18492ffd-b37c-46fa-841a-770cf79346da
            transform: Ifnull(try_cast(StageContacts_1.Level1ForceId AS int),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48019ab9-e9c7-4a48-8ecd-89a1a825cba4
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6971817-0acb-4855-afbb-28c619738e89
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: Ifnull(try_cast(LoadOPUS_CONTACT.FORCEID AS int),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a99427e7-d857-4ad0-affb-52f2a83738aa
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83af3b7e-ba9d-4542-b067-33dbe3ebfbad
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48adf87a-9597-4925-9751-024829765e7d
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c81f838-8f22-48d7-9209-07ea1c760aad
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cafb0a59-6ab4-4f8f-a88f-798baf68ef31
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c2ee88b-4fe1-4e5c-bbff-545d854068a6
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e119f58-363b-4930-8b84-155b721b57e1
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da510173-0fea-43fc-bb1e-2f9bfb48093a
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: LOWER(LoadOPUS_CONTACT.EMAIL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab772e7f-819e-46e4-9b85-b6ff687ad2cc
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2c6fc33-1eef-4b13-a912-29c15fc785a2
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39faee5f-b337-4715-ae0d-1bfb35c64bee
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f70a6e4-6309-4e19-8448-2b43dd092d68
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be41d4c8-74b9-448f-9c1c-681d95545670
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCEPETEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04f11f5b-420c-42de-bfe7-dfa5acdbff9d
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c82ca1e-a239-45af-a94f-851d145b0fb7
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f8ac734-e70c-4376-9821-3c2bfe208f25
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bec6c61-a49c-4eb0-85d0-e8871aeaf56d
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20ba1b49-8148-47a2-b8ec-53035925204c
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d1481d6-b0d8-4656-896f-7509fce5a631
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03bab35a-da14-4138-a463-8a492cb5da09
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59711f9f-b7b6-4d4f-9b1a-d11eec2d15b3
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5af61ea8-db69-4909-a19c-2e5c1c919b57
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c82b507-d1b7-41e4-8cd4-163e5a0d6373
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c5fbce1-c8bd-446e-960c-75eb9162e7ff
                stepCounter: 3612ca11-b73f-4e2e-8660-2810545b8814
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fd77da3-681b-40a6-8cf7-3e290d96eb94
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15348200-4c10-4b2d-b29e-e223bb8a2561
          stepCounter: 5e23afad-afff-4545-bc14-109653809e02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_CONTACT: 3612ca11-b73f-4e2e-8660-2810545b8814
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
          - locationName: LOAD
            nodeName: LOADOPUS_CONTACT
          - locationName: STAGE
            nodeName: STAGECONTACTS_1
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_CONTACT') }} LoadOPUS_CONTACT
              LEFT JOIN stage.stageaccount_2 stageaccount_2
                ON try_cast(LoadOPUS_CONTACT.forceid AS int) = stageaccount_2.forceid
              LEFT JOIN stage.StageContacts_1 StageContacts_1
                ON StageContacts_1.Email = LoadOPUS_CONTACT.EMAIL
               AND StageContacts_1.ForceId = try_cast(LoadOPUS_CONTACT.FORCEID AS int)
              LEFT JOIN load.loadopusaccount
                ON LoadOPUS_CONTACT.OrganizationId=LoadOPUSACCOUNT.OrganizationId
        name: STAGEOPUS_CONTACT
        noLinkRefs: []
  name: STAGEOPUS_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
