fileVersion: 1
id: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
name: STAGEOPUS_CONTACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fcc1676-5bc9-431f-be17-229999f49a32
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d93542c-3e7a-44ee-99ec-0ea98b6f755d
                stepCounter: 69ba9e71-ff05-4225-a353-b30c4fa82da6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541bc7a1-4e80-43a3-a62b-29a0d12a4cab
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4abc13-7069-4000-a27c-c4a438b8d800
                stepCounter: 69ba9e71-ff05-4225-a353-b30c4fa82da6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0790dcee-674a-47a3-8288-07b8b0d28720
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b745e275-98d7-4eb5-a1f2-0c8aa8208c0f
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c617be7-69f4-4997-9bd1-5ea06ed30189
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f92f1846-820f-4d0f-8bfd-d51b219ea2f2
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9546bee-707c-4a11-8433-14f2e4def45b
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32d16773-7e96-48b9-9974-0d68e8841da8
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d67c2853-5230-4368-a570-d1158fd03424
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88cbf49e-f63f-445b-9cca-7c5986ff456a
                stepCounter: 69ba9e71-ff05-4225-a353-b30c4fa82da6
            transform: IFNULL(TRY_CAST(STAGECONTACTS_1.LEVEL1FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f16bbb3-7273-4d41-9768-53d370491c0c
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1040c839-537f-4017-8a26-cd507d9ba5e3
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: IFNULL(TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 386fdfc4-1ed0-4ccb-a381-11697b08f554
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f87afa10-7907-4505-b21c-3d288364509c
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f769681-be20-4542-8b65-7bed42fcc39c
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc260539-4adc-4fbb-85e1-4aa880da12ba
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b8c02ed-a65b-47c8-9ee6-858115514a72
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f686498b-ee22-4621-8076-46b2b670e2dd
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e81e608d-97e8-44aa-a58c-ac96335a1fc8
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a19e2d3-6e08-42f2-9965-92e8eb93279c
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: LOWER(LOADOPUS_CONTACT.EMAIL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8bfb8fc-eb53-40a3-941f-c282a5401a4f
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a60f6d83-7b97-4e9f-9eeb-b3c4b2e23c92
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6581dd39-afac-4bae-a9cb-f4504f0a347f
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 596a9959-fc4a-474e-99fa-40d927043f2d
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b8e55f6-651d-4e92-b4dd-c991390aacd4
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPETEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 450ac78e-c0c8-4d22-b8a6-4674e3a12bf9
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04189fdc-2e8b-400e-92d5-c7ce53cd8dff
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce78c42-54fe-47ef-ba60-e4d8b6d5c36a
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1073cf66-c592-4f52-84f0-c210f02c77dc
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a58d1c-3ef3-4bfa-bc26-2d196cca5c0c
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9acc90fb-9c29-4868-aa49-66a95a0721b8
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86e2e536-509f-40cc-8519-202ed21665d0
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2ee6b21-c306-45b2-be35-6936637db494
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96c1c4e7-6a77-4087-9bd4-3f113d10c1b3
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea8830e9-b770-45bd-87a6-8641e19e6638
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bef8683-85fc-4b6b-ac62-d1e267c84286
                stepCounter: 3255e5f1-268e-4724-a294-1eec3159ed50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a1f6900-a041-490e-9822-d41b2ef14bf3
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6af65c4f-1bbb-4d46-b0c1-d57384ab479c
          stepCounter: af897b38-9f5c-46e7-9e49-f3eaf7832d3a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_CONTACT: 3255e5f1-268e-4724-a294-1eec3159ed50
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
          - locationName: LOAD
            nodeName: LOADOPUS_CONTACT
          - locationName: STAGE
            nodeName: STAGECONTACTS_1
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_CONTACT') }} LOADOPUS_CONTACT
              LEFT JOIN STAGE.STAGEACCOUNT_2 STAGEACCOUNT_2
                ON TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT) = STAGEACCOUNT_2.FORCEID
              LEFT JOIN STAGE.STAGECONTACTS_1 STAGECONTACTS_1
                ON STAGECONTACTS_1.EMAIL = LOADOPUS_CONTACT.EMAIL
               AND STAGECONTACTS_1.FORCEID = TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT)
              LEFT JOIN LOAD.LOADOPUSACCOUNT
                ON LOADOPUS_CONTACT.ORGANIZATIONID=LOADOPUSACCOUNT.ORGANIZATIONID
        name: STAGEOPUS_CONTACT
        noLinkRefs: []
  name: STAGEOPUS_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
