fileVersion: 1
id: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
name: STAGEOPUS_CONTACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c44abce5-ad12-4f82-b17d-70f1d8d363d0
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4879ec3-6b14-4a13-8885-eeddfde4ec6d
                stepCounter: ab4df6e5-1112-4f6f-b7df-531828932628
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb5f4499-90b9-49c9-965c-ba32b5fbbe23
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c04eb6b-0f6a-4d29-bb3d-9b1b7e2089ce
                stepCounter: ab4df6e5-1112-4f6f-b7df-531828932628
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c45fed99-7e6e-48ca-b48d-4c4b961652f7
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2740759-0f3a-4719-90ad-bf4a91132be5
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02437389-014f-404a-b980-4aea07d78ab5
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07c81c6c-6062-4d02-bc46-ba1492dafc3c
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30773937-54fb-4dbf-a60b-c2e27d52d315
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51216395-5269-44f1-ab7f-cf03dfa5fa23
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecd7fcee-2d45-4b6e-a938-0442222dfdd6
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b73e7b10-5383-4d57-bf8a-6896accdba2b
                stepCounter: ab4df6e5-1112-4f6f-b7df-531828932628
            transform: IFNULL(TRY_CAST(STAGECONTACTS_1.LEVEL1FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93ab30c2-f371-402c-9c0d-1f913e452d14
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c109b1e-0f59-4d7a-a417-8660c9c45ea6
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: IFNULL(TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89d38485-75fc-416f-8876-6d1016cb8585
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 152a05e5-a4cc-41f7-8a18-9be43867b524
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 554c37a9-6e8a-4dd5-9483-c5d875489415
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b10315a-8eca-4618-9698-2b867a862cee
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a6d978c-d32a-46d2-8022-26f39cf0effd
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e20ef61-329e-4b77-a152-12c5c696cdb4
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bae7462c-af5f-4c06-a35f-b9bb67c1a270
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c455a74f-21da-4bf8-aefc-736ea432f755
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: LOWER(LOADOPUS_CONTACT.EMAIL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87065d92-536e-4c53-b837-c267f54b4261
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f9a2ab-483b-4154-b2ea-19c5980f28b2
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8569656-03f4-4150-a225-e379202fab0a
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0b90dec-f945-4805-8305-baaca84d0a18
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d2812b4-4221-4a25-b569-882c2072bc26
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPETEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1247f20e-015b-4ce7-84d2-1a0afb32010b
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dc2d563-258b-41aa-a032-cd246b1ff873
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be4cf425-ee5a-497c-9f46-84e6032e06ab
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18d20dca-34c7-4996-b638-c09dc6f86422
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78aa7be4-383c-49d4-a94c-9b6393c7d03a
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca055bc5-c7a6-4bb3-97ea-450e1a1e08c9
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 246f68c0-8a5e-47ba-aaa2-75e1830f1230
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb30232d-60e1-4ace-abe1-9ffe1a50e692
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f694cb5-f634-45a3-b6d8-e7b0e969fcef
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b61195f-695f-47cb-ac82-098236cb08fe
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9af1a571-f971-438d-8486-a771fe508b14
                stepCounter: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f37525c1-dbb5-48e7-a485-271eb373f931
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 332a0fb5-69ff-497a-b3fd-128d24779591
          stepCounter: 1d5e04a8-f164-44fc-b6c2-f921d5385dd4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_CONTACT: 6931931a-2cc7-4eb4-908f-5d035c1d64f5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
          - locationName: LOAD
            nodeName: LOADOPUS_CONTACT
          - locationName: STAGE
            nodeName: STAGECONTACTS_1
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_CONTACT') }} LOADOPUS_CONTACT
              LEFT JOIN STAGE.STAGEACCOUNT_2 STAGEACCOUNT_2
                ON TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT) = STAGEACCOUNT_2.FORCEID
              LEFT JOIN STAGE.STAGECONTACTS_1 STAGECONTACTS_1
                ON STAGECONTACTS_1.EMAIL = LOADOPUS_CONTACT.EMAIL
               AND STAGECONTACTS_1.FORCEID = TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT)
              LEFT JOIN LOAD.LOADOPUSACCOUNT
                ON LOADOPUS_CONTACT.ORGANIZATIONID=LOADOPUSACCOUNT.ORGANIZATIONID
        name: STAGEOPUS_CONTACT
        noLinkRefs: []
  name: STAGEOPUS_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
