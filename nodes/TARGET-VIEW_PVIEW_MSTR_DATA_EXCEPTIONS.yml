fileVersion: 1
id: 3015816c-3abb-42ee-b688-1ad47ae4c560
name: VIEW_PVIEW_MSTR_DATA_EXCEPTIONS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f367ed-3900-43bc-9ea7-55fcb081c589
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: PV_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b6e1d74-6828-42ae-b9d7-69ba4615f389
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fc151af-9a7b-439d-b32c-2376e1453b8e
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d37f47d0-ca23-4e9a-9442-6d4c7f467ae9
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a37c017-a5f8-47ea-bfad-52cb42fc2413
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_COST_CENTRE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd3e1556-ef81-493c-9720-e488c74447ce
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e7f7b24-a948-4320-b319-8248bb9b68a0
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(53)
        defaultValue: ""
        description: ""
        name: EDW_COST_CENTRE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06adf1b5-2716-4e11-97ee-797f1760f518
                stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1ce469d-3e02-43d4-a60f-258760b5e03a
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85500cd7-4fed-41cc-9f74-0057b082bae7
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af354669-e68d-4649-a457-64146a69b2f8
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37d4c090-d8c8-4438-a0f9-d753dc6d0632
                stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcebd41e-b030-47b1-83ea-d53d69b8fce1
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7fe1a76-e16c-4253-9cef-5607e7315e56
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2550a26b-20af-4014-aa77-f866a3924f65
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 951615e8-da61-4378-ad87-3a4681891896
                stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5db1b081-648e-4887-99d5-d39e989c796e
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PV_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1779ea8-be06-43ed-a285-b7e2f5cf34bf
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b87b54ec-c75e-4972-b426-bb3e1999d034
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a2b2d9-5e48-4796-81f8-62aed279d8d1
                stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7805794b-aa69-4fab-8505-25e1be66205f
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PV_DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9cf7ea6-340c-4b7d-9dd9-6f55a9da5f4a
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d360899-b1ce-45c6-828a-787b5bf6c4b9
          stepCounter: 3015816c-3abb-42ee-b688-1ad47ae4c560
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2ce76b3-c75f-4252-8946-26c5c9286213
                stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_MSTR_DATA_EXCEPTIONS: 3015816c-3abb-42ee-b688-1ad47ae4c560
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_MSTR_DATA_EXCEPTIONS') }} AS SELECT PV1.IDREC AS PV_IDREC,
                   PV1.COSTCENTERIDA AS PV_Cost_Center,
                   PV1.UNITIDPA AS PV_Cost_Centre_Name,
                   PV2."PVT_PVUNIT_unitidpa" AS EDW_Cost_Centre_Name,
                   PV1.field AS PV_Area,
                   PV2."PVT_PVUNIT_field" AS EDW_Area,
                   PV1.area AS PV_Core_Area,
                   PV2."PVT_PVUNIT_area" AS EDW_Core_Area,
                   PV1.division AS PV_Country,
                   PV2."PVT_PVUNIT_division" AS EDW_Country,
                   PV1.district AS PV_District,
                   PV2."PVT_PVUNIT_district" AS EDW_District
              FROM DS_PRODVIEW.PVT_PVUNIT PV1
             INNER JOIN WS_STAGE_DT.STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR PV2
                ON PV1.IDREC = PV2."PVT_PVUNIT_idrec"
             WHERE PV1.field != PV2."PVT_PVUNIT_field"
                OR PV2."PVT_PVUNIT_field" IS NULL
                OR PV1.area != PV2."PVT_PVUNIT_area"
                OR PV2."PVT_PVUNIT_area" IS NULL
                OR PV1.UNITIDPA != PV2."PVT_PVUNIT_unitidpa"
                OR PV2."PVT_PVUNIT_unitidpa" IS NULL
                OR PV1.division != PV2."PVT_PVUNIT_division"
                OR PV2."PVT_PVUNIT_division" IS NULL
                OR PV1.district != PV2."PVT_PVUNIT_district"
                OR PV2."PVT_PVUNIT_district" IS NULL
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
        name: VIEW_PVIEW_MSTR_DATA_EXCEPTIONS
        noLinkRefs: []
  name: VIEW_PVIEW_MSTR_DATA_EXCEPTIONS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
