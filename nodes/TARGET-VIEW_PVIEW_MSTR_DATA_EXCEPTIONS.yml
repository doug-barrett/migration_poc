fileVersion: 1
id: 750428db-39df-4735-8fb5-c2f44af288c7
name: VIEW_PVIEW_MSTR_DATA_EXCEPTIONS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bf30f1e-b49b-497d-b6b8-1039e9c11ddf
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: PV_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe22de8-f6e2-429b-90aa-91f793353b62
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d11179-6f87-428b-8503-3d2e36341941
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d509337f-2ce6-4703-b898-0d9f424534b9
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00fb2d43-4f85-4cbc-ab7e-48497f8caf67
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_COST_CENTRE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcb82200-733b-4189-8b27-530dec17123c
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba11f7a5-69e7-4ce9-ad34-742ba7e74ccb
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(53)
        defaultValue: ""
        description: ""
        name: EDW_COST_CENTRE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0ff617d-f19d-4fd3-ae7a-93a07c6c2964
                stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e98ed538-afd8-4ee3-8b10-963316bc3098
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c01c879e-07ba-4916-b139-744483f793b2
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fd14555-ec7e-4e93-ada1-1b10cd5b840f
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 096a9e36-e05d-4def-9349-9584faa55229
                stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9308dcb3-f4ac-469e-b340-c3fde4281890
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PV_CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66c5b120-bd07-45ad-b22a-e20b747ac5d7
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 352f1909-eb8b-40ad-8168-7d8e294cb41a
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13c24c17-f7b9-45ff-8927-9ef228cd1fc3
                stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 160bb321-3318-46d1-a8b2-0a3f8062c528
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PV_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68e50ebb-cd59-49f5-b939-e1bf6e72579b
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7a54486-b879-44e0-9ebf-b4e2c9be55fd
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0226d215-2bb6-44ab-8642-eda0644d9809
                stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58cdf7a5-57b1-48d7-987e-23447ac5bf0b
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PV_DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d96f944-44ce-49f9-ba99-ef4510b5d01c
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16b28d24-65c2-4e91-bd9f-23b42efcdd8b
          stepCounter: 750428db-39df-4735-8fb5-c2f44af288c7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: EDW_DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b22dd4b4-9d68-4f91-9457-1d29f1a7ea8b
                stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_MSTR_DATA_EXCEPTIONS: 750428db-39df-4735-8fb5-c2f44af288c7
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_MSTR_DATA_EXCEPTIONS') }} AS SELECT PV1.IDREC AS PV_IDREC,
                   PV1.COSTCENTERIDA AS PV_Cost_Center,
                   PV1.UNITIDPA AS PV_Cost_Centre_Name,
                   PV2."PVT_PVUNIT_unitidpa" AS EDW_Cost_Centre_Name,
                   PV1.field AS PV_Area,
                   PV2."PVT_PVUNIT_field" AS EDW_Area,
                   PV1.area AS PV_Core_Area,
                   PV2."PVT_PVUNIT_area" AS EDW_Core_Area,
                   PV1.division AS PV_Country,
                   PV2."PVT_PVUNIT_division" AS EDW_Country,
                   PV1.district AS PV_District,
                   PV2."PVT_PVUNIT_district" AS EDW_District
              FROM DS_PRODVIEW.PVT_PVUNIT PV1
             INNER JOIN WS_STAGE_DT.STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR PV2
                ON PV1.IDREC = PV2."PVT_PVUNIT_idrec"
             WHERE PV1.field != PV2."PVT_PVUNIT_field"
                OR PV2."PVT_PVUNIT_field" IS NULL
                OR PV1.area != PV2."PVT_PVUNIT_area"
                OR PV2."PVT_PVUNIT_area" IS NULL
                OR PV1.UNITIDPA != PV2."PVT_PVUNIT_unitidpa"
                OR PV2."PVT_PVUNIT_unitidpa" IS NULL
                OR PV1.division != PV2."PVT_PVUNIT_division"
                OR PV2."PVT_PVUNIT_division" IS NULL
                OR PV1.district != PV2."PVT_PVUNIT_district"
                OR PV2."PVT_PVUNIT_district" IS NULL
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
        name: VIEW_PVIEW_MSTR_DATA_EXCEPTIONS
        noLinkRefs: []
  name: VIEW_PVIEW_MSTR_DATA_EXCEPTIONS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
