fileVersion: 1
id: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
name: S_PJ_PATHWAY_PROCEDURE_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Map events to pathways via theatre procedure codes."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77b0dd39-9d43-4594-baa0-664738708b75
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique ID for a patient journey
        name: JOURNEY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f7dd4ca-4b72-4471-8e15-dd1ec0a54c3c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 936f06fd-94b4-4609-9cac-71d1ed05d01f
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7f60003-b7a5-4f17-92d1-b8cb3e8fce89
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cfa7a97-e071-4154-af70-9bfb32c19f4a
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey number for the patient.
        name: JOURNEY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8017333-8bf1-48d8-ae28-60f8be1ba8fd
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 359b389a-cd81-4090-86e1-3390b55cffc8
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 262474ea-64f5-4a8a-8e03-2f585f9dc405
                stepCounter: 840b1a44-55c1-4cbc-9199-4415e254bce4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e2ad851-1a53-4c61-bbe0-86bc521021a7
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ICD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "''"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1245cd50-38f7-4fc5-9602-00cbe16c48a0
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: ICD_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "''"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13274a76-c87a-4d85-931c-8368a13c531c
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: procedure_desc
        name: PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4af711b3-0ba3-4364-b578-34a6270b67c8
                stepCounter: 840b1a44-55c1-4cbc-9199-4415e254bce4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d478200f-ff50-4d70-b35e-6df9cb4bb224
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fb1f729-9506-4e97-a2e6-910cc695a94b
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DRG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 432fb999-5356-43e8-9ddc-56c317519ec0
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ICD_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 741b51f5-f086-4ba5-a288-30b248b5a30e
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DRG_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f56773b4-c631-48d0-999d-2726fc004641
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ED_TREATMENT_PROTOCOL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49af65df-2071-40ac-bb7c-04bba1578715
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_THEATRE_BOOKING_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ef6644-44e9-4728-bdc2-7474d12f6885
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_THEATRE_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51c19742-3062-4a74-82ae-251e5c27eb8e
                stepCounter: 730862be-91f8-4f46-a87a-ba8787c86eac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a83f5625-31f0-4742-abc3-8925b8b97e57
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CODE_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c73b2a9d-2c47-46ec-8c40-d62485371c8e
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27773230-4a36-40fb-9d35-261e15b6ad61
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATHWAY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeb7b32b-8f2a-437f-8a26-00aa90fc341e
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63a7a61f-2d8c-4fa9-a6ed-c66e225ed761
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATHWAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 822a56ac-8b7d-465d-a60d-afe98e705c59
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f403648-42ea-4c61-8e65-a1dcef231d86
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f9c4f67-e8f2-4ec7-b342-4ffc0a502a3f
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50781b05-efca-4cd4-9ede-0c3dcdbd205d
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b85a1e98-f006-44f3-b271-293c15237feb
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe77d660-51dd-4755-b4ab-530d9b110f6a
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e009f44-734a-4289-8221-7835e51a48eb
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7724a5ba-2ef8-4877-a62b-a97efc507214
          stepCounter: 637149b8-9d7b-4a59-ba72-52ef4d6a56ef
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PJ_EVENT
        join:
          joinCondition: |-
            FROM s_PJ_event
              JOIN fact.fact_theatre_visit_coding
                ON s_PJ_event.theatre_encounter_id = fact_theatre_visit_coding.theatre_visit_encounter_id
              JOIN dim.dim_theatre_procedure
                ON fact_theatre_visit_coding.dim_theatre_procedure_key = dim_theatre_procedure.dim_theatre_procedure_key
              JOIN s_PJ_pathway_code_xref
                ON dim_theatre_procedure.theatre_procedure_code = s_PJ_pathway_code_xref.theatre_procedure_code
             WHERE s_PJ_event.event_source = 'Theatre'
        name: S_PJ_PATHWAY_PROCEDURE_30
        noLinkRefs: []
  name: S_PJ_PATHWAY_PROCEDURE_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
