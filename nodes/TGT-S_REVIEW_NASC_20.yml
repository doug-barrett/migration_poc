fileVersion: 1
id: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
name: S_REVIEW_NASC_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2a36505-28f0-46cb-9090-e79d75d8d887
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9a34e2e-b1ff-4129-91ea-68d9a80b3c98
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcae21d0-a1a3-4568-a5b8-009ae6fc6229
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddd2cb8b-3f0e-43e8-9470-e9e28c7f29eb
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f8dfd09-62c7-4ef8-8b5b-b784f2b36bcb
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.contact_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0243b5c-593c-4f45-bcbf-5ba9aa9c1345
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3097a887-65a2-48c6-acd4-b05e0de8635f
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5f32dbc-bf74-448c-94f6-cc085dff6bee
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f52de3fe-cf28-49a3-9a18-88a4d3290895
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7873bcea-de01-4ea2-8c0e-83cc0b789214
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme_status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09f778eb-84df-4c15-8e54-11332717431e
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7df908f-ff0f-4a98-a811-171679bf2bc9
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5ce28af-9aca-48f3-8591-0c22ae35dbff
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dce797e-56aa-4435-a514-7e5d953996d3
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54080c7d-bd2f-46c3-8340-0d54df1eae03
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_AT_CONTACT_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_review_NASC_10.task_request_date) < s_review_NASC_10.task_request_date THEN IFNULL(dim_patient.patient_date_of_death,s_review_NASC_10.task_request_date) ELSE s_review_NASC_10.task_request_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c5e2334-85f5-401a-aaf2-a00d51ab0838
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.patient_age_at_contact_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baa39b09-f684-4584-9f25-6b2c9d3270de
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70d68016-ad4f-49b6-a958-f5421bcaedee
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 658a6ee6-eaea-4b74-9841-65c64464ba61
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce84e2e-4226-4836-bb29-535cd68428f2
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c7ff960-4635-4f64-ae01-a9381b86d737
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3defaf1-6695-4512-a534-4541bf3f23fb
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf481d50-43b0-4fb9-9f24-58ccb05d4fe8
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.health_org_reference_no=dim_health_organisation.health_org_reference_no
        name: DIM_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78290bb6-3cd5-4503-8179-d1f65525ba15
                stepCounter: 0790fdf4-e815-4587-a9cd-954ea13f53c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dc5c136-e3c9-41e2-b810-7d22174a230c
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1859c228-9c26-4a4f-9918-0856800ed020
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fd06faa-46e1-4131-ac3c-6587fb2e3b8e
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17eea908-ed43-42de-a538-549924acc22e
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dce6ebc5-4146-4388-b48a-00806aba6340
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.seen_by_clinician_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fca110ff-4717-4f90-bf09-19285040de92
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0271ff7-3a03-4135-a514-984eb91160c4
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c36e113-fffb-403f-8ff1-b549fbad93cc
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee4af4bb-eec4-410c-b6dc-aba5d5ccfbb7
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc8edd3b-1ad8-4cc7-8919-efb07bf36974
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d3ab207-c70d-45e0-88c1-33b7855cb93d
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15c072c6-c4ff-42e7-8ce7-229d44011f3a
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.provider_id=dim_provider_community.provider_id
        name: DIM_PROVIDER_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b90d7a-0e1c-4ff6-a2e5-e32763dfcbcd
                stepCounter: fe333361-f763-4fd4-b86e-f42e95e81344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0acde93-1eb4-4a3b-823e-acf86334d429
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d846aef-06e8-40ef-a08e-1812bffc06c0
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fb4262b-b82b-46a4-82f0-f1f239f11bdb
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 055a3eb7-501a-491a-80ba-21760a4401f4
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d974c43e-9287-4d9e-847f-5c71fcd4ac1f
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.programme_role_code=dim_role_community.role_code
        name: DIM_ROLE_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acff4fff-07f1-43da-966d-53a96d429471
                stepCounter: ab48ab83-7613-4d28-acbd-ba81b413fe84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39fc3902-e2fb-4dae-bc26-96f43a0769d5
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5eaf5a03-6cd5-4c33-8e35-1d2dc42798ad
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dff96f6-b38d-4c86-adb9-402f661cd4f1
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d151bcc0-4aae-45fa-9229-c87517201773
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 825b5cf2-c453-4f65-8063-9cf420ae27ce
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c138d8-95f8-495b-a6c8-c8594a68d0b8
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f81672-a7a0-465c-b2c6-f7b2df84b764
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_review_NASC_20.CONVERT(date,s_review_NASC_10.task_request_date)=dim_request_date.request_calendar_date
        name: DIM_REQUEST_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 776fe4b8-0bb6-494d-a530-7fae3de7a539
                stepCounter: d1b797ef-4926-45af-a745-f75c3ed18b1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ec78820-caea-4efc-8a61-e0c611c89aca
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45e2421-4106-457c-9385-e2ff1490b14c
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a3ba4c7-7888-40d5-950a-0edf82fd51b9
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REVIEW_OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8ff74cf-3e06-4004-8cf1-806e2b68d8c0
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65887fdd-0a52-4f6d-9070-7f9e78b8c3b9
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REVIEW_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ec223e5-1005-4c20-891f-f8382749f5e5
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7156d45a-3f91-4cac-8d2a-b8649acf1209
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_REVIEW_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfc3b9ba-8c15-4e38-86d1-d8fe42731294
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e80bf70-31bd-4c9f-a63a-ea72a984ba33
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_REVIEW_DATE_CHAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4500f3d0-ff47-4561-a2fc-07be15c0ca40
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04056305-80cd-4fa0-a566-7bf0e81e12ce
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NEXT_REVIEW_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83dbac56-f3b1-4847-ae4f-76db2c28b53b
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e176f6c9-ba2a-4850-9ed8-b8c371bc68a1
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PREVIOUS_REVIEW_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5aa99fc-e6f3-474e-8a5a-3bfd23e81dee
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba0dda5b-c2af-4e4e-a578-d9932d35024e
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXIT_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65706bfa-e61e-43f4-aac0-78ccd4f428f7
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03f1d8e3-f0d2-4438-b5dd-1920b92977e4
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13ea2611-6e73-4950-b7a6-72aea9a11470
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b8e8938-4495-407c-9402-37d730dc0fbc
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_RESIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6e36d75-8e9a-480c-942c-ce4c3bbe738c
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c56595ec-3762-4af5-8179-5606a72cb107
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64f66ab3-15c0-4bed-bafd-d003de65807a
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0422bf64-f007-4b45-9a9d-a14146654335
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.transfer_out_DHB=dim_NASC_review.transfer_out_DHB  s_review_NASC_20.transfer_out_residential=dim_NASC_review.transfer_out_residential  s_review_NASC_20.exit_reason=dim_NASC_review.exit_reason  s_review_NASC_20.next_review_type=dim_NASC_review.next_review_type  s_review_NASC_20.review_reason=dim_NASC_review.review_reason  s_review_NASC_20.review_outcome=dim_NASC_review.review_outcome  s_review_NASC_20.programme_status=dim_NASC_review.patient_programme_status  s_review_NASC_20.observation_report_status=dim_NASC_review.observation_report_status
        name: DIM_NASC_REVIEW_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f89fec4-e0bf-420c-920d-b79762245ea1
                stepCounter: 088fbd60-e1da-45fb-aeed-76fe6cd3ec86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b1d3420-5917-4365-b622-4d3a0ba2b43f
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REVIEW_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f99aeb7-b3c5-4beb-9523-3e0d25c9d6aa
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: |-
              CASE WHEN s_review_NASC_10.referral_review_seq_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3b2a2b0-1950-4bc5-9f68-d676db54cf4a
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CURRENT_REVIEW_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f99aeb7-b3c5-4beb-9523-3e0d25c9d6aa
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: |-
              CASE WHEN s_review_NASC_10.referral_review_seq_num = s_review_NASC_10.referral_review_count THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d52556a-f7d9-4808-bc9c-7384c4a38d60
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: addf6c03-87f3-447f-9950-33854a5feed3
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ad68df6-ca3b-44c5-bc32-571b09a6eb7d
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a52d99d-1490-4b05-b4b9-4e14877d23e9
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2454fe37-9161-49a0-a03e-80c8a5dee453
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2034d32-0902-45f1-bbce-61cf998512e8
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8610596-3e48-492e-a81a-b88c92f2a97b
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REVIEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 137ede2d-e6a4-4473-a5ec-418ef4200177
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b033700-4c0f-4c26-8785-66bc3dc1538b
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REVIEW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d4d061f-1243-4966-a26a-6af24ad5bd8a
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ca9e1fc-4142-4eba-a0ae-7dbcae9011b8
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REVIEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f99aeb7-b3c5-4beb-9523-3e0d25c9d6aa
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02045ace-81f9-437d-9621-66d80b981516
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REVIEW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45f919f6-6e9d-4ecc-a1cd-70ff31146b8f
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 951f9f92-464e-4867-b41e-e9eb5742b9d3
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REVIEW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4979299e-18f2-498a-80e8-0337f7ffa8ce
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 893cb798-8f9c-460c-81c7-d4c846f7fb60
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf7aaee-e740-4cc3-a4c6-5e21bd9ec578
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a78f7d4-c13a-4438-9f08-82cac57fe5d1
                stepCounter: 65c18d2d-d6a7-42b5-a9b2-ca972eab4001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4307b024-1a0f-461c-be18-f61df32ac9f2
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_review_NASC_20.create_user_login_name=dim_user_login_concerto.user_name
        name: DIM_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f2ac98-6185-439c-9a15-757698e43d58
                stepCounter: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
            transform: IFNULL(dim_user_login_concerto.dim_user_login_concerto_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5ff58b2-9206-47aa-83b5-5c23e29bed0f
          stepCounter: f7a193f1-bd80-4c3c-9ceb-4ec10ff4f043
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_USER_LOGIN_CONCERTO: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_REVIEW_NASC_10
          - locationName: TGT
            nodeName: DIM_USER_LOGIN_CONCERTO
        join:
          joinCondition: |-
            FROM s_review_NASC_10
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_review_NASC_10.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT OUTER JOIN {{ ref('TGT','DIM_USER_LOGIN_CONCERTO') }}
                ON s_review_NASC_10.create_user_login_name = dim_user_login_concerto.user_name
               AND IFNULL(dim_user_login_concerto.validity_start_date, GETDATE()-10000) <= s_review_NASC_10.task_request_date
               AND IFNULL(dim_user_login_concerto.validity_end_date, GETDATE()+10000) >= s_review_NASC_10.task_request_date
        name: S_REVIEW_NASC_20
        noLinkRefs: []
  name: S_REVIEW_NASC_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
