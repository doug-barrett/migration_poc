fileVersion: 1
id: f75d42c1-f96f-4a6b-9305-d95054099ec2
name: S_ED_ATTENDANCE_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Dimension key look ups for fact_ed_attendance.  "
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b38d505e-1567-47e5-bcd4-9bf3038ccf11
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 655cb7c5-ea4e-421b-b4d1-d1937aea43fe
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f8ea43d-c2bf-4c28-b1ef-6b9ffb3601a8
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: first character of the attendance_encounter_type_code (A, H, etc...)
        name: ATTENDANCE_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88ad1f79-09e3-4c74-9110-32222aa7a6ce
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd915b74-dd28-43f8-90ac-95cbef6f4b6a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.attendance_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: IFNULL(dim_encounter_type.dim_encounter_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39ff1ea3-8dcb-4fda-860f-35d2096c666f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: attendance_reference_no
        name: ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: decef4af-31f8-4491-8813-d6282b13b362
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86549b4a-9f5d-42d5-af54-5201d20a76b1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Visit date and time.
        name: ATTENDANCE_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e237f4f-0610-4730-920f-3a4d9a1b8bef
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e5dad49-0b93-4f40-9a6d-1c0bd1e22e72
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Arrival date and time.
        name: ARRIVED_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d740fcea-f049-4f1b-ba22-35bdc8e9d692
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a7168ff-c8bc-44bd-ae7d-a04e1ec00a0b
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.stream=dim_ED_stream.stream
        name: DIM_ED_STREAM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aa3590d-ef11-4bde-a83e-47a5b9a124f8
                stepCounter: 8cd23f46-52eb-42fc-8e85-9d8153730879
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7e751da-a84b-4606-9355-882812d92d74
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.arrived_time=dim_arrived_time.arrived_time_of_day
        name: DIM_ARRIVED_TIME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aac17781-c309-440c-86c0-8aaee41fb3c0
                stepCounter: a4adc93f-ec40-47e1-af0b-5e31ca2f0b66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 552b6a66-ce17-42ea-9f90-07cae832fd99
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Financial month representation. Fromat YYYYMM. Examples: 200101, 200102.'
        name: ADMISSION_FINANCIAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c484db0b-3a04-45fb-96ba-aa788f8f3a87
                stepCounter: 1cd7fb94-db63-47da-bede-ced19af38f40
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a87bf6d-1123-40b8-a0c2-bd347b2191d2
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.CONVERT(date, s_ed_attendance_20.arrived_date)=dim_arrived_date.arrived_calendar_date
        name: DIM_ARRIVED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33f7f445-5a3a-4797-98df-44e3bf68e939
                stepCounter: 1cd7fb94-db63-47da-bede-ced19af38f40
            transform: IFNULL(dim_arrived_date.dim_arrived_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78f8e526-47b2-45f9-b9d2-addc78c8f47a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: IFNULL(dim_hospital.dim_hospital_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f12856fb-50d5-49c4-a5af-1a4b193ffb0a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: IFNULL(dim_purchase_unit.dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c304664-d074-4311-8265-92f02468a255
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ARRIVAL_TRANSPORT_MODE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3b3cc53-895a-4e98-8cbf-1c3fc71ebd57
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34ce4adc-9cb3-43ac-9374-ad5565d0f18e
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.arrival_transport_mode_reference_no=dim_arrival_transport_mode.arrival_transport_mode_reference_no
        name: DIM_ARRIVAL_TRANSPORT_MODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 586f7a6e-f853-4255-8617-732c56184dc8
                stepCounter: 3d490dc0-61d6-4ccf-b56a-1abb7b700fd4
            transform: IFNULL(dim_arrival_transport_mode.dim_arrival_transport_mode_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ea06572-6776-41db-9def-d335b548a78f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance category reference no
        name: ATTENDANCE_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93f22d23-d3b0-47a6-8de5-fb56b331450a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffc9f5a2-ea27-4dfe-ad81-c9fe08d2edf8
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.attendance_category_reference_no=dim_ED_attendance_category.attendance_category_reference_no
        name: DIM_ED_ATTENDANCE_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d14c9079-06d5-4ba4-b5b1-e3c833954f21
                stepCounter: 9b9c79c3-de71-43ad-9a4a-a1bbef0d1a2a
            transform: IFNULL(dim_ED_attendance_category.dim_ed_attendance_category_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03392ecb-7ad1-4259-b97e-cc10cf3fef08
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: feddad68-694a-4c46-b98d-515c3a96f7b1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1af4b1bd-8904-49bb-bfb2-73a0a7e12ca0
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d88912d-5262-4daf-9aa5-8d6cc4655cd6
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7d3342e-9d63-4c35-adb7-611aabc7cfe1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INT
        defaultValue: ""
        description: Patient age at date of visit.
        name: AGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dc03e6d-a59b-4177-b67f-b66ff853a2a8
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aea2e3a-1c01-49e3-80e2-1c0680002cb5
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(1000)
        defaultValue: ""
        description: ed_location_path
        name: ED_LOCATION_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b1f3553-5c98-4127-8daf-5c2aadb0edc9
                stepCounter: 54b2f02a-b840-43e5-a510-821a8264294d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12a1a5fb-d563-4b96-a7d2-e9d53b3c208d
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR (255)
        defaultValue: ""
        description: Concatenation of ED seen by clinicians specialty
        name: ED_SPECIALTY_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24c9f7bc-bdfd-4be0-9c3b-db625065e9d8
                stepCounter: 4b25cdd5-d4bc-4358-92cd-4acdcf32f05a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 375e1db7-e2d4-4c8c-b011-b9f578fd34e4
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.first_seen_by_doctor_id=dim_first_seenby_clinician.user_name
        name: DIM_FIRST_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 151f8a46-3b9c-400d-a148-0d903ca39281
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e960bf31-5822-48d4-8a30-d5017a2bd138
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.second_seen_by_doctor_id=dim_second_seenby_clinician.user_name
        name: DIM_SECOND_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6355ae6a-23e4-4859-b6ac-0e08be58a4d0
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cf49b70-f30e-468c-924a-d3c3da01bc4d
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.third_seen_by_doctor_id=dim_third_seenby_clinician.user_name
        name: DIM_THIRD_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abd7dfb9-4126-425c-be03-18bab6679993
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6b192d4-6626-401b-865b-f1a0f05384ce
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FOURTH_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e1272ce-f4b2-4818-8412-cda2c02e2e5a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d206899-71f8-4f44-9ba6-852a2102024c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FIFTH_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3ae459d-1a0d-4a24-8a21-6df36c518c56
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b46932d-b923-416d-9717-40b6e87637cb
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FIFTH_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3907335f-0c2c-4c63-8ba2-2e98b3c4eca7
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbe014fe-b2ae-4a59-8597-5d71fec9d8e1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.patient_age_on_arrival_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52f310d3-cba8-48a9-8add-5316ef212358
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_PRESENTATION_NUMBER_TO_THIS_VISIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f3d021c-941d-485a-bd9e-94954f46fd1e
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45ebbb00-ee32-4676-bf77-09528b2c9683
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_count
        name: ED_PRESENTATION_NUMBERS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05efab8a-65de-4ae1-a5ae-3df26dac537a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 941834ef-173d-4ae6-9714-64720f1a92f7
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.triage_category_reference_no=dim_ED_triage_category.triage_category_reference_no
        name: DIM_ED_TRIAGE_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74ff5474-346e-4cd7-9143-5e733a77aa3f
                stepCounter: e54396c4-42ab-493b-8c49-31e8636f0c5f
            transform: IFNULL(dim_ED_triage_category.dim_ed_triage_category_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cb0741-c46e-4b4e-92a1-b7acaa102052
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.triage_healthcare_professional_reference_no=dim_triage_clinician.triage_clinician_reference_no
        name: DIM_TRIAGE_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8baaca1-107a-4727-ab5d-9205ae25f33e
                stepCounter: 876bb1e1-2b91-401f-af8a-213622eb008a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ef24f27-2c62-46b3-bebc-32e4a52517e9
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.presenting_location_reference_no=dim_presenting_location.presenting_location_reference_no
        name: DIM_PRESENTING_LOCATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02d0b0a0-303f-421e-8529-d55b47973ab1
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 472f2ad2-3c66-400d-bbb7-916e9503d7af
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.hospital_code=dim_presenting_lead_clinician.shift_location_code
        name: DIM_PRESENTING_LEAD_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad239023-abe8-4038-b564-afe30c21e66e
                stepCounter: 3aa54fc8-83f0-43ae-882f-27b5a691ff71
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 835f0834-2ccd-4dd7-87ca-1ba00d65e4b7
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.presenting_healthcare_professional_reference_no=dim_presenting_clinician.presenting_clinician_reference_no
        name: DIM_PRESENTING_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c83c3754-85e9-4c16-a2d7-b61b8bd87d3b
                stepCounter: df8448c0-fce7-4262-b0c7-7d17c70f3daf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2429df3-9665-4087-a118-aad1e26e721e
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.presenting_specialty_refererence_no=dim_presenting_specialty.presenting_specialty_reference_no
        name: DIM_PRESENTING_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d5c4efb-2c08-471f-ac4c-75861d902c4f
                stepCounter: a0f51a19-f02f-44a5-82aa-11ec6307bcd0
            transform: IFNULL(dim_presenting_specialty.dim_presenting_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b64b58b3-d212-4a0e-a3ec-0c5846570036
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient first seen by a clinician.
        name: EM_CLINICIAN_SB_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d0f08d3-ec0f-48d4-96f6-19cd602b8a21
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN s_ed_attendance_20.first_seen_specialty = 'EMMED' THEN s_ed_attendance_20.first_seen_date
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a726916-89ca-4220-96f9-7a40dc64b62c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_LOCATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f87c145f-86bd-4d6d-8d6a-3ef5638682ed
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.first_seen_spont_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed300f27-03e4-4926-b0f2-22e7c85d0eb5
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: first_seen_healthcare_professional_reference_no
        name: FIRST_SEEN_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d9c9f5-d9e6-4c00-bc8a-63c788f61844
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.first_seen_proca_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e2dd33f-325c-4698-9252-8b902c1485f8
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FIRST_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10ce7d2f-d8c7-4f45-a7f5-8749c9b300f8
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de03c1a3-b9e1-4b23-bf3c-b48048d1db22
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Symptoms code.
        name: FIRSTPRESENTINGCOMPLAINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 769536ac-fd52-4066-8e44-e25dc3145173
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc0e428c-3e79-40f1-9444-6eef19a27197
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.first_seen_specialty_reference_no=dim_seen_by_specialty.seen_by_specialty_reference_no
        name: DIM_SEEN_BY_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c156773-c9b6-46d8-b86c-c4e61e7a7588
                stepCounter: 86f01b33-4439-4996-ad36-36cf6d4f54d5
            transform: IFNULL(dim_seen_by_specialty.dim_seen_by_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504f7793-1074-4378-bab2-196264535dcf
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FOURTH_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58b6c4be-86e1-48a8-a9c4-5842ffbbb995
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e0b5c2d-b506-4d23-acc0-c8cab54e1f7c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.event_end_type=dim_ed_event_end_type.event_end_type  s_ed_attendance_30.clinical_disposition=dim_ed_event_end_type.clinical_disposition
        name: DIM_ED_EVENT_END_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf17547a-db95-4ee1-b73c-8266cfcd341a
                stepCounter: ce54e159-b8c2-45ca-a89b-4967a72735da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2178ac35-ef27-4b09-8eed-4b9b668157c5
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Yes if not part of the Diagnosis codes
        name: FREE_TEXT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78f60561-fcbf-4927-ba5e-873130263528
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6209f5dd-6333-46e5-bc65-32cc5fdbeee5
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.event_end_type_final=dim_ED_event_end_type_final.event_end_type_final  s_ed_attendance_30.clinical_disposition=dim_ED_event_end_type_final.clinical_disposition
        name: DIM_ED_EVENT_END_TYPE_FINAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5351b5db-8ee5-4577-b2c5-9a8e16014c3d
                stepCounter: 6445bacb-bb8b-47ae-8444-6cbbd594e4a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 673a0645-05f7-4189-bb65-d975a243b5a6
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 105f4164-3d60-4d22-a120-e04a7164c740
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de250b57-2181-4c0c-a385-47978282118d
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: s_ed_attendance_30.hospital_code=dim_hospital.hospital_code
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a18e675c-d343-4ae7-ad2d-346a13111dd0
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e20b70a-2d41-48de-b40d-617fada86aba
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: inappropriate_location_stay_flag
        name: INAPPROPRIATE_ED_SPACES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f83b467b-c921-491f-be9a-deb1d86568dd
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.inappropriate_location_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7a32578-7e9f-442c-b2b6-3db639e90ba2
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.principal_diagnosis_code=dim_principal_diagnosis.principal_diagnosis_code
        name: DIM_PRINCIPAL_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1a7261f-2942-445d-88b4-fe34e5a3929f
                stepCounter: 6a64703e-9924-4948-986a-0578fe6b91b7
            transform: IFNULL(dim_principal_diagnosis.dim_principal_diagnosis_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38ac892e-4aeb-4173-ba9b-4180fa7080ed
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y.N indicator entered by triage staff to indicate if an accident was the cause of the presentation.  The queetion asked is; Is there and injury component to this presentation?
        name: INJURY_COMPONENT_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e351246-e2eb-4546-8be7-a698f8db8611
                stepCounter: 80735e6c-8a12-41ae-8034-6cf7e83a9a5f
            transform: IFNULL(s_ed_injury_flag.TextValue,'U')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59834a9b-c4bc-4c81-a38d-9c444843550d
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: IP_admission_ward_reference_no
        name: IP_ADMISSION_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32fc29fd-74da-4dcc-bd1b-9747aed0a5de
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.IP_admission_ward_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ebdf7fa-9cbb-4668-acee-417828daba0c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Medical discharge date.
        name: IP_CLINICIAN_DISPOSITION_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7adcdd70-4aba-45f6-9e66-054c9df3a88f
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c509e9f8-09f8-454e-9a57-852d6ec2df42
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.first_seen_healthcare_professional_reference_no=dim_seen_by_consultant.seen_by_consultant_reference_no
        name: DIM_SEEN_BY_CONSULTANT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf26dffd-6421-4dad-a6f9-17e47be2720c
                stepCounter: 24b66526-56f5-4e79-b3c6-b36770997001
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2739f615-2553-44ee-a8da-672c12c704d1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: First seen date by a clinician outside of EMMED.
        name: IP_CLINICIAN_SB_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e778060-0e5e-4507-ac0f-abb9becfc52d
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b57587b-84a3-4331-ac0b-b3b2ad3bf21f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: encounter_id of IP admission
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e7b2a41-2a36-4ecd-9f9c-e5c0d8a503b9
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38df7189-41d1-499b-a3a4-503347829fb8
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: IP_healthcare_professional_reference_no
        name: IP_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5eac7674-1191-4b22-8598-2e76a6ccba4b
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.IP_healthcare_professional_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1cc2777-5e05-496d-bfc0-c98d83a8624c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration between EMMED end and first seen by IP clinician.
        name: IP_RESPONSE_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de42c103-1d51-41c5-ae15-c154388cfa18
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.IP_response_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5efa8a6-36aa-4619-9964-b824570feee0
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.symptom_reference_no=dim_ED_symptom.symptom_reference_no
        name: DIM_SYMPTOM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a823ed9-582d-46af-8c71-bd74184f25c3
                stepCounter: 4437afd0-4a46-4166-b676-d6557047e9ad
            transform: IFNULL(dim_ED_symptom.dim_symptom_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2e21442-278b-4c3d-b5c5-723ed42d3fe9
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94473826-ba98-4b26-a010-13019e2651b8
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.IP_specialty_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 834495f6-0abc-4a69-af7a-53ad630935fa
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: patient_last_attendance_flag
        name: LAST_ED_ATTENDANCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_attendance_20.patient_visit_num = s_ed_attendance_20.patient_visit_count THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce38e778-5f8f-4cfb-bba1-022f26f594b2
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTURE_ED_ADU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06a39a59-233b-401b-8589-fd02f49e1ce3
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ca54491-d06e-41e8-b1e0-2796f463b3b2
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient last seen by a clinician.
        name: LAST_ED_CLINICIAN_SB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a776f8-8ea2-4860-b102-aa7343ada3bb
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.last_seen_date, s_ed_attendance_20.departed_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0680a2f-2197-4e66-bc52-b5206ae703d4
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Ref no of Clinician at ED Discharge  '
        name: LAST_STAY_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4af1656-ca5e-4136-b083-cfaccf893a1f
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.last_stay_proca_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d19c53-ada8-4580-9b1b-37c6be88324f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_LOCATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5d5581d-c443-40cf-b2dd-e3d0b77127c3
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.last_stay_spont_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97f548ed-67f8-4558-835b-26cfd8f4c903
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTED_TIME_ED_ADU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ac8826d-76d7-4c6b-8a7a-cfe23ad29adf
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d57615a5-bb95-489e-90f3-40d4b00f78fe
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: last_stay_specialty_reference_no
        name: LAST_STAY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcf649fb-96c9-4591-8f3c-0214d4f901b1
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.last_stay_spect_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c09e06cf-c64b-485d-972d-634dee2222c9
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.CONVERT(date, s_ed_attendance_20.departed_date)=dim_departed_date.departed_calendar_date
        name: DIM_DEPARTED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0617f56-8a26-4d7f-984d-59db345fee91
                stepCounter: 6751697d-4a73-4618-9b17-85f4089a15be
            transform: IFNULL(dim_departed_date.dim_departed_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55de2b21-6fe8-4f6b-9099-94999e103ec0
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating that the Patient did Not wait for Treatment in ED
        name: LWBS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b7e8296-9372-42ef-8fe6-fe1d2df16a16
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 805d0470-73c9-4bc5-a9e1-f95e9e46f469
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebed1c43-9894-41bf-9622-ca7c4c5286bc
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1871a0d-9b00-4a7c-bbfb-7f5863cc675a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9fedc4a-cffa-45dc-a077-ba2f36bec2e2
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6de319a-2193-46dd-89a7-e6046f3fda0f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.departed_time=dim_departed_time.departed_time_of_day
        name: DIM_DEPARTED_TIME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24d98008-8e21-4da3-abfa-fe8acfed672c
                stepCounter: 7b3d920c-54f2-4b7a-9613-fcacea461bb4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ced5c311-667b-46cb-bc9e-169b01a4126c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: multiple_EM_clinician_seen_bys
        name: MULTIPLE_EM_CLINICIAN_SEEN_BYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cabbf1d-59d3-4192-9e0b-f41e453793f0
                stepCounter: b2d5f1b6-4e48-4de5-acd2-2a385cf804fa
            transform: IFNULL(s_ed_wb_many_EM_Seen_bys_v.many_seen_bys,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8017acd6-3259-4169-92d4-032504fee990
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_ED_ATTENDANCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d7c589c-4f28-4775-85de-d09e0fa8c953
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c2c0a95-38c5-4568-965b-8542a09c6966
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_ED_ATTENDANCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bc7831a-14a6-4f48-a433-caaed51d26da
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1651c4e-3741-4d3a-81b5-721fb2324a00
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NON_EMMED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43890033-2845-4a85-ab79-04892c683585
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a8c3dce-28f7-43e0-815b-2b92a29feed1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79e9f70c-111e-4a02-b7a1-7fb0dfd00720
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1579870b-57af-44ef-b741-120be4577305
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95ff912e-a711-4115-8952-b8c177c52688
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e47971fa-b7e5-4b8f-ad31-a9489941b6d2
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating if Patient was in Observation
        name: OBS_ADMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d41e379d-3e5c-478b-b2a3-26e6a477106d
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.observation_location_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c375c3c-b896-451f-aa33-329e918d20a6
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.last_stay_location_reference_no=dim_discharge_location.discharge_location_reference_no
        name: DIM_DISCHARGE_LOCATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a417b573-9b4d-4f76-8d27-22337a0e7014
                stepCounter: 8bdea297-67ca-4ecf-8202-29b54a48d924
            transform: IFNULL(dim_discharge_location.dim_discharge_location_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f7bc73f-d77b-4e51-b93f-ecbfab3e2678
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: observation area admit date
        name: OBS_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43ff562a-0479-4179-9fcc-bf5a123833be
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8699cd38-008a-4e7d-8406-ba980cb0e02c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient age at date of visit.
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: s_ed_attendance_20.patient_age_on_arrival_years * 12 + s_ed_attendance_20.patient_age_on_arrival_months
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5731aac6-6b98-4c95-93e5-112c6f2b4177
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_years
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dc03e6d-a59b-4177-b67f-b66ff853a2a8
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d657c552-707a-4598-a3ae-aac4564b47e7
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edaf2fbc-26ae-4f75-b381-b5252617a519
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7086762a-3b79-41f1-b7fe-3c1fffcc02d9
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_reference_no
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e487ca41-ee52-4bd0-b1e3-8e9ee2e3629b
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.patnt_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f8f1fb0-01cc-45de-aa9b-594ec17b323f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: current_to_next_attendance_duration
        name: PATIENT_RETURN_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e877291a-a3ab-4292-a4f9-a8486e7158dd
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2015628-0ae4-49ba-9d7f-abb7ca2d82f0
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.last_stay_specialty_reference_no=dim_discharge_specialty.discharge_specialty_reference_no
        name: DIM_DISCHARGE_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 958dc448-145a-434d-9ea4-20fc505ee700
                stepCounter: 0a4357f3-ec96-4b4a-843e-aee2051c1131
            transform: IFNULL(dim_discharge_specialty.dim_discharge_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55788009-ad9d-4051-beef-42c5dcad36f4
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Notes presented on patient's arrival.
        name: PRESENTATION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28c0d052-cdb0-4f21-ae25-c9303071e736
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 393a3791-a0b8-4ab0-9085-8ab66875edb6
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Notes presented on patient's arrival.
        name: DISCHARGE_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55cbdcb0-66c1-48c8-8959-eee20a1da122
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67fa0308-b2fe-4b76-8746-26a2c300fe54
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: 'List of Symptoms that Patient presented with '
        name: PRESENTING_COMPLAINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 805104d6-2cfd-45d0-a025-06722d8f248a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN len(IFNULL(s_ed_attendance_20.symptom_list,''))=0 THEN s_ed_attendance_20.presentation_note
                          ELSE s_ed_attendance_20.symptom_list + IFNULL(+ ', ' + s_ed_attendance_20.presentation_note,'')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84c6127b-5219-428c-89f5-be59249b6add
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRESENTING_COMPLAINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1ea130d-93e7-4da8-b809-8c27f50d602a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27781254-4c72-4bd3-a20c-b50b4c44ef0f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRESENTING_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1c7b33f-1499-48d7-8bd1-004546e8c755
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.first_stay_proca_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9236f08b-6ec2-425a-a45f-d9808d8ee294
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRESENTING_LOCATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2555d3a-f22e-46e2-ad47-4b8d7b0eed18
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.first_stay_spont_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46daa092-e195-4c39-a8db-74c350321805
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.last_stay_healthcare_professional_reference_no=dim_discharge_clinician.discharge_clinician_reference_no
        name: DIM_DISCHARGE_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cca54d1-eacf-425c-a627-1bac1547c043
                stepCounter: 95f534bc-2a59-4894-85f0-8f8290f11380
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d79a379-eb54-436b-8091-bdc319b9d32c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Reason for discharge code
        name: DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 742e9c14-868b-4d53-8684-9cd040fa0a45
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cadb2b1-3e29-40d2-992c-48f0bdbcfd71
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: presenting_specialty_refererence_no
        name: PRESENTING_SPECIALTY_REFERERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 309cdcbf-9a9f-4ed4-9aa0-77ac57ccccb2
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.first_stay_spect_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5372c0e-9457-4f73-859f-d65a0cf30827
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a6f947c-e8e7-43c2-a455-ea32143fad73
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.event_end_type,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aad7945a-4016-4dad-81e8-eb66f4595326
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINICAL_DISPOSITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a1d010c-59f9-4f0e-a086-88037bd3086a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e10ce9f-1718-47a1-9196-2259856fd9c6
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATETIME_OF_DISPOSITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2dd18a9-eaae-4e9c-9b60-feb4229917c8
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eadafbd8-b77e-4db3-b522-e009fe2b021a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_ED_ATTENDANCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08267483-12ac-4b87-9650-9ddefa37dc20
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abed3862-fcf3-4f86-b6d0-c544a42e1340
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_ED_ATTENDANCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6e3cd02-50ab-47e3-a90e-f1a9d3e305ae
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a80054-13e6-4adf-99fd-9820b555d5de
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_reason_reference_no
        name: DISCHARGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 379a2cc5-72b0-4052-8345-4dd0b805f0cb
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.discharge_reason_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f9b3cc0-308a-4bd0-ad77-ded8a16d7d0c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Principal diagnosis code.
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b06038b9-bdc4-4ba4-bb30-20542b5d6a8d
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2deea6ca-af47-421d-9e76-018adef5c192
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.discharge_reason_reference_no=dim_discharge_reason.discharge_reason_reference_no
        name: DIM_DISCHARGE_REASON_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0f5c699-59a4-4dca-97d3-e0eb165f28f5
                stepCounter: 9bacfc57-3a94-40a0-99e8-44500f0ad467
            transform: IFNULL(dim_discharge_reason.dim_discharge_reason_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0abeb084-3da9-46e8-bc78-9f8e3225d6ba
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2efe374e-9495-476e-ae38-698e1575985f
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 742f3ece-de1e-434d-a0a7-ed51a37b3c7f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.alcohol_answer=dim_ED_alcohol_assessment.alcohol_assessment_desc
        name: DIM_ED_ALCOHOL_ASSESSMENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63529c6b-abe1-44ed-bc28-d04e9d287283
                stepCounter: dd5930ef-11b4-44df-a117-82fc46c38272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6af08ed8-ed1c-414c-b922-762a4f65fa65
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f2b257d-16bd-4a3f-a396-9cc0ef950674
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 736e4528-40a5-437a-8748-65c24017ca05
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ALCOHOL_ANSWER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 353c32ef-9640-447f-b8f1-f4b332bbfb08
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b629cd3d-8223-4f1e-a381-89a92de7f05b
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_attendance_20.event_end_type <> s_ed_attendance_20.event_end_type_final AND s_ed_attendance_20.event_end_type_final='ER' THEN 1
                          WHEN dim_purchase_unit.unit_of_measure ='bed days'                                                                                 THEN DATEDIFF(DAY, arrived_date,departed_date)
                          WHEN s_ed_attendance_20.arrived_date >= getdate()                                                                                  THEN 0
                          WHEN s_ed_attendance_20.patient_not_waited_flag ='Y' AND arrived_date >= '1 Jul 2025'                                              THEN 0
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd527b57-7fab-4d3a-93ea-7d3db37b3097
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Referral date and time.
        name: REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77afccfa-6f14-4017-bf20-67a486670045
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51c1324d-9510-472d-a516-19850607e06c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: "'R' + Referral ref no."
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8067adac-dba4-4557-b96a-d9c90653521a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: "'R' + CONVERT(varchar,s_ed_attendance_20.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbdad11a-f974-4ae5-b70c-acce367e6499
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_destination_reference_no
        name: DISCHARGE_DESTINATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f22e88c0-64a1-4cf4-9311-521f744b74a2
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.discharge_destination_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f62079af-6e8c-4b2d-aa96-b146b859249f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: referral_reference_no
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8067adac-dba4-4557-b96a-d9c90653521a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eb179f9-4f2d-4928-801f-833d81f27697
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: previous_to current_attendance_duration
        name: REPRESENTATION_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d4f4655-f0a3-448e-81d4-f0b4e5c761a7
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db0a34ff-60f1-4a5a-bcfc-3ce5f20e5fe4
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: discharge_destination_code
        name: DISCHARGE_DESTINATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ee981bb-b931-4909-8622-cae4bd0b6b5c
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e6d3d2a-5d25-468b-816f-649d89978b22
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether this is a return visit within 48 hrs
        name: RETURN_WITHIN_48_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58ebe4e6-7a88-42f2-ac39-6186180aa900
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 819cfdc9-e6bd-4c19-a7a6-c062be89b542
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: SECOND_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d449b061-438c-41ef-887e-96609395b3e4
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e9152cc-3fe0-4347-8aa1-e6335be06875
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.treatmentprotocolid=dim_ED_treatment_protocol.treatment_protocol_no
        name: DIM_ED_TREATMENT_PROTOCOL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbd13b77-1d33-4021-91de-c191ad877dbc
                stepCounter: bca3ad6c-7baa-4f42-8e2f-7ab945c58863
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0208a4f-f363-47fc-a8e5-28d391405b08
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether patient self-discharged.
        name: SELF_DISCHARGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 133cdef3-4e7e-423a-81eb-a86a4b6ee8e2
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f414145f-c9f5-45dc-990a-5ba535bc8e03
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: stop_clock_location_flag
        name: SIX_HR_CLOCK_STOP_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c701eaa-ed86-4ba8-a125-3bf51c4f392a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.stop_clock_location_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95779ec4-1853-451f-b5ff-af3765495c16
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.discharge_destination_reference_no=dim_discharge_destination.discharge_destination_reference_no
        name: DIM_DISCHARGE_DESTINATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50139081-3c61-470c-a651-adf046a5ce35
                stepCounter: a05a4266-44b7-4574-abee-00c3094cf764
            transform: IFNULL(dim_discharge_destination.dim_discharge_destination_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 148ea62e-26f3-4e5f-933d-877fef6400e6
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time used to check 6 hour limit
        name: SIX_HR_CLOCK_STOP_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 671d75ae-911d-4ef9-8009-4a148fd1605c
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5e75fd1-16de-41a7-86a2-7d7bf5ecb25c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the first specialty transfer was performed
        name: SPECIALTY_TRANSFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5da89d39-9efc-4760-b58b-58b52205436b
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ca06187-7efb-4186-9885-e085dcecfffd
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating whether patient was discharged within 6 hours
        name: SSED_COMPLIANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f5960c-c9ff-4cb1-9dd9-c403317fc5ba
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN ED_6hr_report_eligibility_flag = 'Y' AND LOS_duration <= 360 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2123dd4-377e-498e-8a5e-7aad0a8b5890
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: EMMED end date and time.
        name: EM_REFERRAL_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 376f8395-78d7-442a-b7d6-29b839335e78
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fea00fe2-2a81-4792-b34c-3c9a123624c1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating whether encounter is eligible for 6hr reporting.
        name: SSED_ELIGIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f5960c-c9ff-4cb1-9dd9-c403317fc5ba
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 075f5a1b-5b1a-4682-9de7-462b2d1fed07
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Total LOS of Attendance in minutes
        name: SSED_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f8f85a2-b259-46e2-8fba-d80d279dae8a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.LOS_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62aabc3e-56e4-4086-bdbd-f34dc4d12518
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: EM final clinician seen, clinician at EM referral time
        name: EM_REFERRAL_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62bfeaba-5961-4dff-a0a5-d5ed4b29d23b
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aa7a5df-3a30-4929-aa1e-1137aaab70f9
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61953f30-ec4d-4d0d-83a4-2a1432a6acea
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7230054-439d-4e54-a45f-e07299d45d64
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_FINAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6327516-671e-4c6e-aeb2-e5b5465a228f
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecfaed65-f63b-464b-ba83-d3f1c72b24ab
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.EM_referral_clinician=dim_EM_referral_clinician.user_name
        name: DIM_EM_REFERRAL_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b59d50b-2be2-4192-aeb6-799e6e095b5f
                stepCounter: 077f2d01-ab49-4352-ae92-2e5ffaa09315
            transform: IFNULL(dim_EM_referral_clinician.dim_EM_referral_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61553eac-2d60-4be7-8c1f-458730e5b304
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: symptom_reference_no
        name: SYMPTOM_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b8b6cae-f278-4dec-923b-720fc8c506b2
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.symptom_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89fce256-b773-4f62-a7a2-efe677e71d04
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: THIRD_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b90da679-adf6-47d9-9509-d9021ac8b334
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19c30011-60b0-4975-a913-d0228707c9f4
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_INITIATION_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66164e55-eaad-4f24-bc13-4666d701b657
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a238b9-4a48-4a3b-bf82-2439291f175a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08146ff0-1ba5-45fe-9ae5-2b8c9bce1d5f
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 055ffc78-4132-4aef-8221-ab8b8b3ec291
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: treatmentprotocolid
        name: TREATMENTPROTOCOLID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd95aeb3-0c3c-49d5-8521-0542990e344a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26a30126-050b-47cd-b0aa-1a5b9962a251
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.IP_admission_ward_reference_no=dim_admission_ward.admission_ward_reference_no
        name: DIM_ADMISSION_WARD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6de0d799-570f-44e1-ab72-e01157ee4c80
                stepCounter: 0b4f315f-51cb-4593-8623-b32f3fc664aa
            transform: IFNULL(dim_admission_ward.dim_admission_ward_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7d87e92-98f1-484c-9a52-4c2453192464
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Triage Category Reference No
        name: TRIAGE_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bcd3c2b-b972-4158-b4c1-b18c418121eb
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe342eae-c4bb-49de-8c42-233e8f7f166b
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.IP_healthcare_professional_reference_no=dim_admission_clinician.admission_clinician_reference_no
        name: DIM_ADMISSION_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34bd1187-6d8f-4c2b-9eb2-a0cce6f50aae
                stepCounter: 90b9aba6-49fc-4ba5-8f65-83c15df32c79
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2768c5aa-4311-4eb1-a9ff-84e59f496589
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: triage_healthcare_professional_code
        name: TRIAGE_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa38847b-bd61-4daa-bb51-d3da449cd85c
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6a065a3-d5d5-4e14-8b82-019d740e88a5
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: triage_healthcare_professional_reference_no
        name: TRIAGE_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a5af8da-3618-4556-80c2-7d02522a5c3f
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.triag_proca_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3929343-efdb-4710-9e52-1d1f403f8620
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: TRIAGE_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f820ad29-ba83-4f61-9d36-3d98988b2a63
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d811941-89f3-402e-8649-d0f3e85e7ca0
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_attendance_30.IP_specialty_reference_no=dim_admission_specialty.admission_specialty_reference_no
        name: DIM_ADMISSION_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7032326d-f344-413c-aab1-3525299c9ceb
                stepCounter: 653bb678-9e6b-4b04-9b51-5cbba170a526
            transform: IFNULL(dim_admission_specialty.dim_admission_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0de17d6-d004-46a1-b574-576846050100
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y/N flag indicating whether the ED patient is currently not discharged, i.e. still in emergency care.
        name: DISCHARGE_FROM_ED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 180083e8-499d-4bfa-92bb-05a883f86cff
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN dim_discharge_location.acute_diagnosis_unit_location_flag='Y' THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb9dfc0d-1021-4ffb-a6b9-40295312a02c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Triage end date and time.
        name: TRIAGE_STOP_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72a15050-9901-49f7-a247-883906171732
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 376f2a1a-e0b4-4df7-8fcf-98ccceb458ab
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: triage_target_compliance_flag
        name: TRIAGE_TARGET_COMPLIANCE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN dim_ED_triage_category.triage_to_seen_maximum_duration IS NULL THEN NULL
                          ELSE CASE WHEN CASE WHEN s_ed_attendance_20.triage_duration < s_ed_attendance_20.treatment_protocol_period THEN s_ed_attendance_20.triage_duration ELSE s_ed_attendance_20.treatment_protocol_period END <= CONVERT(integer, dim_ED_triage_category.triage_to_seen_maximum_duration) THEN 'Y' ELSE 'N' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03bc9159-d9c5-48f2-85c4-9da249a12664
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating whether first stay specialty was EMMED
        name: EM_PRESENTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e1dc62b-5da1-4da3-a969-d09492e535d6
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aea3b97-c582-40f2-908e-e295eafd8c7a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Triage start date and time..
        name: TRIAGE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27dd613b-7887-4a47-ab9d-67f7eaa45cd8
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fb608ab-3b0c-4354-9641-ab296a7bdc3e
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between first seen date and end of stay in EMMED.
        name: TTD_EM_CLINICIAN_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a74c9e4-dcd3-4fc8-a540-c4375bdc692c
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.emmed_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd4a55c4-fccb-4110-ae93-2298b8d4568e
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration between IP seen date and disposition decision.
        name: TTD_IP_CLINICIAN_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3c8052f-ab6d-4c6b-bd42-c4f1d962cd05
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.IP_seen_decn_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9653afd-5fa7-4bc4-8e55-f7481c5421a1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: TTDEM_COMPLIANCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a74c9e4-dcd3-4fc8-a540-c4375bdc692c
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN s_ed_attendance_20.EMMED_duration < 180 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5cf760b-fd76-429e-abcc-5f1377fb9c4d
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_RESPONSIBILITY_CENTRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9a966f-0750-4c8b-a92a-a034376ca161
                stepCounter: a84cf165-8cc6-4510-8bae-53366e2d4ff7
            transform: IFNULL(dim_responsibility_centre_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41bc08dd-ccb2-4c90-a88c-4602c3bb4f63
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: TTDIP_COMPLIANCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3c8052f-ab6d-4c6b-bd42-c4f1d962cd05
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN s_ed_attendance_20.IP_seen_decn_duration < 120 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 393b3e55-546f-414b-8800-03df7185472e
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether first stay is in ADU.
        name: ADUDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f3123b-ab9d-42f4-ae05-ef711fcf3cab
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.first_stay_ADU_location_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa32911f-8bfa-4ce6-b0b0-b3043c93788d
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating whether the ED patient was admitted to an IP ward.
        name: WARD_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0ce36c4-b2d3-4b6e-b816-b1befdf0070b
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01734101-0c8a-47c5-8d23-e13df73c49fe
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether any stay is in ADU.
        name: ADUSTAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f3123b-ab9d-42f4-ae05-ef711fcf3cab
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN s_ed_attendance_20.first_ADU_aesty_refno IS NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bf9606b-7c7d-4ec2-86cc-fea3f1ff67f7
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: 'First date time within ADU '
        name: ADU_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1da4e6e1-4f5c-4333-92df-f1e399dedfe5
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c78305c5-3446-41db-9f94-8a2a00f6c1e3
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between triage start date and first seen date.
        name: WTBS_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9173a35a-a6a2-4be6-80b2-ec79bb2fff09
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.triage_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e022718f-bc60-4717-a540-d45bb7388b21
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c9ff703-4121-4fb0-a2fc-bc1783890a9f
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.first_seen_spect_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24957a8b-a655-4307-a37b-58439414d24c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INT
        defaultValue: ""
        description: Time in emergency department
        name: DWELL_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN datediff(MINUTE,first_seen_date, CASE WHEN specialty_transfer_date <= IFNULL(observation_admit_date,@v_dss_update_time) AND specialty_transfer_date <=IFNULL(medical_discharge_date,@v_dss_update_time) THEN specialty_transfer_date WHEN observation_admit_date <= IFNULL(specialty_transfer_date,@v_dss_update_time) AND observation_admit_date <=IFNULL(medical_discharge_date,@v_dss_update_time) THEN observation_admit_date WHEN medical_discharge_date <= IFNULL(specialty_transfer_date,@v_dss_update_time) AND medical_discharge_date <=IFNULL(observation_admit_date,@v_dss_update_time) THEN medical_discharge_date ELSE NULL END) <0 THEN 0
                          ELSE datediff(MINUTE,first_seen_date, CASE WHEN specialty_transfer_date <= IFNULL(observation_admit_date,@v_dss_update_time) AND specialty_transfer_date <=IFNULL(medical_discharge_date,@v_dss_update_time) THEN specialty_transfer_date WHEN observation_admit_date <= IFNULL(specialty_transfer_date,@v_dss_update_time) AND observation_admit_date <=IFNULL(medical_discharge_date,@v_dss_update_time) THEN observation_admit_date WHEN medical_discharge_date <= IFNULL(specialty_transfer_date,@v_dss_update_time) AND medical_discharge_date <=IFNULL(observation_admit_date,@v_dss_update_time) THEN medical_discharge_date ELSE NULL END)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8bcdc30-7f93-461e-91d5-c5f82a7222f9
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: patient_first_attendance_flag
        name: FIRST_ED_ATTENDANCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_attendance_20.patient_visit_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45264192-10c9-419a-9231-c7b607a6155a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating patient viist was planned return, as against unplanned return
        name: ED_PLANNED_RETURN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a182e1c-9031-4dfe-b313-3c3cda6a1ed5
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c33a938-e4cb-4a5a-9041-c3bf7815a330
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a090f736-8cb5-495b-be7a-c10313b7a2a9
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: duration between visit date and triage start date.
        name: CLERKINGPERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17a35300-a126-401b-9a8f-3a785be8455d
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.triage_start_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a99f297-7da0-43b2-b053-12a8446f7975
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Minutes between disposition decision and actual disposition.
        name: BED_BOOKING_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce80a84c-b42a-4551-b1bd-abf3d50c0d4a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: IFNULL(s_ed_attendance_20.decn_disp_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d88af800-7e01-422e-8567-b004aa9af060
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Total LOS of Attendance in dd:hh:mm format
        name: ED_ADU_PERIOD_DDHHMM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f75589b1-bb3c-4470-8838-7b856c7eef59
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              --convert (varchar(100),(attendance_duration/60)/24) + ':' +
               --  case when len(convert (varchar(100),(attendance_duration/60)%24)) =1 then '0' +
              --  convert (varchar(100),(attendance_duration/60)%24)
              --  when len(convert (varchar(100),(attendance_duration/60)%24)) =0 then '00'
              --   else convert (varchar(100),(attendance_duration/60)%24) end
              --  + ':' + case when len(convert (varchar(100),(attendance_duration%60))) =1 then '0' +
              --  convert (varchar(100),(attendance_duration%60))
              --  when len(convert (varchar(100),(attendance_duration%60))) =0 then '00'
              --   else convert (varchar(100),(attendance_duration%60)) end
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a29bd26-ef1c-48ab-b9d4-b978f47eb6cd
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: attendance_elapsed_duration
        name: ED_ADU_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aae09635-5377-44a7-8637-c508b711edff
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54024f3a-3241-41c6-a5a0-0a90a03812f3
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance counter always set to 1.
        name: ATTENDANCE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fed486e-c917-4957-ac8d-f6eff06b3466
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: 'Actual cost of the event  '
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03b4085f-4ce4-45c2-bfe7-f17da269bccb
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 906fbfac-1612-4b56-a242-e9272a987ae1
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Budget cost of the event
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d0b2ce0-20f4-4810-a77f-924f2e20f3eb
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a79aa0b3-e071-4ce6-af62-1b7b430edddc
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: BED_BOOKING_COMPLIANCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce80a84c-b42a-4551-b1bd-abf3d50c0d4a
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: |-
              CASE WHEN s_ed_Attendance_20.decn_disp_duration < 60 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 197941ce-c9fa-4828-98e6-81cde89bdf43
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.create_user_login=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b27e5010-e4d9-4259-8dbe-d218cd726d16
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c0303d5-0a49-4ca8-aad8-06005c896b5d
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83b3547c-2d82-4003-87a9-9326e5d1fb8f
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53ab2b10-bc58-4a88-9135-b3eac7ba2b7e
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9eb8c954-2b66-4dac-bd45-22c6ed785f3a
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.modify_user_login=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef97cad1-2946-4ec3-b4cf-9bc645353948
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.first_seen_location_reference_no=dim_seen_by_location.seen_by_location_reference_no
        name: DIM_SEEN_BY_LOCATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 760de31c-df83-4e77-8576-78b615c9c91d
                stepCounter: 523615eb-7a54-4c8b-aa53-faa738bb4374
            transform: IFNULL(dim_seen_by_location.dim_seen_by_location_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3ca62a6-0eea-43d1-aedd-28095917f85b
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e38241a2-5c40-4e91-9aea-83f0b97c25e3
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efd33484-a679-4315-b0e5-2a8fdcfa5c4c
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Contains Null fields where no diagnosis exists
        name: CLD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0e8ad63-c919-4348-b9ec-9d3ed4c9c7b9
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1301eea1-6a2e-4b80-a7a5-5eee97bcffdd
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CLD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 893063db-5819-4312-a6a2-7baf1fa160d7
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7ec0004-c3e1-4dca-b11c-9bc101c090a5
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Contains Null fields where no diagnosis exists
        name: EDS_TEXT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 676d2819-7e70-4eb3-a19f-bcd5ea4fa589
                stepCounter: 67ed942c-e015-4c6e-abcc-46d4a5aa19e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2260be1f-fbd4-4135-8286-97333ca3c374
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.presenting_complaint_code=dim_ED_presenting_complaint.presenting_complaint_code
        name: DIM_ED_PRESENTING_COMPLAINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b817c18c-dec1-47bd-8c55-8f48b2f64720
                stepCounter: 910ce259-56ea-4404-974a-34e5bfaa318d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a1b0585-f368-4e24-87f6-07356b358402
          stepCounter: f75d42c1-f96f-4a6b-9305-d95054099ec2
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_RESPONSIBILITY_CENTRE: a84cf165-8cc6-4510-8bae-53366e2d4ff7
          DIM_PURCHASE_UNIT: d198650d-0f77-489d-92ec-0c0257cd5a43
          DIM_HOSPITAL: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
          S_ED_INJURY_FLAG: 80735e6c-8a12-41ae-8034-6cf7e83a9a5f
          S_ED_WB_MANY_EM_SEEN_BYS_V: b2d5f1b6-4e48-4de5-acd2-2a385cf804fa
          DIM_EM_REFERRAL_CLINICIAN: 077f2d01-ab49-4352-ae92-2e5ffaa09315
          S_ED_ATTENDANCE_LOCATION_PATH_V: 54b2f02a-b840-43e5-a510-821a8264294d
          S_ED_ATTENDANCE_SPECIALTY_PATH_V: 4b25cdd5-d4bc-4358-92cd-4acdcf32f05a
          DIM_PRINCIPAL_DIAGNOSIS: 6a64703e-9924-4948-986a-0578fe6b91b7
          DIM_ED_ALCOHOL_ASSESSMENT: dd5930ef-11b4-44df-a117-82fc46c38272
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ED_ATTENDANCE_20
          - locationName: TGT
            nodeName: DIM_RESPONSIBILITY_CENTRE
          - locationName: TGT
            nodeName: DIM_PURCHASE_UNIT
          - locationName: TGT
            nodeName: DIM_HOSPITAL
          - locationName: TGT
            nodeName: S_ED_INJURY_FLAG
          - locationName: TGT
            nodeName: S_ED_WB_MANY_EM_SEEN_BYS_V
          - locationName: TGT
            nodeName: DIM_EM_REFERRAL_CLINICIAN
          - locationName: TGT
            nodeName: S_ED_ATTENDANCE_LOCATION_PATH_V
          - locationName: TGT
            nodeName: S_ED_ATTENDANCE_SPECIALTY_PATH_V
          - locationName: TGT
            nodeName: DIM_PRINCIPAL_DIAGNOSIS
          - locationName: TGT
            nodeName: DIM_ED_ALCOHOL_ASSESSMENT
        join:
          joinCondition: |-
            FROM s_ed_attendance_20
              LEFT OUTER JOIN {{ ref('TGT','DIM_RESPONSIBILITY_CENTRE') }}
                ON replace(s_ed_attendance_20.responsibility_centre_code,'-','') = dim_responsibility_centre.responsibility_centre_code
               AND s_ed_attendance_20.arrived_date BETWEEN dim_responsibility_centre.dss_start_date AND IFNULL(dim_responsibility_centre.dss_end_date,dim_responsibility_centre.dss_update_time)
              LEFT OUTER JOIN {{ ref('TGT','DIM_PURCHASE_UNIT') }}
                ON s_ed_attendance_20.purchase_unit_code = dim_purchase_unit.purchase_unit_code
               AND s_ed_attendance_20.arrived_date BETWEEN [dim_purchase_unit].validity_start_date AND [dim_purchase_unit].validity_end_date
              LEFT JOIN {{ ref('TGT','DIM_HOSPITAL') }}
                ON s_ed_attendance_20.hospital_id = dim_hospital.hospital_id
              LEFT OUTER JOIN {{ ref('TGT','S_ED_INJURY_FLAG') }}
                ON s_ed_attendance_20.aeatt_refno = s_ed_injury_flag.ed_attendance_reference_no
              LEFT OUTER JOIN {{ ref('TGT','S_ED_WB_MANY_EM_SEEN_BYS_V') }}
                ON s_ed_attendance_20.encounter = s_ed_wb_many_EM_Seen_bys_v.attendance_encounter_id
              LEFT OUTER JOIN {{ ref('TGT','DIM_EM_REFERRAL_CLINICIAN') }}
                ON s_ed_attendance_20.EM_referral_clinician = dim_EM_referral_clinician.user_name
               AND s_ed_attendance_20.arrived_date BETWEEN dim_EM_referral_clinician.validity_start_date AND dim_EM_referral_clinician.validity_end_date
               AND dim_EM_referral_clinician.source_namespace = 'Legacy'
              LEFT OUTER JOIN {{ ref('TGT','S_ED_ATTENDANCE_LOCATION_PATH_V') }}
                ON s_ed_attendance_20.aeatt_refno = s_ed_attendance_location_path_v.aeatt_refno
              LEFT OUTER JOIN {{ ref('TGT','S_ED_ATTENDANCE_SPECIALTY_PATH_V') }}
                ON s_ed_attendance_20.aeatt_refno = s_ed_attendance_specialty_path_v.aeatt_refno
              LEFT OUTER JOIN {{ ref('TGT','DIM_PRINCIPAL_DIAGNOSIS') }}
                ON s_ed_attendance_20.diagnosis_procedure_reference_no = dim_principal_diagnosis.principal_diagnosis_reference_no
               AND IFNULL(dim_principal_diagnosis.dss_start_date, GETDATE()-10000) <= s_ed_attendance_20.arrived_date
               AND IFNULL(dim_principal_diagnosis.dss_end_date, GETDATE()+10000) >= s_ed_attendance_20.arrived_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_ED_ALCOHOL_ASSESSMENT') }}
                ON dim_ED_alcohol_assessment.alcohol_assessment_code = s_ed_attendance_20.alcohol_answer
             WHERE 1=1
            OPTION (maxdop 1)
        name: S_ED_ATTENDANCE_30
        noLinkRefs: []
  name: S_ED_ATTENDANCE_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
