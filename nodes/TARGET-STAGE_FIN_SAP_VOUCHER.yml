fileVersion: 1
id: 7a6d7017-466b-4f13-b616-6b44de52d53d
name: STAGE_FIN_SAP_VOUCHER
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98c9b28e-b5b1-4eff-90e3-7f3a855f5447
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(28)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: VOUCHER_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc871783-9afd-4af5-8882-c179ca221817
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ODS_SAP_ACDOCA.RLDNR|| ODS_SAP_ACDOCA.RBUKRS|| TO_CHAR(ODS_SAP_ACDOCA.GJAHR)|| ODS_SAP_ACDOCA.BELNR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 227efe5d-2b0c-479d-8813-8be28172f690
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The organization owning the voucher.
        name: VCHR_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32cb7c18-5b8e-4f5e-9af7-b6de766ee127
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3340d7b9-19c7-4bff-beb2-dad369cd575b
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: organization for which the Voucher was created
        name: VCHR_ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c88df64-0b02-454e-98bb-f429ee21f644
                stepCounter: 380b20ff-1088-454d-94c3-b7fc7688cca8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc520c6e-eb8c-4031-bbd6-8f4b29cc18e2
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The user"s voucher number.
        name: VCHR_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc871783-9afd-4af5-8882-c179ca221817
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0446a6f-91ad-4a9c-89bc-8be615f228af
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Indicates voucher type.
        name: VCHR_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 931e4e48-a467-481f-81de-30b229d7a88f
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94aa3b79-3d56-42a3-a412-4ffe5f168b1d
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The accounting period (end date) when the voucher is entered.  This date is usually expressed as the last day of the month.
        name: VCHR_ACCT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd6c5511-5449-4c86-83bf-2852a5569aa8
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: LAST_DAY(ODS_SAP_ACDOCA.BUDAT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ee5e2c0-c0ca-4998-acfa-f4640917d5b2
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: 'The source currency for line items on the voucher.  Used for all foreign currency methods. For method #3, this is the currency of the amount in reporting curr amt.'
        name: VCHR_CURR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be0d481a-b82a-4bf9-af66-64968f32525d
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 703f917a-fce7-42bd-8842-86e6293fe419
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Originating group or department.
        name: VCHR_SRC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff9393d5-e001-4f01-9185-e88a54f3a1c9
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: The voucher status (posted, unposted, deferred, archived).
        name: VCHR_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d696023-b007-4095-b7a2-1b7212ec6359
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Voucher description.
        name: VCHR_REMARK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 387c1efa-1d08-4fe7-b08e-eda2dfd876c5
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb9d989d-05be-4475-8ecb-27ff2d220cb8
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date the voucher was created.
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04a32e4c-e827-49e5-81af-19f2892afb61
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c728b494-1d5d-4a30-96b1-fa9dab793dc2
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Name or user ID of the person entering the voucher.
        name: CREATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2fbbb24-e173-4e2d-980a-8853387b419f
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 158efb9b-8995-4258-8533-892ff695c318
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date voucher line items are posted to the general ledger.
        name: GL_POSTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ab4098b-ce56-48d6-a1f9-66623603d141
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e0e9fe0-19db-4188-8eab-44c970428b26
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: The user id that posted a voucher.
        name: GL_POST_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77e59bcc-31fb-48c3-a016-595ec1383735
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b46b47f-ad43-46ae-8fbb-f0077fa2ee99
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEST_ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2be6c575-3d38-4adf-b5de-b4a936c1c166
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: The voucher status (posted, unposted, deferred, archived).
        name: PWV_LINK
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ODS_SAP_BKPF.BLART = 'OI' THEN '{{ parameters.SAP_INVOICE_URL _PREFIX_OI }}'||ODS_SAP_BKPF.XBLNR
                          ELSE '{{ parameters.SAP_INVOICE_URL _PREFIX_FIORI }}'||ODS_SAP_BKPF.BELNR|| '&CompanyCode='||ODS_SAP_BKPF.BUKRS|| '&FiscalPeriod='||ODS_SAP_BKPF.MONAT|| '&FiscalYear='||ODS_SAP_BKPF.GJAHR|| '&/detail/'||ODS_SAP_BKPF.BUKRS||'/'||ODS_SAP_BKPF.GJAHR||'/'||ODS_SAP_BKPF.BELNR
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40ea6a4f-d22c-4763-b5b6-746f13fb1a86
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CODERS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60b7587f-3721-4a8c-b80b-ceb9ac7db343
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: APPROVERS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1acd02f-35f4-4cc6-b49e-15132f7d81c3
          stepCounter: 7a6d7017-466b-4f13-b616-6b44de52d53d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: TRANSLATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f33bf556-277d-4f8f-b0b6-1f10ec656d65
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_ACDOCA: 0f008214-d701-47dc-8dec-ed7f400b3d52
          ODS_SAP_BKPF: fcf862a8-1642-409e-b4fd-c9257fbc2f70
          ODS_SAP_T001: 380b20ff-1088-454d-94c3-b7fc7688cca8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_ACDOCA
          - locationName: TARGET
            nodeName: ODS_SAP_BKPF
          - locationName: TARGET
            nodeName: ODS_SAP_T001
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_ACDOCA
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BKPF') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BKPF
                ON ODS_SAP_ACDOCA.BELNR = ODS_SAP_BKPF.BELNR
               AND ODS_SAP_ACDOCA.GJAHR = ODS_SAP_BKPF.GJAHR
               AND ODS_SAP_ACDOCA.RBUKRS = ODS_SAP_BKPF.BUKRS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T001') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T001
                ON ODS_SAP_ACDOCA.RBUKRS = ODS_SAP_T001.BUKRS
        name: STAGE_FIN_SAP_VOUCHER
        noLinkRefs: []
  name: STAGE_FIN_SAP_VOUCHER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
