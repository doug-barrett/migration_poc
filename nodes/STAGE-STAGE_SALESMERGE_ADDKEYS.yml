fileVersion: 1
id: 8ab99844-5417-4453-8a79-1ff9619ee91a
name: STAGE_SALESMERGE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56ab7094-2afb-4e4d-998b-151bd55b2e88
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 033cab82-ab65-434b-8c9e-9c195f009c69
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30d0efdb-8aea-435f-8604-7d4e117772c8
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.ORGANIZATIONID=ORGANIZATION.ORGANIZATIONID
        name: ORGANIZATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ef9c655-6960-42ce-affa-f42417c7cadc
                stepCounter: 062cb303-87f5-44ce-baff-589e059efcf8
            transform: COALESCE(ORGANIZATION.ORGANIZATIONKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fb50b01-dc56-47a7-82a0-21a05b0b2956
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fb5332d-dc80-4275-82d8-f23183e9b2d6
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c114dfe8-006b-4e8e-9e3c-835e444358ad
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9809deca-da5b-4fe0-a80a-ab6cafa8782e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: COALESCE(ACCOUNT.ACCOUNTKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f1ce28e-f05f-4bb1-9ea0-5fc212f8335b
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39e7aa11-a768-4188-8624-a12de61cda39
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: COALESCE(ACCOUNTGEOGRAPHY.ACCOUNTGEOGRAPHYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a371e6db-643a-4469-8ce7-0f0b29a629af
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTHIERARCHY_OMNIA.FORCEID
        name: ACCOUNTHIERARCHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d13403bd-df9d-4938-9676-ba19d00849e9
                stepCounter: 4d228627-be75-4864-bf90-d4097201926a
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.ACCOUNTHIERARCHYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61180641-1a28-4f42-b203-fbf3438dab4b
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe16325a-fb79-4ba3-b104-c9575d322311
                stepCounter: cc972abd-f7f0-44e0-8442-97087a448d7d
            transform: COALESCE(REVENUEBUDGETFORCEIDDETAIL.REVENUEBUDGETFORCEIDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac43dffb-24ed-4684-8f33-6dad19423171
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDIRECTDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDIRECTDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDIRECTDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2c0f30d-a410-458d-98d9-0b350721738f
                stepCounter: 97d1a8d4-1ab0-4395-a8a4-fb7f9bd7a15e
            transform: COALESCE(REVENUEBUDGETFORCEIDDIRECTDETAIL.REVENUEBUDGETFORCEIDDIRECTDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92b8e3da-d3b0-4683-b109-f071f23978c6
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.CONTRACTID=REVENUEBUDGETPDDETAIL.CONTRACTID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETPDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETPDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17e9f4be-2c7a-4e55-b0d8-d72fcb7ed1e7
                stepCounter: ae234259-4f14-4a64-b243-f42d7e0382ad
            transform: COALESCE(REVENUEBUDGETPDDETAIL.REVENUEBUDGETPDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0204928f-5883-4c87-af54-a463a54f0e24
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d0a6ecc-dca7-4174-a034-445d2070db15
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62490dcc-9884-455d-b3b5-34d22b00fa99
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d338f07-8fd5-49d1-b849-eaecdaa18a8e
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2add500f-510f-4ea6-9524-6be0fb0c9c19
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 603e244a-7880-4b41-9a73-dcd41408f611
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ced0052-5ff6-4f2a-b5bd-78210018f271
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f387fd0-9142-46c0-a8c9-406593d68510
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87c24106-b205-4daa-92aa-d9a58ef97b42
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b5937f-ec7f-4ece-b632-382690940d51
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09453d5f-4662-457e-ae7b-fc53d16383fb
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6387ef42-2368-44e9-8906-3d58877bbfcf
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 797e32b5-0c54-4cbb-960b-a95c88160273
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525dab0b-f43c-4fb8-a396-0ff001a9a05b
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35090f04-2035-4a11-b127-a75d647a4454
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df373f39-ce34-4998-be9a-254483061574
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d6cacef-e547-4544-8052-d3e04b6021a8
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 572d93a1-d1d1-40b8-b5d0-82eafa0456f5
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea3ea08d-2688-4831-a3aa-97102923ce20
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f4e397-bd41-483f-976a-9ed99246bd6e
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 952fb579-7c1d-4ea3-924c-faee8f45f244
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOURCEENTITYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34fa6a04-f1b5-4f31-b01d-acf427ab53d2
                stepCounter: a550c43a-4d5a-4a69-aa48-4cefa3de4b21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc72b074-e206-4475-a705-9c9319911d1e
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.CONTRACTID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd104e19-ca47-41af-94d4-cca1548f548e
                stepCounter: a550c43a-4d5a-4a69-aa48-4cefa3de4b21
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf9d63bc-0a00-4c58-a793-fd62dd11928d
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: REVENUE TYPE (MOSTLY USED AS INPUT TO PREPARE NEXT YEAR'S BUDGET)
        name: REVENUETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE--UC
              \N --WHEN BUYER=UC AND PPA=UC, THEN "SOLICITATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SOLICITATION' \N --WHEN BUYER=UC AND PPA<>UC, THEN "ADOPTION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) NOT IN(4055673) \N THEN 'UC ADOPTION' \N --WHEN BUYER<>UC AND PPA=UC, THEN "SYNDICATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID NOT IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SYNDICATION' \N --
              \N ELSE \N CASE \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PUBLIC%'  THEN 'ISO PUBLIC' \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PRIVATE%' THEN 'ISO PRIVATE' \N
                          ELSE SALESTERRITORY.TERRITORYDIVISIONNAME \N
                           END \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edc545df-d4c0-4d42-8c00-3db802af189d
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4752525a-6a39-4285-96c2-deef1436742a
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae4e92d1-de54-4c9d-a622-1ddecad87560
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.RECEIPTDATE=DIMRECEIPTDATE.RECEIPTDATE
        name: RECEIPTDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 488d4346-9b54-4968-89cb-9e9b8d7ac4c1
                stepCounter: 27a7ecfd-1ae2-435c-89b6-cdcea595076c
            transform: COALESCE(DIMRECEIPTDATE.RECEIPTDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dd6db01-4046-43d5-9776-c6bdfb47802b
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b99878d0-8a9e-4e9e-af14-c0804be62833
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c38a9954-b54a-4f26-ba1a-04a8071d6aac
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: GENERATE RECEIPT DATE FOR NEW 2019 BUDGET COMPARISON
        name: RECEIPTDATEFORBUDGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0298eeb6-75c1-4db1-a4ff-50b2d69bb6f8
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7495b77-22b3-441f-a6de-ffef7b4956d4
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1492500-69f4-459a-b955-6b361cafce6b
                stepCounter: 3e31c3d9-a69e-4432-b045-bd91575d1cbf
            transform: COALESCE(DIMTRANSACTIONDATE.TRANSACTIONDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c3c9857-362f-47d6-9b07-83a23c2dde63
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68ee3fed-072e-4207-b162-1a1b57a7ba50
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c05be4b6-8088-438d-ac3e-5a7c785577ad
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: UNITSSOLD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e4b480b-1778-48cb-a9a3-a20e20458efc
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab92ee00-a738-4df9-bbb2-6cc7f06bb5a3
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: PRICEPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dddd3ec-2dc7-4f31-9ca7-673fd72f31dc
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a04d55d7-5d64-422c-96a8-857b9c1a6ba0
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6e3dbee-466c-4ae2-a984-46b6666158b1
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8fd7569-f25e-4424-b723-264641f53a30
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ec1d8d4-4a3f-42bc-abdd-5b674b69c838
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0fcc396-1f12-4120-a8e7-183f34cfdc25
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYID=SALESTERRITORY.TERRITORYID
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea8d2cc7-b4bd-4d7d-969e-105f8fdaaf97
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: COALESCE(SALESTERRITORY.SALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdeccdbc-3a92-4f34-af4f-bd065ea5b43f
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDFINANCIAL=FINANCIALSALESTERRITORY.FINANCIALTERRITORYID
        name: FINANCIALSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 402e805f-83df-4cc5-b743-1ca0248f9065
                stepCounter: c148126a-703d-450c-8357-ac3e6cf71acf
            transform: COALESCE(FINANCIALSALESTERRITORY.FINANCIALSALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc1eda8e-9cfc-40cb-877d-e630bd1f3a51
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDDIRECT=DIRECTSALESTERRITORY.TERRITORYID
        name: DIRECTSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7df738b9-fe4a-4aaf-a3f5-9774fecbf119
                stepCounter: 2a7c23ab-183b-4e17-ba74-85817581bc04
            transform: COALESCE(DIRECTSALESTERRITORY.DIRECTSALESTERRITORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 758d91a1-09d7-443c-b8ea-08fdea815aff
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac38d316-379e-4184-9729-1fa6e33fe493
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57811d94-ccd6-4b11-8352-6ec7ba87346a
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ORIGINAL FORCEID (ID) OF THE CUSTOMER TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdad00b5-bae7-4c26-9b82-1e61e6ed92d6
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c60d4e2-b7ef-4583-b2c1-9a9a2d5be375
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca9e9c49-12b8-4d20-bf47-6198105e1d70
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0a26060-5595-40fe-b7f8-5db46a0576c4
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f9dd084-be2e-4fd1-9a21-8888695156a7
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67283bf2-b4b0-4f78-9154-4d9e3622fe6b
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: VIZIENT SYSTEM IDENTIFIER
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b481269-f665-46e5-a178-9d757763e95c
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f14080e-19d1-4ce5-b107-b19ac2d68979
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTREBATEDETAILSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92db8279-78df-4cc6-bb61-de8909e4a760
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c043775-8fb9-456b-ae7b-ee426b7c28c8
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: TRANSACTIONCLASSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc3a393d-244a-41d8-9ce1-d56311674459
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d07139e2-ff9d-402b-a54a-c0bd63619c52
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONCLASSID=TRANSACTIONCLASS.TRANSACTIONCLASSID
        name: TRANSACTIONCLASSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd8e6c5a-54f9-4dde-9507-8dd9b9ea6556
                stepCounter: 427779c3-6025-4eab-a433-d06bdcf642ea
            transform: COALESCE(TRANSACTIONCLASS.TRANSACTIONCLASSKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab4848ee-ca95-48ad-b3aa-5395a4b54688
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_DATE('$MAXRECEIPTDATE')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdfeffeb-969a-4d25-84ee-731862705e4e
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b69081b8-7bd2-4994-9d9a-8849f5f36a09
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38dbcc13-42bb-4f9e-90b3-485e2209513f
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeefec5d-bfe6-45f1-9b86-d5d01b33ba93
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8f73e43-079c-47d3-963f-935cd2a955c2
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8be4f141-1b35-487b-9ec4-65183650dedd
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2a5c4ba-a05d-4007-a3e0-89d3396f7d35
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1927dd44-a998-429e-820b-40862695eb06
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f68fe22-8002-4b8a-b972-ef12723be493
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a504d30b-7f51-47b1-9c8e-8e4dcebb5c17
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f6da658-9c27-4f1c-887f-7ee1f79edeac
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b96b11f-287e-4a6a-ab95-d000cb8f6940
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e197f84c-c080-45d9-8e11-44449146f148
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62e71b51-6ae4-4d12-914d-5e9d1c2d5dba
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 930e1cf1-b6f1-4d8e-9387-e467fc5fdafd
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALESUNITOFMEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e25f859a-becf-4300-b63a-785b3822ffc8
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9e6c565-46f5-4f22-a5fa-bbb78de77e73
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: TRANSACTIONNOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 979aba5b-5ec3-43e7-866c-549423466a3f
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64ad373e-8f9d-4ee2-aa08-8cfe14869919
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68e2d23d-d47f-4f5b-855b-04bcee90c534
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e839e95b-a984-41b2-b854-33b3007dfee9
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHANGE THE SOURCE OF CHANNELPARTNERFEESHAREPARTNERID TO ACCOUNTHIERARCHY INSTEAD OF FROM SALESREPORTINGLINEITEMS(FORCESALES)
        name: CHANNELPARTNERFEESHAREPARTNERID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa1af4e2-0fee-45e3-9967-d85b0f0d4ba3
                stepCounter: 4d228627-be75-4864-bf90-d4097201926a
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.CHANNELPARTNERFEESHAREPARTNERID,STAGESALESMERGE_BIZXFORMS.CHANNELPARTNERFEESHAREPARTNERID,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c85c354-6488-4224-8a7c-0b0dc6df9a9b
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERLEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58ba848b-71cb-4268-99f0-15d86bb1e3a7
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58f6d826-4999-4ae8-99a8-b03771902d11
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTEXTERNALCATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 775dbbf7-8cc7-4874-8c7a-e2614ff97fc6
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3382578e-4e25-41d6-a582-0dc844eb2b83
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: CUSTOMERIDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4b92164-3b6b-456d-bc9c-9a5df661321f
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 116f0f01-b29f-41ba-84a6-f7b8cad80216
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CUSTOMERLEVEL1IDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd496d5a-87d5-40fd-9ba2-bb9af8b8dbba
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf1f9bb-a795-4091-b7da-62ef1adbeaff
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ALLIANCE_NAME_PREMIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c70ce9b5-67f4-4b3c-ac53-2fc811866659
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dbf56ec-4da1-41f5-a6ad-4bae5e9516c4
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edc7a1d6-646d-4e33-b3ed-bd72003cb5f2
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceffbb7a-ddae-48d5-a4ed-f2e5dac745c9
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ARTIFICIAL KEY FOR THE DSS SOURCE SYSTEM TABLE.
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 025f0bfd-efee-48b8-b9e4-7b6de55d0828
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: IFF(STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY IS NULL,3,STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a235e387-161e-4e79-8303-51abcf63b668
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5399e5dc-1059-4aab-96cc-d6b6c27cacc4
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe6955ba-f125-4df5-9b56-055d0f5e95af
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 885dc500-555a-407d-a161-80850a51ba83
                stepCounter: e4a8aff5-79f6-4be2-a65e-ea6e3385276e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ff2252f-434b-4772-a4ee-60fe9468ca50
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20895e72-e9ee-4403-93ec-d6b4c5f69a34
          stepCounter: 8ab99844-5417-4453-8a79-1ff9619ee91a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTRACT: a550c43a-4d5a-4a69-aa48-4cefa3de4b21
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: ACCOUNTHIERARCHY_OMNIA
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIM_RECEIPTDATE
          - locationName: DIM
            nodeName: DIM_TRANSACTIONDATE
          - locationName: DIM
            nodeName: DIRECTSALESTERRITORY
          - locationName: DIM
            nodeName: FINANCIALSALESTERRITORY
          - locationName: DIM
            nodeName: ORGANIZATION
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDIRECTDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETPDDETAIL
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: TRANSACTIONCLASS
          - locationName: STAGE
            nodeName: STAGE_SALESMERGE_BIZXFORMS
          - locationName: UNKNOWN
            nodeName: STAGESALESMERGE_BIZXFORMS
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','STAGESALESMERGE_BIZXFORMS') }} STAGESALESMERGE_BIZXFORMS
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGESALESMERGE_BIZXFORMS.CONTRACTID = CONTRACT.CONTRACTID
               AND STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY = CONTRACT.DSS_SOURCE_SYSTEM_KEY
        name: STAGESALESMERGE_ADDKEYS
        noLinkRefs: []
  name: STAGE_SALESMERGE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
