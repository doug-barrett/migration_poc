fileVersion: 1
id: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
name: STAGE_SALESMERGE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef4e0e9-9f9d-46e2-a404-afe107115253
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6413d2d-b7f9-4ddc-99a1-d7d905cee2c2
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fafafc1-4b61-4566-976a-38723519598b
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.ORGANIZATIONID=ORGANIZATION.ORGANIZATIONID
        name: ORGANIZATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ccdfaa-e7ee-405c-a0ab-08a8318dbe76
                stepCounter: 93a4965e-bf0a-4692-81df-394a6a64272b
            transform: COALESCE(ORGANIZATION.ORGANIZATIONKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8067bdcc-8b18-4b5f-9665-9e782d14ec1a
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ea0e162-04d0-4ac5-bbe9-3166e6618af2
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc5691fa-1641-42a2-b5e2-6e09e2dae5d3
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b17fba0-9db5-4ba8-9eeb-d24027f151eb
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: COALESCE(ACCOUNT.ACCOUNTKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5696955-603e-4257-abfc-c059fedbcea4
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4cc9946-bffa-41bf-b067-a43469328685
                stepCounter: f517f373-db5e-414e-82b2-6a9f5d644ee3
            transform: COALESCE(ACCOUNTGEOGRAPHY.ACCOUNTGEOGRAPHYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88900765-d79c-4075-80d8-f49b56bf02a5
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTHIERARCHY_OMNIA.FORCEID
        name: ACCOUNTHIERARCHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40d1125-19e2-4f8a-a25f-1bce5b181316
                stepCounter: 159d1a84-5962-4aac-b776-eb430234402a
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.ACCOUNTHIERARCHYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60414a90-cf20-4dc1-a2fa-1fb6bb685826
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f100024e-6ba9-42ae-9ba4-9c7ca00618f4
                stepCounter: 91d1b8c1-d103-4730-a5c7-3bbf5daf50d9
            transform: COALESCE(REVENUEBUDGETFORCEIDDETAIL.REVENUEBUDGETFORCEIDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4a1eb87-83ab-40ba-9d7d-b7e4493e1457
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDIRECTDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDIRECTDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDIRECTDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2703572d-0deb-4596-bded-3f0bf6f612ca
                stepCounter: 9d0aff7b-b651-46ed-8e24-4f526c1755bc
            transform: COALESCE(REVENUEBUDGETFORCEIDDIRECTDETAIL.REVENUEBUDGETFORCEIDDIRECTDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c1895b4-5a71-4edf-94e7-237148d1be68
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.CONTRACTID=REVENUEBUDGETPDDETAIL.CONTRACTID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETPDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETPDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dd3fdb9-6d44-41e5-a087-7c625d1552b2
                stepCounter: 5098ceda-0c85-4440-84cc-0d356f17b1a4
            transform: COALESCE(REVENUEBUDGETPDDETAIL.REVENUEBUDGETPDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fdd03b4-de96-4c7f-b62d-3c9b1e16ab13
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ccf31fa-18c2-4313-8caf-f9567a96b9ad
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a929e306-2890-4a51-be1d-4097fcaf7aa8
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37cd0780-86fc-41b0-9229-c2aabab985c5
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38506ab0-1c4d-4c2c-9ab7-f8a3908d9bf7
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c76d8412-73ff-44a4-bab0-7df03d71caf6
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ae5c162-94cd-4392-85cd-675fb99b10eb
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5de8555d-34cf-4f1b-b980-c4f9f009f8ac
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14f4d936-9e20-41e1-bb7c-82490d00aa94
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 439f0a5c-82d9-4dd4-9d68-c9e758034d35
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 652adba3-454b-46fe-b828-47936b5f45d5
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19d557d0-501f-4c69-9e53-5f3d46c725f4
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d8f76a9-b936-4b02-a520-da0ac9f42148
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bf11c1f-5eec-4f7d-9aec-bb791df36511
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15431ade-c0b4-44a6-aac5-0e7527a3c781
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eedc51cf-6a63-42fd-8cb1-e66334db2abb
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8160801d-d2ce-4881-9337-6b86f9766f62
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42547a03-a30a-48d7-a5ff-9ea5134b3974
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 712ef6fa-0909-4b33-a2b0-0d212d9d6010
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a40ebd06-9c3a-4233-866a-175d204e1e97
                stepCounter: d1900eab-6bfb-4275-9540-868877d9163b
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86f9c9ae-28c0-4280-92ab-146bd23bd618
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOURCEENTITYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e1e2250-a506-4dd3-b205-5d44fc88c591
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 167fb3da-d1b5-4045-9a00-95792f83029e
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.CONTRACTID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2695753d-6f1a-4e8d-9172-3bccc50d7c6a
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5a5a5ea-ce04-4550-88f1-affc0bc1ce2e
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: REVENUE TYPE (MOSTLY USED AS INPUT TO PREPARE NEXT YEAR'S BUDGET)
        name: REVENUETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE--UC
              \N --WHEN BUYER=UC AND PPA=UC, THEN "SOLICITATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SOLICITATION' \N --WHEN BUYER=UC AND PPA<>UC, THEN "ADOPTION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) NOT IN(4055673) \N THEN 'UC ADOPTION' \N --WHEN BUYER<>UC AND PPA=UC, THEN "SYNDICATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID NOT IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SYNDICATION' \N --
              \N ELSE \N CASE \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PUBLIC%'  THEN 'ISO PUBLIC' \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PRIVATE%' THEN 'ISO PRIVATE' \N
                          ELSE SALESTERRITORY.TERRITORYDIVISIONNAME \N
                           END \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68f28fc9-c65c-4c73-b13d-986c85bf7a15
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f525cb03-6bf5-438e-bd81-cd137722d939
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5c06d99-4276-418a-b43f-4c7d7f4547b6
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.RECEIPTDATE=DIMRECEIPTDATE.RECEIPTDATE
        name: RECEIPTDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93034a0c-4fca-4e5f-a254-66f910308fb1
                stepCounter: adf141a9-8097-453e-8fe9-345cd1cc4c90
            transform: COALESCE(DIMRECEIPTDATE.RECEIPTDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 549cecd1-7f19-4b3b-a60e-04c53c09ded4
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2352aa4c-ab39-451a-8f40-faa822c226e7
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29047ea3-a615-4d62-b818-2ac9df61bf3e
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: DATE
        defaultValue: ""
        description: GENERATE RECEIPT DATE FOR NEW 2019 BUDGET COMPARISON
        name: RECEIPTDATEFORBUDGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7378b6a-2dbd-4691-ade8-86df7d542b95
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c065902b-815c-478b-aab6-20ef036fffe6
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9633bd23-ea38-4260-9f7e-a79e3214fd0a
                stepCounter: 388d963b-7c6b-4464-a76a-4027878a166d
            transform: COALESCE(DIMTRANSACTIONDATE.TRANSACTIONDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e421df78-ad6d-4801-8dcd-91fe3dcad9d3
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 021ab744-da1b-4f54-a2b6-7ff5de6ccef0
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd8df2d2-cecf-472c-83b4-bcdded8a969b
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: UNITSSOLD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2861e54-ff61-4d20-ad08-bd06443c3df8
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e561c01-239b-4976-a1bd-fd8fe61a13db
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: PRICEPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c683206-4722-466d-badd-806ad0e121d8
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db759295-6e75-42b1-811c-0160d2c16ad4
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db5693ae-87ea-4386-b644-c96f144b4ff6
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8511655f-e2ab-438e-9089-df0edb7d5458
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb87a5c4-255d-404b-8b02-9f04fed36bb2
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d4764ad-acf7-4c88-bb20-f117dbeeb503
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYID=SALESTERRITORY.TERRITORYID
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb19aab3-e29f-4e8a-9ca1-bb07128f2e6a
                stepCounter: 600ce668-325b-49f6-8cab-2b74ee7ee57a
            transform: COALESCE(SALESTERRITORY.SALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaa3219f-6cd7-446d-a176-a57053337ad3
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDFINANCIAL=FINANCIALSALESTERRITORY.FINANCIALTERRITORYID
        name: FINANCIALSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2adee46-284b-4000-bb62-c594e8d06984
                stepCounter: 5bec94d8-3441-46a1-9199-08f894c43268
            transform: COALESCE(FINANCIALSALESTERRITORY.FINANCIALSALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0620dfc1-6c88-4966-a3e7-f5bd4bbbc773
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDDIRECT=DIRECTSALESTERRITORY.TERRITORYID
        name: DIRECTSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0e32d21-ce92-4dd6-a1ee-b84632978e11
                stepCounter: 4f97fb6e-372d-4ee6-aa6d-b6965b637c07
            transform: COALESCE(DIRECTSALESTERRITORY.DIRECTSALESTERRITORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0685b4c5-ccea-4a8a-b6cd-c6b1e048990b
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6495881-e089-4546-a8cf-7a103e8676f1
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ada3c4c0-24b7-409c-aa80-af19dacf295b
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ORIGINAL FORCEID (ID) OF THE CUSTOMER TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c064303-13ea-4271-b212-c83f836a2ab5
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6945ba37-f69f-4591-a4eb-ad412f64c865
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d9908cf-2f29-4705-848d-f84b384f1acb
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2288e27-1645-43eb-9cc4-85bfd9ed62bc
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02335ae7-3cf6-4b88-a851-5ca2a4dbbfb3
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e00cf667-0909-4b7b-894d-1a52cc720d6b
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: VIZIENT SYSTEM IDENTIFIER
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b502cfb-332c-4a02-a4f0-3f9a66f62d80
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40631557-de51-4a3a-9415-b60f917c9f6d
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTREBATEDETAILSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 386fe0b2-c233-48b0-985b-9af724928468
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 742d3241-753e-4c4d-a599-a3b5fee4c8bc
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: TRANSACTIONCLASSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95987e9d-e0ed-41a5-b766-cfb49804190e
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3390bcb5-7060-412d-8f4d-5533baeefc34
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONCLASSID=TRANSACTIONCLASS.TRANSACTIONCLASSID
        name: TRANSACTIONCLASSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d51cb9d-8ca7-453a-b154-6c666c09e299
                stepCounter: 881bf626-986c-4894-81bf-0974d7fb5d82
            transform: COALESCE(TRANSACTIONCLASS.TRANSACTIONCLASSKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cd5e0e3-cb7d-47fa-8973-5b3bbd0261a3
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_DATE('$MAXRECEIPTDATE')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6f29ce5-8db4-4029-aafd-8cf159185813
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96ebea45-84bc-4713-9736-03757132eba5
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8650b6a-492c-4f17-809b-04624948d7c7
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d9e83d4-803c-4e0f-a457-333afac72cfe
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46369419-5955-42fc-89fa-b1c5b76d1203
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02eecfe3-7f30-472f-87ec-ea6a0da37741
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e261dac7-f5e6-49f9-bddd-f5e013c67061
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1dbbd35-5188-4ed4-927b-39e2df3934f6
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 860a3866-a7d9-4b26-bcbd-8b28b6942c74
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c1bcc35-6d6b-4587-bc7b-3d01958f3df5
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb3e231a-2424-492e-b50b-3ea39ca02bd0
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cc555b5-c619-42a9-9c2d-b727ae420366
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 652bc2ca-9493-4f40-8f70-a1ebccb55fb6
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76403ee0-8ca7-4b71-8d85-a5fd3d7ffbe8
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e54faf9-6da2-42c3-84ad-b201500d99af
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALESUNITOFMEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb4f6f63-a957-47c4-bd8d-3839b45975d9
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4fb8ec-94b1-481a-8856-7bdc7cdb85b2
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: TRANSACTIONNOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca6dace1-c093-4bb4-b1e9-86dfaed3db2c
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5a8e1d3-164e-44df-af28-7b793839fc55
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34b7026f-b32a-43a4-876e-c6eee68b4a47
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca69bdbb-09b5-4e38-ba71-1a8d5d2c7e07
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHANGE THE SOURCE OF CHANNELPARTNERFEESHAREPARTNERID TO ACCOUNTHIERARCHY INSTEAD OF FROM SALESREPORTINGLINEITEMS(FORCESALES)
        name: CHANNELPARTNERFEESHAREPARTNERID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97803bea-a7a7-41c7-acf2-3e09e5189e04
                stepCounter: 159d1a84-5962-4aac-b776-eb430234402a
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.CHANNELPARTNERFEESHAREPARTNERID,STAGESALESMERGE_BIZXFORMS.CHANNELPARTNERFEESHAREPARTNERID,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecf1f1c9-a2c2-4f94-8d8b-953dc4ccdef2
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERLEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d2a4337-b2c4-4930-8a23-c6481b795682
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04fcaa9e-2598-4e8a-8a90-ac548cd92034
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTEXTERNALCATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0e06ed-c876-4daa-a9bd-92adc2bb5b64
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 979b2763-fab4-42bf-9f6a-78e992507640
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: CUSTOMERIDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1af34657-e28a-4add-8b8f-796cc9fb8e5f
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e2ec50c-752a-45f9-825c-02c27aef0ab6
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CUSTOMERLEVEL1IDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa2555fe-6375-49de-9afd-a426ff46df5f
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 204c5860-efa2-43d4-aa4d-5b132c2609e6
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ALLIANCE_NAME_PREMIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b279396d-29f0-4341-b6e5-e6ef403b02e7
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0084931f-a9fb-4127-99c6-141478a24541
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0168bc8-47c9-4e3a-bcb4-8c0d9c97f7fc
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4957f20c-163a-4983-a068-04b3f4bedd5f
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ARTIFICIAL KEY FOR THE DSS SOURCE SYSTEM TABLE.
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3945626d-1b58-4e81-8957-23fc36c0b8f1
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: IFF(STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY IS NULL,3,STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af3795cb-3cac-40f6-8d4c-2654169bd75c
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ade8785-ea98-499d-a2c4-e51f3b3d4e14
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd2b4bb1-872f-45d0-9df8-8ef481bf4fe0
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf04070d-dd15-4b25-9dc6-3a084a96c9c9
                stepCounter: f0e71e62-c3fb-4771-8aea-75be0604aca5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba239786-8dc1-4baa-823f-436e397c9bc5
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a95f3a12-1c9b-4688-a326-f9f6e130d513
          stepCounter: 5ffda0a1-cecf-4f6c-8a84-541415b2ad43
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_SALESMERGE_BIZXFORMS: f0e71e62-c3fb-4771-8aea-75be0604aca5
          CONTRACT: 84116e71-ebf6-4262-b818-71628fbd5079
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: ACCOUNTHIERARCHY_OMNIA
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIM_RECEIPTDATE
          - locationName: DIM
            nodeName: DIM_TRANSACTIONDATE
          - locationName: DIM
            nodeName: DIRECTSALESTERRITORY
          - locationName: DIM
            nodeName: FINANCIALSALESTERRITORY
          - locationName: DIM
            nodeName: ORGANIZATION
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDIRECTDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETPDDETAIL
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: TRANSACTIONCLASS
          - locationName: STAGE
            nodeName: STAGE_SALESMERGE_BIZXFORMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGE_SALESMERGE_BIZXFORMS') }} STAGE_SALESMERGE_BIZXFORMS
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGE_SALESMERGE_BIZXFORMS.CONTRACTID = CONTRACT.CONTRACTID
               AND STAGE_SALESMERGE_BIZXFORMS.DS_S_SOURCE_SYSTEM_KEY = CONTRACT.DS_S_SOURCE_SYSTEM_KEY
        name: STAGESALESMERGE_ADDKEYS
        noLinkRefs: []
  name: STAGE_SALESMERGE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
