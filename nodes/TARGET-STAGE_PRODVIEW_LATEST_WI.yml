fileVersion: 1
id: a069bd05-2316-4a76-908b-0eca6588549b
name: STAGE_PRODVIEW_LATEST_WI
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ad609f-2175-442e-be4c-e91afd952970
          stepCounter: a069bd05-2316-4a76-908b-0eca6588549b
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe22de8-f6e2-429b-90aa-91f793353b62
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e28ec1f2-4b54-4789-9909-34fb3bbdb6af
          stepCounter: a069bd05-2316-4a76-908b-0eca6588549b
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c20e0f47-3157-4ac3-b43f-71f5fe1a075d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: FIRST_VALUE(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.WIGAS) OVER (PARTITION BY IDRECUNIT ORDER BY DTTM DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62b71e50-4166-4e98-bb7a-359eec3650cc
          stepCounter: a069bd05-2316-4a76-908b-0eca6588549b
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HCLIQ_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56af0ab0-f80f-4382-9236-5939ab19ee61
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: FIRST_VALUE(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.WIHCLIQ) OVER (PARTITION BY IDRECUNIT ORDER BY DTTM DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60e5244a-c488-42a7-a419-6bf541ec0511
          stepCounter: a069bd05-2316-4a76-908b-0eca6588549b
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SAND_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc98fd8d-12e4-4909-875b-d54734241f4a
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: FIRST_VALUE(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.WISAND) OVER (PARTITION BY IDRECUNIT ORDER BY DTTM DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 427de531-279e-4e5a-8edb-40c832420742
          stepCounter: a069bd05-2316-4a76-908b-0eca6588549b
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60f030ec-4d2a-43f6-ab43-1b5e3ad5523b
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: FIRST_VALUE(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.WIWATER) OVER (PARTITION BY IDRECUNIT ORDER BY DTTM DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f09df950-52f8-47fc-a0c6-eac59b37c7b1
          stepCounter: a069bd05-2316-4a76-908b-0eca6588549b
        config: {}
        dataType: VARCHAR(26)
        defaultValue: ""
        description: ""
        name: LATEST_PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cdaa879-d97a-482f-9fe0-34e82ffb6acf
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: FIRST_VALUE(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECPUMPENTRYTK) OVER (PARTITION BY IDRECUNIT ORDER BY DTTM DESC)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: b78e68df-21f7-427c-9ce7-426d1d304567
          ODS_PVIEW_PVT_PVUNIT: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
              JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }} ODS_PVIEW_PVT_PVUNIT
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNIT.IDFLOWNET
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = ODS_PVIEW_PVT_PVUNIT.IDREC
               AND ODS_PVIEW_PVT_PVUNIT.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNIT.DSS_DELETE_FLAG != 'Y'
             WHERE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_DELETE_FLAG != 'Y'
        name: STAGE_PRODVIEW_LATEST_WI
        noLinkRefs: []
  name: STAGE_PRODVIEW_LATEST_WI
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
