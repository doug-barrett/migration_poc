fileVersion: 1
id: f37ca059-0d96-4741-95c2-6d9d2f480cab
name: S_WAITLIST_40
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Dimensionalise Waitlist Stage table  dim_gastro_production_list_name join groups up priority 3 and 4 referrals into 3"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18ebff81-93fc-4c28-aebb-deb8124b3fdd
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15d736c2-ff2d-4c46-986d-d9b4d61eb132
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcff0559-5975-4717-8db5-32b706e67fa3
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c494277-71bf-406f-b94a-736ff2f7705a
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f06f1f77-3886-4cfd-be98-eaa58df6bcec
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0f5e6bc-a2b1-4872-bbc5-bae20adef2f4
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abee2021-5e01-41d2-9f2b-80816d8d8300
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d33299ef-bc2f-49db-9f28-7e88054f215a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6b6d63e-d825-4a5f-9067-bbc9ed1d12ae
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbca87f8-9e7c-4ca3-9357-71b2b13cb98b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9969cdd8-5655-4ade-beca-bba1ed4e052b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b909a696-a23b-4450-aab2-9094bb21ab0e
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebb42005-83fe-4e13-bbee-c4e13af78b34
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_RULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0fae873-48fb-4da9-a7e8-58fd0bb6605c
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f43050a5-c1f5-4185-a989-7b86f7cd77d0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_at_waitlist_years
        name: PATIENT_AGE_AT_WAITLIST_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 247cca89-30d6-45fe-86fc-e82e5696ce79
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3181946-b8a1-4357-b67d-5097c9c41b53
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.patient_age_at_waitlist_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c508ffe9-3706-4a25-8f0e-f3757c4273ab
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86cdec8c-1773-4061-9a39-728e0622f4ec
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4dc953f-0e0c-4173-9a2b-b8acfce731f4
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_type_reference_no=dim_waitlist_type.waitlist_type_reference_no
        name: DIM_WAITLIST_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0262e650-13e9-4c2c-9e12-83091a68a73f
                stepCounter: be8cd5e0-3def-42d2-83c0-8edb9de13deb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 414ca182-6a11-43cc-ab0b-f1414335f72a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53610b44-5b63-40cb-9255-d2aea4e66985
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a54ef0e2-efc8-4fe4-934a-2995baf81921
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_specialty_reference_no=dim_waitlist_specialty.waitlist_specialty_reference_no
        name: DIM_WAITLIST_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7079b2ef-9f2e-4032-99ec-75819d9db993
                stepCounter: 37897fcd-5ea0-47ee-96e7-b3f1f8b36d87
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 739f2e3d-4d3c-4b7c-8a41-94fb9c158c37
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18b3c7b2-9af0-469c-b58f-c05a5fa66df3
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19b96707-70d9-479a-a10c-755ea34f3566
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_clinician_reference_no=dim_waitlist_clinician.waitlist_clinician_reference_no
        name: DIM_WAITLIST_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcac1c0d-bdd1-4fc8-bc8e-5ddf9246393d
                stepCounter: 19000cde-0ad8-4d32-812e-f0fec7243d19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 470142b9-a857-4b25-a0c2-f11590026451
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASSESSING_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 833a23c6-e076-4b79-b906-17485a9baef6
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9e58ef7-79cc-4fad-bccc-5e1e577f3ce9
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_waitlist_40.assessing_clinician_reference_no=dim_assessing_clinician.assessing_clinician_reference_no
        name: DIM_ASSESSING_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e650767-6ff6-4fd2-b368-0714030cbdfe
                stepCounter: 0b553545-ae13-4069-b468-ceda7ef91e7b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62c5f43b-52c2-4de3-9aca-9ad39deb054a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_CONSULTANT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7a442d8-e2a3-4975-b263-00a81ad2b27d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e827b53-6564-4297-a84b-8ece0a1cfa5d
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: 'Used for planning at the facility level of NSH, WTK or outsourced OS '
        name: PRODUCTION_PLAN_FACILITY_GROUP
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: caa6ef1e-50ae-4c59-9993-a502d6bc243e
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9103c8a0-c075-49db-9656-d86bf9cd7f97
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: dim_gastro_production_list_name.facility = s_waitlist_30.production_plan_facility_group   AND dim_gastro_production_list_name.priority_reference_no = case   when s_waitlist_30.referral_priority_reference_no = 201774 then 201773 else s_waitlist_30.referral_priority_reference_no end   AND dim_gastro_production_list_name.production_plan_group = dim_local_category.local_category_production_plan_group
        name: DIM_GASTRO_PRODUCTION_LIST_NAME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9003ed7a-6a23-4c1b-b6f2-d0a62f03e3a6
                stepCounter: becda575-69fd-49ed-9ef4-c39f3af8f862
            transform: IFNULL(dim_gastro_production_list_name_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73eae600-2dad-45f5-a6c3-7a06de55827f
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_consultant_type_reference_no=dim_waitlist_consultant_type.waitlist_consultant_type_reference_no
        name: DIM_WAITLIST_CONSULTANT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6d26c57-9a03-437f-965a-528fe3a4bc12
                stepCounter: cdae63b6-32df-476e-ab1b-3babce31f8ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a24e5ff-4cd1-4ac3-9588-be8dea78a435
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a8ae1af-5d04-4ef5-b7e9-8e5dc561aaf7
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eee7f1c-9839-411b-be51-8cff8213a01c
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_ward_reference_no=dim_waitlist_ward.waitlist_ward_reference_no
        name: DIM_WAITLIST_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3445291b-c0d8-423a-b6e1-496f30d6308d
                stepCounter: 0505afd9-f94c-4122-8bc5-f2f93c7b5b2b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d3917a3-0f4e-447f-9643-8ef493ff4d00
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TRANFER_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fac7ec9-bd29-4462-9a1e-218976f8441f
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e55b229-ddb4-4dbd-9465-2e56c226d28e
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date on which the referral/waitlist was prioritised.  For a NPF presenting referral this is the authorisation date.  Otherwise this is the waitlist start date.
        name: PRIORITISATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c95fa96-b19f-4601-8c54-5d30fab5c46c
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0032f4d5-20c8-49d4-8e71-1cac56ccc554
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_40.waiting_start_date=dim_waiting_start_date.waiting_start_calendar_date
        name: DIM_WAITING_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e6aa523-c796-4463-a114-18919b4494e2
                stepCounter: ea840484-f70c-4bad-aad7-a289315c11d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f3f0f7-d5b6-434e-bb81-b7c4121b7a37
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f38ed119-b14c-4b12-9255-53f4345fb973
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 599b5a04-a2c4-4cf7-bcfd-ecb983bb0797
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12022d62-1324-4a18-9f1a-935ef73620b8
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a55be68-a243-481c-8029-36a09f2437a9
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Removal Date or Last Day of Current Month
        name: ESPI_COMPLIANCE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64a92bdd-b918-4336-a456-07ede920b4ef
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1f03a76-cf7f-4165-9fab-a66757b4ed7b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_40.waitlist_due_date=dim_waitlist_due_date.waitlist_due_calendar_date
        name: DIM_WAITLIST_DUE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 418b1c3b-df1b-40d0-aca8-f0cf9fc62af3
                stepCounter: 38f52f37-cea5-44f3-93ef-7b2ac9299248
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a78ebd06-67df-43b3-9e9e-d4b7ad532346
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50a06bc9-1b17-4a1c-a953-11f30943d51f
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_ACKNOWLEDGEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b573fc1-ce2f-4629-b289-710a0b9c0186
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 577e01fa-2252-4b9f-93f1-8580ac574d36
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fab9f4fd-cc65-45be-8a34-d0993664be7d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22bc1385-4d5c-4274-9945-1bb362a48160
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0f9210b-d062-4c5b-8e3e-67f9d15f4f06
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a04735e9-163f-4cec-a14c-1f6e16feee36
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e283126-b8ba-4653-b96a-f21f96be3777
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c56d87fe-f432-4c18-8c06-933b208cb2e3
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b1f5ac3-7833-4f60-aaf0-84638b4a9829
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: "'R'+CONVERT(varchar,s_waitlist_30.referral_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d254992-673f-499a-a884-3f30b4c3b05c
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a0b2a31-6ef8-470b-ae44-c0ba03309545
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1efa6452-b75e-495f-8b49-6015041b09d0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09e9fa4b-6dd2-4138-b812-0249d829e437
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18630fb1-a4f4-4bef-912f-9bb3ef627a32
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37af5325-a9d0-4643-949f-933b222f3faf
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba648f1a-301b-4996-84a9-e3ec5a0817d0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1826953-505b-4fa8-bc6b-cddacfa69779
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d5b6afc-4022-48ac-af03-22dff06e751e
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LIST_NAME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0fae873-48fb-4da9-a7e8-58fd0bb6605c
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d79351e-ed39-4eae-a77f-14b9c5f9ba98
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.list_name_reference_no=dim_list_name.list_name_reference_no
        name: DIM_LIST_NAME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdb3912a-f8d8-4d6b-bece-bf3c6be3e112
                stepCounter: dadb2ec5-9218-4b98-83b9-011c7f4f1cb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96cd1b24-570d-43a4-95e1-561950daa9d8
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 438945b1-9617-4dc0-bd2b-e89c0700bc7c
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4585b191-e2e7-416e-bf24-4a5a4059da59
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.local_category_reference_no=dim_local_category.local_category_reference_no
        name: DIM_LOCAL_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 105edc79-535c-4421-a4ad-bdc7bac7a44a
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: IFNULL(dim_local_category_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5646d3fe-b493-4314-b5ea-7ff311c69e28
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: s_waitlist_40.local_category_reference_no=dim_list_name.list_name_reference_no
        name: LOCAL_CATEGORY_PRODUCTION_PLAN_GROUP
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e3fd988-ea49-40fc-aade-d77c53e283e7
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: IFNULL(local_category_production_plan_group,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5b4d45b-db07-4bee-88f9-e1ad241a2f90
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7145b809-5be6-4709-b84e-8bc303ae56fb
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d3798fc-a897-4c7d-911f-215790356833
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.admission_type_reference_no=dim_admission_type.admission_method_reference_no
        name: DIM_ADMISSION_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2e60128-b077-486c-b90e-18022d25b932
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fe1ed07-9809-4496-ad0e-dd076e7aef39
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fbd0637-b95c-44ad-b5af-26e990debfdf
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76988970-9131-40e4-96a9-c62291270e19
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROPOSED_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e256fb1-18f1-4816-8212-4cd1ff89fa01
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba12e17-3c2d-4a3c-879a-4e8114eb3bcb
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_REASSESSMENT_DATE_MONTH4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b512c81-51b2-4ba0-8fbc-cbbe03cfa312
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afc13d45-2d88-4173-a4af-4695dfb27a98
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_40.waitlist_clock_start_date=dim_waitlist_clock_start_date.waitlist_clock_start_calendar_date
        name: DIM_WAITLIST_CLOCK_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ee95ebe-b5b5-4e93-884d-06b0d576aa30
                stepCounter: 9591ae01-a523-4da1-b1e0-42812c498ef9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5113b787-4e7a-4cbe-b599-bfba03d2e339
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46ddb3ed-2eda-48fc-a223-475d17070c0f
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3c5f6f9-04c4-4c37-97b9-b5a6ef6c885c
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_STOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c0b2e81-245f-41f5-ac85-bed4db4fca4d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d71120d7-c9d8-4ebe-b7d8-a755efb1ac2d
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38c9183e-a9b8-4ad3-997d-32078fd09159
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd44075e-c0d5-446b-877e-2fb96e251f80
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78d1ccf5-5bdf-40be-b269-9f0dd8d2d976
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd60153f-08de-45de-b744-327589a2276f
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INPATIENT_ACTUAL_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fd49351-61ec-40d9-97ee-2f2fbdb6be4d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2325ee1-4cf1-4f95-b936-c61fd7dfcf6a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is the patient currently admitted for theis waitlist episode
        name: CURRENT_INPATIENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 575b8758-6e93-48f3-a1e6-506eeac2535b
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bca6eb70-1318-4151-8643-593560ed59a6
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_GIVEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe529d95-32d0-4118-9466-adc705bac2ed
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff4f9649-194d-4090-81f8-a03220245a8a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CARE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bece39bb-b565-4931-849b-54bb64b06689
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9362a4d2-4048-4157-9d28-ce0b5c0eda56
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: caed160d-0492-4536-904c-f40c71844517
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f66b8bea-f033-4be2-9231-2560e6a59fc9
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TCI_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf26a3f8-edec-4303-bfa5-916eba915efb
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87f008de-2477-4e2c-9f03-374ad2c32366
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKING_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbb98395-9b5b-44ef-8fed-6920735b9dc6
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d4aca36-f6ff-447b-855d-a8870128471e
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3886ffb-abf0-43a1-8286-0f4f7e70b3d8
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3ce627c-cef0-4437-b045-5ec989d4329d
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_priority_reference_no=dim_waitlist_priority.waitlist_priority_reference_no
        name: DIM_WAITLIST_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5d3320e-8dee-425b-b8a6-f51afefb4ad4
                stepCounter: 44358bb9-9c05-480c-80fc-1195de9552b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cff2c03-73c5-47f7-898f-dd850027acc2
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57a71bcf-b7a8-456b-b8f4-cde1cf18af2a
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: "'W'+CONVERT(varchar,s_waitlist_30.patient_previous_waitlist_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ad6766d-df7a-4b89-b472-ec8b7f19e943
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb2e7f6-6534-4616-8ba4-5cf204b6a4f3
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41892757-2d81-475e-a386-e08a39c3513e
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2cf4d43-7c16-45df-9924-3ea5be45f004
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33e59e81-6493-4c16-b616-61c0f3279005
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a47187be-f077-41d1-890e-5f13e06cd43a
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f140f31-65e5-4dfe-91b8-d87356df094f
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 378f7c8a-4b44-4a5e-8a81-b56754a9e2b3
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a90cbbdf-e4ba-4ef2-9a95-d3b7407fb74c
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc05a575-546a-43c5-9fd0-23ac2a3c0f8a
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: "'W'+CONVERT(varchar,s_waitlist_30.patient_next_waitlist_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d82e4665-46bd-4347-8d24-ad8f001216ff
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be50acf-a0ed-4340-a6d5-798430a5d7ce
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91f08f27-e5e8-45ce-9327-2992721d32b4
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16800af8-522f-4fca-80bb-389f38da0b27
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a6a4365-9ced-49a1-8e01-cecacd71a6e0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5518236c-a605-47a7-9b9c-5567743f2c1d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc594142-05e7-4bee-8ee0-718e33d016d0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8c055ab-d0c9-4c14-9a2c-32bede2eef3b
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8385b84-60a6-4149-8a59-6e6d19f72284
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 745b5584-2df6-4a2f-9cfb-710f032bafc6
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 029f15fc-160a-4ca5-9965-23547a1991e0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.admin_category_reference_no=dim_waitlist_admin_category.waitlist_admin_category_reference_no
        name: DIM_WAITLIST_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5882c66-2509-4447-943f-2a06d1b7b9ea
                stepCounter: 13cfae57-e6b6-4cc8-bfb9-f2c62d05a51a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10ba8586-aa64-48d0-b872-64ae15d09988
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bc19149-94c7-45fb-bfe8-a44d98771c3b
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b38fc7ff-8bf7-4b35-a477-e2daf37388fa
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_removal_reason_reference_no=dim_waitlist_removal_reason.waitlist_removal_reason_reference_no
        name: DIM_WAITLIST_REMOVAL_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65994591-0a22-424f-ab4b-0571e7000955
                stepCounter: c39228fd-cafe-41e2-93c8-28669128f12b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebaaf14d-cb74-4370-9487-48c039c4b6a0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_COMPLETION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1e35ad3-7291-4555-bcb7-07b73f07fe3f
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c026ff-7f9f-40d1-8803-029aeae0179c
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_completion_status_reference_no=dim_waitlist_completion_status.waitlist_completion_status_reference_no
        name: DIM_WAITLIST_COMPLETION_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1964657-ecc1-4773-9875-1610e3a48896
                stepCounter: f92ad849-55e5-4869-988f-93aac31e1451
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c3ca621-8075-4c38-9b4c-37afa0d5e4a7
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdbb8f13-1324-44d1-b318-d11261586800
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f705899-50f4-456e-9679-3fba1740f87f
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.anaesthetic_type_reference_no=dim_anaesthetic_type.anaesthetic_type_reference_no
        name: DIM_ANAES_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6232bcb3-08a4-493f-8773-33030e01219b
                stepCounter: 3890dfb8-ef60-4e28-b7d9-a10d5b1109ef
            transform: IFNULL(dim_anaes_type.dim_anaes_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 763125cc-bff8-4afd-9a1f-c6e7faf3e8b6
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d2455d3-eda7-4352-ac53-49962c4c309f
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbebbf50-6b18-4d49-8c17-ef0b398fa293
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_booking_status_reference_no=dim_waitlist_booking_status.waitlist_booking_status_reference_no
        name: DIM_WAITLIST_BOOKING_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44c3ceea-be3e-490f-993c-2e19a2c7fc05
                stepCounter: 3b273b47-3733-4612-903f-ceef191c2efb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ca8f6f7-b4d1-42b6-9930-5d32c1f4f763
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_PROCEDURE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e33e1a8-df95-4fff-b9be-726020f96312
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2e40c86-ce1f-4f29-ac21-a40faae44884
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.waitlist_procedure_type_reference_no=dim_waitlist_procedure_type.waitlist_procedure_type_reference_no
        name: DIM_WAITLIST_PROCEDURE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7cab10d-bb4d-4128-9367-3e49138ba089
                stepCounter: e793675a-545e-43dd-9489-a82874eebfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 843e431d-8d27-487d-97dc-9801156b5a33
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_MODE_OF_DELIVERY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24d7591d-29f7-4a2e-baaf-42c8e1172818
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4018a53e-88e8-4669-99cc-aab773b427a9
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2b4e82d-3517-4a56-825a-60f39b822e62
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d5e49a0-d37b-4f75-affb-3d10aa709e98
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d5d1e0a-08ed-40f5-b8c1-8064cebbcdcb
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33ade373-9e28-42d7-9d28-cdd1c0ad7420
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.principal_diagnosis_code=dim_principal_diagnosis.principal_diagnosis_code
        name: DIM_PRINCIPAL_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1a7261f-2942-445d-88b4-fe34e5a3929f
                stepCounter: 6a64703e-9924-4948-986a-0578fe6b91b7
            transform: IFNULL(dim_principal_diagnosis.dim_principal_diagnosis_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10b1cc4a-d26f-4701-a7d9-63b24f9ca1cc
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 202328fe-399e-466b-8370-be18a0f3f256
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2830d167-c955-4184-b1c0-947c9ef04a7a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5cf5b66-7a5e-4501-ac89-1d832cef898b
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54a22c3d-50d1-4b03-aaf1-85cfa8c9d477
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf26aa26-7867-49d0-a0ec-fcbf017a424e
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a05f2a-a202-4566-b27d-2953b02f471b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.planned_procedure_reference_no=dim_planned_procedure.planned_procedure_reference_no
        name: DIM_PLANNED_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82c753c4-4ad4-457d-956c-b772c01d6892
                stepCounter: b85b583b-38a3-4dd4-8909-ac0102501436
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c8167b5-fb0a-453d-b28f-6ffab1f977fe
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURVEILLANCE_PERIOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bdb1775-2131-4159-9433-c7dbe8538f08
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71f309ea-e7a6-41f6-b909-74bc8a6f4d9c
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.surveillance_period_reference_no=dim_surveillance_period.surveillance_period_reference_no
        name: DIM_SURVEILLANCE_PERIOD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb227715-4b52-43cf-949a-0b88197af700
                stepCounter: 51a223fb-ad9c-4a43-8fea-4421fbf95bbd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb53f1b5-d7b8-445a-8111-cdd46ac30677
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: outsourced
        name: OUTSOURCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e5894b2-d6c3-4ca2-a17b-406579458b6d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 570cedf5-b3ac-4a37-b6d4-80e62893b432
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: date_outsourced
        name: DATE_OUTSOURCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76cf7fa7-1a96-460b-a3f9-6d10097b83f1
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59115959-55a9-407b-a50d-dc953d83198b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: If outsourced the facility outsourced to.
        name: OUTSOURCED_FACILITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68c17a85-8738-4994-97ce-b1ff25f8bbc1
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 380125fc-2103-4c39-9028-0bfabbdd8dc1
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OUTSOURCED_RETURN_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e9db68a-da20-4c19-aa9f-1feb8f3906db
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 029eff90-68b4-4311-b571-76863915956b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTSOURCED_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 637fb4d5-a1be-4b51-bd84-895510331e57
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dba9b6c-47f4-498e-a2a0-b080214629ad
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NBRS_PROCEDURE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b1291ea-a107-4d29-865b-83e97a640ff7
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2a6bf5c-9469-4ecf-86f8-171ab5ee6a9f
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NBRS_PROCEDURE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10b37509-88b0-4c10-89ad-e23937555e95
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 827b324c-4753-4333-92a6-82d9881d3828
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NBRS_PERIOD_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff126306-1b0a-473e-b1ed-3fa752f2dacf
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de59126d-f6d0-4d90-a5f7-ce0ef619e9dc
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CPAC_ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59e6dfe6-fdb2-4abf-b8b1-7e80f7cc0645
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee71d4a2-5b8e-43c5-a1cd-758e396b02eb
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CPAC_SCORING_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2cdf101-edc0-4e9e-a4f2-5b2fb9b508bd
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7354637d-1b3f-4ff9-a3cc-1b38b0f18e9e
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CPAC_ASSESSMENT_PERIOD_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59e6dfe6-fdb2-4abf-b8b1-7e80f7cc0645
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: DATEDIFF(dd,s_waitlist_30.waiting_start_date,s_waitlist_30.CPAC_assessment_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddd08068-d983-4250-a487-dd974da7c7d2
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CPAC_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3375a781-6384-458c-846f-8e769d9da3ca
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4947c8c3-19fc-417a-a7de-5563fcd5005b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.CPAC_scoring_category_reference_no=dim_CPAC_scoring_category.CPAC_scoring_category_reference_no
        name: DIM_CPAC_SCORING_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fec9184a-683b-4652-8a1f-d3d671ab32e9
                stepCounter: f8933f2c-0b6e-4df8-ba37-ef15c338a6ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d8d7bbc-4e96-4839-abb2-90b24c49dc87
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADMISSION_READY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c60a9bb9-11d5-45b7-84cd-d22f743755f9
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e59cf67-894f-4f32-b9c1-15ba424a2d9d
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SHORT_NOTICE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93732b88-5a33-4e08-9d77-813e70533916
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c84d4ab-6531-4ed8-9f50-4e8e457a73d9
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a133245-9a89-492d-86af-22c87df7c8a9
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f14322a9-e379-4982-ad8f-827cec2ab471
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 816d371b-4304-4efe-aaf2-df642a495cc0
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1274422b-d9ea-4209-bded-59722e273f45
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI_COMPLIANT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: |-
              CASE WHEN s_waitlist_30.waitlist_group IN ('ESPI 2 (FSAs)','Non ESPI 120 days') THEN CASE WHEN outpatient_appointment_date IS NULL OR outpatient_appointment_date> waiting_end_date THEN CASE --         WHEN month(getdate()) = month( espi_compliance_end_date) and year(getdate()) = year( espi_compliance_end_date) and waitlist_due_date=espi_compliance_end_date
              --                                    and waiting_end_date is null
              --               THEN 'N'
               WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN outpatient_appointment_date < waitlist_due_date THEN 'Y' WHEN outpatient_appointment_date > waitlist_due_date THEN 'N' WHEN espi_compliance_end_date <= waitlist_due_date THEN 'Y' WHEN espi_compliance_end_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group ='ESPI 5 (NBRS)'                         THEN CASE WHEN surgical_theatre_booking_date IS NULL OR surgical_theatre_booking_date > waiting_end_date THEN CASE --         WHEN month(getdate()) = month( espi_compliance_end_date) and year(getdate()) = year( espi_compliance_end_date) and waitlist_due_date=espi_compliance_end_date
              --                                    and waiting_end_date is null
              --               THEN 'N'
               WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN waiting_end_date IS NULL AND GETDATE() > waitlist_due_date AND surgical_theatre_booking_date < getdate() THEN 'N' WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' WHEN surgical_theatre_booking_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group IN ('Colonoscopy','Surveillance')        THEN CASE WHEN surgical_theatre_booking_date IS NULL OR surgical_theatre_booking_date > waiting_end_date THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN s_waitlist_30.espi_type_no = 1                                        THEN CASE WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN espi_compliance_end_date <= waitlist_due_date                         THEN 'Y'
                          WHEN espi_compliance_end_date > waitlist_due_date                          THEN 'N'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33deb588-d650-4b8e-8ce3-f95a2e134e01
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: "ng_date IS NULL THEN                  CASE                    WHEN Datediff(dd, waitlist_clock_start_date,                         espi_compliance_end_date)                         <=                         Datediff(dd, waitlist_clock_start_date, waitlist_due_date)                  THEN 'Y'                    ELSE 'N'                  END                WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y'                ELSE 'N'              END            WHEN s_waitlist_30.espi_type_no = 1 THEN              CASE                WHEN IFNULL(surgical_theatre_booking_date,                     outpatient_appointment_date) IS                     NULL THEN                  CASE                    WHEN Datediff(dd, waitlist_clock_start_date,                         espi_compliance_end_date)                         <=                         Datediff(dd, waitlist_clock_start_date, waitlist_due_date)                  THEN 'Y'                    ELSE 'N'                  END                WHEN IFNULL(surgical_theatre_booking_date,                     outpatient_appointment_date) <                     waitlist_due_date THEN 'Y'                ELSE 'N'              END            WHEN espi_compliance_end_date <= waitlist_due_date THEN 'Y'            WHEN espi_compliance_end_date > waitlist_due_date THEN 'N'            ELSE 'N'          END   "
        name: ESPI_COMPLIANT_FLAG_OFFSET_MINUS1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: |-
              CASE WHEN s_waitlist_30.waitlist_group IN ('ESPI 2 (FSAs)','Non ESPI 120 days') THEN CASE WHEN outpatient_appointment_date IS NULL THEN CASE WHEN month(getdate()) = month(espi_compliance_end_date) AND year(getdate()) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN espi_compliance_end_date <= waitlist_due_date THEN 'Y' WHEN espi_compliance_end_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group ='ESPI 5 (NBRS)'                         THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN month(getdate()) = month(espi_compliance_end_date) AND year(getdate()) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' WHEN surgical_theatre_booking_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group IN ('Colonoscopy','Surveillance')        THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN s_waitlist_30.espi_type_no = 1                                        THEN CASE WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN espi_compliance_end_date <= waitlist_due_date                         THEN 'Y'
                          WHEN espi_compliance_end_date > waitlist_due_date                          THEN 'N'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f473a0d8-4f08-4257-a6cb-38f690392a70
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI_COMPLIANT_FLAG_OFFSET_0
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: |-
              CASE WHEN s_waitlist_30.waitlist_group IN ('ESPI 2 (FSAs)','Non ESPI 120 days') THEN CASE WHEN outpatient_appointment_date IS NULL THEN CASE WHEN month(getdate()) = month(espi_compliance_end_date) AND year(getdate()) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN outpatient_appointment_date > espi_compliance_end_date AND espi_compliance_end_date = cast(eomonth(getdate())AS datetime)+cast(TIMEFROMPARTS(23,59,59,0,0)AS datetime) THEN 'N' WHEN espi_compliance_end_date < getdate() AND cast(getdate() AS date) = eomonth(getdate()) THEN 'N' WHEN espi_compliance_end_date <= waitlist_due_date THEN 'Y' WHEN espi_compliance_end_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group ='ESPI 5 (NBRS)'                         THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN s_waitlist_30.waitlist_rule_reference_no= 17720 AND tci_date < waitlist_due_date THEN 'Y' WHEN month(getdate()) = month(espi_compliance_end_date) AND year(getdate()) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN IFNULL(surgical_theatre_booking_date, TCI_Date) > waitlist_due_date AND datediff(MONTH,IFNULL(surgical_theatre_booking_date, TCI_Date),getdate()) = 0 THEN 'Y' WHEN IFNULL(surgical_theatre_booking_date, TCI_Date) < waitlist_due_date THEN 'Y' WHEN IFNULL(surgical_theatre_booking_date, TCI_Date) > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group IN ('Colonoscopy','Surveillance')        THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN s_waitlist_30.espi_type_no = 1                                        THEN CASE WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN espi_compliance_end_date <= waitlist_due_date                         THEN 'Y'
                          WHEN espi_compliance_end_date > waitlist_due_date                          THEN 'N'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8874dad-a09a-4502-938a-1afa2c5aeccb
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI_COMPLIANT_FLAG_OFFSET_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: |-
              CASE WHEN s_waitlist_30.waitlist_group IN ('ESPI 2 (FSAs)','Non ESPI 120 days') THEN CASE WHEN outpatient_appointment_date IS NULL THEN CASE WHEN espi_compliance_end_date < dateadd(mm,2,getdate()) THEN 'N' WHEN month(dateadd(mm,1,getdate())) = month(espi_compliance_end_date) AND year(dateadd(mm,1,getdate())) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN outpatient_appointment_date > espi_compliance_end_date AND datediff(DAY,dateadd(mm,1,getdate()),espi_compliance_end_date)>0 THEN 'N' --               when outpatient_appointment_date > espi_compliance_end_date and  espi_compliance_end_date > cast(dateadd(mm,2,getdate())) as date) then 'N'
               WHEN espi_compliance_end_date <= waitlist_due_date THEN 'Y' WHEN espi_compliance_end_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group ='ESPI 5 (NBRS)'                         THEN CASE WHEN current_inpatient_flag = 'Y' THEN 'Y' WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN s_waitlist_30.waitlist_rule_reference_no= 17720 AND tci_date < waitlist_due_date THEN 'Y' WHEN month(dateadd(mm,1,getdate())) = month(espi_compliance_end_date) AND year(dateadd(mm,1,getdate())) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,dateadd(mm,1,getdate()))) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN eomonth(surgical_theatre_booking_date)<= eomonth(dateadd(mm,1,getdate())) THEN 'Y' WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' WHEN surgical_theatre_booking_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group IN ('Colonoscopy','Surveillance')        THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN s_waitlist_30.espi_type_no = 1                                        THEN CASE WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN espi_compliance_end_date <= waitlist_due_date                         THEN 'Y'
                          WHEN espi_compliance_end_date > waitlist_due_date                          THEN 'N'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2db08a06-6612-4725-a1cc-af1838a3a492
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI_COMPLIANT_FLAG_OFFSET_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: |-
              CASE WHEN s_waitlist_30.waitlist_group IN ('ESPI 2 (FSAs)','Non ESPI 120 days') THEN CASE WHEN outpatient_appointment_date IS NULL THEN CASE WHEN espi_compliance_end_date < dateadd(mm,2,getdate()) THEN 'N' WHEN month(dateadd(mm,2,getdate())) = month(espi_compliance_end_date) AND year(dateadd(mm,2,getdate())) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN outpatient_appointment_date > espi_compliance_end_date AND espi_compliance_end_date > cast(dateadd(mm,2,getdate()) AS date) THEN 'N' WHEN espi_compliance_end_date <= waitlist_due_date THEN 'Y' WHEN espi_compliance_end_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group ='ESPI 5 (NBRS)'                         THEN CASE WHEN current_inpatient_flag = 'Y' THEN 'Y' WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN s_waitlist_30.waitlist_rule_reference_no= 17720 AND tci_date < waitlist_due_date THEN 'Y' WHEN month(dateadd(mm,2,getdate())) = month(espi_compliance_end_date) AND year(dateadd(mm,2,getdate())) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,dateadd(mm,2,getdate()))) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN eomonth(surgical_theatre_booking_date)<= eomonth(dateadd(mm,2,getdate())) THEN 'Y' WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' WHEN surgical_theatre_booking_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group IN ('Colonoscopy','Surveillance')        THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN s_waitlist_30.espi_type_no = 1                                        THEN CASE WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN espi_compliance_end_date <= waitlist_due_date                         THEN 'Y'
                          WHEN espi_compliance_end_date > waitlist_due_date                          THEN 'N'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48cac366-e8ad-4ac9-8be9-633c59af04f7
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI_COMPLIANT_FLAG_OFFSET_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: |-
              CASE WHEN s_waitlist_30.waitlist_group IN ('ESPI 2 (FSAs)','Non ESPI 120 days') THEN CASE WHEN outpatient_appointment_date IS NULL THEN CASE WHEN espi_compliance_end_date < dateadd(mm,3,getdate()) THEN 'N' WHEN month(dateadd(mm,3,getdate())) = month(espi_compliance_end_date) AND year(dateadd(mm,3,getdate())) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,getdate())) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN espi_compliance_end_date <= waitlist_due_date THEN 'Y' WHEN espi_compliance_end_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group ='ESPI 5 (NBRS)'                         THEN CASE WHEN current_inpatient_flag = 'Y' THEN 'Y' WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN current_inpatient_flag = 'Y' THEN 'Y' WHEN s_waitlist_30.waitlist_rule_reference_no= 17720 AND tci_date < waitlist_due_date THEN 'Y' WHEN month(dateadd(mm,3,getdate())) = month(espi_compliance_end_date) AND year(dateadd(mm,3,getdate())) = year(espi_compliance_end_date) AND waitlist_due_date=espi_compliance_end_date THEN 'N' WHEN Datediff(dd, waitlist_clock_start_date, IFNULL(waiting_end_date,dateadd(mm,3,getdate()))) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN eomonth(surgical_theatre_booking_date)<= eomonth(dateadd(mm,3,getdate())) THEN 'Y' WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' WHEN surgical_theatre_booking_date > waitlist_due_date THEN 'N' ELSE 'N' END
                          WHEN s_waitlist_30.waitlist_group IN ('Colonoscopy','Surveillance')        THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN surgical_theatre_booking_date < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN s_waitlist_30.espi_type_no = 1                                        THEN CASE WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) IS NULL THEN CASE WHEN Datediff(dd, waitlist_clock_start_date, espi_compliance_end_date) <= Datediff(dd, waitlist_clock_start_date, waitlist_due_date) THEN 'Y' ELSE 'N' END WHEN IFNULL(surgical_theatre_booking_date, outpatient_appointment_date) < waitlist_due_date THEN 'Y' ELSE 'N' END
                          WHEN espi_compliance_end_date <= waitlist_due_date                         THEN 'Y'
                          WHEN espi_compliance_end_date > waitlist_due_date                          THEN 'N'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75c13aa5-407a-4467-90ba-3b59360b97b6
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI_TYPE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7a98fb0-2097-4e09-b198-2445ec78c521
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0090d3a-6859-4864-ba44-af841d48ee02
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ESPI_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN waiting_end_date < waitlist_due_date      THEN 1 -- Completed Compliant

                          WHEN waiting_end_date > waitlist_due_date      THEN 2 -- Completed Non-Compliant

                          WHEN s_waitlist_30.espi_type_no IN(2,16,17)   THEN CASE WHEN outpatient_appointment_date IS NULL THEN CASE WHEN datediff(DAY,waitlist_clock_start_date,cast(getdate()+1 AS date)) < datediff(DAY,waitlist_clock_start_date,waitlist_due_date) THEN 3 -- Not Booked Compliant
               ELSE 4 END --Not Booked non Compliant
               WHEN outpatient_appointment_date < waitlist_due_date THEN 5 --Booked Compliant
               ELSE 6 END --Booked Non Complaint

                          WHEN s_waitlist_30.espi_type_no IN(5,6,7,8,9)THEN CASE WHEN surgical_theatre_booking_date IS NULL THEN CASE WHEN datediff(DAY,waitlist_clock_start_date,cast(getdate()+1 AS date)) < datediff(DAY,waitlist_clock_start_date,waitlist_due_date) THEN 3 -- Not Booked Compliant
               ELSE 4 END --Not Booked non Compliant
               WHEN surgical_theatre_booking_date < waitlist_due_date THEN 5 --Booked Compliant
               ELSE 6 END --Booked Non Complaint

                          WHEN s_waitlist_30.espi_type_no= 1             THEN CASE WHEN IFNULL(surgical_theatre_booking_date,outpatient_appointment_date) IS NULL THEN CASE WHEN datediff(DAY,waitlist_clock_start_date,cast(getdate()+1 AS date)) < datediff(DAY,waitlist_clock_start_date,waitlist_due_date) THEN 3 -- Not Booked Compliant
               ELSE 4 END --Not Booked non Compliant
               WHEN IFNULL(surgical_theatre_booking_date,outpatient_appointment_date) < waitlist_due_date THEN 5 --Booked Compliant
               ELSE 6 END --Booked Non Complaint

                          ELSE 7
                           END -- Could_Not_Count
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e557612-1913-4265-9208-ca0942b3d550
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.ESPI_type_no=dim_ESPI_type.ESPI_type_no
        name: DIM_ESPI_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8338b9c1-afad-4fb8-bacd-c0938f44ba56
                stepCounter: fa4aa4f0-f734-4a9b-bf53-ca1e2647b7b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cac00895-2fea-47f4-bb71-f1228f221a33
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5862252-1885-4dd3-b6b3-0855116e4328
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0e16443-9dd4-4074-a7c1-5f2ee763b88a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: WAITLIST_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6cf9bee-c100-4615-becf-2127d0dbacb3
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db4fc371-e17f-4522-b471-84b1a806968d
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f968620-51fd-47a1-ac36-ea77feffcbc1
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1365c0d1-47e4-45d2-a92e-a6417bdef9af
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Days that the wailist has been suspended including any future suspension period '
        name: WAITLIST_SUSPENSION_DAYS_PLANNED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ac2a5eb-a22d-4879-8752-db66baef1926
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b78038c4-4c55-43ef-ba19-909127c5dd57
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: waitlist_days_to_breach relative to the clock start date
        name: WAITLIST_DAYS_TO_BREACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dca01a1-e60b-466d-8104-8813d1043ce8
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01e55294-413c-493f-8a23-f44ed8a4ecfc
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WAITING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54262bae-197d-478b-acd8-f82940616420
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e3573de-73c9-4a54-aacb-5f817cf8c10b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Days waited at the end of the current month, if waitlist still open
        name: WAITLIST_WAITING_MONTHEND_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31a800f4-98b3-4c6c-b101-b9ea00fc8251
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e398696-b07a-4a91-89b0-98167bff204b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOSPITAL_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a755603-5dfb-431a-b895-e479b1440ff2
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfa7bc6c-6220-4afb-b054-267f01c4d657
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fdde7fc-40e3-4ad3-8113-f64837a0100d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2226be83-377e-42eb-81c7-e64498993712
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence of the waitlist withing a referral
        name: PATIENT_REFERRAL_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0efc8836-6ce6-4888-963f-bee9474fc6ec
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8a14256-bc08-4e55-b786-7ba84920c251
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d60c3e6a-4802-4479-bcd3-748b11250ad4
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2a8332b-7299-4aed-b9ee-524f7ecce179
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: waitlist_count = 1
        name: WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31a800f4-98b3-4c6c-b101-b9ea00fc8251
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 283e2ab7-d0de-4832-9863-972a1fa9b04b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f367845-cdf4-4a6c-ab38-76c367232e32
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c1b2178-3bb7-475f-8d69-06d51f399a4b
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c7f24c1-07df-42a6-9a09-a1c1783b16fc
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d31c8997-1b41-4c02-a0b4-d80bca217753
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16b247cb-3a43-4c81-84d2-f453bb29ec26
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68b4cb44-b8a9-4d10-8bd7-6940baca7194
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is currently the same as the ESPI1 rule over time it will evolve to include more data than ESPI 1.
        name: NPF_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa218dd4-cd76-41aa-8ee4-d66aae26ca1a
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c762264-7488-4183-9b9b-15a7ffe05ba3
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow related referral, related referrals are all waitlists on a referral except the first.  The first is considered a presenting referral.
        name: NPF_RELATED_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d044fb4c-134b-4ad4-b47a-fde948072ec0
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c206cfe-7574-47b4-82bd-1ea16e40d666
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this waitlist a National patient flow preseting referral, presenting referrals are the first referral waitlist.  FSA waitlists can be recreated for DNAs so the last FSA waitlist on a referral is the only one counted for NPF.
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 110aeaf4-4eae-4180-8274-18727d462f52
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26a21613-7af3-48c5-88f3-6748112bd966
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence to show reverse order of waitlist types within a referral.  Needed for NPF to identify the last FSA waitlist.
        name: NPF_SEQ_REV_ESPI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 451bae99-f57a-4a13-b308-a447d52873d4
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceae7610-decf-4040-9f71-88a9938bebcb
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_40.service_type=dim_NPF_service_type.NPF_service_type_code
        name: DIM_NPF_SERVICE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5901bd2c-9bce-4c2b-a59d-0818e57418e2
                stepCounter: 83570343-e260-48f3-9459-7bd3af2f1f5c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a00cd46-cb80-410b-952c-cf9ceb159084
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f702389-0b89-4d64-b1ea-90c042f6de3d
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b99d5586-5579-46c0-83d2-f2a5bf6ecf7e
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_40.service_sub_type=dim_NPF_service_sub_type.NPF_service_sub_type_code
        name: DIM_NPF_SERVICE_SUB_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ddef90-34b9-46a2-900e-34dae7dfd049
                stepCounter: d3a2410a-e74b-4b00-a2d1-2b91cbbefa38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80ba97bc-034e-4920-aab5-4e4c4b1736a0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(4)
        defaultValue: ""
        description: ""
        name: SERVICE_SUB_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0777668-dd94-424e-98f6-37d4ccb0a291
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5dfc84e-e2bd-49bf-9adb-a4370a48be36
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_40.encounter_type=dim_NPF_encounter_type.NPF_encounter_type_code
        name: DIM_NPF_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bed6384f-a713-46f1-8da8-588a1f1ec7c4
                stepCounter: f4b98cde-2d4a-4437-beea-5d8aa35c4c46
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74667c0c-a99c-4508-a1fe-a3b99d0968d4
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64c5fcf4-ac2d-4903-8764-943f6e6a56d5
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76ae0229-c287-4e56-bad4-e096c1569b19
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_MAPPINGS_ROWID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82d328cc-ea08-4dd4-a627-44fd8b1f13e7
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86debb71-8827-4cd5-8bee-9fe8ca3404b0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8aba431-e8a9-4437-8d52-c7dc38b30cc6
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78b13d42-4a5b-47f5-97cb-0084cf3ee873
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c26f18c9-4823-439c-afc5-befff8947b93
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0e81821-d29f-4e36-a1b0-c12bfb0d5a97
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53b5c8d2-f103-40ef-9b6f-3c38a9bb98fe
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39f0b00e-1274-435d-a8da-45f22e4b1b1e
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40271427-e8c3-4846-bc76-4795d712ee21
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5895443-a93d-4739-8b17-396f7f824d72
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b75a88f1-f26e-427c-899f-3a0b877aad75
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_waitlist_40.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e2da6a8-6d6a-4792-a41c-f6db53b1fb97
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P1_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb183d3-07c5-4b1d-a6f6-a72dd6ecd431
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48d5ee1a-95cc-42a4-a52b-51bbce18d713
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P2_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2e29ef7-aa49-4fbe-9e17-ef096a2485ce
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d81ede51-ab6a-4d22-aa86-805728d92988
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P3_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b06abb3e-98b7-4db3-aeaf-89a958aca098
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d53ed711-0926-4d6d-832a-450df7144645
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INT
        defaultValue: ""
        description: Time from clock start to desired waiting time end.  Period type indicates if this number indicates days or months
        name: PERIOD_TO_BOOK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1afd149-07c9-42d4-8299-740d982274d9
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49159a1f-8b37-421a-aa4d-96072bbf7372
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: If a lead in time for booking is greater than the period of time to book, this is the date to alert for booking from
        name: BOOKING_ALERT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ff722f1-ee01-47fb-b27d-08bd65b7a639
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: |-
              CASE WHEN s_waitlist_30.advance_alert_for_booking_days IS NOT NULL THEN dateadd(DAY,s_waitlist_30.advance_alert_for_booking_days*-1, s_waitlist_30.waitlist_due_date)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f673c2f-4f2a-4ea3-9b95-951cc734336c
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: BOOKED_WITHIN_PRIORITY_TIMEFRAME
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN referral_priority_reference_no = 201771 AND dateadd(DAY,IFNULL(s_waitlist_30.P1_book_days,waitlist_days_to_breach), s_waitlist_30.waitlist_clock_start_date) > coalesce(outpatient_appointment_date,s_waitlist_30.surgical_theatre_booking_date)--,getdate())
               THEN 1
                          WHEN referral_priority_reference_no = 201772 AND dateadd(DAY,IFNULL(s_waitlist_30.P2_book_days,waitlist_days_to_breach), s_waitlist_30.waitlist_clock_start_date)> coalesce(outpatient_appointment_date,s_waitlist_30.surgical_theatre_booking_date)--,getdate())
                THEN 1
                          WHEN referral_priority_reference_no = 201773 AND dateadd(DAY,IFNULL(s_waitlist_30.P3_book_days,waitlist_days_to_breach), s_waitlist_30.waitlist_clock_start_date)> coalesce(outpatient_appointment_date,s_waitlist_30.surgical_theatre_booking_date)--,getdate())
                THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac0ebacc-b8ea-4f16-97c1-8986d4619c3a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date by which you'd expect the patient to be seen.  Based on timings per priority provided by the services
        name: OPTIMAL_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da77b7af-7020-4716-a5fc-cddab030b4df
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f4c8a1c-6a5e-46f9-95cf-4a14ae33ca14
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: If a lead in time for booking is greater than the period of time to book, this is the date to alert for booking from
        name: BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf26a3f8-edec-4303-bfa5-916eba915efb
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: coalesce(CASE WHEN s_waitlist_30.booking_date_DNA IS NULL THEN NULL ELSE s_waitlist_30.outpatient_appointment_date END, s_waitlist_30.surgical_theatre_booking_date, s_waitlist_30.TCI_Date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a867f6b3-d059-4d53-ae8d-f9cfb19ed4c0
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADVANCE_ALERT_FOR_BOOKING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ff722f1-ee01-47fb-b27d-08bd65b7a639
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1eef6f6-60bf-45a1-ab00-00bccc514741
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_waitlist_30.patient_reference_no IS NULL AND s_waitlist_30.referral_reference_no IS NULL                                                                                                                                                                                           THEN 'PATNT,REFRL'
                          WHEN s_waitlist_30.referral_reference_no IS NULL                                                                                                                                                                                                                                          THEN 'REFRL'
                          WHEN s_waitlist_30.patient_reference_no IS NULL                                                                                                                                                                                                                                           THEN 'PATNT'
                          WHEN (IFNULL(s_waitlist_30.waiting_start_date,GETDATE()) >= GETDATE() OR IFNULL(s_waitlist_30.waiting_end_date,GETDATE()) > GETDATE() OR IFNULL(s_waitlist_30.waitlist_clock_start_date,GETDATE()) >= GETDATE() OR IFNULL(s_waitlist_30.waitlist_clock_stop_date,GETDATE()) >= GETDATE()) THEN 'DT'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b59bc1bc-afa7-43a5-b2cf-94f70650be61
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fe1faf0-f827-4e65-a9de-69e58cc9104a
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_40.waiting_end_date=dim_waiting_end_date.waiting_end_calendar_date
        name: DIM_WAITING_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7d2d4a5-1703-4347-9cab-78cadfa073ea
                stepCounter: da3f36bd-f127-46ab-97cb-a1473e8da461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37ee4664-059b-4600-9b2b-d00bd7462f24
          stepCounter: f37ca059-0d96-4741-95c2-6d9d2f480cab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d20a9f8-8989-4172-a0ed-e9316c17ec51
                stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_ANAES_TYPE: 3890dfb8-ef60-4e28-b7d9-a10d5b1109ef
          DIM_PRINCIPAL_DIAGNOSIS: 6a64703e-9924-4948-986a-0578fe6b91b7
          DIM_LOCAL_CATEGORY: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
          DIM_GASTRO_PRODUCTION_LIST_NAME: becda575-69fd-49ed-9ef4-c39f3af8f862
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_WAITLIST_30
          - locationName: TGT
            nodeName: DIM_ANAES_TYPE
          - locationName: TGT
            nodeName: DIM_PRINCIPAL_DIAGNOSIS
          - locationName: TGT
            nodeName: DIM_LOCAL_CATEGORY
          - locationName: TGT
            nodeName: DIM_GASTRO_PRODUCTION_LIST_NAME
        join:
          joinCondition: |-
            FROM s_waitlist_30
              LEFT OUTER JOIN dim.dim_ward
                ON s_waitlist_30.waitlist_ward_reference_no = dim_ward.ward_reference_no
               AND IFNULL(dim_ward.dss_start_date, GETDATE()-10000) <= s_waitlist_30.waiting_start_date
               AND IFNULL(dim_ward.dss_end_date, GETDATE()+10000) >= s_waitlist_30.waiting_start_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_ANAES_TYPE') }}
                ON s_waitlist_30.anaesthetic_type_reference_no = dim_anaes_type.Anaesthetic_type_reference_no
              LEFT OUTER JOIN {{ ref('TGT','DIM_PRINCIPAL_DIAGNOSIS') }}
                ON s_waitlist_30.principal_diagnosis_reference_no = dim_principal_diagnosis.principal_diagnosis_reference_no
               AND IFNULL(dim_principal_diagnosis.dss_start_date, GETDATE()-10000) <= s_waitlist_30.waiting_start_date
               AND IFNULL(dim_principal_diagnosis.dss_end_date, GETDATE()+10000) >= s_waitlist_30.waiting_start_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_LOCAL_CATEGORY') }}
                ON s_waitlist_30.waitlist_local_rule_reference_no = dim_local_category.local_category_reference_no
               AND dim_local_category.dss_current_flag = 'Y'
              LEFT OUTER JOIN {{ ref('TGT','DIM_GASTRO_PRODUCTION_LIST_NAME') }}
                ON dim_gastro_production_list_name.facility = s_waitlist_30.production_plan_facility_group
               AND dim_gastro_production_list_name.priority_reference_no = CASE WHEN s_waitlist_30.referral_priority_reference_no = 201774 THEN 201773
                        ELSE s_waitlist_30.referral_priority_reference_no
                         END
               AND dim_gastro_production_list_name.production_plan_group = dim_local_category.local_category_production_plan_group
        name: S_WAITLIST_40
        noLinkRefs: []
  name: S_WAITLIST_40
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
