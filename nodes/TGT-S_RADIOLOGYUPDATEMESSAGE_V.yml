fileVersion: 1
id: 82831064-648a-4a85-9e1a-b2b4b660144e
name: S_RADIOLOGYUPDATEMESSAGE_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b016f59-8472-4c7c-a785-0f20648be521
          stepCounter: 82831064-648a-4a85-9e1a-b2b4b660144e
        config: {}
        dataType: VARCHAR(22)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3e2e3d3-9637-4ef1-959c-7f5a3b381803
                stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e51b797-4841-440d-91af-cec5ca5eba58
          stepCounter: 82831064-648a-4a85-9e1a-b2b4b660144e
        config: {}
        dataType: VARCHAR(22)
        defaultValue: ""
        description: ""
        name: FUNDED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b8425a1-822d-458c-a30b-c514053ec7f5
                stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ae41211-ed30-40b7-bda3-2358ae29d907
          stepCounter: 82831064-648a-4a85-9e1a-b2b4b660144e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31b056f1-261b-4aae-a725-dce5fd2e00ec
                stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02ea8cf3-876b-457a-a399-f9f6762b25a1
          stepCounter: 82831064-648a-4a85-9e1a-b2b4b660144e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EVENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN isdate(left(s_radiology_update_10.message_datetime,8))=1 THEN convert(datetime, left(s_radiology_update_10.message_datetime,8),112)+ CASE WHEN isdate(left(s_radiology_update_10.message_datetime,8))=1 THEN dateadd(ss,cast(substring(s_radiology_update_10.message_datetime,11,2) AS int), dateadd(mi,cast(substring(s_radiology_update_10.message_datetime,11,2) AS int) ,dateadd(hh,cast(substring(s_radiology_update_10.message_datetime,9,2) AS int),0))) ELSE NULL END
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 752fe3ab-bd31-477b-b95e-3921138193b9
          stepCounter: 82831064-648a-4a85-9e1a-b2b4b660144e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31b056f1-261b-4aae-a725-dce5fd2e00ec
                stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
            transform: "''"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2387061e-7be7-4b85-b3d4-65d52e546149
          stepCounter: 82831064-648a-4a85-9e1a-b2b4b660144e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SORT_ORDER
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: '99'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_RADIOLOGY_UPDATE_10: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_RADIOLOGY_UPDATE_10
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_RADIOLOGY_UPDATE_10') }}
             WHERE placer_group_reference IS NOT NULL
               AND SEQUENCE = 1
        name: S_RADIOLOGYUPDATEMESSAGE_V
        noLinkRefs: []
  name: S_RADIOLOGYUPDATEMESSAGE_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
