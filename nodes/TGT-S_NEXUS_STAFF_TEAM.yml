fileVersion: 1
id: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
name: S_NEXUS_STAFF_TEAM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca042bb4-8d8e-470f-a5f8-bf1718955d39
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78d00002-2dcb-427d-84fa-a710582c8792
                stepCounter: e48131bb-00b0-410a-a8bf-a1c1cfac9735
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43b2862d-4089-4990-b594-4a59e3ddfe40
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_ENCOUNTER_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NX'+cast(ds_nexus_OPSTAFF.opnumber AS varchar)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6a56420-3964-4b91-95a1-cf7d09a465f1
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 082117bd-af90-4ea1-bbca-2bbb30f4ce67
                stepCounter: f6b4f93d-a644-48e3-93fd-eb4c6bca6c3e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38788e0f-0884-4fa5-a8ec-2afb7c4ac6fc
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_STAFF_TEAM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2030fa3c-65c8-49cd-8e31-7d93c4d3069f
                stepCounter: c2c00be3-5ba0-4886-830e-19251a8bd04b
            transform: IFNULL(dim_staff_team.dim_staff_team_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56eb40eb-6594-4967-a6ee-720133649679
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_HEALTHCARE_PROFESSIONAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b22451-95b4-47f3-b7c1-48136447e09b
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: IFNULL(dim_healthcare_professional.dim_healthcare_professional_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5850501e-6d16-4380-919e-00cfbcd1ac04
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5b57a97-1120-4cb0-9382-18ec0ef788c9
                stepCounter: fefa3052-b73b-4b33-86de-2e242663a332
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c325708e-0166-42de-b98c-e44d155b6900
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: HEALTHCARE_PROFESSIONAL_FULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eadd978e-5aa2-4c28-8eea-a75d5bfd108b
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: dim_healthcare_professional.healthcare_professional_fullname +' ('+ dim_healthcare_professional.healthcare_professional_type_desc + ')'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4cd2278-5997-4be3-9e7f-afda1560e674
          stepCounter: 97dbe8e7-d3e3-4867-9586-77a3ebc5505c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_NEXUS_OPSTAFF: e48131bb-00b0-410a-a8bf-a1c1cfac9735
          DS_NEXUS_STAFF: f6b4f93d-a644-48e3-93fd-eb4c6bca6c3e
          DS_NEXUS_SWE_MAP_DUTY_ROLE: fefa3052-b73b-4b33-86de-2e242663a332
          DIM_STAFF_TEAM: c2c00be3-5ba0-4886-830e-19251a8bd04b
          DIM_HEALTHCARE_PROFESSIONAL: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_NEXUS_OPSTAFF
          - locationName: TGT
            nodeName: DS_NEXUS_STAFF
          - locationName: TGT
            nodeName: DS_NEXUS_SWE_MAP_DUTY_ROLE
          - locationName: TGT
            nodeName: DIM_STAFF_TEAM
          - locationName: TGT
            nodeName: DIM_HEALTHCARE_PROFESSIONAL
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_NEXUS_OPSTAFF') }}
              JOIN {{ ref('TGT','DS_NEXUS_STAFF') }}
                ON ds_nexus_OPSTAFF.opstaff_number = ds_nexus_STAFF.s_number
              JOIN {{ ref('TGT','DS_NEXUS_SWE_MAP_DUTY_ROLE') }}
                ON ds_nexus_OPSTAFF.dutycode = ds_nexus_SWE_MAP_DUTY_ROLE.dutycode
              LEFT JOIN {{ ref('TGT','DIM_STAFF_TEAM') }}
                ON ds_nexus_SWE_MAP_DUTY_ROLE.swe_role = dim_staff_team.staff_team_code
              LEFT OUTER JOIN {{ ref('TGT','DIM_HEALTHCARE_PROFESSIONAL') }}
                ON ds_nexus_STAFF.s_number = dim_healthcare_professional.healthcare_professional_reference_no
             WHERE [ds_nexus_OPSTAFF].dss_update_time > @v_pa_schedule_incremental
        name: S_NEXUS_STAFF_TEAM
        noLinkRefs: []
  name: S_NEXUS_STAFF_TEAM
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
