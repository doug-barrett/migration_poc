fileVersion: 1
id: 83deebdd-3f67-47ec-a79a-619fca3b3b40
name: OPC_CONTACT_HISTORY_LTM
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 958f5573-fbba-43a5-8334-9654ec1c2386
          stepCounter: 83deebdd-3f67-47ec-a79a-619fca3b3b40
        config: {}
        dataType: INT
        defaultValue: ""
        description: Level 1 Force Id
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8da064e-fc01-4c24-8c4d-116c963287ea
                stepCounter: 04f7176b-0716-4811-8d7d-c208debc3c23
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d0d76d0-3b8d-4d9f-a2d8-86190ae4dc56
          stepCounter: 83deebdd-3f67-47ec-a79a-619fca3b3b40
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Contact Created Month
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATED_MONTH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93e5f965-ad44-4d70-8dd1-4f2865eaa9bb
                stepCounter: 04f7176b-0716-4811-8d7d-c208debc3c23
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9c12506-69bf-41e2-9f75-4dea2d2df7d8
          stepCounter: 83deebdd-3f67-47ec-a79a-619fca3b3b40
        config: {}
        dataType: INT
        defaultValue: ""
        description: Contact Count by ForceId, Contact Created Month
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACT_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa0dde73-7978-4bc7-87e4-1655dfdc2c06
                stepCounter: 04f7176b-0716-4811-8d7d-c208debc3c23
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 879536fc-fb58-49c1-869d-01747cd63e8f
          stepCounter: 83deebdd-3f67-47ec-a79a-619fca3b3b40
        config: {}
        dataType: INT
        defaultValue: ""
        description: Running Contact Count by ForceId, Contact Created Date
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RUNNING_CONTACT_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cdbef92-c874-4cfb-98b5-6169125e328e
                stepCounter: 04f7176b-0716-4811-8d7d-c208debc3c23
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_CONTACT_HISTORY: 04f7176b-0716-4811-8d7d-c208debc3c23
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_CONTACT_HISTORY
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_CONTACT_HISTORY') }}
             WHERE DATEDIFF('MONTH',OPC_Contact_History.Created_Month,LAST_DAY(CURRENT_DATE())) BETWEEN 1 AND 12
        name: OPC_CONTACT_HISTORY_LTM
        noLinkRefs: []
  name: OPC_CONTACT_HISTORY_LTM
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
