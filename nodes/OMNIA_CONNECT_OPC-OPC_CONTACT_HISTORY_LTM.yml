fileVersion: 1
id: 0d0b04cf-890d-4899-82c9-db18c543bbb5
name: OPC_CONTACT_HISTORY_LTM
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 562c5055-039f-4ac1-8e14-0d7f339b141d
          stepCounter: 0d0b04cf-890d-4899-82c9-db18c543bbb5
        config: {}
        dataType: INT
        defaultValue: ""
        description: Level 1 Force Id
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8e5846-542f-4c4c-8618-b8c9351dbfb5
                stepCounter: 99213c3f-8996-4ff5-a594-ec2ae782058b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3787ab9-7595-4565-8ee5-01422fbcb16b
          stepCounter: 0d0b04cf-890d-4899-82c9-db18c543bbb5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Contact Created Month
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATED_MONTH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43ebc324-ce79-496e-ba0c-faee0278cdd8
                stepCounter: 99213c3f-8996-4ff5-a594-ec2ae782058b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe847ae4-d743-4a54-9f8d-757e078f03a6
          stepCounter: 0d0b04cf-890d-4899-82c9-db18c543bbb5
        config: {}
        dataType: INT
        defaultValue: ""
        description: Contact Count by ForceId, Contact Created Month
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACT_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 464fc9b1-e91a-499d-8481-41b01331b392
                stepCounter: 99213c3f-8996-4ff5-a594-ec2ae782058b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bca96be7-ba92-4bc9-8e04-429aacb9c48f
          stepCounter: 0d0b04cf-890d-4899-82c9-db18c543bbb5
        config: {}
        dataType: INT
        defaultValue: ""
        description: Running Contact Count by ForceId, Contact Created Date
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RUNNING_CONTACT_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4185b679-18a7-409d-9b65-96626e9a5c78
                stepCounter: 99213c3f-8996-4ff5-a594-ec2ae782058b
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_CONTACT_HISTORY: 99213c3f-8996-4ff5-a594-ec2ae782058b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_CONTACT_HISTORY
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_CONTACT_HISTORY') }}
             WHERE DATEDIFF('MONTH',OPC_Contact_History.Created_Month,LAST_DAY(CURRENT_DATE())) BETWEEN 1 AND 12
        name: OPC_CONTACT_HISTORY_LTM
        noLinkRefs: []
  name: OPC_CONTACT_HISTORY_LTM
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
