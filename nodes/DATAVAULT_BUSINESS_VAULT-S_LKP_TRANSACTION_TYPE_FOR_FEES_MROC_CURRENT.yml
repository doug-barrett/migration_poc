fileVersion: 1
id: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65f5abf2-116e-4f5f-867f-df4301583313
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_TRANSACTION_TYPE_FOR_FEES
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb34a039-8f36-4a12-aaaf-1bc6611e6615
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1775287f-5e1b-45ff-9171-36026e625297
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TXN_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcf1a556-a91a-482b-93ef-b86de0128eb6
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1db28bc0-66e6-4316-a5c5-f341f5d2d761
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 244294fe-9df7-476b-8beb-3dab2e54c56f
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f545974-5f73-41f0-827b-21fff0cf11b7
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b710551-711b-4587-8940-f2ece10ff98e
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 277ff643-7064-48a2-8a98-f705addfdd97
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TXN_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 298f393d-2727-42ce-b472-dfa9837fc90d
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a003e66-64a5-45d8-8014-e6f3a4263f64
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f78671e-ebc9-4ba9-bd5c-4983ec976651
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50fc86a9-2a0f-4404-94aa-95bf03c66def
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ff0319-0621-4997-b649-7300808eab8d
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73877777-beb9-44aa-b6c1-d81fcbd575bd
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c900f8af-13df-40c5-bb0d-a582f7e1d948
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e91c5e37-ad08-4d64-bec1-ca0fdd65eaff
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9677ed2a-531c-4327-aada-56784ab4eaa3
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 457b7068-6dc5-48ac-9830-6bc4ca777cc6
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 392f96e7-3b2e-4eed-8a73-5e1169360907
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8e62165-c62f-45c5-89ca-8dbe2694bbac
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ed96262-161b-4d4e-89b3-81519ec4f80a
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fcb10c9-bd60-478b-a2a5-ee0af9ddc269
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1c41c6a-41d4-4ec8-9ed4-20b794fb0b29
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c52a4fc-9619-4063-b4fb-f0152c634e07
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c2c06c5-a1d6-402b-aa7b-6157c23c0a2b
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03f42cd7-937f-4204-9350-7aa3d5f74327
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e35bcb00-e8d3-4337-b29e-9b4bb85bc635
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b852d157-3a0e-4d7e-bb33-28e3efbca701
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c717513-fd42-4f6d-a404-f5ce644ba914
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14b77e65-5179-45f5-a79c-54744be3df08
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d72e7ed-d626-4b4c-85ae-0b0bf06459ff
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ccf4997-3dcf-4599-9944-0236b52febc9
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ebb11f-295d-4dc5-9c21-1c1943ef199d
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 686b70b3-7f6a-4cf9-9449-0d50121e7200
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cf30e24-93c5-4ab2-a33f-b86cee348748
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1664828-d536-4a8c-ab09-04799843d8f2
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffe717b7-cd55-46da-b703-c3235982f844
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fc4b531-a5bf-4a2c-9d16-43b0eb095d0d
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa409f2-e464-4032-8bc0-3a466082bdc2
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 859b11d8-3e01-4673-ac3d-b2d825c94734
          stepCounter: 37b9ffb1-846d-46ec-aa4f-1a72ac7d8b7a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ab34d39-b200-4e65-91c2-79f1a7825ca8
                stepCounter: e72aea18-4b7a-498b-866c-cc68c3e2094e
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC: e72aea18-4b7a-498b-866c-cc68c3e2094e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC') }} s_lkp_transaction_type_for_fees_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_transaction_type_for_fees,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC') }}
                     GROUP BY hk_h_lkp_transaction_type_for_fees
                   ) curr
                ON curr.hk_h_lkp_transaction_type_for_fees = s_lkp_transaction_type_for_fees_mroc.hk_h_lkp_transaction_type_for_fees
               AND curr.dss_start_date = s_lkp_transaction_type_for_fees_mroc.dss_start_date
        name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
