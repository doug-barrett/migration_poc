fileVersion: 1
id: 47c48181-f155-49d6-af13-4beee24eb0fb
name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8555cd75-e801-4803-94ea-15260ec38f12
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_TRANSACTION_TYPE_FOR_FEES
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14a05a07-3dbe-4890-a3d9-1fe2a40bc2e2
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb1cadfe-5261-4fc7-bfb1-a1eb16c277e1
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TXN_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d95e0e4a-cfe3-4de0-b105-71da8f8b42c8
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 408e522c-7470-4d21-ad49-05d0697cd53e
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 197006fc-2dd6-4d74-b3df-1726a87499e1
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa8277f7-b204-4e1a-8025-c1f22eabf45d
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9570c73e-ec79-46aa-a1a2-6360eb42e522
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c33d601-6a9a-49f8-b12a-2e680ed2c54c
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TXN_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d20d83-7fb0-4577-a3b2-9edd6bccb86b
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 408b9dba-43bb-47d8-af74-b0f5850cde27
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e03d1162-de78-46f0-888f-0f944eccb2ec
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba071aaa-5ca8-47ee-9f38-f596ee382525
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cf69551-dea9-45f0-a692-30eb989aaa05
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c44addc6-cb97-44c8-a2c3-571deca3fc0f
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3912d891-b0fe-4888-8ba8-28008bd7f8da
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c6cedda-4cef-43ba-91dc-2d9ed9528d78
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 093068d2-6088-443c-8968-72e534a0c9d8
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fae63c59-6ea2-49e3-a332-2d1349b261bd
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93a723e8-8a05-4988-b90e-212a58d71341
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7054cd8f-4234-47d0-866c-7f3e71d12154
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e21f6f4d-c483-4595-b115-a5ad311a0669
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bd34fb4-fd70-4100-8607-00511e202dbd
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 889b0657-1bef-4f25-8e79-f632475fdc4c
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ce77845-a7ef-4d1c-8ca4-762fab78d17d
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b41b6881-ed2a-49c3-8bda-d639f2c7443d
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50553de1-f38a-46f6-81eb-9154415558e1
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ec46085-6277-439f-aed3-505fd1acf404
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c1f4d1b-a906-4ca8-8b39-574c1d2ac921
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65d09d2c-f031-4822-bc89-1dc315aec822
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38c53b4f-61db-4dab-9612-cde112e97fca
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c46bbb6-6086-4884-8440-e90ddb8cd608
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 987efc11-8b42-4e15-862b-584cc9a6749d
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ac71ac4-b97f-4598-8ae6-8b694722596f
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d38c5f9-c237-4812-b876-c3874cd19644
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00768bf4-6be9-4b59-8f98-64c2a65e349f
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 140090d0-047a-4030-8b3a-95a95893496c
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 604fcf98-0952-4454-b28a-294fa7a87d2b
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67990e5c-9dd3-497b-a6d5-f67e05d7d4e8
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 711032c9-e18c-4b20-ac76-2f258d85f28b
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfde5550-0728-4b2d-b016-f6d6e29cd59a
          stepCounter: 47c48181-f155-49d6-af13-4beee24eb0fb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbbed972-3b98-40e1-a178-4c9826cb3db7
                stepCounter: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC: 7d07f735-5a5b-48b3-b612-f2b16dab66ff
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC') }} s_lkp_transaction_type_for_fees_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_transaction_type_for_fees,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC') }}
                     GROUP BY hk_h_lkp_transaction_type_for_fees
                   ) curr
                ON curr.hk_h_lkp_transaction_type_for_fees = s_lkp_transaction_type_for_fees_mroc.hk_h_lkp_transaction_type_for_fees
               AND curr.dss_start_date = s_lkp_transaction_type_for_fees_mroc.dss_start_date
        name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_TRANSACTION_TYPE_FOR_FEES_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
