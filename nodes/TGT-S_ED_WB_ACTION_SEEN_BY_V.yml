fileVersion: 1
id: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
name: S_ED_WB_ACTION_SEEN_BY_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Limits WB actinos to just the seen by data"
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88671fc3-9f27-42d3-9c0f-a129c4fd7676
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: INT
        defaultValue: ""
        description: whiteboard unique id from WB cacheAudit table
        name: WHITEBOARD_ACTION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06a3f6f1-2282-4931-88fb-46eb98927d37
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2d5accf-5847-4762-97b8-7ad9e3d441a8
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM encounter number
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5aa4eb6e-b2f8-40b6-839d-50a00c2fae70
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 380fc34b-23d0-436b-b231-90eed8d1e532
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM specialty under which the action was performed
        name: WB_ACTION_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63fca3b7-9f4b-49df-bcda-da51ea6ffd1b
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 070aae4e-5c9f-46da-b1be-463acd5d8f13
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'iPM specialty group EMMED or other as they are managed independently '
        name: SPECIALTY_CODE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a537c86-4191-4d16-a4a3-f505e7b72deb
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7bb1637-e73e-437c-b43e-2d23c20b2024
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: WB_ACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc81555f-9005-4784-ba73-e324bed333af
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46b332ca-4315-4007-b837-1d83e1bbc1f1
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence of seen by action within encounter
        name: SEEN_BY_ACTION_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 715ff9b9-998a-4442-ab94-d30e29ea31e6
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3e597af-40a1-4125-9b21-9a22f5469a01
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'Sequence or seen bys within an specialty grouping '
        name: SPECIALTY_GROUP_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3669ed5a-fc7a-4583-b038-cb6387e187b8
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d55b07-4dec-4596-a0a7-905cea366b85
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'Reverse Sequence for seen bys within an specialty grouping '
        name: SPECIALTY_GROUP_SEQUENCE_REV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb348728-1d99-4000-a1f4-7da3346abedf
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43d62630-5c22-4b97-b525-77ad1293195f
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_consolidate_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_ED_WB_ACTION_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9eb4757-83dd-43e9-83e6-a9ace615f6df
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66726236-e208-4014-8b32-b81909041a21
          stepCounter: 72ef2eec-eaf1-4bc9-b7c7-363a6be4db73
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WB_ACTION_PERFORMED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8809181-3e06-48d9-9497-cdf2274b42cf
                stepCounter: a21d1ead-f234-445a-9637-b66949901878
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT whiteboard_action_key ,
                   attendance_encounter_id ,
                   WB_action_specialty_code ,
                   specialty_code_group ,
                   WB_action_date --,case when WB_action_performed='Doctor Seen By' then WB_action_date end WB_action_date
            ,
                   seen_by_action_sequence ,
                   specialty_group_sequence --,emergency_department_location_flag
             --,acute_diagnosis_unit_location_flag
             --,stop_clock_location_flag
             --,observation_location_flag
             ,
                   specialty_group_sequence_rev ,
                   dim_ED_WB_action_seenby_clinician_key ,
                   WB_action_performed
              FROM s_consolidate_whiteboard_action a --s_consolidate_whiteboard_action  a
            --from s_ed_whiteboard_action  a
            -- inner join dim.dim_ED_location ed on ed.dim_ED_location_key = a.dim_ED_location_key

             WHERE seen_by_action = 1
               AND removed_action = 0 -- and attendance_encounter_id = 'A1000163352'
            --order by a.attendance_encounter_id , a.wb_action_date
        dependencies:
          - locationName: TGT
            nodeName: S_CONSOLIDATE_WHITEBOARD_ACTION
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_CONSOLIDATE_WHITEBOARD_ACTION') }}
        name: S_ED_WB_ACTION_SEEN_BY_V
        noLinkRefs: []
  name: S_ED_WB_ACTION_SEEN_BY_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
